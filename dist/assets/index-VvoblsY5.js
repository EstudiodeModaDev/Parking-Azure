(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();var l0={exports:{}},Cl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cy;function ow(){if(cy)return Cl;cy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var h in s)h!=="key"&&(l[h]=s[h])}else l=s;return s=l.ref,{$$typeof:n,type:a,key:c,ref:s!==void 0?s:null,props:l}}return Cl.Fragment=e,Cl.jsx=t,Cl.jsxs=t,Cl}var uy;function lw(){return uy||(uy=1,l0.exports=ow()),l0.exports}var y=lw(),c0={exports:{}},Ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hy;function cw(){if(hy)return Ze;hy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function T(U){return U===null||typeof U!="object"?null:(U=v&&U[v]||U["@@iterator"],typeof U=="function"?U:null)}var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,_={};function A(U,ue,b){this.props=U,this.context=ue,this.refs=_,this.updater=b||x}A.prototype.isReactComponent={},A.prototype.setState=function(U,ue){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ue,"setState")},A.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function B(){}B.prototype=A.prototype;function I(U,ue,b){this.props=U,this.context=ue,this.refs=_,this.updater=b||x}var k=I.prototype=new B;k.constructor=I,C(k,A.prototype),k.isPureReactComponent=!0;var z=Array.isArray,X={H:null,A:null,T:null,S:null,V:null},W=Object.prototype.hasOwnProperty;function N(U,ue,b,L,P,j){return b=j.ref,{$$typeof:n,type:U,key:ue,ref:b!==void 0?b:null,props:j}}function G(U,ue){return N(U.type,ue,void 0,void 0,void 0,U.props)}function V(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function ie(U){var ue={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(b){return ue[b]})}var J=/\/+/g;function he(U,ue){return typeof U=="object"&&U!==null&&U.key!=null?ie(""+U.key):ue.toString(36)}function Ae(){}function je(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(Ae,Ae):(U.status="pending",U.then(function(ue){U.status==="pending"&&(U.status="fulfilled",U.value=ue)},function(ue){U.status==="pending"&&(U.status="rejected",U.reason=ue)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function ke(U,ue,b,L,P){var j=typeof U;(j==="undefined"||j==="boolean")&&(U=null);var Z=!1;if(U===null)Z=!0;else switch(j){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(U.$$typeof){case n:case e:Z=!0;break;case p:return Z=U._init,ke(Z(U._payload),ue,b,L,P)}}if(Z)return P=P(U),Z=L===""?"."+he(U,0):L,z(P)?(b="",Z!=null&&(b=Z.replace(J,"$&/")+"/"),ke(P,ue,b,"",function(Pe){return Pe})):P!=null&&(V(P)&&(P=G(P,b+(P.key==null||U&&U.key===P.key?"":(""+P.key).replace(J,"$&/")+"/")+Z)),ue.push(P)),1;Z=0;var be=L===""?".":L+":";if(z(U))for(var Ce=0;Ce<U.length;Ce++)L=U[Ce],j=be+he(L,Ce),Z+=ke(L,ue,b,j,P);else if(Ce=T(U),typeof Ce=="function")for(U=Ce.call(U),Ce=0;!(L=U.next()).done;)L=L.value,j=be+he(L,Ce++),Z+=ke(L,ue,b,j,P);else if(j==="object"){if(typeof U.then=="function")return ke(je(U),ue,b,L,P);throw ue=String(U),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return Z}function re(U,ue,b){if(U==null)return U;var L=[],P=0;return ke(U,L,"","",function(j){return ue.call(b,j,P++)}),L}function _e(U){if(U._status===-1){var ue=U._result;ue=ue(),ue.then(function(b){(U._status===0||U._status===-1)&&(U._status=1,U._result=b)},function(b){(U._status===0||U._status===-1)&&(U._status=2,U._result=b)}),U._status===-1&&(U._status=0,U._result=ue)}if(U._status===1)return U._result.default;throw U._result}var fe=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function Te(){}return Ze.Children={map:re,forEach:function(U,ue,b){re(U,function(){ue.apply(this,arguments)},b)},count:function(U){var ue=0;return re(U,function(){ue++}),ue},toArray:function(U){return re(U,function(ue){return ue})||[]},only:function(U){if(!V(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Ze.Component=A,Ze.Fragment=t,Ze.Profiler=s,Ze.PureComponent=I,Ze.StrictMode=a,Ze.Suspense=d,Ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=X,Ze.__COMPILER_RUNTIME={__proto__:null,c:function(U){return X.H.useMemoCache(U)}},Ze.cache=function(U){return function(){return U.apply(null,arguments)}},Ze.cloneElement=function(U,ue,b){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var L=C({},U.props),P=U.key,j=void 0;if(ue!=null)for(Z in ue.ref!==void 0&&(j=void 0),ue.key!==void 0&&(P=""+ue.key),ue)!W.call(ue,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&ue.ref===void 0||(L[Z]=ue[Z]);var Z=arguments.length-2;if(Z===1)L.children=b;else if(1<Z){for(var be=Array(Z),Ce=0;Ce<Z;Ce++)be[Ce]=arguments[Ce+2];L.children=be}return N(U.type,P,void 0,void 0,j,L)},Ze.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},Ze.createElement=function(U,ue,b){var L,P={},j=null;if(ue!=null)for(L in ue.key!==void 0&&(j=""+ue.key),ue)W.call(ue,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(P[L]=ue[L]);var Z=arguments.length-2;if(Z===1)P.children=b;else if(1<Z){for(var be=Array(Z),Ce=0;Ce<Z;Ce++)be[Ce]=arguments[Ce+2];P.children=be}if(U&&U.defaultProps)for(L in Z=U.defaultProps,Z)P[L]===void 0&&(P[L]=Z[L]);return N(U,j,void 0,void 0,null,P)},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(U){return{$$typeof:h,render:U}},Ze.isValidElement=V,Ze.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:_e}},Ze.memo=function(U,ue){return{$$typeof:g,type:U,compare:ue===void 0?null:ue}},Ze.startTransition=function(U){var ue=X.T,b={};X.T=b;try{var L=U(),P=X.S;P!==null&&P(b,L),typeof L=="object"&&L!==null&&typeof L.then=="function"&&L.then(Te,fe)}catch(j){fe(j)}finally{X.T=ue}},Ze.unstable_useCacheRefresh=function(){return X.H.useCacheRefresh()},Ze.use=function(U){return X.H.use(U)},Ze.useActionState=function(U,ue,b){return X.H.useActionState(U,ue,b)},Ze.useCallback=function(U,ue){return X.H.useCallback(U,ue)},Ze.useContext=function(U){return X.H.useContext(U)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(U,ue){return X.H.useDeferredValue(U,ue)},Ze.useEffect=function(U,ue,b){var L=X.H;if(typeof b=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return L.useEffect(U,ue)},Ze.useId=function(){return X.H.useId()},Ze.useImperativeHandle=function(U,ue,b){return X.H.useImperativeHandle(U,ue,b)},Ze.useInsertionEffect=function(U,ue){return X.H.useInsertionEffect(U,ue)},Ze.useLayoutEffect=function(U,ue){return X.H.useLayoutEffect(U,ue)},Ze.useMemo=function(U,ue){return X.H.useMemo(U,ue)},Ze.useOptimistic=function(U,ue){return X.H.useOptimistic(U,ue)},Ze.useReducer=function(U,ue,b){return X.H.useReducer(U,ue,b)},Ze.useRef=function(U){return X.H.useRef(U)},Ze.useState=function(U){return X.H.useState(U)},Ze.useSyncExternalStore=function(U,ue,b){return X.H.useSyncExternalStore(U,ue,b)},Ze.useTransition=function(){return X.H.useTransition()},Ze.version="19.1.1",Ze}var fy;function J0(){return fy||(fy=1,c0.exports=cw()),c0.exports}var K=J0(),u0={exports:{}},El={},h0={exports:{}},f0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dy;function uw(){return dy||(dy=1,(function(n){function e(re,_e){var fe=re.length;re.push(_e);e:for(;0<fe;){var Te=fe-1>>>1,U=re[Te];if(0<s(U,_e))re[Te]=_e,re[fe]=U,fe=Te;else break e}}function t(re){return re.length===0?null:re[0]}function a(re){if(re.length===0)return null;var _e=re[0],fe=re.pop();if(fe!==_e){re[0]=fe;e:for(var Te=0,U=re.length,ue=U>>>1;Te<ue;){var b=2*(Te+1)-1,L=re[b],P=b+1,j=re[P];if(0>s(L,fe))P<U&&0>s(j,L)?(re[Te]=j,re[P]=fe,Te=P):(re[Te]=L,re[b]=fe,Te=b);else if(P<U&&0>s(j,fe))re[Te]=j,re[P]=fe,Te=P;else break e}}return _e}function s(re,_e){var fe=re.sortIndex-_e.sortIndex;return fe!==0?fe:re.id-_e.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],g=[],p=1,v=null,T=3,x=!1,C=!1,_=!1,A=!1,B=typeof setTimeout=="function"?setTimeout:null,I=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function z(re){for(var _e=t(g);_e!==null;){if(_e.callback===null)a(g);else if(_e.startTime<=re)a(g),_e.sortIndex=_e.expirationTime,e(d,_e);else break;_e=t(g)}}function X(re){if(_=!1,z(re),!C)if(t(d)!==null)C=!0,W||(W=!0,he());else{var _e=t(g);_e!==null&&ke(X,_e.startTime-re)}}var W=!1,N=-1,G=5,V=-1;function ie(){return A?!0:!(n.unstable_now()-V<G)}function J(){if(A=!1,W){var re=n.unstable_now();V=re;var _e=!0;try{e:{C=!1,_&&(_=!1,I(N),N=-1),x=!0;var fe=T;try{t:{for(z(re),v=t(d);v!==null&&!(v.expirationTime>re&&ie());){var Te=v.callback;if(typeof Te=="function"){v.callback=null,T=v.priorityLevel;var U=Te(v.expirationTime<=re);if(re=n.unstable_now(),typeof U=="function"){v.callback=U,z(re),_e=!0;break t}v===t(d)&&a(d),z(re)}else a(d);v=t(d)}if(v!==null)_e=!0;else{var ue=t(g);ue!==null&&ke(X,ue.startTime-re),_e=!1}}break e}finally{v=null,T=fe,x=!1}_e=void 0}}finally{_e?he():W=!1}}}var he;if(typeof k=="function")he=function(){k(J)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,je=Ae.port2;Ae.port1.onmessage=J,he=function(){je.postMessage(null)}}else he=function(){B(J,0)};function ke(re,_e){N=B(function(){re(n.unstable_now())},_e)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return T},n.unstable_next=function(re){switch(T){case 1:case 2:case 3:var _e=3;break;default:_e=T}var fe=T;T=_e;try{return re()}finally{T=fe}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(re,_e){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var fe=T;T=re;try{return _e()}finally{T=fe}},n.unstable_scheduleCallback=function(re,_e,fe){var Te=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Te+fe:Te):fe=Te,re){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=fe+U,re={id:p++,callback:_e,priorityLevel:re,startTime:fe,expirationTime:U,sortIndex:-1},fe>Te?(re.sortIndex=fe,e(g,re),t(d)===null&&re===t(g)&&(_?(I(N),N=-1):_=!0,ke(X,fe-Te))):(re.sortIndex=U,e(d,re),C||x||(C=!0,W||(W=!0,he()))),re},n.unstable_shouldYield=ie,n.unstable_wrapCallback=function(re){var _e=T;return function(){var fe=T;T=_e;try{return re.apply(this,arguments)}finally{T=fe}}}})(f0)),f0}var gy;function hw(){return gy||(gy=1,h0.exports=uw()),h0.exports}var d0={exports:{}},Mn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var my;function fw(){if(my)return Mn;my=1;var n=J0();function e(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)g+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(d,g,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:g,implementation:p}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,g){if(d==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Mn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Mn.createPortal=function(d,g){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(d,g,null,p)},Mn.flushSync=function(d){var g=c.T,p=a.p;try{if(c.T=null,a.p=2,d)return d()}finally{c.T=g,a.p=p,a.d.f()}},Mn.preconnect=function(d,g){typeof d=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,a.d.C(d,g))},Mn.prefetchDNS=function(d){typeof d=="string"&&a.d.D(d)},Mn.preinit=function(d,g){if(typeof d=="string"&&g&&typeof g.as=="string"){var p=g.as,v=h(p,g.crossOrigin),T=typeof g.integrity=="string"?g.integrity:void 0,x=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;p==="style"?a.d.S(d,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:T,fetchPriority:x}):p==="script"&&a.d.X(d,{crossOrigin:v,integrity:T,fetchPriority:x,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Mn.preinitModule=function(d,g){if(typeof d=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var p=h(g.as,g.crossOrigin);a.d.M(d,{crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&a.d.M(d)},Mn.preload=function(d,g){if(typeof d=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var p=g.as,v=h(p,g.crossOrigin);a.d.L(d,p,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Mn.preloadModule=function(d,g){if(typeof d=="string")if(g){var p=h(g.as,g.crossOrigin);a.d.m(d,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else a.d.m(d)},Mn.requestFormReset=function(d){a.d.r(d)},Mn.unstable_batchedUpdates=function(d,g){return d(g)},Mn.useFormState=function(d,g,p){return c.H.useFormState(d,g,p)},Mn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Mn.version="19.1.1",Mn}var py;function tx(){if(py)return d0.exports;py=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),d0.exports=fw(),d0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vy;function dw(){if(vy)return El;vy=1;var n=hw(),e=J0(),t=tx();function a(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(a(188))}function d(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(a(188));return i!==r?null:r}for(var o=r,u=i;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return h(f),r;if(m===u)return h(f),i;m=m.sibling}throw Error(a(188))}if(o.return!==u.return)o=f,u=m;else{for(var S=!1,w=f.child;w;){if(w===o){S=!0,o=f,u=m;break}if(w===u){S=!0,u=f,o=m;break}w=w.sibling}if(!S){for(w=m.child;w;){if(w===o){S=!0,o=m,u=f;break}if(w===u){S=!0,u=m,o=f;break}w=w.sibling}if(!S)throw Error(a(189))}}if(o.alternate!==u)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?r:i}function g(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=g(r),i!==null)return i;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),T=Symbol.for("react.transitional.element"),x=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),_=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),I=Symbol.for("react.consumer"),k=Symbol.for("react.context"),z=Symbol.for("react.forward_ref"),X=Symbol.for("react.suspense"),W=Symbol.for("react.suspense_list"),N=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),V=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function he(r){return r===null||typeof r!="object"?null:(r=J&&r[J]||r["@@iterator"],typeof r=="function"?r:null)}var Ae=Symbol.for("react.client.reference");function je(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Ae?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case A:return"Profiler";case _:return"StrictMode";case X:return"Suspense";case W:return"SuspenseList";case V:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case x:return"Portal";case k:return(r.displayName||"Context")+".Provider";case I:return(r._context.displayName||"Context")+".Consumer";case z:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case N:return i=r.displayName||null,i!==null?i:je(r.type)||"Memo";case G:i=r._payload,r=r._init;try{return je(r(i))}catch{}}return null}var ke=Array.isArray,re=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,_e=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Te=[],U=-1;function ue(r){return{current:r}}function b(r){0>U||(r.current=Te[U],Te[U]=null,U--)}function L(r,i){U++,Te[U]=r.current,r.current=i}var P=ue(null),j=ue(null),Z=ue(null),be=ue(null);function Ce(r,i){switch(L(Z,i),L(j,r),L(P,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?Lv(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=Lv(i),r=Uv(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}b(P),L(P,r)}function Pe(){b(P),b(j),b(Z)}function De(r){r.memoizedState!==null&&L(be,r);var i=P.current,o=Uv(i,r.type);i!==o&&(L(j,r),L(P,o))}function ot(r){j.current===r&&(b(P),b(j)),be.current===r&&(b(be),yl._currentValue=fe)}var et=Object.prototype.hasOwnProperty,jt=n.unstable_scheduleCallback,lt=n.unstable_cancelCallback,Un=n.unstable_shouldYield,kt=n.unstable_requestPaint,Fe=n.unstable_now,Nn=n.unstable_getCurrentPriorityLevel,Bn=n.unstable_ImmediatePriority,Cr=n.unstable_UserBlockingPriority,sr=n.unstable_NormalPriority,Me=n.unstable_LowPriority,Ot=n.unstable_IdlePriority,vn=n.log,Hn=n.unstable_setDisableYieldValue,jn=null,yn=null;function kn(r){if(typeof vn=="function"&&Hn(r),yn&&typeof yn.setStrictMode=="function")try{yn.setStrictMode(jn,r)}catch{}}var zn=Math.clz32?Math.clz32:hc,cc=Math.log,uc=Math.LN2;function hc(r){return r>>>=0,r===0?32:31-(cc(r)/uc|0)|0}var Ri=256,Ni=4194304;function ea(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function gs(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var f=0,m=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var w=u&134217727;return w!==0?(u=w&~m,u!==0?f=ea(u):(S&=w,S!==0?f=ea(S):o||(o=w&~r,o!==0&&(f=ea(o))))):(w=u&~m,w!==0?f=ea(w):S!==0?f=ea(S):o||(o=u&~r,o!==0&&(f=ea(o)))),f===0?0:i!==0&&i!==f&&(i&m)===0&&(m=f&-f,o=i&-i,m>=o||m===32&&(o&4194048)!==0)?i:f}function ki(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function fc(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Ao(){var r=Ri;return Ri<<=1,(Ri&4194048)===0&&(Ri=256),r}function wo(){var r=Ni;return Ni<<=1,(Ni&62914560)===0&&(Ni=4194304),r}function bo(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Oi(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ms(r,i,o,u,f,m){var S=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var w=r.entanglements,H=r.expirationTimes,ne=r.hiddenUpdates;for(o=S&~o;0<o;){var me=31-zn(o),xe=1<<me;w[me]=0,H[me]=-1;var oe=ne[me];if(oe!==null)for(ne[me]=null,me=0;me<oe.length;me++){var ce=oe[me];ce!==null&&(ce.lane&=-536870913)}o&=~xe}u!==0&&dc(r,u,0),m!==0&&f===0&&r.tag!==0&&(r.suspendedLanes|=m&~(S&~i))}function dc(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-zn(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&4194090}function gc(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-zn(o),f=1<<u;f&i|r[u]&i&&(r[u]|=i),o&=~f}}function Io(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Ro(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function mc(){var r=_e.p;return r!==0?r:(r=window.event,r===void 0?32:ry(r.type))}function nf(r,i){var o=_e.p;try{return _e.p=r,i()}finally{_e.p=o}}var ta=Math.random().toString(36).slice(2),on="__reactFiber$"+ta,ln="__reactProps$"+ta,Ga="__reactContainer$"+ta,No="__reactEvents$"+ta,rf="__reactListeners$"+ta,E="__reactHandles$"+ta,D="__reactResources$"+ta,R="__reactMarker$"+ta;function O(r){delete r[on],delete r[ln],delete r[No],delete r[rf],delete r[E]}function M(r){var i=r[on];if(i)return i;for(var o=r.parentNode;o;){if(i=o[Ga]||o[on]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=zv(r);r!==null;){if(o=r[on])return o;r=zv(r)}return i}r=o,o=r.parentNode}return null}function F(r){if(r=r[on]||r[Ga]){var i=r.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return r}return null}function ae(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(a(33))}function de(r){var i=r[D];return i||(i=r[D]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ee(r){r[R]=!0}var se=new Set,le={};function Ee(r,i){Re(r,i),Re(r+"Capture",i)}function Re(r,i){for(le[r]=i,r=0;r<i.length;r++)se.add(i[r])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Le={};function We(r){return et.call(Le,r)?!0:et.call(Ie,r)?!1:Be.test(r)?Le[r]=!0:(Ie[r]=!0,!1)}function St(r,i,o){if(We(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Ct(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function Pt(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}var ya,$a;function Er(r){if(ya===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);ya=i&&i[1]||"",$a=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+ya+r+$a}var Br=!1;function Mi(r,i){if(!r||Br)return"";Br=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var xe=function(){throw Error()};if(Object.defineProperty(xe.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(xe,[])}catch(ce){var oe=ce}Reflect.construct(r,[],xe)}else{try{xe.call()}catch(ce){oe=ce}r.call(xe.prototype)}}else{try{throw Error()}catch(ce){oe=ce}(xe=r())&&typeof xe.catch=="function"&&xe.catch(function(){})}}catch(ce){if(ce&&oe&&typeof ce.stack=="string")return[ce.stack,oe.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),S=m[0],w=m[1];if(S&&w){var H=S.split(`
`),ne=w.split(`
`);for(f=u=0;u<H.length&&!H[u].includes("DetermineComponentFrameRoot");)u++;for(;f<ne.length&&!ne[f].includes("DetermineComponentFrameRoot");)f++;if(u===H.length||f===ne.length)for(u=H.length-1,f=ne.length-1;1<=u&&0<=f&&H[u]!==ne[f];)f--;for(;1<=u&&0<=f;u--,f--)if(H[u]!==ne[f]){if(u!==1||f!==1)do if(u--,f--,0>f||H[u]!==ne[f]){var me=`
`+H[u].replace(" at new "," at ");return r.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",r.displayName)),me}while(1<=u&&0<=f);break}}}finally{Br=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?Er(o):""}function Hr(r){switch(r.tag){case 26:case 27:case 5:return Er(r.type);case 16:return Er("Lazy");case 13:return Er("Suspense");case 19:return Er("SuspenseList");case 0:case 15:return Mi(r.type,!1);case 11:return Mi(r.type.render,!1);case 1:return Mi(r.type,!0);case 31:return Er("Activity");default:return""}}function km(r){try{var i="";do i+=Hr(r),r=r.return;while(r);return i}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Ar(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Om(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function nE(r){var i=Om(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),u=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,m=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return f.call(this)},set:function(S){u=""+S,m.call(this,S)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function pc(r){r._valueTracker||(r._valueTracker=nE(r))}function Mm(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=Om(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function vc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var rE=/[\n"\\]/g;function wr(r){return r.replace(rE,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function af(r,i,o,u,f,m,S,w){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),i!=null?S==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+Ar(i)):r.value!==""+Ar(i)&&(r.value=""+Ar(i)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),i!=null?sf(r,S,Ar(i)):o!=null?sf(r,S,Ar(o)):u!=null&&r.removeAttribute("value"),f==null&&m!=null&&(r.defaultChecked=!!m),f!=null&&(r.checked=f&&typeof f!="function"&&typeof f!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.name=""+Ar(w):r.removeAttribute("name")}function Dm(r,i,o,u,f,m,S,w){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(r.type=m),i!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||i!=null))return;o=o!=null?""+Ar(o):"",i=i!=null?""+Ar(i):o,w||i===r.value||(r.value=i),r.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=w?r.checked:!!u,r.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S)}function sf(r,i,o){i==="number"&&vc(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function ps(r,i,o,u){if(r=r.options,i){i={};for(var f=0;f<o.length;f++)i["$"+o[f]]=!0;for(o=0;o<r.length;o++)f=i.hasOwnProperty("$"+r[o].value),r[o].selected!==f&&(r[o].selected=f),f&&u&&(r[o].defaultSelected=!0)}else{for(o=""+Ar(o),i=null,f=0;f<r.length;f++){if(r[f].value===o){r[f].selected=!0,u&&(r[f].defaultSelected=!0);return}i!==null||r[f].disabled||(i=r[f])}i!==null&&(i.selected=!0)}}function Pm(r,i,o){if(i!=null&&(i=""+Ar(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+Ar(o):""}function Fm(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(a(92));if(ke(u)){if(1<u.length)throw Error(a(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=Ar(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u)}function vs(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var aE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Lm(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||aE.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function Um(r,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&o[f]!==u&&Lm(r,f,u)}else for(var m in i)i.hasOwnProperty(m)&&Lm(r,m,i[m])}function of(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var iE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),sE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function yc(r){return sE.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var lf=null;function cf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var ys=null,Ts=null;function Bm(r){var i=F(r);if(i&&(r=i.stateNode)){var o=r[ln]||null;e:switch(r=i.stateNode,i.type){case"input":if(af(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+wr(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var f=u[ln]||null;if(!f)throw Error(a(90));af(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&Mm(u)}break e;case"textarea":Pm(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&ps(r,!!o.multiple,i,!1)}}}var uf=!1;function Hm(r,i,o){if(uf)return r(i,o);uf=!0;try{var u=r(i);return u}finally{if(uf=!1,(ys!==null||Ts!==null)&&(ru(),ys&&(i=ys,r=Ts,Ts=ys=null,Bm(i),r)))for(i=0;i<r.length;i++)Bm(r[i])}}function ko(r,i){var o=r.stateNode;if(o===null)return null;var u=o[ln]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var Ta=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),hf=!1;if(Ta)try{var Oo={};Object.defineProperty(Oo,"passive",{get:function(){hf=!0}}),window.addEventListener("test",Oo,Oo),window.removeEventListener("test",Oo,Oo)}catch{hf=!1}var Ka=null,ff=null,Tc=null;function jm(){if(Tc)return Tc;var r,i=ff,o=i.length,u,f="value"in Ka?Ka.value:Ka.textContent,m=f.length;for(r=0;r<o&&i[r]===f[r];r++);var S=o-r;for(u=1;u<=S&&i[o-u]===f[m-u];u++);return Tc=f.slice(r,1<u?1-u:void 0)}function xc(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function _c(){return!0}function zm(){return!1}function Wn(r){function i(o,u,f,m,S){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=m,this.target=S,this.currentTarget=null;for(var w in r)r.hasOwnProperty(w)&&(o=r[w],this[w]=o?o(m):m[w]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?_c:zm,this.isPropagationStopped=zm,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=_c)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=_c)},persist:function(){},isPersistent:_c}),i}var Di={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Sc=Wn(Di),Mo=p({},Di,{view:0,detail:0}),oE=Wn(Mo),df,gf,Do,Cc=p({},Mo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:pf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Do&&(Do&&r.type==="mousemove"?(df=r.screenX-Do.screenX,gf=r.screenY-Do.screenY):gf=df=0,Do=r),df)},movementY:function(r){return"movementY"in r?r.movementY:gf}}),Gm=Wn(Cc),lE=p({},Cc,{dataTransfer:0}),cE=Wn(lE),uE=p({},Mo,{relatedTarget:0}),mf=Wn(uE),hE=p({},Di,{animationName:0,elapsedTime:0,pseudoElement:0}),fE=Wn(hE),dE=p({},Di,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),gE=Wn(dE),mE=p({},Di,{data:0}),$m=Wn(mE),pE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},vE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},yE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function TE(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=yE[r])?!!i[r]:!1}function pf(){return TE}var xE=p({},Mo,{key:function(r){if(r.key){var i=pE[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=xc(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?vE[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:pf,charCode:function(r){return r.type==="keypress"?xc(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?xc(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),_E=Wn(xE),SE=p({},Cc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Km=Wn(SE),CE=p({},Mo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:pf}),EE=Wn(CE),AE=p({},Di,{propertyName:0,elapsedTime:0,pseudoElement:0}),wE=Wn(AE),bE=p({},Cc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),IE=Wn(bE),RE=p({},Di,{newState:0,oldState:0}),NE=Wn(RE),kE=[9,13,27,32],vf=Ta&&"CompositionEvent"in window,Po=null;Ta&&"documentMode"in document&&(Po=document.documentMode);var OE=Ta&&"TextEvent"in window&&!Po,Vm=Ta&&(!vf||Po&&8<Po&&11>=Po),qm=" ",Ym=!1;function Xm(r,i){switch(r){case"keyup":return kE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Wm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var xs=!1;function ME(r,i){switch(r){case"compositionend":return Wm(i);case"keypress":return i.which!==32?null:(Ym=!0,qm);case"textInput":return r=i.data,r===qm&&Ym?null:r;default:return null}}function DE(r,i){if(xs)return r==="compositionend"||!vf&&Xm(r,i)?(r=jm(),Tc=ff=Ka=null,xs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return Vm&&i.locale!=="ko"?null:i.data;default:return null}}var PE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Qm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!PE[r.type]:i==="textarea"}function Jm(r,i,o,u){ys?Ts?Ts.push(u):Ts=[u]:ys=u,i=cu(i,"onChange"),0<i.length&&(o=new Sc("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var Fo=null,Lo=null;function FE(r){Ov(r,0)}function Ec(r){var i=ae(r);if(Mm(i))return r}function Zm(r,i){if(r==="change")return i}var ep=!1;if(Ta){var yf;if(Ta){var Tf="oninput"in document;if(!Tf){var tp=document.createElement("div");tp.setAttribute("oninput","return;"),Tf=typeof tp.oninput=="function"}yf=Tf}else yf=!1;ep=yf&&(!document.documentMode||9<document.documentMode)}function np(){Fo&&(Fo.detachEvent("onpropertychange",rp),Lo=Fo=null)}function rp(r){if(r.propertyName==="value"&&Ec(Lo)){var i=[];Jm(i,Lo,r,cf(r)),Hm(FE,i)}}function LE(r,i,o){r==="focusin"?(np(),Fo=i,Lo=o,Fo.attachEvent("onpropertychange",rp)):r==="focusout"&&np()}function UE(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ec(Lo)}function BE(r,i){if(r==="click")return Ec(i)}function HE(r,i){if(r==="input"||r==="change")return Ec(i)}function jE(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var or=typeof Object.is=="function"?Object.is:jE;function Uo(r,i){if(or(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!et.call(i,f)||!or(r[f],i[f]))return!1}return!0}function ap(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function ip(r,i){var o=ap(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ap(o)}}function sp(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?sp(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function op(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=vc(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=vc(r.document)}return i}function xf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var zE=Ta&&"documentMode"in document&&11>=document.documentMode,_s=null,_f=null,Bo=null,Sf=!1;function lp(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Sf||_s==null||_s!==vc(u)||(u=_s,"selectionStart"in u&&xf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),Bo&&Uo(Bo,u)||(Bo=u,u=cu(_f,"onSelect"),0<u.length&&(i=new Sc("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=_s)))}function Pi(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var Ss={animationend:Pi("Animation","AnimationEnd"),animationiteration:Pi("Animation","AnimationIteration"),animationstart:Pi("Animation","AnimationStart"),transitionrun:Pi("Transition","TransitionRun"),transitionstart:Pi("Transition","TransitionStart"),transitioncancel:Pi("Transition","TransitionCancel"),transitionend:Pi("Transition","TransitionEnd")},Cf={},cp={};Ta&&(cp=document.createElement("div").style,"AnimationEvent"in window||(delete Ss.animationend.animation,delete Ss.animationiteration.animation,delete Ss.animationstart.animation),"TransitionEvent"in window||delete Ss.transitionend.transition);function Fi(r){if(Cf[r])return Cf[r];if(!Ss[r])return r;var i=Ss[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in cp)return Cf[r]=i[o];return r}var up=Fi("animationend"),hp=Fi("animationiteration"),fp=Fi("animationstart"),GE=Fi("transitionrun"),$E=Fi("transitionstart"),KE=Fi("transitioncancel"),dp=Fi("transitionend"),gp=new Map,Ef="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Ef.push("scrollEnd");function jr(r,i){gp.set(r,i),Ee(i,[r])}var mp=new WeakMap;function br(r,i){if(typeof r=="object"&&r!==null){var o=mp.get(r);return o!==void 0?o:(i={value:r,source:i,stack:km(i)},mp.set(r,i),i)}return{value:r,source:i,stack:km(i)}}var Ir=[],Cs=0,Af=0;function Ac(){for(var r=Cs,i=Af=Cs=0;i<r;){var o=Ir[i];Ir[i++]=null;var u=Ir[i];Ir[i++]=null;var f=Ir[i];Ir[i++]=null;var m=Ir[i];if(Ir[i++]=null,u!==null&&f!==null){var S=u.pending;S===null?f.next=f:(f.next=S.next,S.next=f),u.pending=f}m!==0&&pp(o,f,m)}}function wc(r,i,o,u){Ir[Cs++]=r,Ir[Cs++]=i,Ir[Cs++]=o,Ir[Cs++]=u,Af|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function wf(r,i,o,u){return wc(r,i,o,u),bc(r)}function Es(r,i){return wc(r,null,null,i),bc(r)}function pp(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var f=!1,m=r.return;m!==null;)m.childLanes|=o,u=m.alternate,u!==null&&(u.childLanes|=o),m.tag===22&&(r=m.stateNode,r===null||r._visibility&1||(f=!0)),r=m,m=m.return;return r.tag===3?(m=r.stateNode,f&&i!==null&&(f=31-zn(o),r=m.hiddenUpdates,u=r[f],u===null?r[f]=[i]:u.push(i),i.lane=o|536870912),m):null}function bc(r){if(50<ul)throw ul=0,Od=null,Error(a(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var As={};function VE(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function lr(r,i,o,u){return new VE(r,i,o,u)}function bf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xa(r,i){var o=r.alternate;return o===null?(o=lr(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function vp(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Ic(r,i,o,u,f,m){var S=0;if(u=r,typeof r=="function")bf(r)&&(S=1);else if(typeof r=="string")S=YA(r,o,P.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case V:return r=lr(31,o,i,f),r.elementType=V,r.lanes=m,r;case C:return Li(o.children,f,m,i);case _:S=8,f|=24;break;case A:return r=lr(12,o,i,f|2),r.elementType=A,r.lanes=m,r;case X:return r=lr(13,o,i,f),r.elementType=X,r.lanes=m,r;case W:return r=lr(19,o,i,f),r.elementType=W,r.lanes=m,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B:case k:S=10;break e;case I:S=9;break e;case z:S=11;break e;case N:S=14;break e;case G:S=16,u=null;break e}S=29,o=Error(a(130,r===null?"null":typeof r,"")),u=null}return i=lr(S,o,i,f),i.elementType=r,i.type=u,i.lanes=m,i}function Li(r,i,o,u){return r=lr(7,r,u,i),r.lanes=o,r}function If(r,i,o){return r=lr(6,r,null,i),r.lanes=o,r}function Rf(r,i,o){return i=lr(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var ws=[],bs=0,Rc=null,Nc=0,Rr=[],Nr=0,Ui=null,_a=1,Sa="";function Bi(r,i){ws[bs++]=Nc,ws[bs++]=Rc,Rc=r,Nc=i}function yp(r,i,o){Rr[Nr++]=_a,Rr[Nr++]=Sa,Rr[Nr++]=Ui,Ui=r;var u=_a;r=Sa;var f=32-zn(u)-1;u&=~(1<<f),o+=1;var m=32-zn(i)+f;if(30<m){var S=f-f%5;m=(u&(1<<S)-1).toString(32),u>>=S,f-=S,_a=1<<32-zn(i)+f|o<<f|u,Sa=m+r}else _a=1<<m|o<<f|u,Sa=r}function Nf(r){r.return!==null&&(Bi(r,1),yp(r,1,0))}function kf(r){for(;r===Rc;)Rc=ws[--bs],ws[bs]=null,Nc=ws[--bs],ws[bs]=null;for(;r===Ui;)Ui=Rr[--Nr],Rr[Nr]=null,Sa=Rr[--Nr],Rr[Nr]=null,_a=Rr[--Nr],Rr[Nr]=null}var Gn=null,zt=null,dt=!1,Hi=null,na=!1,Of=Error(a(519));function ji(r){var i=Error(a(418,""));throw zo(br(i,r)),Of}function Tp(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[on]=r,i[ln]=u,o){case"dialog":st("cancel",i),st("close",i);break;case"iframe":case"object":case"embed":st("load",i);break;case"video":case"audio":for(o=0;o<fl.length;o++)st(fl[o],i);break;case"source":st("error",i);break;case"img":case"image":case"link":st("error",i),st("load",i);break;case"details":st("toggle",i);break;case"input":st("invalid",i),Dm(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),pc(i);break;case"select":st("invalid",i);break;case"textarea":st("invalid",i),Fm(i,u.value,u.defaultValue,u.children),pc(i)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||Fv(i.textContent,o)?(u.popover!=null&&(st("beforetoggle",i),st("toggle",i)),u.onScroll!=null&&st("scroll",i),u.onScrollEnd!=null&&st("scrollend",i),u.onClick!=null&&(i.onclick=uu),i=!0):i=!1,i||ji(r)}function xp(r){for(Gn=r.return;Gn;)switch(Gn.tag){case 5:case 13:na=!1;return;case 27:case 3:na=!0;return;default:Gn=Gn.return}}function Ho(r){if(r!==Gn)return!1;if(!dt)return xp(r),dt=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Yd(r.type,r.memoizedProps)),o=!o),o&&zt&&ji(r),xp(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(a(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8)if(o=r.data,o==="/$"){if(i===0){zt=Gr(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++;r=r.nextSibling}zt=null}}else i===27?(i=zt,oi(r.type)?(r=Jd,Jd=null,zt=r):zt=i):zt=Gn?Gr(r.stateNode.nextSibling):null;return!0}function jo(){zt=Gn=null,dt=!1}function _p(){var r=Hi;return r!==null&&(Zn===null?Zn=r:Zn.push.apply(Zn,r),Hi=null),r}function zo(r){Hi===null?Hi=[r]:Hi.push(r)}var Mf=ue(null),zi=null,Ca=null;function Va(r,i,o){L(Mf,i._currentValue),i._currentValue=o}function Ea(r){r._currentValue=Mf.current,b(Mf)}function Df(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function Pf(r,i,o,u){var f=r.child;for(f!==null&&(f.return=r);f!==null;){var m=f.dependencies;if(m!==null){var S=f.child;m=m.firstContext;e:for(;m!==null;){var w=m;m=f;for(var H=0;H<i.length;H++)if(w.context===i[H]){m.lanes|=o,w=m.alternate,w!==null&&(w.lanes|=o),Df(m.return,o,r),u||(S=null);break e}m=w.next}}else if(f.tag===18){if(S=f.return,S===null)throw Error(a(341));S.lanes|=o,m=S.alternate,m!==null&&(m.lanes|=o),Df(S,o,r),S=null}else S=f.child;if(S!==null)S.return=f;else for(S=f;S!==null;){if(S===r){S=null;break}if(f=S.sibling,f!==null){f.return=S.return,S=f;break}S=S.return}f=S}}function Go(r,i,o,u){r=null;for(var f=i,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var S=f.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var w=f.type;or(f.pendingProps.value,S.value)||(r!==null?r.push(w):r=[w])}}else if(f===be.current){if(S=f.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(r!==null?r.push(yl):r=[yl])}f=f.return}r!==null&&Pf(i,r,o,u),i.flags|=262144}function kc(r){for(r=r.firstContext;r!==null;){if(!or(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Gi(r){zi=r,Ca=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function On(r){return Sp(zi,r)}function Oc(r,i){return zi===null&&Gi(r),Sp(r,i)}function Sp(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Ca===null){if(r===null)throw Error(a(308));Ca=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Ca=Ca.next=i;return o}var qE=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},YE=n.unstable_scheduleCallback,XE=n.unstable_NormalPriority,tn={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Ff(){return{controller:new qE,data:new Map,refCount:0}}function $o(r){r.refCount--,r.refCount===0&&YE(XE,function(){r.controller.abort()})}var Ko=null,Lf=0,Is=0,Rs=null;function WE(r,i){if(Ko===null){var o=Ko=[];Lf=0,Is=Bd(),Rs={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Lf++,i.then(Cp,Cp),i}function Cp(){if(--Lf===0&&Ko!==null){Rs!==null&&(Rs.status="fulfilled");var r=Ko;Ko=null,Is=0,Rs=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function QE(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<o.length;f++)(0,o[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),u}var Ep=re.S;re.S=function(r,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&WE(r,i),Ep!==null&&Ep(r,i)};var $i=ue(null);function Uf(){var r=$i.current;return r!==null?r:Ft.pooledCache}function Mc(r,i){i===null?L($i,$i.current):L($i,i.pool)}function Ap(){var r=Uf();return r===null?null:{parent:tn._currentValue,pool:r}}var Vo=Error(a(460)),wp=Error(a(474)),Dc=Error(a(542)),Bf={then:function(){}};function bp(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Pc(){}function Ip(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(Pc,Pc),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,Np(r),r;default:if(typeof i.status=="string")i.then(Pc,Pc);else{if(r=Ft,r!==null&&100<r.shellSuspendCounter)throw Error(a(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,Np(r),r}throw qo=i,Vo}}var qo=null;function Rp(){if(qo===null)throw Error(a(459));var r=qo;return qo=null,r}function Np(r){if(r===Vo||r===Dc)throw Error(a(483))}var qa=!1;function Hf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jf(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Ya(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Xa(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(mt&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=bc(r),pp(r,null,o),i}return wc(r,u,i,o),bc(r)}function Yo(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,gc(r,o)}}function zf(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var S={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=S:m=m.next=S,o=o.next}while(o!==null);m===null?f=m=i:m=m.next=i}else f=m=i;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var Gf=!1;function Xo(){if(Gf){var r=Rs;if(r!==null)throw r}}function Wo(r,i,o,u){Gf=!1;var f=r.updateQueue;qa=!1;var m=f.firstBaseUpdate,S=f.lastBaseUpdate,w=f.shared.pending;if(w!==null){f.shared.pending=null;var H=w,ne=H.next;H.next=null,S===null?m=ne:S.next=ne,S=H;var me=r.alternate;me!==null&&(me=me.updateQueue,w=me.lastBaseUpdate,w!==S&&(w===null?me.firstBaseUpdate=ne:w.next=ne,me.lastBaseUpdate=H))}if(m!==null){var xe=f.baseState;S=0,me=ne=H=null,w=m;do{var oe=w.lane&-536870913,ce=oe!==w.lane;if(ce?(ct&oe)===oe:(u&oe)===oe){oe!==0&&oe===Is&&(Gf=!0),me!==null&&(me=me.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Ye=r,Ke=w;oe=i;var wt=o;switch(Ke.tag){case 1:if(Ye=Ke.payload,typeof Ye=="function"){xe=Ye.call(wt,xe,oe);break e}xe=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=Ke.payload,oe=typeof Ye=="function"?Ye.call(wt,xe,oe):Ye,oe==null)break e;xe=p({},xe,oe);break e;case 2:qa=!0}}oe=w.callback,oe!==null&&(r.flags|=64,ce&&(r.flags|=8192),ce=f.callbacks,ce===null?f.callbacks=[oe]:ce.push(oe))}else ce={lane:oe,tag:w.tag,payload:w.payload,callback:w.callback,next:null},me===null?(ne=me=ce,H=xe):me=me.next=ce,S|=oe;if(w=w.next,w===null){if(w=f.shared.pending,w===null)break;ce=w,w=ce.next,ce.next=null,f.lastBaseUpdate=ce,f.shared.pending=null}}while(!0);me===null&&(H=xe),f.baseState=H,f.firstBaseUpdate=ne,f.lastBaseUpdate=me,m===null&&(f.shared.lanes=0),ri|=S,r.lanes=S,r.memoizedState=xe}}function kp(r,i){if(typeof r!="function")throw Error(a(191,r));r.call(i)}function Op(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)kp(o[r],i)}var Ns=ue(null),Fc=ue(0);function Mp(r,i){r=ka,L(Fc,r),L(Ns,i),ka=r|i.baseLanes}function $f(){L(Fc,ka),L(Ns,Ns.current)}function Kf(){ka=Fc.current,b(Ns),b(Fc)}var Wa=0,rt=null,Et=null,Xt=null,Lc=!1,ks=!1,Ki=!1,Uc=0,Qo=0,Os=null,JE=0;function qt(){throw Error(a(321))}function Vf(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!or(r[o],i[o]))return!1;return!0}function qf(r,i,o,u,f,m){return Wa=m,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,re.H=r===null||r.memoizedState===null?p1:v1,Ki=!1,m=o(u,f),Ki=!1,ks&&(m=Pp(i,o,u,f)),Dp(r),m}function Dp(r){re.H=$c;var i=Et!==null&&Et.next!==null;if(Wa=0,Xt=Et=rt=null,Lc=!1,Qo=0,Os=null,i)throw Error(a(300));r===null||cn||(r=r.dependencies,r!==null&&kc(r)&&(cn=!0))}function Pp(r,i,o,u){rt=r;var f=0;do{if(ks&&(Os=null),Qo=0,ks=!1,25<=f)throw Error(a(301));if(f+=1,Xt=Et=null,r.updateQueue!=null){var m=r.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}re.H=iA,m=i(o,u)}while(ks);return m}function ZE(){var r=re.H,i=r.useState()[0];return i=typeof i.then=="function"?Jo(i):i,r=r.useState()[0],(Et!==null?Et.memoizedState:null)!==r&&(rt.flags|=1024),i}function Yf(){var r=Uc!==0;return Uc=0,r}function Xf(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Wf(r){if(Lc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}Lc=!1}Wa=0,Xt=Et=rt=null,ks=!1,Qo=Uc=0,Os=null}function Qn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?rt.memoizedState=Xt=r:Xt=Xt.next=r,Xt}function Wt(){if(Et===null){var r=rt.alternate;r=r!==null?r.memoizedState:null}else r=Et.next;var i=Xt===null?rt.memoizedState:Xt.next;if(i!==null)Xt=i,Et=r;else{if(r===null)throw rt.alternate===null?Error(a(467)):Error(a(310));Et=r,r={memoizedState:Et.memoizedState,baseState:Et.baseState,baseQueue:Et.baseQueue,queue:Et.queue,next:null},Xt===null?rt.memoizedState=Xt=r:Xt=Xt.next=r}return Xt}function Qf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Jo(r){var i=Qo;return Qo+=1,Os===null&&(Os=[]),r=Ip(Os,r,i),i=rt,(Xt===null?i.memoizedState:Xt.next)===null&&(i=i.alternate,re.H=i===null||i.memoizedState===null?p1:v1),r}function Bc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return Jo(r);if(r.$$typeof===k)return On(r)}throw Error(a(438,String(r)))}function Jf(r){var i=null,o=rt.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=rt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Qf(),rt.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=ie;return i.index++,o}function Aa(r,i){return typeof i=="function"?i(r):i}function Hc(r){var i=Wt();return Zf(i,Et,r)}function Zf(r,i,o){var u=r.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=o;var f=r.baseQueue,m=u.pending;if(m!==null){if(f!==null){var S=f.next;f.next=m.next,m.next=S}i.baseQueue=f=m,u.pending=null}if(m=r.baseState,f===null)r.memoizedState=m;else{i=f.next;var w=S=null,H=null,ne=i,me=!1;do{var xe=ne.lane&-536870913;if(xe!==ne.lane?(ct&xe)===xe:(Wa&xe)===xe){var oe=ne.revertLane;if(oe===0)H!==null&&(H=H.next={lane:0,revertLane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),xe===Is&&(me=!0);else if((Wa&oe)===oe){ne=ne.next,oe===Is&&(me=!0);continue}else xe={lane:0,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},H===null?(w=H=xe,S=m):H=H.next=xe,rt.lanes|=oe,ri|=oe;xe=ne.action,Ki&&o(m,xe),m=ne.hasEagerState?ne.eagerState:o(m,xe)}else oe={lane:xe,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},H===null?(w=H=oe,S=m):H=H.next=oe,rt.lanes|=xe,ri|=xe;ne=ne.next}while(ne!==null&&ne!==i);if(H===null?S=m:H.next=w,!or(m,r.memoizedState)&&(cn=!0,me&&(o=Rs,o!==null)))throw o;r.memoizedState=m,r.baseState=S,r.baseQueue=H,u.lastRenderedState=m}return f===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function ed(r){var i=Wt(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=r;var u=o.dispatch,f=o.pending,m=i.memoizedState;if(f!==null){o.pending=null;var S=f=f.next;do m=r(m,S.action),S=S.next;while(S!==f);or(m,i.memoizedState)||(cn=!0),i.memoizedState=m,i.baseQueue===null&&(i.baseState=m),o.lastRenderedState=m}return[m,u]}function Fp(r,i,o){var u=rt,f=Wt(),m=dt;if(m){if(o===void 0)throw Error(a(407));o=o()}else o=i();var S=!or((Et||f).memoizedState,o);S&&(f.memoizedState=o,cn=!0),f=f.queue;var w=Bp.bind(null,u,f,r);if(Zo(2048,8,w,[r]),f.getSnapshot!==i||S||Xt!==null&&Xt.memoizedState.tag&1){if(u.flags|=2048,Ms(9,jc(),Up.bind(null,u,f,o,i),null),Ft===null)throw Error(a(349));m||(Wa&124)!==0||Lp(u,i,o)}return o}function Lp(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=rt.updateQueue,i===null?(i=Qf(),rt.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Up(r,i,o,u){i.value=o,i.getSnapshot=u,Hp(i)&&jp(r)}function Bp(r,i,o){return o(function(){Hp(i)&&jp(r)})}function Hp(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!or(r,o)}catch{return!0}}function jp(r){var i=Es(r,2);i!==null&&dr(i,r,2)}function td(r){var i=Qn();if(typeof r=="function"){var o=r;if(r=o(),Ki){kn(!0);try{o()}finally{kn(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:r},i}function zp(r,i,o,u){return r.baseState=o,Zf(r,Et,typeof u=="function"?u:Aa)}function eA(r,i,o,u,f){if(Gc(r))throw Error(a(485));if(r=i.action,r!==null){var m={payload:f,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){m.listeners.push(S)}};re.T!==null?o(!0):m.isTransition=!1,u(m),o=i.pending,o===null?(m.next=i.pending=m,Gp(i,m)):(m.next=o.next,i.pending=o.next=m)}}function Gp(r,i){var o=i.action,u=i.payload,f=r.state;if(i.isTransition){var m=re.T,S={};re.T=S;try{var w=o(f,u),H=re.S;H!==null&&H(S,w),$p(r,i,w)}catch(ne){nd(r,i,ne)}finally{re.T=m}}else try{m=o(f,u),$p(r,i,m)}catch(ne){nd(r,i,ne)}}function $p(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Kp(r,i,u)},function(u){return nd(r,i,u)}):Kp(r,i,o)}function Kp(r,i,o){i.status="fulfilled",i.value=o,Vp(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,Gp(r,o)))}function nd(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,Vp(i),i=i.next;while(i!==u)}r.action=null}function Vp(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function qp(r,i){return i}function Yp(r,i){if(dt){var o=Ft.formState;if(o!==null){e:{var u=rt;if(dt){if(zt){t:{for(var f=zt,m=na;f.nodeType!==8;){if(!m){f=null;break t}if(f=Gr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){zt=Gr(f.nextSibling),u=f.data==="F!";break e}}ji(u)}u=!1}u&&(i=o[0])}}return o=Qn(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:qp,lastRenderedState:i},o.queue=u,o=d1.bind(null,rt,u),u.dispatch=o,u=td(!1),m=od.bind(null,rt,!1,u.queue),u=Qn(),f={state:i,dispatch:null,action:r,pending:null},u.queue=f,o=eA.bind(null,rt,f,m,o),f.dispatch=o,u.memoizedState=r,[i,o,!1]}function Xp(r){var i=Wt();return Wp(i,Et,r)}function Wp(r,i,o){if(i=Zf(r,i,qp)[0],r=Hc(Aa)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=Jo(i)}catch(S){throw S===Vo?Dc:S}else u=i;i=Wt();var f=i.queue,m=f.dispatch;return o!==i.memoizedState&&(rt.flags|=2048,Ms(9,jc(),tA.bind(null,f,o),null)),[u,m,r]}function tA(r,i){r.action=i}function Qp(r){var i=Wt(),o=Et;if(o!==null)return Wp(i,o,r);Wt(),i=i.memoizedState,o=Wt();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function Ms(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=rt.updateQueue,i===null&&(i=Qf(),rt.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function jc(){return{destroy:void 0,resource:void 0}}function Jp(){return Wt().memoizedState}function zc(r,i,o,u){var f=Qn();u=u===void 0?null:u,rt.flags|=r,f.memoizedState=Ms(1|i,jc(),o,u)}function Zo(r,i,o,u){var f=Wt();u=u===void 0?null:u;var m=f.memoizedState.inst;Et!==null&&u!==null&&Vf(u,Et.memoizedState.deps)?f.memoizedState=Ms(i,m,o,u):(rt.flags|=r,f.memoizedState=Ms(1|i,m,o,u))}function Zp(r,i){zc(8390656,8,r,i)}function e1(r,i){Zo(2048,8,r,i)}function t1(r,i){return Zo(4,2,r,i)}function n1(r,i){return Zo(4,4,r,i)}function r1(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function a1(r,i,o){o=o!=null?o.concat([r]):null,Zo(4,4,r1.bind(null,i,r),o)}function rd(){}function i1(r,i){var o=Wt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&Vf(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function s1(r,i){var o=Wt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&Vf(i,u[1]))return u[0];if(u=r(),Ki){kn(!0);try{r()}finally{kn(!1)}}return o.memoizedState=[u,i],u}function ad(r,i,o){return o===void 0||(Wa&1073741824)!==0?r.memoizedState=i:(r.memoizedState=o,r=cv(),rt.lanes|=r,ri|=r,o)}function o1(r,i,o,u){return or(o,i)?o:Ns.current!==null?(r=ad(r,o,u),or(r,i)||(cn=!0),r):(Wa&42)===0?(cn=!0,r.memoizedState=o):(r=cv(),rt.lanes|=r,ri|=r,i)}function l1(r,i,o,u,f){var m=_e.p;_e.p=m!==0&&8>m?m:8;var S=re.T,w={};re.T=w,od(r,!1,i,o);try{var H=f(),ne=re.S;if(ne!==null&&ne(w,H),H!==null&&typeof H=="object"&&typeof H.then=="function"){var me=QE(H,u);el(r,i,me,fr(r))}else el(r,i,u,fr(r))}catch(xe){el(r,i,{then:function(){},status:"rejected",reason:xe},fr())}finally{_e.p=m,re.T=S}}function nA(){}function id(r,i,o,u){if(r.tag!==5)throw Error(a(476));var f=c1(r).queue;l1(r,f,i,fe,o===null?nA:function(){return u1(r),o(u)})}function c1(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:fe},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Aa,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function u1(r){var i=c1(r).next.queue;el(r,i,{},fr())}function sd(){return On(yl)}function h1(){return Wt().memoizedState}function f1(){return Wt().memoizedState}function rA(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=fr();r=Ya(o);var u=Xa(i,r,o);u!==null&&(dr(u,i,o),Yo(u,i,o)),i={cache:Ff()},r.payload=i;return}i=i.return}}function aA(r,i,o){var u=fr();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},Gc(r)?g1(i,o):(o=wf(r,i,o,u),o!==null&&(dr(o,r,u),m1(o,i,u)))}function d1(r,i,o){var u=fr();el(r,i,o,u)}function el(r,i,o,u){var f={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(Gc(r))g1(i,f);else{var m=r.alternate;if(r.lanes===0&&(m===null||m.lanes===0)&&(m=i.lastRenderedReducer,m!==null))try{var S=i.lastRenderedState,w=m(S,o);if(f.hasEagerState=!0,f.eagerState=w,or(w,S))return wc(r,i,f,0),Ft===null&&Ac(),!1}catch{}finally{}if(o=wf(r,i,f,u),o!==null)return dr(o,r,u),m1(o,i,u),!0}return!1}function od(r,i,o,u){if(u={lane:2,revertLane:Bd(),action:u,hasEagerState:!1,eagerState:null,next:null},Gc(r)){if(i)throw Error(a(479))}else i=wf(r,o,u,2),i!==null&&dr(i,r,2)}function Gc(r){var i=r.alternate;return r===rt||i!==null&&i===rt}function g1(r,i){ks=Lc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function m1(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,gc(r,o)}}var $c={readContext:On,use:Bc,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useLayoutEffect:qt,useInsertionEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useSyncExternalStore:qt,useId:qt,useHostTransitionStatus:qt,useFormState:qt,useActionState:qt,useOptimistic:qt,useMemoCache:qt,useCacheRefresh:qt},p1={readContext:On,use:Bc,useCallback:function(r,i){return Qn().memoizedState=[r,i===void 0?null:i],r},useContext:On,useEffect:Zp,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,zc(4194308,4,r1.bind(null,i,r),o)},useLayoutEffect:function(r,i){return zc(4194308,4,r,i)},useInsertionEffect:function(r,i){zc(4,2,r,i)},useMemo:function(r,i){var o=Qn();i=i===void 0?null:i;var u=r();if(Ki){kn(!0);try{r()}finally{kn(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=Qn();if(o!==void 0){var f=o(i);if(Ki){kn(!0);try{o(i)}finally{kn(!1)}}}else f=i;return u.memoizedState=u.baseState=f,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:f},u.queue=r,r=r.dispatch=aA.bind(null,rt,r),[u.memoizedState,r]},useRef:function(r){var i=Qn();return r={current:r},i.memoizedState=r},useState:function(r){r=td(r);var i=r.queue,o=d1.bind(null,rt,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:rd,useDeferredValue:function(r,i){var o=Qn();return ad(o,r,i)},useTransition:function(){var r=td(!1);return r=l1.bind(null,rt,r.queue,!0,!1),Qn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=rt,f=Qn();if(dt){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),Ft===null)throw Error(a(349));(ct&124)!==0||Lp(u,i,o)}f.memoizedState=o;var m={value:o,getSnapshot:i};return f.queue=m,Zp(Bp.bind(null,u,m,r),[r]),u.flags|=2048,Ms(9,jc(),Up.bind(null,u,m,o,i),null),o},useId:function(){var r=Qn(),i=Ft.identifierPrefix;if(dt){var o=Sa,u=_a;o=(u&~(1<<32-zn(u)-1)).toString(32)+o,i="«"+i+"R"+o,o=Uc++,0<o&&(i+="H"+o.toString(32)),i+="»"}else o=JE++,i="«"+i+"r"+o.toString(32)+"»";return r.memoizedState=i},useHostTransitionStatus:sd,useFormState:Yp,useActionState:Yp,useOptimistic:function(r){var i=Qn();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=od.bind(null,rt,!0,o),o.dispatch=i,[r,i]},useMemoCache:Jf,useCacheRefresh:function(){return Qn().memoizedState=rA.bind(null,rt)}},v1={readContext:On,use:Bc,useCallback:i1,useContext:On,useEffect:e1,useImperativeHandle:a1,useInsertionEffect:t1,useLayoutEffect:n1,useMemo:s1,useReducer:Hc,useRef:Jp,useState:function(){return Hc(Aa)},useDebugValue:rd,useDeferredValue:function(r,i){var o=Wt();return o1(o,Et.memoizedState,r,i)},useTransition:function(){var r=Hc(Aa)[0],i=Wt().memoizedState;return[typeof r=="boolean"?r:Jo(r),i]},useSyncExternalStore:Fp,useId:h1,useHostTransitionStatus:sd,useFormState:Xp,useActionState:Xp,useOptimistic:function(r,i){var o=Wt();return zp(o,Et,r,i)},useMemoCache:Jf,useCacheRefresh:f1},iA={readContext:On,use:Bc,useCallback:i1,useContext:On,useEffect:e1,useImperativeHandle:a1,useInsertionEffect:t1,useLayoutEffect:n1,useMemo:s1,useReducer:ed,useRef:Jp,useState:function(){return ed(Aa)},useDebugValue:rd,useDeferredValue:function(r,i){var o=Wt();return Et===null?ad(o,r,i):o1(o,Et.memoizedState,r,i)},useTransition:function(){var r=ed(Aa)[0],i=Wt().memoizedState;return[typeof r=="boolean"?r:Jo(r),i]},useSyncExternalStore:Fp,useId:h1,useHostTransitionStatus:sd,useFormState:Qp,useActionState:Qp,useOptimistic:function(r,i){var o=Wt();return Et!==null?zp(o,Et,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:Jf,useCacheRefresh:f1},Ds=null,tl=0;function Kc(r){var i=tl;return tl+=1,Ds===null&&(Ds=[]),Ip(Ds,r,i)}function nl(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Vc(r,i){throw i.$$typeof===v?Error(a(525)):(r=Object.prototype.toString.call(i),Error(a(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function y1(r){var i=r._init;return i(r._payload)}function T1(r){function i(Q,q){if(r){var te=Q.deletions;te===null?(Q.deletions=[q],Q.flags|=16):te.push(q)}}function o(Q,q){if(!r)return null;for(;q!==null;)i(Q,q),q=q.sibling;return null}function u(Q){for(var q=new Map;Q!==null;)Q.key!==null?q.set(Q.key,Q):q.set(Q.index,Q),Q=Q.sibling;return q}function f(Q,q){return Q=xa(Q,q),Q.index=0,Q.sibling=null,Q}function m(Q,q,te){return Q.index=te,r?(te=Q.alternate,te!==null?(te=te.index,te<q?(Q.flags|=67108866,q):te):(Q.flags|=67108866,q)):(Q.flags|=1048576,q)}function S(Q){return r&&Q.alternate===null&&(Q.flags|=67108866),Q}function w(Q,q,te,pe){return q===null||q.tag!==6?(q=If(te,Q.mode,pe),q.return=Q,q):(q=f(q,te),q.return=Q,q)}function H(Q,q,te,pe){var ze=te.type;return ze===C?me(Q,q,te.props.children,pe,te.key):q!==null&&(q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&y1(ze)===q.type)?(q=f(q,te.props),nl(q,te),q.return=Q,q):(q=Ic(te.type,te.key,te.props,null,Q.mode,pe),nl(q,te),q.return=Q,q)}function ne(Q,q,te,pe){return q===null||q.tag!==4||q.stateNode.containerInfo!==te.containerInfo||q.stateNode.implementation!==te.implementation?(q=Rf(te,Q.mode,pe),q.return=Q,q):(q=f(q,te.children||[]),q.return=Q,q)}function me(Q,q,te,pe,ze){return q===null||q.tag!==7?(q=Li(te,Q.mode,pe,ze),q.return=Q,q):(q=f(q,te),q.return=Q,q)}function xe(Q,q,te){if(typeof q=="string"&&q!==""||typeof q=="number"||typeof q=="bigint")return q=If(""+q,Q.mode,te),q.return=Q,q;if(typeof q=="object"&&q!==null){switch(q.$$typeof){case T:return te=Ic(q.type,q.key,q.props,null,Q.mode,te),nl(te,q),te.return=Q,te;case x:return q=Rf(q,Q.mode,te),q.return=Q,q;case G:var pe=q._init;return q=pe(q._payload),xe(Q,q,te)}if(ke(q)||he(q))return q=Li(q,Q.mode,te,null),q.return=Q,q;if(typeof q.then=="function")return xe(Q,Kc(q),te);if(q.$$typeof===k)return xe(Q,Oc(Q,q),te);Vc(Q,q)}return null}function oe(Q,q,te,pe){var ze=q!==null?q.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return ze!==null?null:w(Q,q,""+te,pe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case T:return te.key===ze?H(Q,q,te,pe):null;case x:return te.key===ze?ne(Q,q,te,pe):null;case G:return ze=te._init,te=ze(te._payload),oe(Q,q,te,pe)}if(ke(te)||he(te))return ze!==null?null:me(Q,q,te,pe,null);if(typeof te.then=="function")return oe(Q,q,Kc(te),pe);if(te.$$typeof===k)return oe(Q,q,Oc(Q,te),pe);Vc(Q,te)}return null}function ce(Q,q,te,pe,ze){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Q=Q.get(te)||null,w(q,Q,""+pe,ze);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case T:return Q=Q.get(pe.key===null?te:pe.key)||null,H(q,Q,pe,ze);case x:return Q=Q.get(pe.key===null?te:pe.key)||null,ne(q,Q,pe,ze);case G:var at=pe._init;return pe=at(pe._payload),ce(Q,q,te,pe,ze)}if(ke(pe)||he(pe))return Q=Q.get(te)||null,me(q,Q,pe,ze,null);if(typeof pe.then=="function")return ce(Q,q,te,Kc(pe),ze);if(pe.$$typeof===k)return ce(Q,q,te,Oc(q,pe),ze);Vc(q,pe)}return null}function Ye(Q,q,te,pe){for(var ze=null,at=null,Ge=q,Ve=q=0,hn=null;Ge!==null&&Ve<te.length;Ve++){Ge.index>Ve?(hn=Ge,Ge=null):hn=Ge.sibling;var ut=oe(Q,Ge,te[Ve],pe);if(ut===null){Ge===null&&(Ge=hn);break}r&&Ge&&ut.alternate===null&&i(Q,Ge),q=m(ut,q,Ve),at===null?ze=ut:at.sibling=ut,at=ut,Ge=hn}if(Ve===te.length)return o(Q,Ge),dt&&Bi(Q,Ve),ze;if(Ge===null){for(;Ve<te.length;Ve++)Ge=xe(Q,te[Ve],pe),Ge!==null&&(q=m(Ge,q,Ve),at===null?ze=Ge:at.sibling=Ge,at=Ge);return dt&&Bi(Q,Ve),ze}for(Ge=u(Ge);Ve<te.length;Ve++)hn=ce(Ge,Q,Ve,te[Ve],pe),hn!==null&&(r&&hn.alternate!==null&&Ge.delete(hn.key===null?Ve:hn.key),q=m(hn,q,Ve),at===null?ze=hn:at.sibling=hn,at=hn);return r&&Ge.forEach(function(fi){return i(Q,fi)}),dt&&Bi(Q,Ve),ze}function Ke(Q,q,te,pe){if(te==null)throw Error(a(151));for(var ze=null,at=null,Ge=q,Ve=q=0,hn=null,ut=te.next();Ge!==null&&!ut.done;Ve++,ut=te.next()){Ge.index>Ve?(hn=Ge,Ge=null):hn=Ge.sibling;var fi=oe(Q,Ge,ut.value,pe);if(fi===null){Ge===null&&(Ge=hn);break}r&&Ge&&fi.alternate===null&&i(Q,Ge),q=m(fi,q,Ve),at===null?ze=fi:at.sibling=fi,at=fi,Ge=hn}if(ut.done)return o(Q,Ge),dt&&Bi(Q,Ve),ze;if(Ge===null){for(;!ut.done;Ve++,ut=te.next())ut=xe(Q,ut.value,pe),ut!==null&&(q=m(ut,q,Ve),at===null?ze=ut:at.sibling=ut,at=ut);return dt&&Bi(Q,Ve),ze}for(Ge=u(Ge);!ut.done;Ve++,ut=te.next())ut=ce(Ge,Q,Ve,ut.value,pe),ut!==null&&(r&&ut.alternate!==null&&Ge.delete(ut.key===null?Ve:ut.key),q=m(ut,q,Ve),at===null?ze=ut:at.sibling=ut,at=ut);return r&&Ge.forEach(function(sw){return i(Q,sw)}),dt&&Bi(Q,Ve),ze}function wt(Q,q,te,pe){if(typeof te=="object"&&te!==null&&te.type===C&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case T:e:{for(var ze=te.key;q!==null;){if(q.key===ze){if(ze=te.type,ze===C){if(q.tag===7){o(Q,q.sibling),pe=f(q,te.props.children),pe.return=Q,Q=pe;break e}}else if(q.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&y1(ze)===q.type){o(Q,q.sibling),pe=f(q,te.props),nl(pe,te),pe.return=Q,Q=pe;break e}o(Q,q);break}else i(Q,q);q=q.sibling}te.type===C?(pe=Li(te.props.children,Q.mode,pe,te.key),pe.return=Q,Q=pe):(pe=Ic(te.type,te.key,te.props,null,Q.mode,pe),nl(pe,te),pe.return=Q,Q=pe)}return S(Q);case x:e:{for(ze=te.key;q!==null;){if(q.key===ze)if(q.tag===4&&q.stateNode.containerInfo===te.containerInfo&&q.stateNode.implementation===te.implementation){o(Q,q.sibling),pe=f(q,te.children||[]),pe.return=Q,Q=pe;break e}else{o(Q,q);break}else i(Q,q);q=q.sibling}pe=Rf(te,Q.mode,pe),pe.return=Q,Q=pe}return S(Q);case G:return ze=te._init,te=ze(te._payload),wt(Q,q,te,pe)}if(ke(te))return Ye(Q,q,te,pe);if(he(te)){if(ze=he(te),typeof ze!="function")throw Error(a(150));return te=ze.call(te),Ke(Q,q,te,pe)}if(typeof te.then=="function")return wt(Q,q,Kc(te),pe);if(te.$$typeof===k)return wt(Q,q,Oc(Q,te),pe);Vc(Q,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,q!==null&&q.tag===6?(o(Q,q.sibling),pe=f(q,te),pe.return=Q,Q=pe):(o(Q,q),pe=If(te,Q.mode,pe),pe.return=Q,Q=pe),S(Q)):o(Q,q)}return function(Q,q,te,pe){try{tl=0;var ze=wt(Q,q,te,pe);return Ds=null,ze}catch(Ge){if(Ge===Vo||Ge===Dc)throw Ge;var at=lr(29,Ge,null,Q.mode);return at.lanes=pe,at.return=Q,at}finally{}}}var Ps=T1(!0),x1=T1(!1),kr=ue(null),ra=null;function Qa(r){var i=r.alternate;L(nn,nn.current&1),L(kr,r),ra===null&&(i===null||Ns.current!==null||i.memoizedState!==null)&&(ra=r)}function _1(r){if(r.tag===22){if(L(nn,nn.current),L(kr,r),ra===null){var i=r.alternate;i!==null&&i.memoizedState!==null&&(ra=r)}}else Ja()}function Ja(){L(nn,nn.current),L(kr,kr.current)}function wa(r){b(kr),ra===r&&(ra=null),b(nn)}var nn=ue(0);function qc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||Qd(o)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function ld(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:p({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var cd={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=fr(),f=Ya(u);f.payload=i,o!=null&&(f.callback=o),i=Xa(r,f,u),i!==null&&(dr(i,r,u),Yo(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=fr(),f=Ya(u);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=Xa(r,f,u),i!==null&&(dr(i,r,u),Yo(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=fr(),u=Ya(o);u.tag=2,i!=null&&(u.callback=i),i=Xa(r,u,o),i!==null&&(dr(i,r,o),Yo(i,r,o))}};function S1(r,i,o,u,f,m,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,m,S):i.prototype&&i.prototype.isPureReactComponent?!Uo(o,u)||!Uo(f,m):!0}function C1(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&cd.enqueueReplaceState(i,i.state,null)}function Vi(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=p({},o));for(var f in r)o[f]===void 0&&(o[f]=r[f])}return o}var Yc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function E1(r){Yc(r)}function A1(r){console.error(r)}function w1(r){Yc(r)}function Xc(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function b1(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function ud(r,i,o){return o=Ya(o),o.tag=3,o.payload={element:null},o.callback=function(){Xc(r,i)},o}function I1(r){return r=Ya(r),r.tag=3,r}function R1(r,i,o,u){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=u.value;r.payload=function(){return f(m)},r.callback=function(){b1(i,o,u)}}var S=o.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){b1(i,o,u),typeof f!="function"&&(ai===null?ai=new Set([this]):ai.add(this));var w=u.stack;this.componentDidCatch(u.value,{componentStack:w!==null?w:""})})}function sA(r,i,o,u,f){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Go(i,o,f,!0),o=kr.current,o!==null){switch(o.tag){case 13:return ra===null?Dd():o.alternate===null&&Gt===0&&(Gt=3),o.flags&=-257,o.flags|=65536,o.lanes=f,u===Bf?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),Fd(r,u,f)),!1;case 22:return o.flags|=65536,u===Bf?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),Fd(r,u,f)),!1}throw Error(a(435,o.tag))}return Fd(r,u,f),Dd(),!1}if(dt)return i=kr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==Of&&(r=Error(a(422),{cause:u}),zo(br(r,o)))):(u!==Of&&(i=Error(a(423),{cause:u}),zo(br(i,o))),r=r.current.alternate,r.flags|=65536,f&=-f,r.lanes|=f,u=br(u,o),f=ud(r.stateNode,u,f),zf(r,f),Gt!==4&&(Gt=2)),!1;var m=Error(a(520),{cause:u});if(m=br(m,o),cl===null?cl=[m]:cl.push(m),Gt!==4&&(Gt=2),i===null)return!0;u=br(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=f&-f,o.lanes|=r,r=ud(o.stateNode,u,r),zf(o,r),!1;case 1:if(i=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ai===null||!ai.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=I1(f),R1(f,r,o,u),zf(o,f),!1}o=o.return}while(o!==null);return!1}var N1=Error(a(461)),cn=!1;function Tn(r,i,o,u){i.child=r===null?x1(i,null,o,u):Ps(i,r.child,o,u)}function k1(r,i,o,u,f){o=o.render;var m=i.ref;if("ref"in u){var S={};for(var w in u)w!=="ref"&&(S[w]=u[w])}else S=u;return Gi(i),u=qf(r,i,o,S,m,f),w=Yf(),r!==null&&!cn?(Xf(r,i,f),ba(r,i,f)):(dt&&w&&Nf(i),i.flags|=1,Tn(r,i,u,f),i.child)}function O1(r,i,o,u,f){if(r===null){var m=o.type;return typeof m=="function"&&!bf(m)&&m.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=m,M1(r,i,m,u,f)):(r=Ic(o.type,null,u,i,i.mode,f),r.ref=i.ref,r.return=i,i.child=r)}if(m=r.child,!yd(r,f)){var S=m.memoizedProps;if(o=o.compare,o=o!==null?o:Uo,o(S,u)&&r.ref===i.ref)return ba(r,i,f)}return i.flags|=1,r=xa(m,u),r.ref=i.ref,r.return=i,i.child=r}function M1(r,i,o,u,f){if(r!==null){var m=r.memoizedProps;if(Uo(m,u)&&r.ref===i.ref)if(cn=!1,i.pendingProps=u=m,yd(r,f))(r.flags&131072)!==0&&(cn=!0);else return i.lanes=r.lanes,ba(r,i,f)}return hd(r,i,o,u,f)}function D1(r,i,o){var u=i.pendingProps,f=u.children,m=r!==null?r.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=m!==null?m.baseLanes|o:o,r!==null){for(f=i.child=r.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;i.childLanes=m&~u}else i.childLanes=0,i.child=null;return P1(r,i,u,o)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Mc(i,m!==null?m.cachePool:null),m!==null?Mp(i,m):$f(),_1(i);else return i.lanes=i.childLanes=536870912,P1(r,i,m!==null?m.baseLanes|o:o,o)}else m!==null?(Mc(i,m.cachePool),Mp(i,m),Ja(),i.memoizedState=null):(r!==null&&Mc(i,null),$f(),Ja());return Tn(r,i,f,o),i.child}function P1(r,i,o,u){var f=Uf();return f=f===null?null:{parent:tn._currentValue,pool:f},i.memoizedState={baseLanes:o,cachePool:f},r!==null&&Mc(i,null),$f(),_1(i),r!==null&&Go(r,i,u,!0),null}function Wc(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function hd(r,i,o,u,f){return Gi(i),o=qf(r,i,o,u,void 0,f),u=Yf(),r!==null&&!cn?(Xf(r,i,f),ba(r,i,f)):(dt&&u&&Nf(i),i.flags|=1,Tn(r,i,o,f),i.child)}function F1(r,i,o,u,f,m){return Gi(i),i.updateQueue=null,o=Pp(i,u,o,f),Dp(r),u=Yf(),r!==null&&!cn?(Xf(r,i,m),ba(r,i,m)):(dt&&u&&Nf(i),i.flags|=1,Tn(r,i,o,m),i.child)}function L1(r,i,o,u,f){if(Gi(i),i.stateNode===null){var m=As,S=o.contextType;typeof S=="object"&&S!==null&&(m=On(S)),m=new o(u,m),i.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=cd,i.stateNode=m,m._reactInternals=i,m=i.stateNode,m.props=u,m.state=i.memoizedState,m.refs={},Hf(i),S=o.contextType,m.context=typeof S=="object"&&S!==null?On(S):As,m.state=i.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(ld(i,o,S,u),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(S=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),S!==m.state&&cd.enqueueReplaceState(m,m.state,null),Wo(i,u,m,f),Xo(),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){m=i.stateNode;var w=i.memoizedProps,H=Vi(o,w);m.props=H;var ne=m.context,me=o.contextType;S=As,typeof me=="object"&&me!==null&&(S=On(me));var xe=o.getDerivedStateFromProps;me=typeof xe=="function"||typeof m.getSnapshotBeforeUpdate=="function",w=i.pendingProps!==w,me||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w||ne!==S)&&C1(i,m,u,S),qa=!1;var oe=i.memoizedState;m.state=oe,Wo(i,u,m,f),Xo(),ne=i.memoizedState,w||oe!==ne||qa?(typeof xe=="function"&&(ld(i,o,xe,u),ne=i.memoizedState),(H=qa||S1(i,o,H,u,oe,ne,S))?(me||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(i.flags|=4194308)):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=ne),m.props=u,m.state=ne,m.context=S,u=H):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{m=i.stateNode,jf(r,i),S=i.memoizedProps,me=Vi(o,S),m.props=me,xe=i.pendingProps,oe=m.context,ne=o.contextType,H=As,typeof ne=="object"&&ne!==null&&(H=On(ne)),w=o.getDerivedStateFromProps,(ne=typeof w=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S!==xe||oe!==H)&&C1(i,m,u,H),qa=!1,oe=i.memoizedState,m.state=oe,Wo(i,u,m,f),Xo();var ce=i.memoizedState;S!==xe||oe!==ce||qa||r!==null&&r.dependencies!==null&&kc(r.dependencies)?(typeof w=="function"&&(ld(i,o,w,u),ce=i.memoizedState),(me=qa||S1(i,o,me,u,oe,ce,H)||r!==null&&r.dependencies!==null&&kc(r.dependencies))?(ne||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,ce,H),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,ce,H)),typeof m.componentDidUpdate=="function"&&(i.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof m.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ce),m.props=u,m.state=ce,m.context=H,u=me):(typeof m.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=1024),u=!1)}return m=u,Wc(r,i),u=(i.flags&128)!==0,m||u?(m=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:m.render(),i.flags|=1,r!==null&&u?(i.child=Ps(i,r.child,null,f),i.child=Ps(i,null,o,f)):Tn(r,i,o,f),i.memoizedState=m.state,r=i.child):r=ba(r,i,f),r}function U1(r,i,o,u){return jo(),i.flags|=256,Tn(r,i,o,u),i.child}var fd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function dd(r){return{baseLanes:r,cachePool:Ap()}}function gd(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=Or),r}function B1(r,i,o){var u=i.pendingProps,f=!1,m=(i.flags&128)!==0,S;if((S=m)||(S=r!==null&&r.memoizedState===null?!1:(nn.current&2)!==0),S&&(f=!0,i.flags&=-129),S=(i.flags&32)!==0,i.flags&=-33,r===null){if(dt){if(f?Qa(i):Ja(),dt){var w=zt,H;if(H=w){e:{for(H=w,w=na;H.nodeType!==8;){if(!w){w=null;break e}if(H=Gr(H.nextSibling),H===null){w=null;break e}}w=H}w!==null?(i.memoizedState={dehydrated:w,treeContext:Ui!==null?{id:_a,overflow:Sa}:null,retryLane:536870912,hydrationErrors:null},H=lr(18,null,null,0),H.stateNode=w,H.return=i,i.child=H,Gn=i,zt=null,H=!0):H=!1}H||ji(i)}if(w=i.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return Qd(w)?i.lanes=32:i.lanes=536870912,null;wa(i)}return w=u.children,u=u.fallback,f?(Ja(),f=i.mode,w=Qc({mode:"hidden",children:w},f),u=Li(u,f,o,null),w.return=i,u.return=i,w.sibling=u,i.child=w,f=i.child,f.memoizedState=dd(o),f.childLanes=gd(r,S,o),i.memoizedState=fd,u):(Qa(i),md(i,w))}if(H=r.memoizedState,H!==null&&(w=H.dehydrated,w!==null)){if(m)i.flags&256?(Qa(i),i.flags&=-257,i=pd(r,i,o)):i.memoizedState!==null?(Ja(),i.child=r.child,i.flags|=128,i=null):(Ja(),f=u.fallback,w=i.mode,u=Qc({mode:"visible",children:u.children},w),f=Li(f,w,o,null),f.flags|=2,u.return=i,f.return=i,u.sibling=f,i.child=u,Ps(i,r.child,null,o),u=i.child,u.memoizedState=dd(o),u.childLanes=gd(r,S,o),i.memoizedState=fd,i=f);else if(Qa(i),Qd(w)){if(S=w.nextSibling&&w.nextSibling.dataset,S)var ne=S.dgst;S=ne,u=Error(a(419)),u.stack="",u.digest=S,zo({value:u,source:null,stack:null}),i=pd(r,i,o)}else if(cn||Go(r,i,o,!1),S=(o&r.childLanes)!==0,cn||S){if(S=Ft,S!==null&&(u=o&-o,u=(u&42)!==0?1:Io(u),u=(u&(S.suspendedLanes|o))!==0?0:u,u!==0&&u!==H.retryLane))throw H.retryLane=u,Es(r,u),dr(S,r,u),N1;w.data==="$?"||Dd(),i=pd(r,i,o)}else w.data==="$?"?(i.flags|=192,i.child=r.child,i=null):(r=H.treeContext,zt=Gr(w.nextSibling),Gn=i,dt=!0,Hi=null,na=!1,r!==null&&(Rr[Nr++]=_a,Rr[Nr++]=Sa,Rr[Nr++]=Ui,_a=r.id,Sa=r.overflow,Ui=i),i=md(i,u.children),i.flags|=4096);return i}return f?(Ja(),f=u.fallback,w=i.mode,H=r.child,ne=H.sibling,u=xa(H,{mode:"hidden",children:u.children}),u.subtreeFlags=H.subtreeFlags&65011712,ne!==null?f=xa(ne,f):(f=Li(f,w,o,null),f.flags|=2),f.return=i,u.return=i,u.sibling=f,i.child=u,u=f,f=i.child,w=r.child.memoizedState,w===null?w=dd(o):(H=w.cachePool,H!==null?(ne=tn._currentValue,H=H.parent!==ne?{parent:ne,pool:ne}:H):H=Ap(),w={baseLanes:w.baseLanes|o,cachePool:H}),f.memoizedState=w,f.childLanes=gd(r,S,o),i.memoizedState=fd,u):(Qa(i),o=r.child,r=o.sibling,o=xa(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(S=i.deletions,S===null?(i.deletions=[r],i.flags|=16):S.push(r)),i.child=o,i.memoizedState=null,o)}function md(r,i){return i=Qc({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function Qc(r,i){return r=lr(22,r,null,i),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function pd(r,i,o){return Ps(i,r.child,null,o),r=md(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function H1(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),Df(r.return,i,o)}function vd(r,i,o,u,f){var m=r.memoizedState;m===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f}:(m.isBackwards=i,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=o,m.tailMode=f)}function j1(r,i,o){var u=i.pendingProps,f=u.revealOrder,m=u.tail;if(Tn(r,i,u.children,o),u=nn.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&H1(r,o,i);else if(r.tag===19)H1(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}u&=1}switch(L(nn,u),f){case"forwards":for(o=i.child,f=null;o!==null;)r=o.alternate,r!==null&&qc(r)===null&&(f=o),o=o.sibling;o=f,o===null?(f=i.child,i.child=null):(f=o.sibling,o.sibling=null),vd(i,!1,f,o,m);break;case"backwards":for(o=null,f=i.child,i.child=null;f!==null;){if(r=f.alternate,r!==null&&qc(r)===null){i.child=f;break}r=f.sibling,f.sibling=o,o=f,f=r}vd(i,!0,o,null,m);break;case"together":vd(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ba(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ri|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(Go(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(a(153));if(i.child!==null){for(r=i.child,o=xa(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=xa(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function yd(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&kc(r)))}function oA(r,i,o){switch(i.tag){case 3:Ce(i,i.stateNode.containerInfo),Va(i,tn,r.memoizedState.cache),jo();break;case 27:case 5:De(i);break;case 4:Ce(i,i.stateNode.containerInfo);break;case 10:Va(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Qa(i),i.flags|=128,null):(o&i.child.childLanes)!==0?B1(r,i,o):(Qa(i),r=ba(r,i,o),r!==null?r.sibling:null);Qa(i);break;case 19:var f=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Go(r,i,o,!1),u=(o&i.childLanes)!==0),f){if(u)return j1(r,i,o);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),L(nn,nn.current),u)break;return null;case 22:case 23:return i.lanes=0,D1(r,i,o);case 24:Va(i,tn,r.memoizedState.cache)}return ba(r,i,o)}function z1(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)cn=!0;else{if(!yd(r,o)&&(i.flags&128)===0)return cn=!1,oA(r,i,o);cn=(r.flags&131072)!==0}else cn=!1,dt&&(i.flags&1048576)!==0&&yp(i,Nc,i.index);switch(i.lanes=0,i.tag){case 16:e:{r=i.pendingProps;var u=i.elementType,f=u._init;if(u=f(u._payload),i.type=u,typeof u=="function")bf(u)?(r=Vi(u,r),i.tag=1,i=L1(null,i,u,r,o)):(i.tag=0,i=hd(null,i,u,r,o));else{if(u!=null){if(f=u.$$typeof,f===z){i.tag=11,i=k1(null,i,u,r,o);break e}else if(f===N){i.tag=14,i=O1(null,i,u,r,o);break e}}throw i=je(u)||u,Error(a(306,i,""))}}return i;case 0:return hd(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,f=Vi(u,i.pendingProps),L1(r,i,u,f,o);case 3:e:{if(Ce(i,i.stateNode.containerInfo),r===null)throw Error(a(387));u=i.pendingProps;var m=i.memoizedState;f=m.element,jf(r,i),Wo(i,u,null,o);var S=i.memoizedState;if(u=S.cache,Va(i,tn,u),u!==m.cache&&Pf(i,[tn],o,!0),Xo(),u=S.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:S.cache},i.updateQueue.baseState=m,i.memoizedState=m,i.flags&256){i=U1(r,i,u,o);break e}else if(u!==f){f=br(Error(a(424)),i),zo(f),i=U1(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(zt=Gr(r.firstChild),Gn=i,dt=!0,Hi=null,na=!0,o=x1(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if(jo(),u===f){i=ba(r,i,o);break e}Tn(r,i,u,o)}i=i.child}return i;case 26:return Wc(r,i),r===null?(o=Vv(i.type,null,i.pendingProps,null))?i.memoizedState=o:dt||(o=i.type,r=i.pendingProps,u=hu(Z.current).createElement(o),u[on]=i,u[ln]=r,_n(u,o,r),ee(u),i.stateNode=u):i.memoizedState=Vv(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return De(i),r===null&&dt&&(u=i.stateNode=Gv(i.type,i.pendingProps,Z.current),Gn=i,na=!0,f=zt,oi(i.type)?(Jd=f,zt=Gr(u.firstChild)):zt=f),Tn(r,i,i.pendingProps.children,o),Wc(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&dt&&((f=u=zt)&&(u=PA(u,i.type,i.pendingProps,na),u!==null?(i.stateNode=u,Gn=i,zt=Gr(u.firstChild),na=!1,f=!0):f=!1),f||ji(i)),De(i),f=i.type,m=i.pendingProps,S=r!==null?r.memoizedProps:null,u=m.children,Yd(f,m)?u=null:S!==null&&Yd(f,S)&&(i.flags|=32),i.memoizedState!==null&&(f=qf(r,i,ZE,null,null,o),yl._currentValue=f),Wc(r,i),Tn(r,i,u,o),i.child;case 6:return r===null&&dt&&((r=o=zt)&&(o=FA(o,i.pendingProps,na),o!==null?(i.stateNode=o,Gn=i,zt=null,r=!0):r=!1),r||ji(i)),null;case 13:return B1(r,i,o);case 4:return Ce(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=Ps(i,null,u,o):Tn(r,i,u,o),i.child;case 11:return k1(r,i,i.type,i.pendingProps,o);case 7:return Tn(r,i,i.pendingProps,o),i.child;case 8:return Tn(r,i,i.pendingProps.children,o),i.child;case 12:return Tn(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,Va(i,i.type,u.value),Tn(r,i,u.children,o),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,Gi(i),f=On(f),u=u(f),i.flags|=1,Tn(r,i,u,o),i.child;case 14:return O1(r,i,i.type,i.pendingProps,o);case 15:return M1(r,i,i.type,i.pendingProps,o);case 19:return j1(r,i,o);case 31:return u=i.pendingProps,o=i.mode,u={mode:u.mode,children:u.children},r===null?(o=Qc(u,o),o.ref=i.ref,i.child=o,o.return=i,i=o):(o=xa(r.child,u),o.ref=i.ref,i.child=o,o.return=i,i=o),i;case 22:return D1(r,i,o);case 24:return Gi(i),u=On(tn),r===null?(f=Uf(),f===null&&(f=Ft,m=Ff(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),i.memoizedState={parent:u,cache:f},Hf(i),Va(i,tn,f)):((r.lanes&o)!==0&&(jf(r,i),Wo(i,null,null,o),Xo()),f=r.memoizedState,m=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),Va(i,tn,u)):(u=m.cache,Va(i,tn,u),u!==f.cache&&Pf(i,[tn],o,!0))),Tn(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ia(r){r.flags|=4}function G1(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Qv(i)){if(i=kr.current,i!==null&&((ct&4194048)===ct?ra!==null:(ct&62914560)!==ct&&(ct&536870912)===0||i!==ra))throw qo=Bf,wp;r.flags|=8192}}function Jc(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?wo():536870912,r.lanes|=i,Bs|=i)}function rl(r,i){if(!dt)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function Ht(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var f=r.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=r,f=f.sibling;else for(f=r.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=r,f=f.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function lA(r,i,o){var u=i.pendingProps;switch(kf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ht(i),null;case 1:return Ht(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Ea(tn),Pe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Ho(i)?Ia(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,_p())),Ht(i),null;case 26:return o=i.memoizedState,r===null?(Ia(i),o!==null?(Ht(i),G1(i,o)):(Ht(i),i.flags&=-16777217)):o?o!==r.memoizedState?(Ia(i),Ht(i),G1(i,o)):(Ht(i),i.flags&=-16777217):(r.memoizedProps!==u&&Ia(i),Ht(i),i.flags&=-16777217),null;case 27:ot(i),o=Z.current;var f=i.type;if(r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ia(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Ht(i),null}r=P.current,Ho(i)?Tp(i):(r=Gv(f,u,o),i.stateNode=r,Ia(i))}return Ht(i),null;case 5:if(ot(i),o=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ia(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return Ht(i),null}if(r=P.current,Ho(i))Tp(i);else{switch(f=hu(Z.current),r){case 1:r=f.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:r=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":r=f.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":r=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":r=f.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?r.multiple=!0:u.size&&(r.size=u.size);break;default:r=typeof u.is=="string"?f.createElement(o,{is:u.is}):f.createElement(o)}}r[on]=i,r[ln]=u;e:for(f=i.child;f!==null;){if(f.tag===5||f.tag===6)r.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===i)break e;for(;f.sibling===null;){if(f.return===null||f.return===i)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i.stateNode=r;e:switch(_n(r,o,u),o){case"button":case"input":case"select":case"textarea":r=!!u.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ia(i)}}return Ht(i),i.flags&=-16777217,null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&Ia(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(r=Z.current,Ho(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,f=Gn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}r[on]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Fv(r.nodeValue,o)),r||ji(i)}else r=hu(r).createTextNode(u),r[on]=i,i.stateNode=r}return Ht(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(f=Ho(i),u!==null&&u.dehydrated!==null){if(r===null){if(!f)throw Error(a(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[on]=i}else jo(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ht(i),f=!1}else f=_p(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(wa(i),i):(wa(i),null)}if(wa(i),(i.flags&128)!==0)return i.lanes=o,i;if(o=u!==null,r=r!==null&&r.memoizedState!==null,o){u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var m=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==f&&(u.flags|=2048)}return o!==r&&o&&(i.child.flags|=8192),Jc(i,i.updateQueue),Ht(i),null;case 4:return Pe(),r===null&&Gd(i.stateNode.containerInfo),Ht(i),null;case 10:return Ea(i.type),Ht(i),null;case 19:if(b(nn),f=i.memoizedState,f===null)return Ht(i),null;if(u=(i.flags&128)!==0,m=f.rendering,m===null)if(u)rl(f,!1);else{if(Gt!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(m=qc(r),m!==null){for(i.flags|=128,rl(f,!1),r=m.updateQueue,i.updateQueue=r,Jc(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)vp(o,r),o=o.sibling;return L(nn,nn.current&1|2),i.child}r=r.sibling}f.tail!==null&&Fe()>tu&&(i.flags|=128,u=!0,rl(f,!1),i.lanes=4194304)}else{if(!u)if(r=qc(m),r!==null){if(i.flags|=128,u=!0,r=r.updateQueue,i.updateQueue=r,Jc(i,r),rl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!dt)return Ht(i),null}else 2*Fe()-f.renderingStartTime>tu&&o!==536870912&&(i.flags|=128,u=!0,rl(f,!1),i.lanes=4194304);f.isBackwards?(m.sibling=i.child,i.child=m):(r=f.last,r!==null?r.sibling=m:i.child=m,f.last=m)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Fe(),i.sibling=null,r=nn.current,L(nn,u?r&1|2:r&1),i):(Ht(i),null);case 22:case 23:return wa(i),Kf(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(Ht(i),i.subtreeFlags&6&&(i.flags|=8192)):Ht(i),o=i.updateQueue,o!==null&&Jc(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&b($i),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Ea(tn),Ht(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function cA(r,i){switch(kf(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Ea(tn),Pe(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return ot(i),null;case 13:if(wa(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(a(340));jo()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return b(nn),null;case 4:return Pe(),null;case 10:return Ea(i.type),null;case 22:case 23:return wa(i),Kf(),r!==null&&b($i),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Ea(tn),null;case 25:return null;default:return null}}function $1(r,i){switch(kf(i),i.tag){case 3:Ea(tn),Pe();break;case 26:case 27:case 5:ot(i);break;case 4:Pe();break;case 13:wa(i);break;case 19:b(nn);break;case 10:Ea(i.type);break;case 22:case 23:wa(i),Kf(),r!==null&&b($i);break;case 24:Ea(tn)}}function al(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&r)===r){u=void 0;var m=o.create,S=o.inst;u=m(),S.destroy=u}o=o.next}while(o!==f)}}catch(w){Mt(i,i.return,w)}}function Za(r,i,o){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var m=f.next;u=m;do{if((u.tag&r)===r){var S=u.inst,w=S.destroy;if(w!==void 0){S.destroy=void 0,f=i;var H=o,ne=w;try{ne()}catch(me){Mt(f,H,me)}}}u=u.next}while(u!==m)}}catch(me){Mt(i,i.return,me)}}function K1(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{Op(i,o)}catch(u){Mt(r,r.return,u)}}}function V1(r,i,o){o.props=Vi(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){Mt(r,i,u)}}function il(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(f){Mt(r,i,f)}}function aa(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(f){Mt(r,i,f)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Mt(r,i,f)}else o.current=null}function q1(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(f){Mt(r,r.return,f)}}function Td(r,i,o){try{var u=r.stateNode;NA(u,r.type,o,i),u[ln]=i}catch(f){Mt(r,r.return,f)}}function Y1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&oi(r.type)||r.tag===4}function xd(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||Y1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&oi(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function _d(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=uu));else if(u!==4&&(u===27&&oi(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(_d(r,i,o),r=r.sibling;r!==null;)_d(r,i,o),r=r.sibling}function Zc(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&oi(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(Zc(r,i,o),r=r.sibling;r!==null;)Zc(r,i,o),r=r.sibling}function X1(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);_n(i,u,o),i[on]=r,i[ln]=o}catch(m){Mt(r,r.return,m)}}var Ra=!1,Yt=!1,Sd=!1,W1=typeof WeakSet=="function"?WeakSet:Set,un=null;function uA(r,i){if(r=r.containerInfo,Vd=vu,r=op(r),xf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var S=0,w=-1,H=-1,ne=0,me=0,xe=r,oe=null;t:for(;;){for(var ce;xe!==o||f!==0&&xe.nodeType!==3||(w=S+f),xe!==m||u!==0&&xe.nodeType!==3||(H=S+u),xe.nodeType===3&&(S+=xe.nodeValue.length),(ce=xe.firstChild)!==null;)oe=xe,xe=ce;for(;;){if(xe===r)break t;if(oe===o&&++ne===f&&(w=S),oe===m&&++me===u&&(H=S),(ce=xe.nextSibling)!==null)break;xe=oe,oe=xe.parentNode}xe=ce}o=w===-1||H===-1?null:{start:w,end:H}}else o=null}o=o||{start:0,end:0}}else o=null;for(qd={focusedElem:r,selectionRange:o},vu=!1,un=i;un!==null;)if(i=un,r=i.child,(i.subtreeFlags&1024)!==0&&r!==null)r.return=i,un=r;else for(;un!==null;){switch(i=un,m=i.alternate,r=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&m!==null){r=void 0,o=i,f=m.memoizedProps,m=m.memoizedState,u=o.stateNode;try{var Ye=Vi(o.type,f,o.elementType===o.type);r=u.getSnapshotBeforeUpdate(Ye,m),u.__reactInternalSnapshotBeforeUpdate=r}catch(Ke){Mt(o,o.return,Ke)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Wd(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Wd(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(a(163))}if(r=i.sibling,r!==null){r.return=i.return,un=r;break}un=i.return}}function Q1(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:ei(r,o),u&4&&al(5,o);break;case 1:if(ei(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(S){Mt(o,o.return,S)}else{var f=Vi(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(f,i,r.__reactInternalSnapshotBeforeUpdate)}catch(S){Mt(o,o.return,S)}}u&64&&K1(o),u&512&&il(o,o.return);break;case 3:if(ei(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Op(r,i)}catch(S){Mt(o,o.return,S)}}break;case 27:i===null&&u&4&&X1(o);case 26:case 5:ei(r,o),i===null&&u&4&&q1(o),u&512&&il(o,o.return);break;case 12:ei(r,o);break;case 13:ei(r,o),u&4&&ev(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=TA.bind(null,o),LA(r,o))));break;case 22:if(u=o.memoizedState!==null||Ra,!u){i=i!==null&&i.memoizedState!==null||Yt,f=Ra;var m=Yt;Ra=u,(Yt=i)&&!m?ti(r,o,(o.subtreeFlags&8772)!==0):ei(r,o),Ra=f,Yt=m}break;case 30:break;default:ei(r,o)}}function J1(r){var i=r.alternate;i!==null&&(r.alternate=null,J1(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&O(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Ut=null,Jn=!1;function Na(r,i,o){for(o=o.child;o!==null;)Z1(r,i,o),o=o.sibling}function Z1(r,i,o){if(yn&&typeof yn.onCommitFiberUnmount=="function")try{yn.onCommitFiberUnmount(jn,o)}catch{}switch(o.tag){case 26:Yt||aa(o,i),Na(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Yt||aa(o,i);var u=Ut,f=Jn;oi(o.type)&&(Ut=o.stateNode,Jn=!1),Na(r,i,o),gl(o.stateNode),Ut=u,Jn=f;break;case 5:Yt||aa(o,i);case 6:if(u=Ut,f=Jn,Ut=null,Na(r,i,o),Ut=u,Jn=f,Ut!==null)if(Jn)try{(Ut.nodeType===9?Ut.body:Ut.nodeName==="HTML"?Ut.ownerDocument.body:Ut).removeChild(o.stateNode)}catch(m){Mt(o,i,m)}else try{Ut.removeChild(o.stateNode)}catch(m){Mt(o,i,m)}break;case 18:Ut!==null&&(Jn?(r=Ut,jv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Sl(r)):jv(Ut,o.stateNode));break;case 4:u=Ut,f=Jn,Ut=o.stateNode.containerInfo,Jn=!0,Na(r,i,o),Ut=u,Jn=f;break;case 0:case 11:case 14:case 15:Yt||Za(2,o,i),Yt||Za(4,o,i),Na(r,i,o);break;case 1:Yt||(aa(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&V1(o,i,u)),Na(r,i,o);break;case 21:Na(r,i,o);break;case 22:Yt=(u=Yt)||o.memoizedState!==null,Na(r,i,o),Yt=u;break;default:Na(r,i,o)}}function ev(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Sl(r)}catch(o){Mt(i,i.return,o)}}function hA(r){switch(r.tag){case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new W1),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new W1),i;default:throw Error(a(435,r.tag))}}function Cd(r,i){var o=hA(r);i.forEach(function(u){var f=xA.bind(null,r,u);o.has(u)||(o.add(u),u.then(f,f))})}function cr(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u],m=r,S=i,w=S;e:for(;w!==null;){switch(w.tag){case 27:if(oi(w.type)){Ut=w.stateNode,Jn=!1;break e}break;case 5:Ut=w.stateNode,Jn=!1;break e;case 3:case 4:Ut=w.stateNode.containerInfo,Jn=!0;break e}w=w.return}if(Ut===null)throw Error(a(160));Z1(m,S,f),Ut=null,Jn=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)tv(i,r),i=i.sibling}var zr=null;function tv(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:cr(i,r),ur(r),u&4&&(Za(3,r,r.return),al(3,r),Za(5,r,r.return));break;case 1:cr(i,r),ur(r),u&512&&(Yt||o===null||aa(o,o.return)),u&64&&Ra&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var f=zr;if(cr(i,r),ur(r),u&512&&(Yt||o===null||aa(o,o.return)),u&4){var m=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":m=f.getElementsByTagName("title")[0],(!m||m[R]||m[on]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(u),f.head.insertBefore(m,f.querySelector("head > title"))),_n(m,u,o),m[on]=r,ee(m),u=m;break e;case"link":var S=Xv("link","href",f).get(u+(o.href||""));if(S){for(var w=0;w<S.length;w++)if(m=S[w],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){S.splice(w,1);break t}}m=f.createElement(u),_n(m,u,o),f.head.appendChild(m);break;case"meta":if(S=Xv("meta","content",f).get(u+(o.content||""))){for(w=0;w<S.length;w++)if(m=S[w],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){S.splice(w,1);break t}}m=f.createElement(u),_n(m,u,o),f.head.appendChild(m);break;default:throw Error(a(468,u))}m[on]=r,ee(m),u=m}r.stateNode=u}else Wv(f,r.type,r.stateNode);else r.stateNode=Yv(f,u,r.memoizedProps);else m!==u?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,u===null?Wv(f,r.type,r.stateNode):Yv(f,u,r.memoizedProps)):u===null&&r.stateNode!==null&&Td(r,r.memoizedProps,o.memoizedProps)}break;case 27:cr(i,r),ur(r),u&512&&(Yt||o===null||aa(o,o.return)),o!==null&&u&4&&Td(r,r.memoizedProps,o.memoizedProps);break;case 5:if(cr(i,r),ur(r),u&512&&(Yt||o===null||aa(o,o.return)),r.flags&32){f=r.stateNode;try{vs(f,"")}catch(ce){Mt(r,r.return,ce)}}u&4&&r.stateNode!=null&&(f=r.memoizedProps,Td(r,f,o!==null?o.memoizedProps:f)),u&1024&&(Sd=!0);break;case 6:if(cr(i,r),ur(r),u&4){if(r.stateNode===null)throw Error(a(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(ce){Mt(r,r.return,ce)}}break;case 3:if(gu=null,f=zr,zr=fu(i.containerInfo),cr(i,r),zr=f,ur(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Sl(i.containerInfo)}catch(ce){Mt(r,r.return,ce)}Sd&&(Sd=!1,nv(r));break;case 4:u=zr,zr=fu(r.stateNode.containerInfo),cr(i,r),ur(r),zr=u;break;case 12:cr(i,r),ur(r);break;case 13:cr(i,r),ur(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(Rd=Fe()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Cd(r,u)));break;case 22:f=r.memoizedState!==null;var H=o!==null&&o.memoizedState!==null,ne=Ra,me=Yt;if(Ra=ne||f,Yt=me||H,cr(i,r),Yt=me,Ra=ne,ur(r),u&8192)e:for(i=r.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(o===null||H||Ra||Yt||qi(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){H=o=i;try{if(m=H.stateNode,f)S=m.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{w=H.stateNode;var xe=H.memoizedProps.style,oe=xe!=null&&xe.hasOwnProperty("display")?xe.display:null;w.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ce){Mt(H,H.return,ce)}}}else if(i.tag===6){if(o===null){H=i;try{H.stateNode.nodeValue=f?"":H.memoizedProps}catch(ce){Mt(H,H.return,ce)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Cd(r,o))));break;case 19:cr(i,r),ur(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Cd(r,u)));break;case 30:break;case 21:break;default:cr(i,r),ur(r)}}function ur(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(Y1(u)){o=u;break}u=u.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var f=o.stateNode,m=xd(r);Zc(r,m,f);break;case 5:var S=o.stateNode;o.flags&32&&(vs(S,""),o.flags&=-33);var w=xd(r);Zc(r,w,S);break;case 3:case 4:var H=o.stateNode.containerInfo,ne=xd(r);_d(r,ne,H);break;default:throw Error(a(161))}}catch(me){Mt(r,r.return,me)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function nv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;nv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function ei(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)Q1(r,i.alternate,i),i=i.sibling}function qi(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:Za(4,i,i.return),qi(i);break;case 1:aa(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&V1(i,i.return,o),qi(i);break;case 27:gl(i.stateNode);case 26:case 5:aa(i,i.return),qi(i);break;case 22:i.memoizedState===null&&qi(i);break;case 30:qi(i);break;default:qi(i)}r=r.sibling}}function ti(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=r,m=i,S=m.flags;switch(m.tag){case 0:case 11:case 15:ti(f,m,o),al(4,m);break;case 1:if(ti(f,m,o),u=m,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ne){Mt(u,u.return,ne)}if(u=m,f=u.updateQueue,f!==null){var w=u.stateNode;try{var H=f.shared.hiddenCallbacks;if(H!==null)for(f.shared.hiddenCallbacks=null,f=0;f<H.length;f++)kp(H[f],w)}catch(ne){Mt(u,u.return,ne)}}o&&S&64&&K1(m),il(m,m.return);break;case 27:X1(m);case 26:case 5:ti(f,m,o),o&&u===null&&S&4&&q1(m),il(m,m.return);break;case 12:ti(f,m,o);break;case 13:ti(f,m,o),o&&S&4&&ev(f,m);break;case 22:m.memoizedState===null&&ti(f,m,o),il(m,m.return);break;case 30:break;default:ti(f,m,o)}i=i.sibling}}function Ed(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&$o(o))}function Ad(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&$o(r))}function ia(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)rv(r,i,o,u),i=i.sibling}function rv(r,i,o,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:ia(r,i,o,u),f&2048&&al(9,i);break;case 1:ia(r,i,o,u);break;case 3:ia(r,i,o,u),f&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&$o(r)));break;case 12:if(f&2048){ia(r,i,o,u),r=i.stateNode;try{var m=i.memoizedProps,S=m.id,w=m.onPostCommit;typeof w=="function"&&w(S,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(H){Mt(i,i.return,H)}}else ia(r,i,o,u);break;case 13:ia(r,i,o,u);break;case 23:break;case 22:m=i.stateNode,S=i.alternate,i.memoizedState!==null?m._visibility&2?ia(r,i,o,u):sl(r,i):m._visibility&2?ia(r,i,o,u):(m._visibility|=2,Fs(r,i,o,u,(i.subtreeFlags&10256)!==0)),f&2048&&Ed(S,i);break;case 24:ia(r,i,o,u),f&2048&&Ad(i.alternate,i);break;default:ia(r,i,o,u)}}function Fs(r,i,o,u,f){for(f=f&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var m=r,S=i,w=o,H=u,ne=S.flags;switch(S.tag){case 0:case 11:case 15:Fs(m,S,w,H,f),al(8,S);break;case 23:break;case 22:var me=S.stateNode;S.memoizedState!==null?me._visibility&2?Fs(m,S,w,H,f):sl(m,S):(me._visibility|=2,Fs(m,S,w,H,f)),f&&ne&2048&&Ed(S.alternate,S);break;case 24:Fs(m,S,w,H,f),f&&ne&2048&&Ad(S.alternate,S);break;default:Fs(m,S,w,H,f)}i=i.sibling}}function sl(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,f=u.flags;switch(u.tag){case 22:sl(o,u),f&2048&&Ed(u.alternate,u);break;case 24:sl(o,u),f&2048&&Ad(u.alternate,u);break;default:sl(o,u)}i=i.sibling}}var ol=8192;function Ls(r){if(r.subtreeFlags&ol)for(r=r.child;r!==null;)av(r),r=r.sibling}function av(r){switch(r.tag){case 26:Ls(r),r.flags&ol&&r.memoizedState!==null&&WA(zr,r.memoizedState,r.memoizedProps);break;case 5:Ls(r);break;case 3:case 4:var i=zr;zr=fu(r.stateNode.containerInfo),Ls(r),zr=i;break;case 22:r.memoizedState===null&&(i=r.alternate,i!==null&&i.memoizedState!==null?(i=ol,ol=16777216,Ls(r),ol=i):Ls(r));break;default:Ls(r)}}function iv(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function ll(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];un=u,ov(u,r)}iv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)sv(r),r=r.sibling}function sv(r){switch(r.tag){case 0:case 11:case 15:ll(r),r.flags&2048&&Za(9,r,r.return);break;case 3:ll(r);break;case 12:ll(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,eu(r)):ll(r);break;default:ll(r)}}function eu(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];un=u,ov(u,r)}iv(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:Za(8,i,i.return),eu(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,eu(i));break;default:eu(i)}r=r.sibling}}function ov(r,i){for(;un!==null;){var o=un;switch(o.tag){case 0:case 11:case 15:Za(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:$o(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,un=u;else e:for(o=r;un!==null;){u=un;var f=u.sibling,m=u.return;if(J1(u),u===o){un=null;break e}if(f!==null){f.return=m,un=f;break e}un=m}}}var fA={getCacheForType:function(r){var i=On(tn),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o}},dA=typeof WeakMap=="function"?WeakMap:Map,mt=0,Ft=null,it=null,ct=0,pt=0,hr=null,ni=!1,Us=!1,wd=!1,ka=0,Gt=0,ri=0,Yi=0,bd=0,Or=0,Bs=0,cl=null,Zn=null,Id=!1,Rd=0,tu=1/0,nu=null,ai=null,xn=0,ii=null,Hs=null,js=0,Nd=0,kd=null,lv=null,ul=0,Od=null;function fr(){if((mt&2)!==0&&ct!==0)return ct&-ct;if(re.T!==null){var r=Is;return r!==0?r:Bd()}return mc()}function cv(){Or===0&&(Or=(ct&536870912)===0||dt?Ao():536870912);var r=kr.current;return r!==null&&(r.flags|=32),Or}function dr(r,i,o){(r===Ft&&(pt===2||pt===9)||r.cancelPendingCommit!==null)&&(zs(r,0),si(r,ct,Or,!1)),Oi(r,o),((mt&2)===0||r!==Ft)&&(r===Ft&&((mt&2)===0&&(Yi|=o),Gt===4&&si(r,ct,Or,!1)),sa(r))}function uv(r,i,o){if((mt&6)!==0)throw Error(a(327));var u=!o&&(i&124)===0&&(i&r.expiredLanes)===0||ki(r,i),f=u?pA(r,i):Pd(r,i,!0),m=u;do{if(f===0){Us&&!u&&si(r,i,0,!1);break}else{if(o=r.current.alternate,m&&!gA(o)){f=Pd(r,i,!1),m=!1;continue}if(f===2){if(m=i,r.errorRecoveryDisabledLanes&m)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){i=S;e:{var w=r;f=cl;var H=w.current.memoizedState.isDehydrated;if(H&&(zs(w,S).flags|=256),S=Pd(w,S,!1),S!==2){if(wd&&!H){w.errorRecoveryDisabledLanes|=m,Yi|=m,f=4;break e}m=Zn,Zn=f,m!==null&&(Zn===null?Zn=m:Zn.push.apply(Zn,m))}f=S}if(m=!1,f!==2)continue}}if(f===1){zs(r,0),si(r,i,0,!0);break}e:{switch(u=r,m=f,m){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:si(u,i,Or,!ni);break e;case 2:Zn=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(f=Rd+300-Fe(),10<f)){if(si(u,i,Or,!ni),gs(u,0,!0)!==0)break e;u.timeoutHandle=Bv(hv.bind(null,u,o,Zn,nu,Id,i,Or,Yi,Bs,ni,m,2,-0,0),f);break e}hv(u,o,Zn,nu,Id,i,Or,Yi,Bs,ni,m,0,-0,0)}}break}while(!0);sa(r)}function hv(r,i,o,u,f,m,S,w,H,ne,me,xe,oe,ce){if(r.timeoutHandle=-1,xe=i.subtreeFlags,(xe&8192||(xe&16785408)===16785408)&&(vl={stylesheets:null,count:0,unsuspend:XA},av(i),xe=QA(),xe!==null)){r.cancelPendingCommit=xe(yv.bind(null,r,i,m,o,u,f,S,w,H,me,1,oe,ce)),si(r,m,S,!ne);return}yv(r,i,m,o,u,f,S,w,H)}function gA(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var f=o[u],m=f.getSnapshot;f=f.value;try{if(!or(m(),f))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function si(r,i,o,u){i&=~bd,i&=~Yi,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var f=i;0<f;){var m=31-zn(f),S=1<<m;u[m]=-1,f&=~S}o!==0&&dc(r,o,i)}function ru(){return(mt&6)===0?(hl(0),!1):!0}function Md(){if(it!==null){if(pt===0)var r=it.return;else r=it,Ca=zi=null,Wf(r),Ds=null,tl=0,r=it;for(;r!==null;)$1(r.alternate,r),r=r.return;it=null}}function zs(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,OA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Md(),Ft=r,it=o=xa(r.current,null),ct=i,pt=0,hr=null,ni=!1,Us=ki(r,i),wd=!1,Bs=Or=bd=Yi=ri=Gt=0,Zn=cl=null,Id=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var f=31-zn(u),m=1<<f;i|=r[f],u&=~m}return ka=i,Ac(),o}function fv(r,i){rt=null,re.H=$c,i===Vo||i===Dc?(i=Rp(),pt=3):i===wp?(i=Rp(),pt=4):pt=i===N1?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,hr=i,it===null&&(Gt=1,Xc(r,br(i,r.current)))}function dv(){var r=re.H;return re.H=$c,r===null?$c:r}function gv(){var r=re.A;return re.A=fA,r}function Dd(){Gt=4,ni||(ct&4194048)!==ct&&kr.current!==null||(Us=!0),(ri&134217727)===0&&(Yi&134217727)===0||Ft===null||si(Ft,ct,Or,!1)}function Pd(r,i,o){var u=mt;mt|=2;var f=dv(),m=gv();(Ft!==r||ct!==i)&&(nu=null,zs(r,i)),i=!1;var S=Gt;e:do try{if(pt!==0&&it!==null){var w=it,H=hr;switch(pt){case 8:Md(),S=6;break e;case 3:case 2:case 9:case 6:kr.current===null&&(i=!0);var ne=pt;if(pt=0,hr=null,Gs(r,w,H,ne),o&&Us){S=0;break e}break;default:ne=pt,pt=0,hr=null,Gs(r,w,H,ne)}}mA(),S=Gt;break}catch(me){fv(r,me)}while(!0);return i&&r.shellSuspendCounter++,Ca=zi=null,mt=u,re.H=f,re.A=m,it===null&&(Ft=null,ct=0,Ac()),S}function mA(){for(;it!==null;)mv(it)}function pA(r,i){var o=mt;mt|=2;var u=dv(),f=gv();Ft!==r||ct!==i?(nu=null,tu=Fe()+500,zs(r,i)):Us=ki(r,i);e:do try{if(pt!==0&&it!==null){i=it;var m=hr;t:switch(pt){case 1:pt=0,hr=null,Gs(r,i,m,1);break;case 2:case 9:if(bp(m)){pt=0,hr=null,pv(i);break}i=function(){pt!==2&&pt!==9||Ft!==r||(pt=7),sa(r)},m.then(i,i);break e;case 3:pt=7;break e;case 4:pt=5;break e;case 7:bp(m)?(pt=0,hr=null,pv(i)):(pt=0,hr=null,Gs(r,i,m,7));break;case 5:var S=null;switch(it.tag){case 26:S=it.memoizedState;case 5:case 27:var w=it;if(!S||Qv(S)){pt=0,hr=null;var H=w.sibling;if(H!==null)it=H;else{var ne=w.return;ne!==null?(it=ne,au(ne)):it=null}break t}}pt=0,hr=null,Gs(r,i,m,5);break;case 6:pt=0,hr=null,Gs(r,i,m,6);break;case 8:Md(),Gt=6;break e;default:throw Error(a(462))}}vA();break}catch(me){fv(r,me)}while(!0);return Ca=zi=null,re.H=u,re.A=f,mt=o,it!==null?0:(Ft=null,ct=0,Ac(),Gt)}function vA(){for(;it!==null&&!Un();)mv(it)}function mv(r){var i=z1(r.alternate,r,ka);r.memoizedProps=r.pendingProps,i===null?au(r):it=i}function pv(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=F1(o,i,i.pendingProps,i.type,void 0,ct);break;case 11:i=F1(o,i,i.pendingProps,i.type.render,i.ref,ct);break;case 5:Wf(i);default:$1(o,i),i=it=vp(i,ka),i=z1(o,i,ka)}r.memoizedProps=r.pendingProps,i===null?au(r):it=i}function Gs(r,i,o,u){Ca=zi=null,Wf(i),Ds=null,tl=0;var f=i.return;try{if(sA(r,f,i,o,ct)){Gt=1,Xc(r,br(o,r.current)),it=null;return}}catch(m){if(f!==null)throw it=f,m;Gt=1,Xc(r,br(o,r.current)),it=null;return}i.flags&32768?(dt||u===1?r=!0:Us||(ct&536870912)!==0?r=!1:(ni=r=!0,(u===2||u===9||u===3||u===6)&&(u=kr.current,u!==null&&u.tag===13&&(u.flags|=16384))),vv(i,r)):au(i)}function au(r){var i=r;do{if((i.flags&32768)!==0){vv(i,ni);return}r=i.return;var o=lA(i.alternate,i,ka);if(o!==null){it=o;return}if(i=i.sibling,i!==null){it=i;return}it=i=r}while(i!==null);Gt===0&&(Gt=5)}function vv(r,i){do{var o=cA(r.alternate,r);if(o!==null){o.flags&=32767,it=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){it=r;return}it=r=o}while(r!==null);Gt=6,it=null}function yv(r,i,o,u,f,m,S,w,H){r.cancelPendingCommit=null;do iu();while(xn!==0);if((mt&6)!==0)throw Error(a(327));if(i!==null){if(i===r.current)throw Error(a(177));if(m=i.lanes|i.childLanes,m|=Af,ms(r,o,m,S,w,H),r===Ft&&(it=Ft=null,ct=0),Hs=i,ii=r,js=o,Nd=m,kd=f,lv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,_A(sr,function(){return Cv(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=re.T,re.T=null,f=_e.p,_e.p=2,S=mt,mt|=4;try{uA(r,i,o)}finally{mt=S,_e.p=f,re.T=u}}xn=1,Tv(),xv(),_v()}}function Tv(){if(xn===1){xn=0;var r=ii,i=Hs,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=re.T,re.T=null;var u=_e.p;_e.p=2;var f=mt;mt|=4;try{tv(i,r);var m=qd,S=op(r.containerInfo),w=m.focusedElem,H=m.selectionRange;if(S!==w&&w&&w.ownerDocument&&sp(w.ownerDocument.documentElement,w)){if(H!==null&&xf(w)){var ne=H.start,me=H.end;if(me===void 0&&(me=ne),"selectionStart"in w)w.selectionStart=ne,w.selectionEnd=Math.min(me,w.value.length);else{var xe=w.ownerDocument||document,oe=xe&&xe.defaultView||window;if(oe.getSelection){var ce=oe.getSelection(),Ye=w.textContent.length,Ke=Math.min(H.start,Ye),wt=H.end===void 0?Ke:Math.min(H.end,Ye);!ce.extend&&Ke>wt&&(S=wt,wt=Ke,Ke=S);var Q=ip(w,Ke),q=ip(w,wt);if(Q&&q&&(ce.rangeCount!==1||ce.anchorNode!==Q.node||ce.anchorOffset!==Q.offset||ce.focusNode!==q.node||ce.focusOffset!==q.offset)){var te=xe.createRange();te.setStart(Q.node,Q.offset),ce.removeAllRanges(),Ke>wt?(ce.addRange(te),ce.extend(q.node,q.offset)):(te.setEnd(q.node,q.offset),ce.addRange(te))}}}}for(xe=[],ce=w;ce=ce.parentNode;)ce.nodeType===1&&xe.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<xe.length;w++){var pe=xe[w];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}vu=!!Vd,qd=Vd=null}finally{mt=f,_e.p=u,re.T=o}}r.current=i,xn=2}}function xv(){if(xn===2){xn=0;var r=ii,i=Hs,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=re.T,re.T=null;var u=_e.p;_e.p=2;var f=mt;mt|=4;try{Q1(r,i.alternate,i)}finally{mt=f,_e.p=u,re.T=o}}xn=3}}function _v(){if(xn===4||xn===3){xn=0,kt();var r=ii,i=Hs,o=js,u=lv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?xn=5:(xn=0,Hs=ii=null,Sv(r,r.pendingLanes));var f=r.pendingLanes;if(f===0&&(ai=null),Ro(o),i=i.stateNode,yn&&typeof yn.onCommitFiberRoot=="function")try{yn.onCommitFiberRoot(jn,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=re.T,f=_e.p,_e.p=2,re.T=null;try{for(var m=r.onRecoverableError,S=0;S<u.length;S++){var w=u[S];m(w.value,{componentStack:w.stack})}}finally{re.T=i,_e.p=f}}(js&3)!==0&&iu(),sa(r),f=r.pendingLanes,(o&4194090)!==0&&(f&42)!==0?r===Od?ul++:(ul=0,Od=r):ul=0,hl(0)}}function Sv(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,$o(i)))}function iu(r){return Tv(),xv(),_v(),Cv()}function Cv(){if(xn!==5)return!1;var r=ii,i=Nd;Nd=0;var o=Ro(js),u=re.T,f=_e.p;try{_e.p=32>o?32:o,re.T=null,o=kd,kd=null;var m=ii,S=js;if(xn=0,Hs=ii=null,js=0,(mt&6)!==0)throw Error(a(331));var w=mt;if(mt|=4,sv(m.current),rv(m,m.current,S,o),mt=w,hl(0,!1),yn&&typeof yn.onPostCommitFiberRoot=="function")try{yn.onPostCommitFiberRoot(jn,m)}catch{}return!0}finally{_e.p=f,re.T=u,Sv(r,i)}}function Ev(r,i,o){i=br(o,i),i=ud(r.stateNode,i,2),r=Xa(r,i,2),r!==null&&(Oi(r,2),sa(r))}function Mt(r,i,o){if(r.tag===3)Ev(r,r,o);else for(;i!==null;){if(i.tag===3){Ev(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ai===null||!ai.has(u))){r=br(o,r),o=I1(2),u=Xa(i,o,2),u!==null&&(R1(o,u,i,r),Oi(u,2),sa(u));break}}i=i.return}}function Fd(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new dA;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(o)||(wd=!0,f.add(o),r=yA.bind(null,r,i,o),i.then(r,r))}function yA(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,Ft===r&&(ct&o)===o&&(Gt===4||Gt===3&&(ct&62914560)===ct&&300>Fe()-Rd?(mt&2)===0&&zs(r,0):bd|=o,Bs===ct&&(Bs=0)),sa(r)}function Av(r,i){i===0&&(i=wo()),r=Es(r,i),r!==null&&(Oi(r,i),sa(r))}function TA(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),Av(r,o)}function xA(r,i){var o=0;switch(r.tag){case 13:var u=r.stateNode,f=r.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),Av(r,o)}function _A(r,i){return jt(r,i)}var su=null,$s=null,Ld=!1,ou=!1,Ud=!1,Xi=0;function sa(r){r!==$s&&r.next===null&&($s===null?su=$s=r:$s=$s.next=r),ou=!0,Ld||(Ld=!0,CA())}function hl(r,i){if(!Ud&&ou){Ud=!0;do for(var o=!1,u=su;u!==null;){if(r!==0){var f=u.pendingLanes;if(f===0)var m=0;else{var S=u.suspendedLanes,w=u.pingedLanes;m=(1<<31-zn(42|r)+1)-1,m&=f&~(S&~w),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,Rv(u,m))}else m=ct,m=gs(u,u===Ft?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||ki(u,m)||(o=!0,Rv(u,m));u=u.next}while(o);Ud=!1}}function SA(){wv()}function wv(){ou=Ld=!1;var r=0;Xi!==0&&(kA()&&(r=Xi),Xi=0);for(var i=Fe(),o=null,u=su;u!==null;){var f=u.next,m=bv(u,i);m===0?(u.next=null,o===null?su=f:o.next=f,f===null&&($s=o)):(o=u,(r!==0||(m&3)!==0)&&(ou=!0)),u=f}hl(r)}function bv(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,f=r.expirationTimes,m=r.pendingLanes&-62914561;0<m;){var S=31-zn(m),w=1<<S,H=f[S];H===-1?((w&o)===0||(w&u)!==0)&&(f[S]=fc(w,i)):H<=i&&(r.expiredLanes|=w),m&=~w}if(i=Ft,o=ct,o=gs(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(pt===2||pt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&lt(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||ki(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&lt(u),Ro(o)){case 2:case 8:o=Cr;break;case 32:o=sr;break;case 268435456:o=Ot;break;default:o=sr}return u=Iv.bind(null,r),o=jt(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&lt(u),r.callbackPriority=2,r.callbackNode=null,2}function Iv(r,i){if(xn!==0&&xn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(iu()&&r.callbackNode!==o)return null;var u=ct;return u=gs(r,r===Ft?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(uv(r,u,i),bv(r,Fe()),r.callbackNode!=null&&r.callbackNode===o?Iv.bind(null,r):null)}function Rv(r,i){if(iu())return null;uv(r,i,!0)}function CA(){MA(function(){(mt&6)!==0?jt(Bn,SA):wv()})}function Bd(){return Xi===0&&(Xi=Ao()),Xi}function Nv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:yc(""+r)}function kv(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function EA(r,i,o,u,f){if(i==="submit"&&o&&o.stateNode===f){var m=Nv((f[ln]||null).action),S=u.submitter;S&&(i=(i=S[ln]||null)?Nv(i.formAction):S.getAttribute("formAction"),i!==null&&(m=i,S=null));var w=new Sc("action","action",null,u,f);r.push({event:w,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Xi!==0){var H=S?kv(f,S):new FormData(f);id(o,{pending:!0,data:H,method:f.method,action:m},null,H)}}else typeof m=="function"&&(w.preventDefault(),H=S?kv(f,S):new FormData(f),id(o,{pending:!0,data:H,method:f.method,action:m},m,H))},currentTarget:f}]})}}for(var Hd=0;Hd<Ef.length;Hd++){var jd=Ef[Hd],AA=jd.toLowerCase(),wA=jd[0].toUpperCase()+jd.slice(1);jr(AA,"on"+wA)}jr(up,"onAnimationEnd"),jr(hp,"onAnimationIteration"),jr(fp,"onAnimationStart"),jr("dblclick","onDoubleClick"),jr("focusin","onFocus"),jr("focusout","onBlur"),jr(GE,"onTransitionRun"),jr($E,"onTransitionStart"),jr(KE,"onTransitionCancel"),jr(dp,"onTransitionEnd"),Re("onMouseEnter",["mouseout","mouseover"]),Re("onMouseLeave",["mouseout","mouseover"]),Re("onPointerEnter",["pointerout","pointerover"]),Re("onPointerLeave",["pointerout","pointerover"]),Ee("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ee("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ee("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ee("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ee("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ee("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var fl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(fl));function Ov(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],f=u.event;u=u.listeners;e:{var m=void 0;if(i)for(var S=u.length-1;0<=S;S--){var w=u[S],H=w.instance,ne=w.currentTarget;if(w=w.listener,H!==m&&f.isPropagationStopped())break e;m=w,f.currentTarget=ne;try{m(f)}catch(me){Yc(me)}f.currentTarget=null,m=H}else for(S=0;S<u.length;S++){if(w=u[S],H=w.instance,ne=w.currentTarget,w=w.listener,H!==m&&f.isPropagationStopped())break e;m=w,f.currentTarget=ne;try{m(f)}catch(me){Yc(me)}f.currentTarget=null,m=H}}}}function st(r,i){var o=i[No];o===void 0&&(o=i[No]=new Set);var u=r+"__bubble";o.has(u)||(Mv(i,r,2,!1),o.add(u))}function zd(r,i,o){var u=0;i&&(u|=4),Mv(o,r,u,i)}var lu="_reactListening"+Math.random().toString(36).slice(2);function Gd(r){if(!r[lu]){r[lu]=!0,se.forEach(function(o){o!=="selectionchange"&&(bA.has(o)||zd(o,!1,r),zd(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[lu]||(i[lu]=!0,zd("selectionchange",!1,i))}}function Mv(r,i,o,u){switch(ry(i)){case 2:var f=ew;break;case 8:f=tw;break;default:f=r0}o=f.bind(null,i,o,r),f=void 0,!hf||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?r.addEventListener(i,o,{capture:!0,passive:f}):r.addEventListener(i,o,!0):f!==void 0?r.addEventListener(i,o,{passive:f}):r.addEventListener(i,o,!1)}function $d(r,i,o,u,f){var m=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var w=u.stateNode.containerInfo;if(w===f)break;if(S===4)for(S=u.return;S!==null;){var H=S.tag;if((H===3||H===4)&&S.stateNode.containerInfo===f)return;S=S.return}for(;w!==null;){if(S=M(w),S===null)return;if(H=S.tag,H===5||H===6||H===26||H===27){u=m=S;continue e}w=w.parentNode}}u=u.return}Hm(function(){var ne=m,me=cf(o),xe=[];e:{var oe=gp.get(r);if(oe!==void 0){var ce=Sc,Ye=r;switch(r){case"keypress":if(xc(o)===0)break e;case"keydown":case"keyup":ce=_E;break;case"focusin":Ye="focus",ce=mf;break;case"focusout":Ye="blur",ce=mf;break;case"beforeblur":case"afterblur":ce=mf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=Gm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=cE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=EE;break;case up:case hp:case fp:ce=fE;break;case dp:ce=wE;break;case"scroll":case"scrollend":ce=oE;break;case"wheel":ce=IE;break;case"copy":case"cut":case"paste":ce=gE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Km;break;case"toggle":case"beforetoggle":ce=NE}var Ke=(i&4)!==0,wt=!Ke&&(r==="scroll"||r==="scrollend"),Q=Ke?oe!==null?oe+"Capture":null:oe;Ke=[];for(var q=ne,te;q!==null;){var pe=q;if(te=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||te===null||Q===null||(pe=ko(q,Q),pe!=null&&Ke.push(dl(q,pe,te))),wt)break;q=q.return}0<Ke.length&&(oe=new ce(oe,Ye,null,o,me),xe.push({event:oe,listeners:Ke}))}}if((i&7)===0){e:{if(oe=r==="mouseover"||r==="pointerover",ce=r==="mouseout"||r==="pointerout",oe&&o!==lf&&(Ye=o.relatedTarget||o.fromElement)&&(M(Ye)||Ye[Ga]))break e;if((ce||oe)&&(oe=me.window===me?me:(oe=me.ownerDocument)?oe.defaultView||oe.parentWindow:window,ce?(Ye=o.relatedTarget||o.toElement,ce=ne,Ye=Ye?M(Ye):null,Ye!==null&&(wt=l(Ye),Ke=Ye.tag,Ye!==wt||Ke!==5&&Ke!==27&&Ke!==6)&&(Ye=null)):(ce=null,Ye=ne),ce!==Ye)){if(Ke=Gm,pe="onMouseLeave",Q="onMouseEnter",q="mouse",(r==="pointerout"||r==="pointerover")&&(Ke=Km,pe="onPointerLeave",Q="onPointerEnter",q="pointer"),wt=ce==null?oe:ae(ce),te=Ye==null?oe:ae(Ye),oe=new Ke(pe,q+"leave",ce,o,me),oe.target=wt,oe.relatedTarget=te,pe=null,M(me)===ne&&(Ke=new Ke(Q,q+"enter",Ye,o,me),Ke.target=te,Ke.relatedTarget=wt,pe=Ke),wt=pe,ce&&Ye)t:{for(Ke=ce,Q=Ye,q=0,te=Ke;te;te=Ks(te))q++;for(te=0,pe=Q;pe;pe=Ks(pe))te++;for(;0<q-te;)Ke=Ks(Ke),q--;for(;0<te-q;)Q=Ks(Q),te--;for(;q--;){if(Ke===Q||Q!==null&&Ke===Q.alternate)break t;Ke=Ks(Ke),Q=Ks(Q)}Ke=null}else Ke=null;ce!==null&&Dv(xe,oe,ce,Ke,!1),Ye!==null&&wt!==null&&Dv(xe,wt,Ye,Ke,!0)}}e:{if(oe=ne?ae(ne):window,ce=oe.nodeName&&oe.nodeName.toLowerCase(),ce==="select"||ce==="input"&&oe.type==="file")var ze=Zm;else if(Qm(oe))if(ep)ze=HE;else{ze=UE;var at=LE}else ce=oe.nodeName,!ce||ce.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ne&&of(ne.elementType)&&(ze=Zm):ze=BE;if(ze&&(ze=ze(r,ne))){Jm(xe,ze,o,me);break e}at&&at(r,oe,ne),r==="focusout"&&ne&&oe.type==="number"&&ne.memoizedProps.value!=null&&sf(oe,"number",oe.value)}switch(at=ne?ae(ne):window,r){case"focusin":(Qm(at)||at.contentEditable==="true")&&(_s=at,_f=ne,Bo=null);break;case"focusout":Bo=_f=_s=null;break;case"mousedown":Sf=!0;break;case"contextmenu":case"mouseup":case"dragend":Sf=!1,lp(xe,o,me);break;case"selectionchange":if(zE)break;case"keydown":case"keyup":lp(xe,o,me)}var Ge;if(vf)e:{switch(r){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else xs?Xm(r,o)&&(Ve="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ve="onCompositionStart");Ve&&(Vm&&o.locale!=="ko"&&(xs||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&xs&&(Ge=jm()):(Ka=me,ff="value"in Ka?Ka.value:Ka.textContent,xs=!0)),at=cu(ne,Ve),0<at.length&&(Ve=new $m(Ve,r,null,o,me),xe.push({event:Ve,listeners:at}),Ge?Ve.data=Ge:(Ge=Wm(o),Ge!==null&&(Ve.data=Ge)))),(Ge=OE?ME(r,o):DE(r,o))&&(Ve=cu(ne,"onBeforeInput"),0<Ve.length&&(at=new $m("onBeforeInput","beforeinput",null,o,me),xe.push({event:at,listeners:Ve}),at.data=Ge)),EA(xe,r,ne,o,me)}Ov(xe,i)})}function dl(r,i,o){return{instance:r,listener:i,currentTarget:o}}function cu(r,i){for(var o=i+"Capture",u=[];r!==null;){var f=r,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=ko(r,o),f!=null&&u.unshift(dl(r,f,m)),f=ko(r,i),f!=null&&u.push(dl(r,f,m))),r.tag===3)return u;r=r.return}return[]}function Ks(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Dv(r,i,o,u,f){for(var m=i._reactName,S=[];o!==null&&o!==u;){var w=o,H=w.alternate,ne=w.stateNode;if(w=w.tag,H!==null&&H===u)break;w!==5&&w!==26&&w!==27||ne===null||(H=ne,f?(ne=ko(o,m),ne!=null&&S.unshift(dl(o,ne,H))):f||(ne=ko(o,m),ne!=null&&S.push(dl(o,ne,H)))),o=o.return}S.length!==0&&r.push({event:i,listeners:S})}var IA=/\r\n?/g,RA=/\u0000|\uFFFD/g;function Pv(r){return(typeof r=="string"?r:""+r).replace(IA,`
`).replace(RA,"")}function Fv(r,i){return i=Pv(i),Pv(r)===i}function uu(){}function At(r,i,o,u,f,m){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||vs(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&vs(r,""+u);break;case"className":Ct(r,"class",u);break;case"tabIndex":Ct(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Ct(r,o,u);break;case"style":Um(r,u,m);break;case"data":if(i!=="object"){Ct(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=yc(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(i!=="input"&&At(r,i,"name",f.name,f,null),At(r,i,"formEncType",f.formEncType,f,null),At(r,i,"formMethod",f.formMethod,f,null),At(r,i,"formTarget",f.formTarget,f,null)):(At(r,i,"encType",f.encType,f,null),At(r,i,"method",f.method,f,null),At(r,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=yc(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=uu);break;case"onScroll":u!=null&&st("scroll",r);break;case"onScrollEnd":u!=null&&st("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=yc(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":st("beforetoggle",r),st("toggle",r),St(r,"popover",u);break;case"xlinkActuate":Pt(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Pt(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Pt(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Pt(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Pt(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Pt(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Pt(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Pt(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Pt(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":St(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=iE.get(o)||o,St(r,o,u))}}function Kd(r,i,o,u,f,m){switch(o){case"style":Um(r,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));r.innerHTML=o}}break;case"children":typeof u=="string"?vs(r,u):(typeof u=="number"||typeof u=="bigint")&&vs(r,""+u);break;case"onScroll":u!=null&&st("scroll",r);break;case"onScrollEnd":u!=null&&st("scrollend",r);break;case"onClick":u!=null&&(r.onclick=uu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!le.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),i=o.slice(2,f?o.length-7:void 0),m=r[ln]||null,m=m!=null?m[o]:null,typeof m=="function"&&r.removeEventListener(i,m,f),typeof u=="function")){typeof m!="function"&&m!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,f);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):St(r,o,u)}}}function _n(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":st("error",r),st("load",r);var u=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var S=o[m];if(S!=null)switch(m){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:At(r,i,m,S,o,null)}}f&&At(r,i,"srcSet",o.srcSet,o,null),u&&At(r,i,"src",o.src,o,null);return;case"input":st("invalid",r);var w=m=S=f=null,H=null,ne=null;for(u in o)if(o.hasOwnProperty(u)){var me=o[u];if(me!=null)switch(u){case"name":f=me;break;case"type":S=me;break;case"checked":H=me;break;case"defaultChecked":ne=me;break;case"value":m=me;break;case"defaultValue":w=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,i));break;default:At(r,i,u,me,o,null)}}Dm(r,m,w,H,ne,S,f,!1),pc(r);return;case"select":st("invalid",r),u=S=m=null;for(f in o)if(o.hasOwnProperty(f)&&(w=o[f],w!=null))switch(f){case"value":m=w;break;case"defaultValue":S=w;break;case"multiple":u=w;default:At(r,i,f,w,o,null)}i=m,o=S,r.multiple=!!u,i!=null?ps(r,!!u,i,!1):o!=null&&ps(r,!!u,o,!0);return;case"textarea":st("invalid",r),m=f=u=null;for(S in o)if(o.hasOwnProperty(S)&&(w=o[S],w!=null))switch(S){case"value":u=w;break;case"defaultValue":f=w;break;case"children":m=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(a(91));break;default:At(r,i,S,w,o,null)}Fm(r,u,f,m),pc(r);return;case"option":for(H in o)if(o.hasOwnProperty(H)&&(u=o[H],u!=null))switch(H){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:At(r,i,H,u,o,null)}return;case"dialog":st("beforetoggle",r),st("toggle",r),st("cancel",r),st("close",r);break;case"iframe":case"object":st("load",r);break;case"video":case"audio":for(u=0;u<fl.length;u++)st(fl[u],r);break;case"image":st("error",r),st("load",r);break;case"details":st("toggle",r);break;case"embed":case"source":case"link":st("error",r),st("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(u=o[ne],u!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:At(r,i,ne,u,o,null)}return;default:if(of(i)){for(me in o)o.hasOwnProperty(me)&&(u=o[me],u!==void 0&&Kd(r,i,me,u,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(u=o[w],u!=null&&At(r,i,w,u,o,null))}function NA(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,S=null,w=null,H=null,ne=null,me=null;for(ce in o){var xe=o[ce];if(o.hasOwnProperty(ce)&&xe!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":H=xe;default:u.hasOwnProperty(ce)||At(r,i,ce,null,u,xe)}}for(var oe in u){var ce=u[oe];if(xe=o[oe],u.hasOwnProperty(oe)&&(ce!=null||xe!=null))switch(oe){case"type":m=ce;break;case"name":f=ce;break;case"checked":ne=ce;break;case"defaultChecked":me=ce;break;case"value":S=ce;break;case"defaultValue":w=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(a(137,i));break;default:ce!==xe&&At(r,i,oe,ce,u,xe)}}af(r,S,w,H,ne,me,m,f);return;case"select":ce=S=w=oe=null;for(m in o)if(H=o[m],o.hasOwnProperty(m)&&H!=null)switch(m){case"value":break;case"multiple":ce=H;default:u.hasOwnProperty(m)||At(r,i,m,null,u,H)}for(f in u)if(m=u[f],H=o[f],u.hasOwnProperty(f)&&(m!=null||H!=null))switch(f){case"value":oe=m;break;case"defaultValue":w=m;break;case"multiple":S=m;default:m!==H&&At(r,i,f,m,u,H)}i=w,o=S,u=ce,oe!=null?ps(r,!!o,oe,!1):!!u!=!!o&&(i!=null?ps(r,!!o,i,!0):ps(r,!!o,o?[]:"",!1));return;case"textarea":ce=oe=null;for(w in o)if(f=o[w],o.hasOwnProperty(w)&&f!=null&&!u.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:At(r,i,w,null,u,f)}for(S in u)if(f=u[S],m=o[S],u.hasOwnProperty(S)&&(f!=null||m!=null))switch(S){case"value":oe=f;break;case"defaultValue":ce=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==m&&At(r,i,S,f,u,m)}Pm(r,oe,ce);return;case"option":for(var Ye in o)if(oe=o[Ye],o.hasOwnProperty(Ye)&&oe!=null&&!u.hasOwnProperty(Ye))switch(Ye){case"selected":r.selected=!1;break;default:At(r,i,Ye,null,u,oe)}for(H in u)if(oe=u[H],ce=o[H],u.hasOwnProperty(H)&&oe!==ce&&(oe!=null||ce!=null))switch(H){case"selected":r.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:At(r,i,H,oe,u,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in o)oe=o[Ke],o.hasOwnProperty(Ke)&&oe!=null&&!u.hasOwnProperty(Ke)&&At(r,i,Ke,null,u,oe);for(ne in u)if(oe=u[ne],ce=o[ne],u.hasOwnProperty(ne)&&oe!==ce&&(oe!=null||ce!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(a(137,i));break;default:At(r,i,ne,oe,u,ce)}return;default:if(of(i)){for(var wt in o)oe=o[wt],o.hasOwnProperty(wt)&&oe!==void 0&&!u.hasOwnProperty(wt)&&Kd(r,i,wt,void 0,u,oe);for(me in u)oe=u[me],ce=o[me],!u.hasOwnProperty(me)||oe===ce||oe===void 0&&ce===void 0||Kd(r,i,me,oe,u,ce);return}}for(var Q in o)oe=o[Q],o.hasOwnProperty(Q)&&oe!=null&&!u.hasOwnProperty(Q)&&At(r,i,Q,null,u,oe);for(xe in u)oe=u[xe],ce=o[xe],!u.hasOwnProperty(xe)||oe===ce||oe==null&&ce==null||At(r,i,xe,oe,u,ce)}var Vd=null,qd=null;function hu(r){return r.nodeType===9?r:r.ownerDocument}function Lv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Uv(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Yd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Xd=null;function kA(){var r=window.event;return r&&r.type==="popstate"?r===Xd?!1:(Xd=r,!0):(Xd=null,!1)}var Bv=typeof setTimeout=="function"?setTimeout:void 0,OA=typeof clearTimeout=="function"?clearTimeout:void 0,Hv=typeof Promise=="function"?Promise:void 0,MA=typeof queueMicrotask=="function"?queueMicrotask:typeof Hv<"u"?function(r){return Hv.resolve(null).then(r).catch(DA)}:Bv;function DA(r){setTimeout(function(){throw r})}function oi(r){return r==="head"}function jv(r,i){var o=i,u=0,f=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"){if(0<u&&8>u){o=u;var S=r.ownerDocument;if(o&1&&gl(S.documentElement),o&2&&gl(S.body),o&4)for(o=S.head,gl(o),S=o.firstChild;S;){var w=S.nextSibling,H=S.nodeName;S[R]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&S.rel.toLowerCase()==="stylesheet"||o.removeChild(S),S=w}}if(f===0){r.removeChild(m),Sl(i);return}f--}else o==="$"||o==="$?"||o==="$!"?f++:u=o.charCodeAt(0)-48;else u=0;o=m}while(o);Sl(i)}function Wd(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Wd(o),O(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function PA(r,i,o,u){for(;r.nodeType===1;){var f=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[R])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(m=r.getAttribute("rel"),m==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(m!==f.rel||r.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||r.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||r.getAttribute("title")!==(f.title==null?null:f.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(m=r.getAttribute("src"),(m!==(f.src==null?null:f.src)||r.getAttribute("type")!==(f.type==null?null:f.type)||r.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&r.getAttribute("name")===m)return r}else return r;if(r=Gr(r.nextSibling),r===null)break}return null}function FA(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Gr(r.nextSibling),r===null))return null;return r}function Qd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function LA(r,i){var o=r.ownerDocument;if(r.data!=="$?"||o.readyState==="complete")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function Gr(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return r}var Jd=null;function zv(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}function Gv(r,i,o){switch(i=hu(o),r){case"html":if(r=i.documentElement,!r)throw Error(a(452));return r;case"head":if(r=i.head,!r)throw Error(a(453));return r;case"body":if(r=i.body,!r)throw Error(a(454));return r;default:throw Error(a(451))}}function gl(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);O(r)}var Mr=new Map,$v=new Set;function fu(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Oa=_e.d;_e.d={f:UA,r:BA,D:HA,C:jA,L:zA,m:GA,X:KA,S:$A,M:VA};function UA(){var r=Oa.f(),i=ru();return r||i}function BA(r){var i=F(r);i!==null&&i.tag===5&&i.type==="form"?u1(i):Oa.r(r)}var Vs=typeof document>"u"?null:document;function Kv(r,i,o){var u=Vs;if(u&&typeof i=="string"&&i){var f=wr(i);f='link[rel="'+r+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),$v.has(f)||($v.add(f),r={rel:r,crossOrigin:o,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),_n(i,"link",r),ee(i),u.head.appendChild(i)))}}function HA(r){Oa.D(r),Kv("dns-prefetch",r,null)}function jA(r,i){Oa.C(r,i),Kv("preconnect",r,i)}function zA(r,i,o){Oa.L(r,i,o);var u=Vs;if(u&&r&&i){var f='link[rel="preload"][as="'+wr(i)+'"]';i==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+wr(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+wr(o.imageSizes)+'"]')):f+='[href="'+wr(r)+'"]';var m=f;switch(i){case"style":m=qs(r);break;case"script":m=Ys(r)}Mr.has(m)||(r=p({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),Mr.set(m,r),u.querySelector(f)!==null||i==="style"&&u.querySelector(ml(m))||i==="script"&&u.querySelector(pl(m))||(i=u.createElement("link"),_n(i,"link",r),ee(i),u.head.appendChild(i)))}}function GA(r,i){Oa.m(r,i);var o=Vs;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+wr(u)+'"][href="'+wr(r)+'"]',m=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Ys(r)}if(!Mr.has(m)&&(r=p({rel:"modulepreload",href:r},i),Mr.set(m,r),o.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(pl(m)))return}u=o.createElement("link"),_n(u,"link",r),ee(u),o.head.appendChild(u)}}}function $A(r,i,o){Oa.S(r,i,o);var u=Vs;if(u&&r){var f=de(u).hoistableStyles,m=qs(r);i=i||"default";var S=f.get(m);if(!S){var w={loading:0,preload:null};if(S=u.querySelector(ml(m)))w.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":i},o),(o=Mr.get(m))&&Zd(r,o);var H=S=u.createElement("link");ee(H),_n(H,"link",r),H._p=new Promise(function(ne,me){H.onload=ne,H.onerror=me}),H.addEventListener("load",function(){w.loading|=1}),H.addEventListener("error",function(){w.loading|=2}),w.loading|=4,du(S,i,u)}S={type:"stylesheet",instance:S,count:1,state:w},f.set(m,S)}}}function KA(r,i){Oa.X(r,i);var o=Vs;if(o&&r){var u=de(o).hoistableScripts,f=Ys(r),m=u.get(f);m||(m=o.querySelector(pl(f)),m||(r=p({src:r,async:!0},i),(i=Mr.get(f))&&e0(r,i),m=o.createElement("script"),ee(m),_n(m,"link",r),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function VA(r,i){Oa.M(r,i);var o=Vs;if(o&&r){var u=de(o).hoistableScripts,f=Ys(r),m=u.get(f);m||(m=o.querySelector(pl(f)),m||(r=p({src:r,async:!0,type:"module"},i),(i=Mr.get(f))&&e0(r,i),m=o.createElement("script"),ee(m),_n(m,"link",r),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function Vv(r,i,o,u){var f=(f=Z.current)?fu(f):null;if(!f)throw Error(a(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=qs(o.href),o=de(f).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=qs(o.href);var m=de(f).hoistableStyles,S=m.get(r);if(S||(f=f.ownerDocument||f,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(r,S),(m=f.querySelector(ml(r)))&&!m._p&&(S.instance=m,S.state.loading=5),Mr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Mr.set(r,o),m||qA(f,r,o,S.state))),i&&u===null)throw Error(a(528,""));return S}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Ys(o),o=de(f).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,r))}}function qs(r){return'href="'+wr(r)+'"'}function ml(r){return'link[rel="stylesheet"]['+r+"]"}function qv(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function qA(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),_n(i,"link",o),ee(i),r.head.appendChild(i))}function Ys(r){return'[src="'+wr(r)+'"]'}function pl(r){return"script[async]"+r}function Yv(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+wr(o.href)+'"]');if(u)return i.instance=u,ee(u),u;var f=p({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),ee(u),_n(u,"style",f),du(u,o.precedence,r),i.instance=u;case"stylesheet":f=qs(o.href);var m=r.querySelector(ml(f));if(m)return i.state.loading|=4,i.instance=m,ee(m),m;u=qv(o),(f=Mr.get(f))&&Zd(u,f),m=(r.ownerDocument||r).createElement("link"),ee(m);var S=m;return S._p=new Promise(function(w,H){S.onload=w,S.onerror=H}),_n(m,"link",u),i.state.loading|=4,du(m,o.precedence,r),i.instance=m;case"script":return m=Ys(o.src),(f=r.querySelector(pl(m)))?(i.instance=f,ee(f),f):(u=o,(f=Mr.get(m))&&(u=p({},o),e0(u,f)),r=r.ownerDocument||r,f=r.createElement("script"),ee(f),_n(f,"link",u),r.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,du(u,o.precedence,r));return i.instance}function du(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,m=f,S=0;S<u.length;S++){var w=u[S];if(w.dataset.precedence===i)m=w;else if(m!==f)break}m?m.parentNode.insertBefore(r,m.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function Zd(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function e0(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var gu=null;function Xv(r,i,o){if(gu===null){var u=new Map,f=gu=new Map;f.set(o,u)}else f=gu,u=f.get(o),u||(u=new Map,f.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),f=0;f<o.length;f++){var m=o[f];if(!(m[R]||m[on]||r==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var S=m.getAttribute(i)||"";S=r+S;var w=u.get(S);w?w.push(m):u.set(S,[m])}}return u}function Wv(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function YA(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Qv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var vl=null;function XA(){}function WA(r,i,o){if(vl===null)throw Error(a(475));var u=vl;if(i.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=qs(o.href),m=r.querySelector(ml(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(u.count++,u=mu.bind(u),r.then(u,u)),i.state.loading|=4,i.instance=m,ee(m);return}m=r.ownerDocument||r,o=qv(o),(f=Mr.get(f))&&Zd(o,f),m=m.createElement("link"),ee(m);var S=m;S._p=new Promise(function(w,H){S.onload=w,S.onerror=H}),_n(m,"link",o),i.instance=m}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,r),(r=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=mu.bind(u),r.addEventListener("load",i),r.addEventListener("error",i))}}function QA(){if(vl===null)throw Error(a(475));var r=vl;return r.stylesheets&&r.count===0&&t0(r,r.stylesheets),0<r.count?function(i){var o=setTimeout(function(){if(r.stylesheets&&t0(r,r.stylesheets),r.unsuspend){var u=r.unsuspend;r.unsuspend=null,u()}},6e4);return r.unsuspend=i,function(){r.unsuspend=null,clearTimeout(o)}}:null}function mu(){if(this.count--,this.count===0){if(this.stylesheets)t0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var pu=null;function t0(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,pu=new Map,i.forEach(JA,r),pu=null,mu.call(r))}function JA(r,i){if(!(i.state.loading&4)){var o=pu.get(r);if(o)var u=o.get(null);else{o=new Map,pu.set(r,o);for(var f=r.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var S=f[m];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(o.set(S.dataset.precedence,S),u=S)}u&&o.set(null,u)}f=i.instance,S=f.getAttribute("data-precedence"),m=o.get(S)||u,m===u&&o.set(null,f),o.set(S,f),this.count++,u=mu.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),m?m.parentNode.insertBefore(f,m.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(f,r.firstChild)),i.state.loading|=4}}var yl={$$typeof:k,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function ZA(r,i,o,u,f,m,S,w){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=bo(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=bo(0),this.hiddenUpdates=bo(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function Jv(r,i,o,u,f,m,S,w,H,ne,me,xe){return r=new ZA(r,i,o,S,w,H,ne,xe),i=1,m===!0&&(i|=24),m=lr(3,null,null,i),r.current=m,m.stateNode=r,i=Ff(),i.refCount++,r.pooledCache=i,i.refCount++,m.memoizedState={element:u,isDehydrated:o,cache:i},Hf(m),r}function Zv(r){return r?(r=As,r):As}function ey(r,i,o,u,f,m){f=Zv(f),u.context===null?u.context=f:u.pendingContext=f,u=Ya(i),u.payload={element:o},m=m===void 0?null:m,m!==null&&(u.callback=m),o=Xa(r,u,i),o!==null&&(dr(o,r,i),Yo(o,r,i))}function ty(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function n0(r,i){ty(r,i),(r=r.alternate)&&ty(r,i)}function ny(r){if(r.tag===13){var i=Es(r,67108864);i!==null&&dr(i,r,67108864),n0(r,67108864)}}var vu=!0;function ew(r,i,o,u){var f=re.T;re.T=null;var m=_e.p;try{_e.p=2,r0(r,i,o,u)}finally{_e.p=m,re.T=f}}function tw(r,i,o,u){var f=re.T;re.T=null;var m=_e.p;try{_e.p=8,r0(r,i,o,u)}finally{_e.p=m,re.T=f}}function r0(r,i,o,u){if(vu){var f=a0(u);if(f===null)$d(r,i,u,yu,o),ay(r,u);else if(rw(f,r,i,o,u))u.stopPropagation();else if(ay(r,u),i&4&&-1<nw.indexOf(r)){for(;f!==null;){var m=F(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var S=ea(m.pendingLanes);if(S!==0){var w=m;for(w.pendingLanes|=2,w.entangledLanes|=2;S;){var H=1<<31-zn(S);w.entanglements[1]|=H,S&=~H}sa(m),(mt&6)===0&&(tu=Fe()+500,hl(0))}}break;case 13:w=Es(m,2),w!==null&&dr(w,m,2),ru(),n0(m,2)}if(m=a0(u),m===null&&$d(r,i,u,yu,o),m===f)break;f=m}f!==null&&u.stopPropagation()}else $d(r,i,u,null,o)}}function a0(r){return r=cf(r),i0(r)}var yu=null;function i0(r){if(yu=null,r=M(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return yu=r,null}function ry(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Nn()){case Bn:return 2;case Cr:return 8;case sr:case Me:return 32;case Ot:return 268435456;default:return 32}default:return 32}}var s0=!1,li=null,ci=null,ui=null,Tl=new Map,xl=new Map,hi=[],nw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ay(r,i){switch(r){case"focusin":case"focusout":li=null;break;case"dragenter":case"dragleave":ci=null;break;case"mouseover":case"mouseout":ui=null;break;case"pointerover":case"pointerout":Tl.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":xl.delete(i.pointerId)}}function _l(r,i,o,u,f,m){return r===null||r.nativeEvent!==m?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:m,targetContainers:[f]},i!==null&&(i=F(i),i!==null&&ny(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),r)}function rw(r,i,o,u,f){switch(i){case"focusin":return li=_l(li,r,i,o,u,f),!0;case"dragenter":return ci=_l(ci,r,i,o,u,f),!0;case"mouseover":return ui=_l(ui,r,i,o,u,f),!0;case"pointerover":var m=f.pointerId;return Tl.set(m,_l(Tl.get(m)||null,r,i,o,u,f)),!0;case"gotpointercapture":return m=f.pointerId,xl.set(m,_l(xl.get(m)||null,r,i,o,u,f)),!0}return!1}function iy(r){var i=M(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,nf(r.priority,function(){if(o.tag===13){var u=fr();u=Io(u);var f=Es(o,u);f!==null&&dr(f,o,u),n0(o,u)}});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Tu(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=a0(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);lf=u,o.target.dispatchEvent(u),lf=null}else return i=F(o),i!==null&&ny(i),r.blockedOn=o,!1;i.shift()}return!0}function sy(r,i,o){Tu(r)&&o.delete(i)}function aw(){s0=!1,li!==null&&Tu(li)&&(li=null),ci!==null&&Tu(ci)&&(ci=null),ui!==null&&Tu(ui)&&(ui=null),Tl.forEach(sy),xl.forEach(sy)}function xu(r,i){r.blockedOn===i&&(r.blockedOn=null,s0||(s0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,aw)))}var _u=null;function oy(r){_u!==r&&(_u=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){_u===r&&(_u=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],f=r[i+2];if(typeof u!="function"){if(i0(u||o)===null)continue;break}var m=F(o);m!==null&&(r.splice(i,3),i-=3,id(m,{pending:!0,data:f,method:o.method,action:u},u,f))}}))}function Sl(r){function i(H){return xu(H,r)}li!==null&&xu(li,r),ci!==null&&xu(ci,r),ui!==null&&xu(ui,r),Tl.forEach(i),xl.forEach(i);for(var o=0;o<hi.length;o++){var u=hi[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<hi.length&&(o=hi[0],o.blockedOn===null);)iy(o),o.blockedOn===null&&hi.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var f=o[u],m=o[u+1],S=f[ln]||null;if(typeof m=="function")S||oy(o);else if(S){var w=null;if(m&&m.hasAttribute("formAction")){if(f=m,S=m[ln]||null)w=S.formAction;else if(i0(f)!==null)continue}else w=S.action;typeof w=="function"?o[u+1]=w:(o.splice(u,3),u-=3),oy(o)}}}function o0(r){this._internalRoot=r}Su.prototype.render=o0.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,u=fr();ey(o,u,r,i,null,null)},Su.prototype.unmount=o0.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;ey(r.current,2,null,r,null,null),ru(),i[Ga]=null}};function Su(r){this._internalRoot=r}Su.prototype.unstable_scheduleHydration=function(r){if(r){var i=mc();r={blockedOn:null,target:r,priority:i};for(var o=0;o<hi.length&&i!==0&&i<hi[o].priority;o++);hi.splice(o,0,r),o===0&&iy(r)}};var ly=e.version;if(ly!=="19.1.1")throw Error(a(527,ly,"19.1.1"));_e.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(a(188)):(r=Object.keys(r).join(","),Error(a(268,r)));return r=d(i),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var iw={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:re,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cu.isDisabled&&Cu.supportsFiber)try{jn=Cu.inject(iw),yn=Cu}catch{}}return El.createRoot=function(r,i){if(!s(r))throw Error(a(299));var o=!1,u="",f=E1,m=A1,S=w1,w=null;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(m=i.onCaughtError),i.onRecoverableError!==void 0&&(S=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(w=i.unstable_transitionCallbacks)),i=Jv(r,1,!1,null,null,o,u,f,m,S,w,null),r[Ga]=i.current,Gd(r),new o0(i)},El.hydrateRoot=function(r,i,o){if(!s(r))throw Error(a(299));var u=!1,f="",m=E1,S=A1,w=w1,H=null,ne=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(H=o.unstable_transitionCallbacks),o.formState!==void 0&&(ne=o.formState)),i=Jv(r,1,!0,i,o??null,u,f,m,S,w,H,ne),i.context=Zv(null),o=i.current,u=fr(),u=Io(u),f=Ya(u),f.callback=null,Xa(o,f,u),o=u,i.current.lanes=o,Oi(i,o),sa(i),r[Ga]=i.current,Gd(r),new Su(i)},El.version="19.1.1",El}var yy;function gw(){if(yy)return u0.exports;yy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),u0.exports=dw(),u0.exports}var mw=gw();const pw="_wrapper_12agz_35",vw="_toolbar_12agz_55",yw="_label_12agz_93",Tw="_input_12agz_109",xw="_select_12agz_111",_w="_button_12agz_141",Sw="_error_12agz_175",gr={wrapper:pw,toolbar:vw,label:yw,input:Tw,select:xw,button:_w,error:Sw},Ty=n=>("0"+n).slice(-2),xy=n=>`${n.getFullYear()}-${Ty(n.getMonth()+1)}-${Ty(n.getDate())}`,Cw=()=>{const n=new Date,e=new Date;return e.setDate(e.getDate()-29),{from:xy(e),to:xy(n)}},Ew=(n,e)=>{const t=new Date(n);return t.setDate(t.getDate()+e),t},_y=n=>n?n.toISOString().slice(0,10):"",Sy=()=>new Date().toISOString().slice(0,10),Aw="_backdrop_lu36a_1",ww="_termsBox_lu36a_19",bw="_modal_lu36a_57",Iw="_header_lu36a_85",Rw="_title_lu36a_93",Nw="_close_lu36a_95",kw="_body_lu36a_99",Ow="_footer_lu36a_103",Mw="_btnPrimary_lu36a_113",Dw="_btnGhost_lu36a_125",oa={backdrop:Aw,termsBox:ww,modal:bw,header:Iw,title:Rw,close:Nw,body:kw,footer:Ow,btnPrimary:Mw,btnGhost:Dw};/*! @azure/msal-common v15.12.0 2025-08-19 */const ye={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},pi={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},Ji={GET:"GET",POST:"POST"},mo=[ye.OPENID_SCOPE,ye.PROFILE_SCOPE,ye.OFFLINE_ACCESS_SCOPE],Cy=[...mo,ye.EMAIL_SCOPE],Kn={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Ey={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Ti={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Eu={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Yn={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",NO_SESSION:"no_session"},Z0={CODE:"code",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"},Rh={QUERY:"query",FRAGMENT:"fragment"},Pw={QUERY:"query"},nx={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},Au={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},Gl={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},An={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},eg="appmetadata",Fw="client_info",Yu="1",Xu={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},mr={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Sn={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},Tt={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},kl={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Ay={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Xs={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},g0={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Wi={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Lw={Pop:"pop"},rx=300;/*! @azure/msal-common v15.12.0 2025-08-19 */const Wu="unexpected_error",Uw="post_request_failed";/*! @azure/msal-common v15.12.0 2025-08-19 */const wy={[Wu]:"Unexpected error in authentication.",[Uw]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class Nt extends Error{constructor(e,t,a){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,Nt.prototype),this.errorCode=e||ye.EMPTY_STRING,this.errorMessage=t||ye.EMPTY_STRING,this.subError=a||ye.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function k0(n,e){return new Nt(n,e?`${wy[n]} ${e}`:wy[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */const tg="client_info_decoding_error",ax="client_info_empty_error",ng="token_parsing_error",ix="null_or_empty_token",Da="endpoints_resolution_error",sx="network_error",ox="openid_config_error",lx="hash_not_deserialized",uo="invalid_state",cx="state_mismatch",O0="state_not_found",ux="nonce_mismatch",rg="auth_time_not_found",hx="max_age_transpired",Bw="multiple_matching_tokens",Hw="multiple_matching_accounts",fx="multiple_matching_appMetadata",dx="request_cannot_be_made",gx="cannot_remove_empty_scope",mx="cannot_append_scopeset",M0="empty_input_scopeset",jw="device_code_polling_cancelled",zw="device_code_expired",Gw="device_code_unknown_error",ag="no_account_in_silent_request",px="invalid_cache_record",ig="invalid_cache_environment",D0="no_account_found",P0="no_crypto_object",$w="unexpected_credential_type",Kw="invalid_assertion",Vw="invalid_client_credential",xi="token_refresh_required",qw="user_timeout_reached",vx="token_claims_cnf_required_for_signedjwt",yx="authorization_code_missing_from_server_response",Tx="binding_key_not_removed",xx="end_session_endpoint_not_supported",sg="key_id_missing",Yw="no_network_connectivity",Xw="user_canceled",Ww="missing_tenant_id_error",tt="method_not_implemented",Qw="nested_app_auth_bridge_disabled";/*! @azure/msal-common v15.12.0 2025-08-19 */const by={[tg]:"The client info could not be parsed/decoded correctly",[ax]:"The client info was empty",[ng]:"Token cannot be parsed",[ix]:"The token is null or empty",[Da]:"Endpoints cannot be resolved",[sx]:"Network request failed",[ox]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[lx]:"The hash parameters could not be deserialized",[uo]:"State was not the expected format",[cx]:"State mismatch error",[O0]:"State not found",[ux]:"Nonce mismatch error",[rg]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[hx]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Bw]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Hw]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[fx]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[dx]:"Token request cannot be made without authorization code or refresh token.",[gx]:"Cannot remove null or empty scope from ScopeSet",[mx]:"Cannot append ScopeSet",[M0]:"Empty input ScopeSet cannot be processed",[jw]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[zw]:"Device code is expired.",[Gw]:"Device code stopped polling for unknown reasons.",[ag]:"Please pass an account object, silent flow is not supported without account information",[px]:"Cache record object was null or undefined.",[ig]:"Invalid environment when attempting to create cache entry",[D0]:"No account found in cache for given key.",[P0]:"No crypto object detected.",[$w]:"Unexpected credential type.",[Kw]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Vw]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[xi]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[qw]:"User defined timeout for device code polling reached",[vx]:"Cannot generate a POP jwt if the token_claims are not populated",[yx]:"Server response does not contain an authorization code to proceed",[Tx]:"Could not remove the credential's binding key from storage.",[xx]:"The provided authority does not support logout",[sg]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Yw]:"No network connectivity. Check your internet connection.",[Xw]:"User cancelled the flow.",[Ww]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[tt]:"This method has not been implemented",[Qw]:"The nested app auth bridge is disabled"};class og extends Nt{constructor(e,t){super(e,t?`${by[e]}: ${t}`:by[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,og.prototype)}}function we(n,e){return new og(n,e)}/*! @azure/msal-common v15.12.0 2025-08-19 */const Qu={createNewGuid:()=>{throw we(tt)},base64Decode:()=>{throw we(tt)},base64Encode:()=>{throw we(tt)},base64UrlEncode:()=>{throw we(tt)},encodeKid:()=>{throw we(tt)},async getPublicKeyThumbprint(){throw we(tt)},async removeTokenBindingKey(){throw we(tt)},async clearKeystore(){throw we(tt)},async signJwt(){throw we(tt)},async hashString(){throw we(tt)}};/*! @azure/msal-common v15.12.0 2025-08-19 */var Bt;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(Bt||(Bt={}));class Ci{constructor(e,t,a){this.level=Bt.Info;const s=()=>{},l=e||Ci.createDefaultLoggerOptions();this.localCallback=l.loggerCallback||s,this.piiLoggingEnabled=l.piiLoggingEnabled||!1,this.level=typeof l.logLevel=="number"?l.logLevel:Bt.Info,this.correlationId=l.correlationId||ye.EMPTY_STRING,this.packageName=t||ye.EMPTY_STRING,this.packageVersion=a||ye.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Bt.Info}}clone(e,t,a){return new Ci({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:a||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const l=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Bt[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,l,t.containsPii||!1)}executeCallback(e,t,a){this.localCallback&&this.localCallback(e,t,a)}error(e,t){this.logMessage(e,{logLevel:Bt.Error,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Bt.Error,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Bt.Warning,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Bt.Warning,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Bt.Info,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Bt.Info,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Bt.Verbose,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Bt.Verbose,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Bt.Trace,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Bt.Trace,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v15.12.0 2025-08-19 */const _x="@azure/msal-common",lg="15.12.0";/*! @azure/msal-common v15.12.0 2025-08-19 */const cg={None:"none"};/*! @azure/msal-common v15.12.0 2025-08-19 */const Sx="redirect_uri_empty",Jw="claims_request_parsing_error",Cx="authority_uri_insecure",bl="url_parse_error",Ex="empty_url_error",Ax="empty_input_scopes_error",ug="invalid_claims",wx="token_request_empty",bx="logout_request_empty",Zw="invalid_code_challenge_method",hg="pkce_params_missing",fg="invalid_cloud_discovery_metadata",Ix="invalid_authority_metadata",Rx="untrusted_authority",Nh="missing_ssh_jwk",Nx="missing_ssh_kid",e2="missing_nonce_authentication_header",t2="invalid_authentication_header",kx="cannot_set_OIDCOptions",Ox="cannot_allow_platform_broker",Mx="authority_mismatch",Dx="invalid_request_method_for_EAR",Px="invalid_authorize_post_body_parameters";/*! @azure/msal-common v15.12.0 2025-08-19 */const n2={[Sx]:"A redirect URI is required for all calls, and none has been set.",[Jw]:"Could not parse the given claims request object.",[Cx]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[bl]:"URL could not be parsed into appropriate segments.",[Ex]:"URL was empty or null.",[Ax]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[ug]:"Given claims parameter must be a stringified JSON object.",[wx]:"Token request was empty and not found in cache.",[bx]:"The logout request was null or undefined.",[Zw]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[hg]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[fg]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[Ix]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Rx]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Nh]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Nx]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[e2]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[t2]:"Invalid authentication header provided",[kx]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ox]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[Mx]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[Px]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[Dx]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class dg extends Nt{constructor(e){super(e,n2[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,dg.prototype)}}function Dt(n){return new dg(n)}/*! @azure/msal-common v15.12.0 2025-08-19 */class xr{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},a=e.split("&"),s=l=>decodeURIComponent(l.replace(/\+/g," "));return a.forEach(l=>{if(l.trim()){const[c,h]=l.split(/=(.+)/g,2);c&&h&&(t[s(c)]=s(h))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class an{constructor(e){const t=e?xr.trimArrayEntries([...e]):[],a=t?xr.removeEmptyStringsFromArray(t):[];if(!a||!a.length)throw Dt(Ax);this.scopes=new Set,a.forEach(s=>this.scopes.add(s))}static fromString(e){const a=(e||ye.EMPTY_STRING).split(" ");return new an(a)}static createSearchScopes(e){const t=e&&e.length>0?e:[...mo],a=new an(t);return a.containsOnlyOIDCScopes()?a.removeScope(ye.OFFLINE_ACCESS_SCOPE):a.removeOIDCScopes(),a}containsScope(e){const t=this.printScopesLowerCase().split(" "),a=new an(t);return e?a.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return Cy.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw we(mx)}}removeScope(e){if(!e)throw we(gx);this.scopes.delete(e.trim())}removeOIDCScopes(){Cy.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw we(M0);const t=new Set;return e.scopes.forEach(a=>t.add(a.toLowerCase())),this.scopes.forEach(a=>t.add(a.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw we(M0);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),a=e.getScopeCount(),s=this.getScopeCount();return t.size<s+a}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):ye.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v15.12.0 2025-08-19 */function Iy(n,e){return!!n&&!!e&&n===e.split(".")[1]}function gg(n,e,t,a){if(a){const{oid:s,sub:l,tid:c,name:h,tfp:d,acr:g,preferred_username:p,upn:v,login_hint:T}=a,x=c||d||g||"";return{tenantId:x,localAccountId:s||l||"",name:h,username:p||v||"",loginHint:T,isHomeTenant:Iy(x,n)}}else return{tenantId:t,localAccountId:e,username:"",isHomeTenant:Iy(t,n)}}function mg(n,e,t,a){let s=n;if(e){const{isHomeTenant:l,...c}=e;s={...n,...c}}if(t){const{isHomeTenant:l,...c}=gg(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...c,idTokenClaims:t,idToken:a},s}return s}/*! @azure/msal-common v15.12.0 2025-08-19 */function po(n,e){const t=r2(n);try{const a=e(t);return JSON.parse(a)}catch{throw we(ng)}}function r2(n){if(!n)throw we(ix);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw we(ng);return t[2]}function Fx(n,e){if(e===0||Date.now()-3e5>n+e)throw we(hx)}/*! @azure/msal-common v15.12.0 2025-08-19 */function Ry(n){if(!n)return n;let e=n.toLowerCase();return xr.endsWith(e,"?")?e=e.slice(0,-1):xr.endsWith(e,"?/")&&(e=e.slice(0,-2)),xr.endsWith(e,"/")||(e+="/"),e}function Lx(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function Ju(n){if(!n||n.indexOf("=")<0)return null;try{const e=Lx(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch{throw we(lx)}return null}function $l(n,e=!0,t){const a=new Array;return n.forEach((s,l)=>{!e&&t&&l in t?a.push(`${l}=${s}`):a.push(`${l}=${encodeURIComponent(s)}`)}),a.join("&")}function Ny(n){if(!n)return n;const e=n.split("#")[0];try{const t=new URL(e),a=t.origin+t.pathname+t.search;return Ry(a)}catch{return Ry(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class ft{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Dt(Ex);e.includes("#")||(this._urlString=ft.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return xr.endsWith(t,"?")?t=t.slice(0,-1):xr.endsWith(t,"?/")&&(t=t.slice(0,-2)),xr.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Dt(bl)}if(!e.HostNameAndPort||!e.PathSegments)throw Dt(bl);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Dt(Cx)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return ft.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),a=t.PathSegments;return e&&a.length!==0&&(a[0]===Ti.COMMON||a[0]===Ti.ORGANIZATIONS)&&(a[0]=e),ft.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Dt(bl);const a={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=a.AbsolutePath.split("/");return s=s.filter(l=>l&&l.length>0),a.PathSegments=s,a.QueryString&&a.QueryString.endsWith("/")&&(a.QueryString=a.QueryString.substring(0,a.QueryString.length-1)),a}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),a=e.match(t);if(!a)throw Dt(bl);return a[2]}static getAbsoluteUrl(e,t){if(e[0]===ye.FORWARD_SLASH){const s=new ft(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new ft(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Ju(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Ux={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},ky=Ux.endpointMetadata,pg=Ux.instanceDiscoveryMetadata,Bx=new Set;pg.metadata.forEach(n=>{n.aliases.forEach(e=>{Bx.add(e)})});function a2(n,e){let t;const a=n.canonicalAuthority;if(a){const s=new ft(a).getUrlComponents().HostNameAndPort;t=Oy(s,n.cloudDiscoveryMetadata?.metadata,mr.CONFIG,e)||Oy(s,pg.metadata,mr.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function Oy(n,e,t,a){if(a?.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=Zu(e,n);if(s)return a?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;a?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function i2(n){return Zu(pg.metadata,n)}function Zu(n,e){for(let t=0;t<n.length;t++){const a=n[t];if(a.aliases.includes(e))return a}return null}/*! @azure/msal-common v15.12.0 2025-08-19 */const eh="cache_quota_exceeded",vg="cache_error_unknown";/*! @azure/msal-common v15.12.0 2025-08-19 */const m0={[eh]:"Exceeded cache storage capacity.",[vg]:"Unexpected error occurred when using cache storage."};class ro extends Nt{constructor(e,t){const a=t||(m0[e]?m0[e]:m0[vg]);super(`${e}: ${a}`),Object.setPrototypeOf(this,ro.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=a}}function F0(n){return n instanceof Error?n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED"||n.message.includes("exceeded the quota")?new ro(eh):new ro(n.name,n.message):new ro(vg)}/*! @azure/msal-common v15.12.0 2025-08-19 */class L0{constructor(e,t,a,s,l){this.clientId=e,this.cryptoImpl=t,this.commonLogger=a.clone(_x,lg),this.staticAuthorityOptions=l,this.performanceClient=s}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(Object.keys(e).length===0||Object.values(e).every(s=>!s))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const a=this.getAllAccounts(e,t);return a.length>1?a.sort(l=>l.idTokenClaims?-1:1)[0]:a.length===1?a[0]:null}getBaseAccountInfo(e,t){const a=this.getAccountsFilteredBy(e,t);return a.length>0?a[0].getAccountInfo():null}buildTenantProfiles(e,t,a){return e.flatMap(s=>this.getTenantProfilesFromAccountEntity(s,t,a?.tenantId,a))}getTenantedAccountInfoByFilter(e,t,a,s,l){let c=null,h;if(l&&!this.tenantProfileMatchesFilter(a,l))return null;const d=this.getIdToken(e,s,t,a.tenantId);return d&&(h=po(d.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(h,l))?null:(c=mg(e,a,h,d?.secret),c)}getTenantProfilesFromAccountEntity(e,t,a,s){const l=e.getAccountInfo();let c=l.tenantProfiles||new Map;const h=this.getTokenKeys();if(a){const g=c.get(a);if(g)c=new Map([[a,g]]);else return[]}const d=[];return c.forEach(g=>{const p=this.getTenantedAccountInfoByFilter(l,h,g,t,s);p&&d.push(p)}),d}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,a){if(!e)throw we(px);try{e.account&&await this.setAccount(e.account,t),e.idToken&&a?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&a?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&a?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(s){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),s instanceof Nt?s:F0(s)}}async saveAccessToken(e,t){const a={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),l=an.fromString(e.target);s.accessToken.forEach(c=>{if(!this.accessTokenKeyMatchesFilter(c,a,!1))return;const h=this.getAccessTokenCredential(c,t);h&&this.credentialMatchesFilter(h,a)&&an.fromString(h.target).intersectingScopeSets(l)&&this.removeAccessToken(c,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const a=this.getAccountKeys(),s=[];return a.forEach(l=>{const c=this.getAccount(l,t);if(!c||e.homeAccountId&&!this.matchHomeAccountId(c,e.homeAccountId)||e.username&&!this.matchUsername(c.username,e.username)||e.environment&&!this.matchEnvironment(c,e.environment)||e.realm&&!this.matchRealm(c,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(c,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(c,e.authorityType))return;const h={localAccountId:e?.localAccountId,name:e?.name},d=c.tenantProfiles?.filter(g=>this.tenantProfileMatchesFilter(g,h));d&&d.length===0||s.push(c)}),s}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===Tt.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),a={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const l=this.getAppMetadata(s);l&&(e.environment&&!this.matchEnvironment(l,e.environment)||e.clientId&&!this.matchClientId(l,e.clientId)||(a[s]=l))}),a}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let a=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const l=this.getAuthorityMetadata(s);l&&l.aliases.indexOf(e)!==-1&&(a=l)}),a}removeAllAccounts(e){this.getAllAccounts({},e).forEach(a=>{this.removeAccount(a,e)})}removeAccount(e,t){this.removeAccountContext(e,t);const a=this.getAccountKeys(),s=l=>l.includes(e.homeAccountId)&&l.includes(e.environment);a.filter(s).forEach(l=>{this.removeItem(l,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const a=this.getTokenKeys(),s=l=>l.includes(e.homeAccountId)&&l.includes(e.environment);a.idToken.filter(s).forEach(l=>{this.removeIdToken(l,t)}),a.accessToken.filter(s).forEach(l=>{this.removeAccessToken(l,t)}),a.refreshToken.filter(s).forEach(l=>{this.removeRefreshToken(l,t)})}removeAccessToken(e,t){const a=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!a||a.credentialType.toLowerCase()!==An.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||a.tokenType!==Tt.POP)return;const s=a.keyId;s&&this.cryptoImpl.removeTokenBindingKey(s).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${s}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(a=>{this.isAppMetadata(a)&&this.removeItem(a,e)}),!0}getIdToken(e,t,a,s,l){this.commonLogger.trace("CacheManager - getIdToken called");const c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.ID_TOKEN,clientId:this.clientId,realm:s},h=this.getIdTokensByFilter(c,t,a),d=h.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(d>1){let g=h;if(!s){const p=new Map;h.forEach((T,x)=>{T.realm===e.tenantId&&p.set(x,T)});const v=p.size;if(v<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),h.values().next().value;if(v===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),p.values().next().value;g=p}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),g.forEach((p,v)=>{this.removeIdToken(v,t)}),l&&t&&l.addFields({multiMatchedID:h.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),h.values().next().value}getIdTokensByFilter(e,t,a){const s=a&&a.idToken||this.getTokenKeys().idToken,l=new Map;return s.forEach(c=>{if(!this.idTokenKeyMatchesFilter(c,{clientId:this.clientId,...e}))return;const h=this.getIdTokenCredential(c,t);h&&this.credentialMatchesFilter(h,e)&&l.set(c,h)}),l}idTokenKeyMatchesFilter(e,t){const a=e.toLowerCase();return!(t.clientId&&a.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&a.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,a,s){const l=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",l);const c=an.createSearchScopes(t.scopes),h=t.authenticationScheme||Tt.BEARER,d=h.toLowerCase()!==Tt.BEARER.toLowerCase()?An.ACCESS_TOKEN_WITH_AUTH_SCHEME:An.ACCESS_TOKEN,g={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:d,clientId:this.clientId,realm:s||e.tenantId,target:c,tokenType:h,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},p=a&&a.accessToken||this.getTokenKeys().accessToken,v=[];p.forEach(x=>{if(this.accessTokenKeyMatchesFilter(x,g,!0)){const C=this.getAccessTokenCredential(x,l);C&&this.credentialMatchesFilter(C,g)&&v.push(C)}});const T=v.length;return T<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",l),null):T>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",l),v.forEach(x=>{this.removeAccessToken(this.generateCredentialKey(x),l)}),this.performanceClient.addFields({multiMatchedAT:v.length},l),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",l),v[0])}accessTokenKeyMatchesFilter(e,t,a){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const l=t.target.asArray();for(let c=0;c<l.length;c++){if(a&&!s.includes(l[c].toLowerCase()))return!1;if(!a&&s.includes(l[c].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const a=this.getTokenKeys(),s=[];return a.accessToken.forEach(l=>{if(!this.accessTokenKeyMatchesFilter(l,e,!0))return;const c=this.getAccessTokenCredential(l,t);c&&this.credentialMatchesFilter(c,e)&&s.push(c)}),s}getRefreshToken(e,t,a,s,l){this.commonLogger.trace("CacheManager - getRefreshToken called");const c=t?Yu:void 0,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:An.REFRESH_TOKEN,clientId:this.clientId,familyId:c},d=s&&s.refreshToken||this.getTokenKeys().refreshToken,g=[];d.forEach(v=>{if(this.refreshTokenKeyMatchesFilter(v,h)){const T=this.getRefreshTokenCredential(v,a);T&&this.credentialMatchesFilter(T,h)&&g.push(T)}});const p=g.length;return p<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(p>1&&l&&a&&l.addFields({multiMatchedRT:p},a),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),g[0])}refreshTokenKeyMatchesFilter(e,t){const a=e.toLowerCase();return!(t.familyId&&a.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&a.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&a.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},a=this.getAppMetadataFilteredBy(t),s=Object.keys(a).map(c=>a[c]),l=s.length;if(l<1)return null;if(l>1)throw we(fx);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Yu)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const a=e.oid||e.sub;return t===a}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=a2(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const a=this.getAuthorityMetadataByAlias(t);return!!(a&&a.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==An.ACCESS_TOKEN&&e.credentialType!==An.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:an.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(eg)!==-1}isAuthorityMetadata(e){return e.indexOf(Xu.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Xu.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const a in t)e[a]=t[a];return e}}class s2 extends L0{async setAccount(){throw we(tt)}getAccount(){throw we(tt)}async setIdTokenCredential(){throw we(tt)}getIdTokenCredential(){throw we(tt)}async setAccessTokenCredential(){throw we(tt)}getAccessTokenCredential(){throw we(tt)}async setRefreshTokenCredential(){throw we(tt)}getRefreshTokenCredential(){throw we(tt)}setAppMetadata(){throw we(tt)}getAppMetadata(){throw we(tt)}setServerTelemetry(){throw we(tt)}getServerTelemetry(){throw we(tt)}setAuthorityMetadata(){throw we(tt)}getAuthorityMetadata(){throw we(tt)}getAuthorityMetadataKeys(){throw we(tt)}setThrottlingCache(){throw we(tt)}getThrottlingCache(){throw we(tt)}removeItem(){throw we(tt)}getKeys(){throw we(tt)}getAccountKeys(){throw we(tt)}getTokenKeys(){throw we(tt)}generateCredentialKey(){throw we(tt)}generateAccountKey(){throw we(tt)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const tr={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};/*! @azure/msal-common v15.12.0 2025-08-19 */const Y={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},o2={InProgress:1};/*! @azure/msal-common v15.12.0 2025-08-19 */class My{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class Hx{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:o2.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new My}}startPerformanceMeasurement(){return new My}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-common v15.12.0 2025-08-19 */const jx={tokenRenewalOffsetSeconds:rx,preventCorsPreflight:!1},l2={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Bt.Info,correlationId:ye.EMPTY_STRING},c2={claimsBasedCachingEnabled:!1},u2={async sendGetRequestAsync(){throw we(tt)},async sendPostRequestAsync(){throw we(tt)}},h2={sku:ye.SKU,version:lg,cpu:ye.EMPTY_STRING,os:ye.EMPTY_STRING},f2={clientSecret:ye.EMPTY_STRING,clientAssertion:void 0},d2={azureCloudInstance:cg.None,tenant:`${ye.DEFAULT_COMMON_TENANT}`},g2={application:{appName:"",appVersion:""}};function m2({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:a,storageInterface:s,networkInterface:l,cryptoInterface:c,clientCredentials:h,libraryInfo:d,telemetry:g,serverTelemetryManager:p,persistencePlugin:v,serializableCache:T}){const x={...l2,...t};return{authOptions:p2(n),systemOptions:{...jx,...e},loggerOptions:x,cacheOptions:{...c2,...a},storageInterface:s||new s2(n.clientId,Qu,new Ci(x),new Hx),networkInterface:l||u2,cryptoInterface:c||Qu,clientCredentials:h||f2,libraryInfo:{...h2,...d},telemetry:{...g2,...g},serverTelemetryManager:p||null,persistencePlugin:v||null,serializableCache:T||null}}function p2(n){return{clientCapabilities:[],azureCloudOptions:d2,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...n}}function zx(n){return n.authOptions.authority.options.protocolMode===tr.OIDC}/*! @azure/msal-common v15.12.0 2025-08-19 */const Yr={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v15.12.0 2025-08-19 */function th(n,e){if(!n)throw we(ax);try{const t=e(n);return JSON.parse(t)}catch{throw we(tg)}}function ao(n){if(!n)throw we(tg);const e=n.split(Gl.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?ye.EMPTY_STRING:e[1]}}/*! @azure/msal-common v15.12.0 2025-08-19 */const ts="client_id",Gx="redirect_uri",v2="response_type",y2="response_mode",T2="grant_type",x2="claims",_2="scope",S2="refresh_token",C2="state",E2="nonce",A2="prompt",w2="code",b2="code_challenge",I2="code_challenge_method",R2="code_verifier",N2="client-request-id",k2="x-client-SKU",O2="x-client-VER",M2="x-client-OS",D2="x-client-CPU",P2="x-client-current-telemetry",F2="x-client-last-telemetry",L2="x-ms-lib-capability",U2="x-app-name",B2="x-app-ver",H2="post_logout_redirect_uri",j2="id_token_hint",z2="client_secret",G2="client_assertion",$2="client_assertion_type",$x="token_type",Kx="req_cnf",Dy="return_spa_code",K2="nativebroker",V2="logout_hint",q2="sid",Y2="login_hint",X2="domain_hint",W2="x-client-xtra-sku",nh="brk_client_id",rh="brk_redirect_uri",U0="instance_aware",Q2="ear_jwk",J2="ear_jwe_crypto";/*! @azure/msal-common v15.12.0 2025-08-19 */function kh(n,e,t){if(!e)return;const a=n.get(ts);a&&n.has(nh)&&t?.addFields({embeddedClientId:a,embeddedRedirectUri:n.get(Gx)},e)}function yg(n,e){n.set(v2,e)}function Z2(n,e){n.set(y2,e||Pw.QUERY)}function eb(n){n.set(K2,"1")}function Tg(n,e,t=!0,a=mo){t&&!a.includes("openid")&&!e.includes("openid")&&a.push("openid");const s=t?[...e||[],...a]:e||[],l=new an(s);n.set(_2,l.printScopes())}function xg(n,e){n.set(ts,e)}function _g(n,e){n.set(Gx,e)}function tb(n,e){n.set(H2,e)}function nb(n,e){n.set(j2,e)}function rb(n,e){n.set(X2,e)}function wu(n,e){n.set(Y2,e)}function ah(n,e){n.set(Kn.CCS_HEADER,`UPN:${e}`)}function Ol(n,e){n.set(Kn.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function Py(n,e){n.set(q2,e)}function Sg(n,e,t){const a=cb(e,t);try{JSON.parse(a)}catch{throw Dt(ug)}n.set(x2,a)}function Cg(n,e){n.set(N2,e)}function Eg(n,e){n.set(k2,e.sku),n.set(O2,e.version),e.os&&n.set(M2,e.os),e.cpu&&n.set(D2,e.cpu)}function Ag(n,e){e?.appName&&n.set(U2,e.appName),e?.appVersion&&n.set(B2,e.appVersion)}function ab(n,e){n.set(A2,e)}function Vx(n,e){e&&n.set(C2,e)}function ib(n,e){n.set(E2,e)}function qx(n,e,t){if(e&&t)n.set(b2,e),n.set(I2,t);else throw Dt(hg)}function sb(n,e){n.set(w2,e)}function ob(n,e){n.set(S2,e)}function lb(n,e){n.set(R2,e)}function Yx(n,e){n.set(z2,e)}function Xx(n,e){e&&n.set(G2,e)}function Wx(n,e){e&&n.set($2,e)}function Qx(n,e){n.set(T2,e)}function wg(n){n.set(Fw,"1")}function Jx(n){n.has(U0)||n.set(U0,"true")}function _i(n,e){Object.entries(e).forEach(([t,a])=>{!n.has(t)&&a&&n.set(t,a)})}function cb(n,e){let t;if(!n)t={};else try{t=JSON.parse(n)}catch{throw Dt(ug)}return e&&e.length>0&&(t.hasOwnProperty(Eu.ACCESS_TOKEN)||(t[Eu.ACCESS_TOKEN]={}),t[Eu.ACCESS_TOKEN][Eu.XMS_CC]={values:e}),JSON.stringify(t)}function bg(n,e){e&&(n.set($x,Tt.POP),n.set(Kx,e))}function Zx(n,e){e&&(n.set($x,Tt.SSH),n.set(Kx,e))}function e_(n,e){n.set(P2,e.generateCurrentRequestHeaderValue()),n.set(F2,e.generateLastRequestHeaderValue())}function t_(n){n.set(L2,kl.X_MS_LIB_CAPABILITY_VALUE)}function ub(n,e){n.set(V2,e)}function Oh(n,e,t){n.has(nh)||n.set(nh,e),n.has(rh)||n.set(rh,t)}function hb(n,e){n.set(Q2,encodeURIComponent(e)),n.set(J2,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}function fb(n,e){Object.entries(e).forEach(([t,a])=>{a&&n.set(t,a)})}/*! @azure/msal-common v15.12.0 2025-08-19 */const Vr={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v15.12.0 2025-08-19 */function db(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v15.12.0 2025-08-19 */function gb(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v15.12.0 2025-08-19 */function mb(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v15.12.0 2025-08-19 */const _r=(n,e,t,a,s)=>(...l)=>{t.trace(`Executing function ${e}`);const c=a?.startMeasurement(e,s);if(s){const h=e+"CallCount";a?.incrementFields({[h]:1},s)}try{const h=n(...l);return c?.end({success:!0}),t.trace(`Returning result from ${e}`),h}catch(h){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(h))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},h),h}},ve=(n,e,t,a,s)=>(...l)=>{t.trace(`Executing function ${e}`);const c=a?.startMeasurement(e,s);if(s){const h=e+"CallCount";a?.incrementFields({[h]:1},s)}return a?.setPreQueueTime(e,s),n(...l).then(h=>(t.trace(`Returning result from ${e}`),c?.end({success:!0}),h)).catch(h=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(h))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},h),h})};/*! @azure/msal-common v15.12.0 2025-08-19 */class Mh{constructor(e,t,a,s){this.networkInterface=e,this.logger=t,this.performanceClient=a,this.correlationId=s}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(Y.RegionDiscoveryDetectRegion,this.correlationId);let a=e;if(a)t.region_source=Xs.ENVIRONMENT_VARIABLE;else{const s=Mh.IMDS_OPTIONS;try{const l=await ve(this.getRegionFromIMDS.bind(this),Y.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(ye.IMDS_VERSION,s);if(l.status===pi.SUCCESS&&(a=l.body,t.region_source=Xs.IMDS),l.status===pi.BAD_REQUEST){const c=await ve(this.getCurrentVersion.bind(this),Y.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(s);if(!c)return t.region_source=Xs.FAILED_AUTO_DETECTION,null;const h=await ve(this.getRegionFromIMDS.bind(this),Y.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(c,s);h.status===pi.SUCCESS&&(a=h.body,t.region_source=Xs.IMDS)}}catch{return t.region_source=Xs.FAILED_AUTO_DETECTION,null}}return a||(t.region_source=Xs.FAILED_AUTO_DETECTION),a||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(Y.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${ye.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,ye.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(Y.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${ye.IMDS_ENDPOINT}?format=json`,e);return t.status===pi.BAD_REQUEST&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch{return null}}}Mh.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v15.12.0 2025-08-19 */function rr(){return Math.round(new Date().getTime()/1e3)}function Fy(n){return n.getTime()/1e3}function io(n){return n?new Date(Number(n)*1e3):new Date}function ih(n,e){const t=Number(n)||0;return rr()+e>t}function pb(n,e){const t=Number(n)+e*24*60*60*1e3;return Date.now()>t}function vb(n){return Number(n)>rr()}/*! @azure/msal-common v15.12.0 2025-08-19 */function Dh(n,e,t,a,s){return{credentialType:An.ID_TOKEN,homeAccountId:n,environment:e,clientId:a,secret:t,realm:s,lastUpdatedAt:Date.now().toString()}}function Ph(n,e,t,a,s,l,c,h,d,g,p,v,T,x,C){const _={homeAccountId:n,credentialType:An.ACCESS_TOKEN,secret:t,cachedAt:rr().toString(),expiresOn:c.toString(),extendedExpiresOn:h.toString(),environment:e,clientId:a,realm:s,target:l,tokenType:p||Tt.BEARER,lastUpdatedAt:Date.now().toString()};if(v&&(_.userAssertionHash=v),g&&(_.refreshOn=g.toString()),x&&(_.requestedClaims=x,_.requestedClaimsHash=C),_.tokenType?.toLowerCase()!==Tt.BEARER.toLowerCase())switch(_.credentialType=An.ACCESS_TOKEN_WITH_AUTH_SCHEME,_.tokenType){case Tt.POP:const A=po(t,d);if(!A?.cnf?.kid)throw we(vx);_.keyId=A.cnf.kid;break;case Tt.SSH:_.keyId=T}return _}function n_(n,e,t,a,s,l,c){const h={credentialType:An.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:a,secret:t,lastUpdatedAt:Date.now().toString()};return l&&(h.userAssertionHash=l),s&&(h.familyId=s),c&&(h.expiresOn=c.toString()),h}function Ig(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function Ly(n){return n?Ig(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===An.ACCESS_TOKEN||n.credentialType===An.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function yb(n){return n?Ig(n)&&n.hasOwnProperty("realm")&&n.credentialType===An.ID_TOKEN:!1}function Uy(n){return n?Ig(n)&&n.credentialType===An.REFRESH_TOKEN:!1}function Tb(n,e){const t=n.indexOf(Sn.CACHE_KEY)===0;let a=!0;return e&&(a=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&a}function xb(n,e){let t=!1;n&&(t=n.indexOf(kl.THROTTLING_PREFIX)===0);let a=!0;return e&&(a=e.hasOwnProperty("throttleTime")),t&&a}function _b({environment:n,clientId:e}){return[eg,n,e].join(Gl.CACHE_KEY_SEPARATOR).toLowerCase()}function Sb(n,e){return e?n.indexOf(eg)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function Cb(n,e){return e?n.indexOf(Xu.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function By(){return rr()+Xu.REFRESH_TIME_SECONDS}function bu(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function p0(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function Hy(n){return n.expiresAt<=rr()}/*! @azure/msal-common v15.12.0 2025-08-19 */class Pn{constructor(e,t,a,s,l,c,h,d){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=a,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=l,this.performanceClient=h,this.correlationId=c,this.managedIdentity=d||!1,this.regionDiscovery=new Mh(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(ye.CIAM_AUTH_URL))return Vr.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case ye.ADFS:return Vr.Adfs;case ye.DSTS:return Vr.Dsts}return Vr.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new ft(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw we(Da)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw we(Da)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw we(Da)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw we(xx);return this.replacePath(this.metadata.end_session_endpoint)}else throw we(Da)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw we(Da)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw we(Da)}canReplaceTenant(e){return e.PathSegments.length===1&&!Pn.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Vr.Default&&this.protocolMode!==tr.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new ft(this.metadata.canonical_authority).getUrlComponents(),l=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((h,d)=>{let g=l[d];if(d===0&&this.canReplaceTenant(s)){const p=new ft(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];g!==p&&(this.logger.verbose(`Replacing tenant domain name ${g} with id ${p}`),g=p)}h!==g&&(t=t.replace(`/${g}/`,`/${h}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Vr.Adfs||this.protocolMode===tr.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(Y.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await ve(this.updateCloudDiscoveryMetadata.bind(this),Y.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const a=await ve(this.updateEndpointMetadata.bind(this),Y.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:a}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:By(),jwks_uri:""}),e}updateCachedMetadata(e,t,a){t!==mr.CACHE&&a?.source!==mr.CACHE&&(e.expiresAt=By(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(Y.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===mr.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){const s=await ve(this.updateMetadataWithRegionalInformation.bind(this),Y.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);bu(e,s,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let a=await ve(this.getEndpointMetadataFromNetwork.bind(this),Y.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(a=await ve(this.updateMetadataWithRegionalInformation.bind(this),Y.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a)),bu(e,a,!0),mr.NETWORK;throw we(ox,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),bu(e,t,!1),{source:mr.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return bu(e,s,!1),{source:mr.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const a=Hy(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!a?(this.logger.verbose("Found endpoint metadata in the cache."),{source:mr.CACHE}):(a&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new ft(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Dt(Ix)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Y.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const a=await this.networkInterface.sendGetRequestAsync(t,e);return db(a.body)?a.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(a){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${a}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in ky?ky[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(Y.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==ye.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=g0.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,Pn.replaceWithRegionalInformation(e,t);const a=await ve(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),Y.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=g0.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,Pn.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=g0.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(Y.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const a=await ve(this.getCloudDiscoveryMetadataFromNetwork.bind(this),Y.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return p0(e,a,!0),mr.NETWORK;throw Dt(Rx)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||ye.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||ye.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||ye.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),p0(e,t,!1),mr.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=i2(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),p0(e,s,!1),mr.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const a=Hy(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!a?(this.logger.verbose("Found cloud discovery metadata in the cache."),mr.CACHE):(a&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Vr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Pn.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=Zu(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Dt(fg)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Pn.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(Y.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${ye.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let a=null;try{const s=await this.networkInterface.sendGetRequestAsync(e,t);let l,c;if(gb(s.body))l=s.body,c=l.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${l.tenant_discovery_endpoint}`);else if(mb(s.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${s.status}`),l=s.body,l.error===ye.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${l.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${l.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),c=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),a=Zu(c,this.hostnameAndPort)}catch(s){if(s instanceof Nt)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${s.errorCode}
Error Description: ${s.errorMessage}`);else{const l=s;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${l.name}
Error Description: ${l.message}`)}return null}return a||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),a=Pn.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),a}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&ft.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let a;if(t&&t.azureCloudInstance!==cg.None){const s=t.tenant?t.tenant:ye.DEFAULT_COMMON_TENANT;a=`${t.azureCloudInstance}/${s}/`}return a||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return ye.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw we(Da)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Bx.has(e)}static isPublicCloudAuthority(e){return ye.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,a){const s=new ft(e);s.validateAsUri();const l=s.getUrlComponents();let c=`${t}.${l.HostNameAndPort}`;this.isPublicCloudAuthority(l.HostNameAndPort)&&(c=`${t}.${ye.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const h=ft.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:c}).urlString;return a?`${h}?${a}`:h}static replaceWithRegionalInformation(e,t){const a={...e};return a.authorization_endpoint=Pn.buildRegionalAuthorityString(a.authorization_endpoint,t),a.token_endpoint=Pn.buildRegionalAuthorityString(a.token_endpoint,t),a.end_session_endpoint&&(a.end_session_endpoint=Pn.buildRegionalAuthorityString(a.end_session_endpoint,t)),a}static transformCIAMAuthority(e){let t=e;const s=new ft(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(ye.CIAM_AUTH_URL)){const l=s.HostNameAndPort.split(".")[0];t=`${t}${l}${ye.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}Pn.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Ti.COMMON,Ti.CONSUMERS,Ti.ORGANIZATIONS]);function Eb(n){const a=new ft(n).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(a){case Ti.COMMON:case Ti.ORGANIZATIONS:case Ti.CONSUMERS:return;default:return a}}function r_(n){return n.endsWith(ye.FORWARD_SLASH)?n:`${n}${ye.FORWARD_SLASH}`}function Ab(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Dt(fg)}return{canonicalAuthority:n.authority?r_(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v15.12.0 2025-08-19 */async function a_(n,e,t,a,s,l,c){c?.addQueueMeasurement(Y.AuthorityFactoryCreateDiscoveredInstance,l);const h=Pn.transformCIAMAuthority(r_(n)),d=new Pn(h,e,t,a,s,l,c);try{return await ve(d.resolveEndpointsAsync.bind(d),Y.AuthorityResolveEndpointsAsync,s,c,l)(),d}catch{throw we(Da)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class ls extends Nt{constructor(e,t,a,s,l){super(e,t,a),this.name="ServerError",this.errorNo=s,this.status=l,Object.setPrototypeOf(this,ls.prototype)}}/*! @azure/msal-common v15.12.0 2025-08-19 */function Fh(n,e,t){return{clientId:n,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}/*! @azure/msal-common v15.12.0 2025-08-19 */class da{static generateThrottlingStorageKey(e){return`${kl.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,a){const s=da.generateThrottlingStorageKey(t),l=e.getThrottlingCache(s);if(l){if(l.throttleTime<Date.now()){e.removeItem(s,a);return}throw new ls(l.errorCodes?.join(" ")||ye.EMPTY_STRING,l.errorMessage,l.subError)}}static postProcess(e,t,a,s){if(da.checkResponseStatus(a)||da.checkResponseForRetryAfter(a)){const l={throttleTime:da.calculateThrottleTime(parseInt(a.headers[Kn.RETRY_AFTER])),error:a.body.error,errorCodes:a.body.error_codes,errorMessage:a.body.error_description,subError:a.body.suberror};e.setThrottlingCache(da.generateThrottlingStorageKey(t),l,s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(Kn.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,a=Date.now()/1e3;return Math.floor(Math.min(a+(t||kl.DEFAULT_THROTTLE_TIME_SECONDS),a+kl.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,a,s){const l=Fh(t,a,s),c=this.generateThrottlingStorageKey(l);e.removeItem(c,a.correlationId)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Lh extends Nt{constructor(e,t,a){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Lh.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=a}}function Il(n,e,t,a){return n.errorMessage=`${n.errorMessage}, additionalErrorInfo: error.name:${a?.name}, error.message:${a?.message}`,new Lh(n,e,t)}/*! @azure/msal-common v15.12.0 2025-08-19 */class Rg{constructor(e,t){this.config=m2(e),this.logger=new Ci(this.config.loggerOptions,_x,lg),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[Kn.CONTENT_TYPE]=ye.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Yr.HOME_ACCOUNT_ID:try{const a=ao(e.credential);t[Kn.CCS_HEADER]=`Oid:${a.uid}@${a.utid}`}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Yr.UPN:t[Kn.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,a,s,l,c){c&&this.performanceClient?.addQueueMeasurement(c,l);const h=await this.sendPostRequest(s,e,{body:t,headers:a},l);return this.config.serverTelemetryManager&&h.status<500&&h.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),h}async sendPostRequest(e,t,a,s){da.preProcess(this.cacheManager,e,s);let l;try{l=await ve(this.networkClient.sendPostRequestAsync.bind(this.networkClient),Y.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,a);const c=l.headers||{};this.performanceClient?.addFields({refreshTokenSize:l.body.refresh_token?.length||0,httpVerToken:c[Kn.X_MS_HTTP_VERSION]||"",requestId:c[Kn.X_MS_REQUEST_ID]||""},s)}catch(c){if(c instanceof Lh){const h=c.responseHeaders;throw h&&this.performanceClient?.addFields({httpVerToken:h[Kn.X_MS_HTTP_VERSION]||"",requestId:h[Kn.X_MS_REQUEST_ID]||"",contentTypeHeader:h[Kn.CONTENT_TYPE]||void 0,contentLengthHeader:h[Kn.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},s),c.error}throw c instanceof Nt?c:we(sx)}return da.postProcess(this.cacheManager,e,l,s),l}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(Y.UpdateTokenEndpointAuthority,t);const a=`https://${e}/${this.authority.tenant}/`,s=await a_(a,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Oh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&_i(t,e.tokenQueryParameters),Cg(t,e.correlationId),kh(t,e.correlationId,this.performanceClient),$l(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */function i_(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v15.12.0 2025-08-19 */class Jr{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,a){const s=new Jr;t.authorityType===Vr.Adfs?s.authorityType=Au.ADFS_ACCOUNT_TYPE:t.protocolMode===tr.OIDC?s.authorityType=Au.GENERIC_ACCOUNT_TYPE:s.authorityType=Au.MSSTS_ACCOUNT_TYPE;let l;e.clientInfo&&a&&(l=th(e.clientInfo,a)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const c=e.environment||t&&t.getPreferredCache();if(!c)throw we(ig);s.environment=c,s.realm=l?.utid||i_(e.idTokenClaims)||"",s.localAccountId=l?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const h=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,d=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(s.username=h||d||"",s.loginHint=e.idTokenClaims?.login_hint,s.name=e.idTokenClaims?.name||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const g=gg(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[g]}return s}static createFromAccountInfo(e,t,a){const s=new Jr;return s.authorityType=e.authorityType||Au.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.loginHint=e.loginHint,s.cloudGraphHostName=t,s.msGraphHost=a,s.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),s}static generateHomeAccountId(e,t,a,s,l){if(!(t===Vr.Adfs||t===Vr.Dsts)){if(e)try{const c=th(e,s.base64Decode);if(c.uid&&c.utid)return`${c.uid}.${c.utid}`}catch{}a.warning("No client info in response")}return l?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,a){if(!e||!t)return!1;let s=!0;if(a){const l=e.idTokenClaims||{},c=t.idTokenClaims||{};s=l.iat===c.iat&&l.nonce===c.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v15.12.0 2025-08-19 */const sh="no_tokens_found",s_="native_account_unavailable",Ng="refresh_token_expired",kg="ux_not_allowed",wb="interaction_required",bb="consent_required",Ib="login_required",Uh="bad_token";/*! @azure/msal-common v15.12.0 2025-08-19 */const jy=[wb,bb,Ib,Uh,kg],Rb=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Nb={[sh]:"No refresh token found in the cache. Please sign-in.",[s_]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Ng]:"Refresh token has expired.",[Uh]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[kg]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Lr extends Nt{constructor(e,t,a,s,l,c,h,d){super(e,t,a),Object.setPrototypeOf(this,Lr.prototype),this.timestamp=s||ye.EMPTY_STRING,this.traceId=l||ye.EMPTY_STRING,this.correlationId=c||ye.EMPTY_STRING,this.claims=h||ye.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=d}}function o_(n,e,t){const a=!!n&&jy.indexOf(n)>-1,s=!!t&&Rb.indexOf(t)>-1,l=!!e&&jy.some(c=>e.indexOf(c)>-1);return a||l||s}function oh(n){return new Lr(n,Nb[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */class vo{static setRequestState(e,t,a){const s=vo.generateLibraryState(e,a);return t?`${s}${ye.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw we(P0);const a={id:e.createNewGuid()};t&&(a.meta=t);const s=JSON.stringify(a);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw we(P0);if(!t)throw we(uo);try{const a=t.split(ye.RESOURCE_DELIM),s=a[0],l=a.length>1?a.slice(1).join(ye.RESOURCE_DELIM):ye.EMPTY_STRING,c=e.base64Decode(s),h=JSON.parse(c);return{userRequestState:l||ye.EMPTY_STRING,libraryState:h}}catch{throw we(uo)}}}/*! @azure/msal-common v15.12.0 2025-08-19 */const kb={SW:"sw"};class ho{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(Y.PopTokenGenerateCnf,e.correlationId);const a=await ve(this.generateKid.bind(this),Y.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(a));return{kid:a.kid,reqCnfString:s}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(Y.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:kb.SW}}async signPopToken(e,t,a){return this.signPayload(e,t,a)}async signPayload(e,t,a,s){const{resourceRequestMethod:l,resourceRequestUri:c,shrClaims:h,shrNonce:d,shrOptions:g}=a,v=(c?new ft(c):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:rr(),m:l?.toUpperCase(),u:v?.HostNameAndPort,nonce:d||this.cryptoUtils.createNewGuid(),p:v?.AbsolutePath,q:v?.QueryString?[[],v.QueryString]:void 0,client_claims:h||void 0,...s},t,g,a.correlationId)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Ob{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v15.12.0 2025-08-19 */class ns{constructor(e,t,a,s,l,c,h){this.clientId=e,this.cacheStorage=t,this.cryptoObj=a,this.logger=s,this.serializableCache=l,this.persistencePlugin=c,this.performanceClient=h}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const a=`Error(s): ${e.error_codes||ye.NOT_AVAILABLE} - Timestamp: ${e.timestamp||ye.NOT_AVAILABLE} - Description: ${e.error_description||ye.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||ye.NOT_AVAILABLE} - Trace ID: ${e.trace_id||ye.NOT_AVAILABLE}`,s=e.error_codes?.length?e.error_codes[0]:void 0,l=new ls(e.error,a,e.suberror,s,e.status);if(t&&e.status&&e.status>=pi.SERVER_ERROR_RANGE_START&&e.status<=pi.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${l}`);return}else if(t&&e.status&&e.status>=pi.CLIENT_ERROR_RANGE_START&&e.status<=pi.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${l}`);return}throw o_(e.error,e.error_description,e.suberror)?new Lr(e.error,e.error_description,e.suberror,e.timestamp||ye.EMPTY_STRING,e.trace_id||ye.EMPTY_STRING,e.correlation_id||ye.EMPTY_STRING,e.claims||ye.EMPTY_STRING,s):l}}async handleServerTokenResponse(e,t,a,s,l,c,h,d,g){this.performanceClient?.addQueueMeasurement(Y.HandleServerTokenResponse,e.correlation_id);let p;if(e.id_token){if(p=po(e.id_token||ye.EMPTY_STRING,this.cryptoObj.base64Decode),l&&l.nonce&&p.nonce!==l.nonce)throw we(ux);if(s.maxAge||s.maxAge===0){const C=p.auth_time;if(!C)throw we(rg);Fx(C,s.maxAge)}}this.homeAccountIdentifier=Jr.generateHomeAccountId(e.client_info||ye.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,p);let v;l&&l.state&&(v=vo.parseRequestState(this.cryptoObj,l.state)),e.key_id=e.key_id||s.sshKid||void 0;const T=this.generateCacheRecord(e,t,a,s,p,c,l);let x;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),x=new Ob(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(x)),h&&!d&&T.account){const C=this.cacheStorage.generateAccountKey(T.account.getAccountInfo());if(!this.cacheStorage.getAccount(C,s.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await ns.generateAuthenticationResult(this.cryptoObj,t,T,!1,s,p,v,void 0,g)}await this.cacheStorage.saveCacheRecord(T,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&x&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(x))}return ns.generateAuthenticationResult(this.cryptoObj,t,T,!1,s,p,v,e,g)}generateCacheRecord(e,t,a,s,l,c,h){const d=t.getPreferredCache();if(!d)throw we(ig);const g=i_(l);let p,v;e.id_token&&l&&(p=Dh(this.homeAccountIdentifier,d,e.id_token,this.clientId,g||""),v=Og(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,s.correlationId,l,e.client_info,d,g,h,void 0,this.logger));let T=null;if(e.access_token){const _=e.scope?an.fromString(e.scope):new an(s.scopes||[]),A=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,B=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,I=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,k=a+A,z=k+B,X=I&&I>0?a+I:void 0;T=Ph(this.homeAccountIdentifier,d,e.access_token,this.clientId,g||t.tenant||"",_.printScopes(),k,z,this.cryptoObj.base64Decode,X,e.token_type,c,e.key_id,s.claims,s.requestedClaimsHash)}let x=null;if(e.refresh_token){let _;if(e.refresh_token_expires_in){const A=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;_=a+A}x=n_(this.homeAccountIdentifier,d,e.refresh_token,this.clientId,e.foci,c,_)}let C=null;return e.foci&&(C={clientId:this.clientId,environment:d,familyId:e.foci}),{account:v,idToken:p,accessToken:T,refreshToken:x,appMetadata:C}}static async generateAuthenticationResult(e,t,a,s,l,c,h,d,g){let p=ye.EMPTY_STRING,v=[],T=null,x,C,_=ye.EMPTY_STRING;if(a.accessToken){if(a.accessToken.tokenType===Tt.POP&&!l.popKid){const k=new ho(e),{secret:z,keyId:X}=a.accessToken;if(!X)throw we(sg);p=await k.signPopToken(z,X,l)}else p=a.accessToken.secret;v=an.fromString(a.accessToken.target).asArray(),T=io(a.accessToken.expiresOn),x=io(a.accessToken.extendedExpiresOn),a.accessToken.refreshOn&&(C=io(a.accessToken.refreshOn))}a.appMetadata&&(_=a.appMetadata.familyId===Yu?Yu:"");const A=c?.oid||c?.sub||"",B=c?.tid||"";d?.spa_accountid&&a.account&&(a.account.nativeAccountId=d?.spa_accountid);const I=a.account?mg(a.account.getAccountInfo(),void 0,c,a.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:A,tenantId:B,scopes:v,account:I,idToken:a?.idToken?.secret||"",idTokenClaims:c||{},accessToken:p,fromCache:s,expiresOn:T,extExpiresOn:x,refreshOn:C,correlationId:l.correlationId,requestId:g||ye.EMPTY_STRING,familyId:_,tokenType:a.accessToken?.tokenType||ye.EMPTY_STRING,state:h?h.userRequestState:ye.EMPTY_STRING,cloudGraphHostName:a.account?.cloudGraphHostName||ye.EMPTY_STRING,msGraphHost:a.account?.msGraphHost||ye.EMPTY_STRING,code:d?.spa_code,fromNativeBroker:!1}}}function Og(n,e,t,a,s,l,c,h,d,g,p,v){v?.verbose("setCachedAccount called");const x=n.getAccountKeys().find(I=>I.startsWith(t));let C=null;x&&(C=n.getAccount(x,s));const _=C||Jr.createAccount({homeAccountId:t,idTokenClaims:l,clientInfo:c,environment:h,cloudGraphHostName:g?.cloud_graph_host_name,msGraphHost:g?.msgraph_host,nativeAccountId:p},e,a),A=_.tenantProfiles||[],B=d||_.realm;if(B&&!A.find(I=>I.tenantId===B)){const I=gg(t,_.localAccountId,B,l);A.push(I)}return _.tenantProfiles=A,_}/*! @azure/msal-common v15.12.0 2025-08-19 */async function l_(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v15.12.0 2025-08-19 */class c_ extends Rg{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(Y.AuthClientAcquireToken,e.correlationId),!e.code)throw we(dx);const a=rr(),s=await ve(this.executeTokenRequest.bind(this),Y.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),l=s.headers?.[Kn.X_MS_REQUEST_ID],c=new ns(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return c.validateTokenResponse(s.body),ve(c.handleServerTokenResponse.bind(c),Y.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,a,e,t,void 0,void 0,void 0,l)}getLogoutUri(e){if(!e)throw Dt(bx);const t=this.createLogoutUrlQueryString(e);return ft.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Y.AuthClientExecuteTokenRequest,t.correlationId);const a=this.createTokenQueryParameters(t),s=ft.appendQueryString(e.tokenEndpoint,a),l=await ve(this.createTokenRequestBody.bind(this),Y.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let c;if(t.clientInfo)try{const g=th(t.clientInfo,this.cryptoUtils.base64Decode);c={credential:`${g.uid}${Gl.CLIENT_INFO_SEPARATOR}${g.utid}`,type:Yr.HOME_ACCOUNT_ID}}catch(g){this.logger.verbose("Could not parse client info for CCS Header: "+g)}const h=this.createTokenRequestHeaders(c||t.ccsCredential),d=Fh(this.config.authOptions.clientId,t);return ve(this.executePostToTokenEndpoint.bind(this),Y.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,l,h,d,t.correlationId,Y.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Y.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(xg(t,e.embeddedClientId||e.tokenBodyParameters?.[ts]||this.config.authOptions.clientId),this.includeRedirectUri)_g(t,e.redirectUri);else if(!e.redirectUri)throw Dt(Sx);if(Tg(t,e.scopes,!0,this.oidcDefaultScopes),sb(t,e.code),Eg(t,this.config.libraryInfo),Ag(t,this.config.telemetry.application),t_(t),this.serverTelemetryManager&&!zx(this.config)&&e_(t,this.serverTelemetryManager),e.codeVerifier&&lb(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&Yx(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const s=this.config.clientCredentials.clientAssertion;Xx(t,await l_(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Wx(t,s.assertionType)}if(Qx(t,nx.AUTHORIZATION_CODE_GRANT),wg(t),e.authenticationScheme===Tt.POP){const s=new ho(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await ve(s.generateCnf.bind(s),Y.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,bg(t,l)}else if(e.authenticationScheme===Tt.SSH)if(e.sshJwk)Zx(t,e.sshJwk);else throw Dt(Nh);(!xr.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Sg(t,e.claims,this.config.authOptions.clientCapabilities);let a;if(e.clientInfo)try{const s=th(e.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${s.uid}${Gl.CLIENT_INFO_SEPARATOR}${s.utid}`,type:Yr.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case Yr.HOME_ACCOUNT_ID:try{const s=ao(a.credential);Ol(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case Yr.UPN:ah(t,a.credential);break}return e.embeddedClientId&&Oh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&_i(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Dy])&&_i(t,{[Dy]:"1"}),kh(t,e.correlationId,this.performanceClient),$l(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&tb(t,e.postLogoutRedirectUri),e.correlationId&&Cg(t,e.correlationId),e.idTokenHint&&nb(t,e.idTokenHint),e.state&&Vx(t,e.state),e.logoutHint&&ub(t,e.logoutHint),e.extraQueryParameters&&_i(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&Jx(t),$l(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Mb=300;class Db extends Rg{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(Y.RefreshTokenClientAcquireToken,e.correlationId);const t=rr(),a=await ve(this.executeTokenRequest.bind(this),Y.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=a.headers?.[Kn.X_MS_REQUEST_ID],l=new ns(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return l.validateTokenResponse(a.body),ve(l.handleServerTokenResponse.bind(l),Y.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){if(!e)throw Dt(wx);if(this.performanceClient?.addQueueMeasurement(Y.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw we(ag);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await ve(this.acquireTokenWithCachedRefreshToken.bind(this),Y.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(a){const s=a instanceof Lr&&a.errorCode===sh,l=a instanceof ls&&a.errorCode===Ay.INVALID_GRANT_ERROR&&a.subError===Ay.CLIENT_MISMATCH_ERROR;if(s||l)return ve(this.acquireTokenWithCachedRefreshToken.bind(this),Y.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw a}return ve(this.acquireTokenWithCachedRefreshToken.bind(this),Y.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(Y.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const a=_r(this.cacheManager.getRefreshToken.bind(this.cacheManager),Y.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!a)throw oh(sh);if(a.expiresOn&&ih(a.expiresOn,e.refreshTokenExpirationOffsetSeconds||Mb))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),oh(Ng);const s={...e,refreshToken:a.secret,authenticationScheme:e.authenticationScheme||Tt.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Yr.HOME_ACCOUNT_ID}};try{return await ve(this.acquireToken.bind(this),Y.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(l){if(l instanceof Lr&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),l.subError===Uh)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const c=this.cacheManager.generateCredentialKey(a);this.cacheManager.removeRefreshToken(c,e.correlationId)}throw l}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(Y.RefreshTokenClientExecuteTokenRequest,e.correlationId);const a=this.createTokenQueryParameters(e),s=ft.appendQueryString(t.tokenEndpoint,a),l=await ve(this.createTokenRequestBody.bind(this),Y.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),c=this.createTokenRequestHeaders(e.ccsCredential),h=Fh(this.config.authOptions.clientId,e);return ve(this.executePostToTokenEndpoint.bind(this),Y.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,l,c,h,e.correlationId,Y.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(Y.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(xg(t,e.embeddedClientId||e.tokenBodyParameters?.[ts]||this.config.authOptions.clientId),e.redirectUri&&_g(t,e.redirectUri),Tg(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),Qx(t,nx.REFRESH_TOKEN_GRANT),wg(t),Eg(t,this.config.libraryInfo),Ag(t,this.config.telemetry.application),t_(t),this.serverTelemetryManager&&!zx(this.config)&&e_(t,this.serverTelemetryManager),ob(t,e.refreshToken),this.config.clientCredentials.clientSecret&&Yx(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;Xx(t,await l_(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),Wx(t,a.assertionType)}if(e.authenticationScheme===Tt.POP){const a=new ho(this.cryptoUtils,this.performanceClient);let s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(await ve(a.generateCnf.bind(a),Y.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,bg(t,s)}else if(e.authenticationScheme===Tt.SSH)if(e.sshJwk)Zx(t,e.sshJwk);else throw Dt(Nh);if((!xr.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Sg(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Yr.HOME_ACCOUNT_ID:try{const a=ao(e.ccsCredential.credential);Ol(t,a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Yr.UPN:ah(t,e.ccsCredential.credential);break}return e.embeddedClientId&&Oh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&_i(t,e.tokenBodyParameters),kh(t,e.correlationId,this.performanceClient),$l(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Pb extends Rg{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(Y.SilentFlowClientAcquireCachedToken,e.correlationId);let t=Wi.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!xr.isEmptyObj(e.claims))throw this.setCacheOutcome(Wi.FORCE_REFRESH_OR_CLAIMS,e.correlationId),we(xi);if(!e.account)throw we(ag);const a=e.account.tenantId||Eb(e.authority),s=this.cacheManager.getTokenKeys(),l=this.cacheManager.getAccessToken(e.account,e,s,a);if(l){if(vb(l.cachedAt)||ih(l.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Wi.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),we(xi);l.refreshOn&&ih(l.refreshOn,0)&&(t=Wi.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Wi.NO_CACHED_ACCESS_TOKEN,e.correlationId),we(xi);const c=e.authority||this.authority.getPreferredCache(),h={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:l,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,s,a,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(c)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await ve(this.generateResultFromCacheRecord.bind(this),Y.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(h,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==Wi.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){this.performanceClient?.addQueueMeasurement(Y.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let a;if(e.idToken&&(a=po(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const s=a?.auth_time;if(!s)throw we(rg);Fx(s,t.maxAge)}return ns.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,a)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Fb={sendGetRequestAsync:()=>Promise.reject(we(tt)),sendPostRequestAsync:()=>Promise.reject(we(tt))};/*! @azure/msal-common v15.12.0 2025-08-19 */function Lb(n,e,t,a){const s=e.correlationId,l=new Map;xg(l,e.embeddedClientId||e.extraQueryParameters?.[ts]||n.clientId);const c=[...e.scopes||[],...e.extraScopesToConsent||[]];if(Tg(l,c,!0,n.authority.options.OIDCOptions?.defaultScopes),_g(l,e.redirectUri),Cg(l,s),Z2(l,e.responseMode),wg(l),e.prompt&&(ab(l,e.prompt),a?.addFields({prompt:e.prompt},s)),e.domainHint&&(rb(l,e.domainHint),a?.addFields({domainHintFromRequest:!0},s)),e.prompt!==Yn.SELECT_ACCOUNT)if(e.sid&&e.prompt===Yn.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Py(l,e.sid),a?.addFields({sidFromRequest:!0},s);else if(e.account){const h=Hb(e.account);let d=jb(e.account);if(d&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),d=null),d){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),wu(l,d),a?.addFields({loginHintFromClaim:!0},s);try{const g=ao(e.account.homeAccountId);Ol(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(h&&e.prompt===Yn.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Py(l,h),a?.addFields({sidFromClaim:!0},s);try{const g=ao(e.account.homeAccountId);Ol(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),wu(l,e.loginHint),ah(l,e.loginHint),a?.addFields({loginHintFromRequest:!0},s);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),wu(l,e.account.username),a?.addFields({loginHintFromUpn:!0},s);try{const g=ao(e.account.homeAccountId);Ol(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),wu(l,e.loginHint),ah(l,e.loginHint),a?.addFields({loginHintFromRequest:!0},s));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&ib(l,e.nonce),e.state&&Vx(l,e.state),(e.claims||n.clientCapabilities&&n.clientCapabilities.length>0)&&Sg(l,e.claims,n.clientCapabilities),e.embeddedClientId&&Oh(l,n.clientId,n.redirectUri),n.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(U0))&&Jx(l),l}function Mg(n,e,t,a){const s=$l(e,t,a);return ft.appendQueryString(n.authorizationEndpoint,s)}function Ub(n,e){if(u_(n,e),!n.code)throw we(yx);return n}function u_(n,e){if(!n.state||!e)throw n.state?we(O0,"Cached State"):we(O0,"Server State");let t,a;try{t=decodeURIComponent(n.state)}catch{throw we(uo,n.state)}try{a=decodeURIComponent(e)}catch{throw we(uo,n.state)}if(t!==a)throw we(cx);if(n.error||n.error_description||n.suberror){const s=Bb(n);throw o_(n.error,n.error_description,n.suberror)?new Lr(n.error||"",n.error_description,n.suberror,n.timestamp||"",n.trace_id||"",n.correlation_id||"",n.claims||"",s):new ls(n.error||"",n.error_description,n.suberror,s)}}function Bb(n){const e="code=",t=n.error_uri?.lastIndexOf(e);return t&&t>=0?n.error_uri?.substring(t+e.length):void 0}function Hb(n){return n.idTokenClaims?.sid||null}function jb(n){return n.loginHint||n.idTokenClaims?.login_hint||null}/*! @azure/msal-common v15.12.0 2025-08-19 */const zy=",",h_="|";function zb(n){const{skus:e,libraryName:t,libraryVersion:a,extensionName:s,extensionVersion:l}=n,c=new Map([[0,[t,a]],[2,[s,l]]]);let h=[];if(e?.length){if(h=e.split(zy),h.length<4)return e}else h=Array.from({length:4},()=>h_);return c.forEach((d,g)=>{d.length===2&&d[0]?.length&&d[1]?.length&&Gb({skuArr:h,index:g,skuName:d[0],skuVersion:d[1]})}),h.join(zy)}function Gb(n){const{skuArr:e,index:t,skuName:a,skuVersion:s}=n;t>=e.length||(e[t]=[a,s].join(h_))}class Kl{constructor(e,t){this.cacheOutcome=Wi.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||ye.EMPTY_STRING,this.wrapperVer=e.wrapperVer||ye.EMPTY_STRING,this.telemetryCacheKey=Sn.CACHE_KEY+Gl.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${Sn.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],a=this.getNativeBrokerErrorCode();a?.length&&t.push(`broker_error=${a}`);const s=t.join(Sn.VALUE_SEPARATOR),l=this.getRegionDiscoveryFields(),c=[e,l].join(Sn.VALUE_SEPARATOR);return[Sn.SCHEMA_VERSION,c,s].join(Sn.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Kl.maxErrorsToSend(e),a=e.failedRequests.slice(0,2*t).join(Sn.VALUE_SEPARATOR),s=e.errors.slice(0,t).join(Sn.VALUE_SEPARATOR),l=e.errors.length,c=t<l?Sn.OVERFLOW_TRUE:Sn.OVERFLOW_FALSE,h=[l,c].join(Sn.VALUE_SEPARATOR);return[Sn.SCHEMA_VERSION,e.cacheHits,a,s,h].join(Sn.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=Sn.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof Nt?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Sn.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=Kl.maxErrorsToSend(e),a=e.errors.length;if(t===a)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s,this.correlationId)}}static maxErrorsToSend(e){let t,a=0,s=0;const l=e.errors.length;for(t=0;t<l;t++){const c=e.failedRequests[2*t]||ye.EMPTY_STRING,h=e.failedRequests[2*t+1]||ye.EMPTY_STRING,d=e.errors[t]||ye.EMPTY_STRING;if(s+=c.toString().length+h.toString().length+d.length+3,s<Sn.MAX_LAST_HEADER_BYTES)a+=1;else break}return a}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||ye.EMPTY_STRING),e.push(this.regionSource||ye.EMPTY_STRING),e.push(this.regionOutcome||ye.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return zb(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const f_="missing_kid_error",d_="missing_alg_error";/*! @azure/msal-common v15.12.0 2025-08-19 */const $b={[f_]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[d_]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Dg extends Nt{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Dg.prototype)}}function Gy(n){return new Dg(n,$b[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */class Pg{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Gy(f_);if(!e.alg)throw Gy(d_);const t=new Pg({typ:e.typ||Lw.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const Fg="pkce_not_created",Lg="ear_jwk_empty",g_="ear_jwe_empty",B0="crypto_nonexistent",Bh="empty_navigate_uri",m_="hash_empty_error",Ug="no_state_in_hash",p_="hash_does_not_contain_known_properties",v_="unable_to_parse_state",y_="state_interaction_type_mismatch",T_="interaction_in_progress",x_="popup_window_error",__="empty_window_error",Vl="user_cancelled",Kb="monitor_popup_timeout",S_="monitor_window_timeout",C_="redirect_in_iframe",E_="block_iframe_reload",A_="block_nested_popups",Vb="iframe_closed_prematurely",Hh="silent_logout_unsupported",w_="no_account_error",qb="silent_prompt_value_error",b_="no_token_request_cache_error",I_="unable_to_parse_token_request_cache_error",Yb="auth_request_not_set_error",Xb="invalid_cache_type",jh="non_browser_environment",Zs="database_not_open",lh="no_network_connectivity",R_="post_request_failed",N_="get_request_failed",H0="failed_to_parse_response",k_="unable_to_load_token",Bg="crypto_key_not_found",O_="auth_code_required",M_="auth_code_or_nativeAccountId_required",D_="spa_code_and_nativeAccountId_present",Hg="database_unavailable",P_="unable_to_acquire_token_from_native_platform",F_="native_handshake_timeout",L_="native_extension_not_installed",jg="native_connection_not_established",Ml="uninitialized_public_client_application",U_="native_prompt_not_supported",B_="invalid_base64_string",H_="invalid_pop_token_request",j_="failed_to_build_headers",z_="failed_to_parse_headers",$u="failed_to_decrypt_ear_response",ch="timed_out";/*! @azure/msal-browser v4.22.1 2025-09-09 */const Ma="For more visit: aka.ms/msaljs/browser-errors",Wb={[Fg]:"The PKCE code challenge and verifier could not be generated.",[Lg]:"No EAR encryption key provided. This is unexpected.",[g_]:"Server response does not contain ear_jwe property. This is unexpected.",[B0]:"The crypto object or function is not available.",[Bh]:"Navigation URI is empty. Please check stack trace for more info.",[m_]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Ma}`,[Ug]:"Hash does not contain state. Please verify that the request originated from msal.",[p_]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Ma}`,[v_]:"Unable to parse state. Please verify that the request originated from msal.",[y_]:"Hash contains state but the interaction type does not match the caller.",[T_]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Ma}`,[x_]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[__]:"window.open returned null or undefined window object.",[Vl]:"User cancelled the flow.",[Kb]:`Token acquisition in popup failed due to timeout.  ${Ma}`,[S_]:`Token acquisition in iframe failed due to timeout.  ${Ma}`,[C_]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[E_]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Ma}`,[A_]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Vb]:"The iframe being monitored was closed prematurely.",[Hh]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[w_]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[qb]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[b_]:"No token request found in cache.",[I_]:"The cached token request could not be parsed.",[Yb]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Xb]:"Invalid cache type",[jh]:"Login and token requests are not supported in non-browser environments.",[Zs]:"Database is not open!",[lh]:"No network connectivity. Check your internet connection.",[R_]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[N_]:"Network request failed. Please check the network trace to determine root cause.",[H0]:"Failed to parse network response. Check network trace.",[k_]:"Error loading token to cache.",[Bg]:"Cryptographic Key or Keypair not found in browser storage.",[O_]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[M_]:"An authorization code or nativeAccountId must be provided to this flow.",[D_]:"Request cannot contain both spa code and native account id.",[Hg]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[P_]:`Unable to acquire token from native platform.  ${Ma}`,[F_]:"Timed out while attempting to establish connection to browser extension",[L_]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[jg]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Ma}`,[Ml]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Ma}`,[U_]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[B_]:"Invalid base64 encoded string.",[H_]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[j_]:"Failed to build request headers object.",[z_]:"Failed to parse response headers",[$u]:"Failed to decrypt ear response",[ch]:"The request timed out."};class nc extends Nt{constructor(e,t){super(e,Wb[e],t),Object.setPrototypeOf(this,nc.prototype),this.name="BrowserAuthError"}}function Ue(n,e){return new nc(n,e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const er={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Fr={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS",MICROSOFT_ENTRA_BROKERID:"MicrosoftEntra",DOM_API_NAME:"DOM API",PLATFORM_DOM_APIS:"get-token-and-sign-out",PLATFORM_DOM_PROVIDER:"PlatformAuthDOMHandler",PLATFORM_EXTENSION_PROVIDER:"PlatformAuthExtensionHandler"},Al={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},sn={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},$y={GET:"GET",POST:"POST"},mi={SIGNIN:"signin",SIGNOUT:"signout"},Jt={ORIGIN_URI:"request.origin",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",VERIFIER:"code.verifier",INTERACTION_STATUS_KEY:"interaction.status",NATIVE_REQUEST:"request.native"},Iu={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Rt={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var qe;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(qe||(qe={}));const Ky={scopes:mo},G_="jwk",j0="msal.db",Qb=1,Jb=`${j0}.keys`,$n={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},Zb=[$n.Default,$n.Skip,$n.RefreshTokenAndNetwork];/*! @azure/msal-browser v4.22.1 2025-09-09 */function Ru(n){return encodeURIComponent(ql(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Ei(n){return $_(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function ql(n){return $_(new TextEncoder().encode(n))}function $_(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Wr(n){return new TextDecoder().decode(Si(n))}function Si(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Ue(B_)}const t=atob(e);return Uint8Array.from(t,a=>a.codePointAt(0)||0)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const eI="RSASSA-PKCS1-v1_5",yo="AES-GCM",K_="HKDF",zg="SHA-256",tI=2048,nI=new Uint8Array([1,0,1]),Vy="0123456789abcdef",qy=new Uint32Array(1),Gg="raw",V_="encrypt",$g="decrypt",rI="deriveKey",aI="crypto_subtle_undefined",Kg={name:eI,hash:zg,modulusLength:tI,publicExponent:nI};function iI(n){if(!window)throw Ue(jh);if(!window.crypto)throw Ue(B0);if(!n&&!window.crypto.subtle)throw Ue(B0,aI)}async function q_(n,e,t){e?.addQueueMeasurement(Y.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest(zg,s)}function sI(n){return window.crypto.getRandomValues(n)}function v0(){return window.crypto.getRandomValues(qy),qy[0]}function Zr(){const n=Date.now(),e=v0()*1024+(v0()&1023),t=new Uint8Array(16),a=Math.trunc(e/2**30),s=e&2**30-1,l=v0();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|a>>>8,t[7]=a,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=l>>>24,t[13]=l>>>16,t[14]=l>>>8,t[15]=l;let c="";for(let h=0;h<t.length;h++)c+=Vy.charAt(t[h]>>>4),c+=Vy.charAt(t[h]&15),(h===3||h===5||h===7||h===9)&&(c+="-");return c}async function oI(n,e){return window.crypto.subtle.generateKey(Kg,n,e)}async function y0(n){return window.crypto.subtle.exportKey(G_,n)}async function lI(n,e,t){return window.crypto.subtle.importKey(G_,n,Kg,e,t)}async function cI(n,e){return window.crypto.subtle.sign(Kg,n,e)}async function Vg(){const n=await Y_(),t={alg:"dir",kty:"oct",k:Ei(new Uint8Array(n))};return ql(JSON.stringify(t))}async function uI(n){const e=Wr(n),a=JSON.parse(e).k,s=Si(a);return window.crypto.subtle.importKey(Gg,s,yo,!1,[$g])}async function hI(n,e){const t=e.split(".");if(t.length!==5)throw Ue($u,"jwe_length");const a=await uI(n).catch(()=>{throw Ue($u,"import_key")});try{const s=new TextEncoder().encode(t[0]),l=Si(t[2]),c=Si(t[3]),h=Si(t[4]),d=h.byteLength*8,g=new Uint8Array(c.length+h.length);g.set(c),g.set(h,c.length);const p=await window.crypto.subtle.decrypt({name:yo,iv:l,tagLength:d,additionalData:s},a,g);return new TextDecoder().decode(p)}catch{throw Ue($u,"decrypt")}}async function Y_(){const n=await window.crypto.subtle.generateKey({name:yo,length:256},!0,[V_,$g]);return window.crypto.subtle.exportKey(Gg,n)}async function Yy(n){return window.crypto.subtle.importKey(Gg,n,K_,!1,[rI])}async function X_(n,e,t){return window.crypto.subtle.deriveKey({name:K_,salt:e,hash:zg,info:new TextEncoder().encode(t)},n,{name:yo,length:256},!1,[V_,$g])}async function fI(n,e,t){const a=new TextEncoder().encode(e),s=window.crypto.getRandomValues(new Uint8Array(16)),l=await X_(n,s,t),c=await window.crypto.subtle.encrypt({name:yo,iv:new Uint8Array(12)},l,a);return{data:Ei(new Uint8Array(c)),nonce:Ei(s)}}async function Xy(n,e,t,a){const s=Si(a),l=await X_(n,Si(e),t),c=await window.crypto.subtle.decrypt({name:yo,iv:new Uint8Array(12)},l,s);return new TextDecoder().decode(c)}async function W_(n){const e=await q_(n),t=new Uint8Array(e);return Ei(t)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const zh="storage_not_supported",Q_="stubbed_public_client_application_called",qg="in_mem_redirect_unavailable";/*! @azure/msal-browser v4.22.1 2025-09-09 */const Ku={[zh]:"Given storage configuration option was not supported.",[Q_]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[qg]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};Ku[zh],Ku[Q_],Ku[qg];class Yg extends Nt{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Yg.prototype)}}function Xg(n){return new Yg(n,Ku[n])}/*! @azure/msal-browser v4.22.1 2025-09-09 */function J_(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function dI(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Wg(){return window.parent!==window}function gI(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${er.POPUP_NAME_PREFIX}.`)===0}function Pa(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function mI(){const e=new ft(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function pI(){if(ft.hashContainsKnownProperties(window.location.hash)&&Wg())throw Ue(E_)}function vI(n){if(Wg()&&!n)throw Ue(C_)}function yI(){if(gI())throw Ue(A_)}function Z_(){if(typeof window>"u")throw Ue(jh)}function eS(n){if(!n)throw Ue(Ml)}function Qg(n){Z_(),pI(),yI(),eS(n)}function Wy(n,e){if(Qg(n),vI(e.system.allowRedirectInIframe),e.cache.cacheLocation===sn.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Xg(qg)}function tS(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function TI(){return Zr()}/*! @azure/msal-browser v4.22.1 2025-09-09 */class uh{navigateInternal(e,t){return uh.defaultNavigateWindow(e,t)}navigateExternal(e,t){return uh.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((a,s)=>{setTimeout(()=>{s(Ue(ch,"failed_to_redirect"))},t.timeout)})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class xI{async sendGetRequestAsync(e,t){let a,s={},l=0;const c=Qy(t);try{a=await fetch(e,{method:$y.GET,headers:c})}catch(h){throw Il(Ue(window.navigator.onLine?N_:lh),void 0,void 0,h)}s=Jy(a.headers);try{return l=a.status,{headers:s,body:await a.json(),status:l}}catch(h){throw Il(Ue(H0),l,s,h)}}async sendPostRequestAsync(e,t){const a=t&&t.body||"",s=Qy(t);let l,c=0,h={};try{l=await fetch(e,{method:$y.POST,headers:s,body:a})}catch(d){throw Il(Ue(window.navigator.onLine?R_:lh),void 0,void 0,d)}h=Jy(l.headers);try{return c=l.status,{headers:h,body:await l.json(),status:c}}catch(d){throw Il(Ue(H0),c,h,d)}}}function Qy(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([a,s])=>{e.append(a,s)}),e}catch(e){throw Il(Ue(j_),void 0,void 0,e)}}function Jy(n){try{const e={};return n.forEach((t,a)=>{e[a]=t}),e}catch{throw Ue(z_)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const _I=6e4,z0=1e4,SI=3e4,nS=2e3;function CI({auth:n,cache:e,system:t,telemetry:a},s){const l={clientId:ye.EMPTY_STRING,authority:`${ye.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:ye.EMPTY_STRING,authorityMetadata:ye.EMPTY_STRING,redirectUri:typeof window<"u"?Pa():"",postLogoutRedirectUri:ye.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:tr.AAD,OIDCOptions:{serverResponseType:Rh.FRAGMENT,defaultScopes:[ye.OPENID_SCOPE,ye.PROFILE_SCOPE,ye.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:cg.None,tenant:ye.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},c={cacheLocation:sn.SessionStorage,cacheRetentionDays:5,temporaryCacheLocation:sn.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===sn.LocalStorage),claimsBasedCachingEnabled:!1},h={loggerCallback:()=>{},logLevel:Bt.Info,piiLoggingEnabled:!1},g={...{...jx,loggerOptions:h,networkClient:s?new xI:Fb,navigationClient:new uh,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||_I,iframeHashTimeout:t?.loadFrameTimeout||z0,navigateFrameWait:0,redirectNavigationTimeout:SI,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||nS,pollIntervalMilliseconds:er.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:t?.loggerOptions||h},p={application:{appName:ye.EMPTY_STRING,appVersion:ye.EMPTY_STRING},client:new Hx};if(n?.protocolMode!==tr.OIDC&&n?.OIDCOptions&&new Ci(g.loggerOptions).warning(JSON.stringify(Dt(kx))),n?.protocolMode&&n.protocolMode===tr.OIDC&&g?.allowPlatformBroker)throw Dt(Ox);return{auth:{...l,...n,OIDCOptions:{...l.OIDCOptions,...n?.OIDCOptions}},cache:{...c,...e},system:g,telemetry:{...p,...a}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const EI="@azure/msal-browser",rs="4.22.1";/*! @azure/msal-browser v4.22.1 2025-09-09 */const dn="msal",Jg="browser",T0="-",gi=1,G0=1,AI=`${dn}.${Jg}.log.level`,wI=`${dn}.${Jg}.log.pii`,bI=`${dn}.${Jg}.platform.auth.dom`,Zy=`${dn}.version`,eT="account.keys",tT="token.keys";function fa(n=G0){return n<1?`${dn}.${eT}`:`${dn}.${n}.${eT}`}function Zi(n,e=gi){return e<1?`${dn}.${tT}.${n}`:`${dn}.${e}.${tT}.${n}`}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Zg{static loggerCallback(e,t){switch(e){case Bt.Error:console.error(t);return;case Bt.Info:console.info(t);return;case Bt.Verbose:console.debug(t);return;case Bt.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=CI(e,this.browserEnvironment);let t;try{t=window[sn.SessionStorage]}catch{}const a=t?.getItem(AI),s=t?.getItem(wI)?.toLowerCase(),l=s==="true"?!0:s==="false"?!1:void 0,c={...this.config.system.loggerOptions},h=a&&Object.keys(Bt).includes(a)?Bt[a]:void 0;h&&(c.loggerCallback=Zg.loggerCallback,c.logLevel=h),l!==void 0&&(c.piiLoggingEnabled=l),this.logger=new Ci(c,EI,rs),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class as extends Zg{getModuleName(){return as.MODULE_NAME}getId(){return as.ID}async initialize(){return this.available=typeof window<"u",this.available}}as.MODULE_NAME="";as.ID="StandardOperatingContext";/*! @azure/msal-browser v4.22.1 2025-09-09 */class II{constructor(){this.dbName=j0,this.version=Qb,this.tableName=Jb,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const a=window.indexedDB.open(this.dbName,this.version);a.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),a.addEventListener("success",s=>{const l=s;this.db=l.target.result,this.dbOpen=!0,e()}),a.addEventListener("error",()=>t(Ue(Hg)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(Zs));const c=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);c.addEventListener("success",h=>{const d=h;this.closeConnection(),t(d.target.result)}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((a,s)=>{if(!this.db)return s(Ue(Zs));const h=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);h.addEventListener("success",()=>{this.closeConnection(),a()}),h.addEventListener("error",d=>{this.closeConnection(),s(d)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(Zs));const c=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);c.addEventListener("success",()=>{this.closeConnection(),t()}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Ue(Zs));const l=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();l.addEventListener("success",c=>{const h=c;this.closeConnection(),e(h.target.result)}),l.addEventListener("error",c=>{this.closeConnection(),t(c)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(Zs));const c=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);c.addEventListener("success",h=>{const d=h;this.closeConnection(),t(d.target.result===1)}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const a=window.indexedDB.deleteDatabase(j0),s=setTimeout(()=>t(!1),200);a.addEventListener("success",()=>(clearTimeout(s),e(!0))),a.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),a.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Gh{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,a)=>{e.push(a)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class RI{constructor(e){this.inMemoryCache=new Gh,this.indexedDBCache=new II,this.logger=e}handleDatabaseAccessError(e){if(e instanceof nc&&e.errorCode===Hg)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(a){this.handleDatabaseAccessError(a)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(a){this.handleDatabaseAccessError(a)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(a){this.handleDatabaseAccessError(a)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Ba{constructor(e,t,a){this.logger=e,iI(a??!1),this.cache=new RI(this.logger),this.performanceClient=t}createNewGuid(){return Zr()}base64Encode(e){return ql(e)}base64Decode(e){return Wr(e)}base64UrlEncode(e){return Ru(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(Y.CryptoOptsGetPublicKeyThumbprint,e.correlationId),a=await oI(Ba.EXTRACTABLE,Ba.POP_KEY_USAGES),s=await y0(a.publicKey),l={e:s.e,kty:s.kty,n:s.n},c=nT(l),h=await this.hashString(c),d=await y0(a.privateKey),g=await lI(d,!1,["sign"]);return await this.cache.setItem(h,{privateKey:g,publicKey:a.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),h}async removeTokenBindingKey(e){if(await this.cache.removeItem(e),await this.cache.containsKey(e))throw we(Tx)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,a,s){const l=this.performanceClient?.startMeasurement(Y.CryptoOptsSignJwt,s),c=await this.cache.getItem(t);if(!c)throw Ue(Bg);const h=await y0(c.publicKey),d=nT(h),g=Ru(JSON.stringify({kid:t})),p=Pg.getShrHeaderString({...a?.header,alg:h.alg,kid:g}),v=Ru(p);e.cnf={jwk:JSON.parse(d)};const T=Ru(JSON.stringify(e)),x=`${v}.${T}`,_=new TextEncoder().encode(x),A=await cI(c.privateKey,_),B=Ei(new Uint8Array(A)),I=`${x}.${B}`;return l&&l.end({success:!0}),I}async hashString(e){return W_(e)}}Ba.POP_KEY_USAGES=["sign","verify"];Ba.EXTRACTABLE=!0;function nT(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v4.22.1 2025-09-09 */const NI=1440*60*1e3,$0={Lax:"Lax",None:"None"};class rS{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,a=document.cookie.split(";");for(let s=0;s<a.length;s++){const l=a[s],[c,...h]=decodeURIComponent(l).trim().split("="),d=h.join("=");if(c===t)return d}return""}getUserData(){throw we(tt)}setItem(e,t,a,s=!0,l=$0.Lax){let c=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${l};`;if(a){const h=kI(a);c+=`expires=${h};`}(s||l===$0.None)&&(c+="Secure;"),document.cookie=c}async setUserData(){return Promise.reject(we(tt))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(a=>{const s=decodeURIComponent(a).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function kI(n){const e=new Date;return new Date(e.getTime()+n*NI).toUTCString()}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Dl(n,e){const t=n.getItem(fa(e));return t?JSON.parse(t):[]}function Pl(n,e,t){const a=e.getItem(Zi(n,t));if(a){const s=JSON.parse(a);if(s&&s.hasOwnProperty("idToken")&&s.hasOwnProperty("accessToken")&&s.hasOwnProperty("refreshToken"))return s}return{idToken:[],accessToken:[],refreshToken:[]}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function K0(n){return n.hasOwnProperty("id")&&n.hasOwnProperty("nonce")&&n.hasOwnProperty("data")}/*! @azure/msal-browser v4.22.1 2025-09-09 */const rT="msal.cache.encryption",OI="msal.broadcast.cache";class MI{constructor(e,t,a){if(!window.localStorage)throw Xg(zh);this.memoryStorage=new Gh,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=a,this.broadcast=new BroadcastChannel(OI)}async initialize(e){const t=new rS,a=t.getItem(rT);let s={key:"",id:""};if(a)try{s=JSON.parse(a)}catch{}if(s.key&&s.id){const l=_r(Si,Y.Base64Decode,this.logger,this.performanceClient,e)(s.key);this.encryptionCookie={id:s.id,key:await ve(Yy,Y.GenerateHKDF,this.logger,this.performanceClient,e)(l)}}else{const l=Zr(),c=await ve(Y_,Y.GenerateBaseKey,this.logger,this.performanceClient,e)(),h=_r(Ei,Y.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(c));this.encryptionCookie={id:l,key:await ve(Yy,Y.GenerateHKDF,this.logger,this.performanceClient,e)(c)};const d={id:l,key:h};t.setItem(rT,JSON.stringify(d),0,!0,$0.None)}await ve(this.importExistingCache.bind(this),Y.ImportExistingCache,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ue(Ml);return this.memoryStorage.getItem(e)}async decryptData(e,t,a){if(!this.initialized||!this.encryptionCookie)throw Ue(Ml);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},a),null;const s=await ve(Xy,Y.Decrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!s)return null;try{return JSON.parse(s)}catch{return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},a),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,a,s){if(!this.initialized||!this.encryptionCookie)throw Ue(Ml);const{data:l,nonce:c}=await ve(fI,Y.Encrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,t,this.getContext(e)),h={id:this.encryptionCookie.id,nonce:c,data:l,lastUpdatedAt:s};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(h)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),Dl(this).forEach(a=>this.removeItem(a));const t=Pl(this.clientId,this);t.idToken.forEach(a=>this.removeItem(a)),t.accessToken.forEach(a=>this.removeItem(a)),t.refreshToken.forEach(a=>this.removeItem(a)),this.getKeys().forEach(a=>{(a.startsWith(dn)||a.indexOf(this.clientId)!==-1)&&this.removeItem(a)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=Dl(this);t=await this.importArray(t,e),t.length?this.setItem(fa(),JSON.stringify(t)):this.removeItem(fa());const a=Pl(this.clientId,this);a.idToken=await this.importArray(a.idToken,e),a.accessToken=await this.importArray(a.accessToken,e),a.refreshToken=await this.importArray(a.refreshToken,e),a.idToken.length||a.accessToken.length||a.refreshToken.length?this.setItem(Zi(this.clientId),JSON.stringify(a)):this.removeItem(Zi(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const a=this.getItem(e);if(!a)return null;let s;try{s=JSON.parse(a)}catch{return null}return K0(s)?s.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):ve(Xy,Y.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,s.nonce,this.getContext(e),s.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),s)}async importArray(e,t){const a=[],s=[];return e.forEach(l=>{const c=this.getItemFromEncryptedCache(l,t).then(h=>{h?(this.memoryStorage.setItem(l,h),a.push(l)):this.removeItem(l)});s.push(c)}),await Promise.all(s),a}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(Y.LocalStorageUpdated);t.add({isBackground:!0});const{key:a,value:s,context:l}=e.data;if(!a){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(l&&l!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${l}`),t.end({success:!1,errorCode:"contextMismatch"});return}s?(this.memoryStorage.setItem(a,s),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(a),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class DI{constructor(){if(!window.sessionStorage)throw Xg(zh)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const $e={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};/*! @azure/msal-browser v4.22.1 2025-09-09 */function aT(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class V0 extends L0{constructor(e,t,a,s,l,c,h){super(e,a,s,l,h),this.cacheConfig=t,this.logger=s,this.internalStorage=new Gh,this.browserStorage=iT(e,t.cacheLocation,s,l),this.temporaryCacheStorage=iT(e,t.temporaryCacheLocation,s,l),this.cookieStorage=new rS,this.eventHandler=c}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){const t=Dl(this.browserStorage,0),a=Pl(this.clientId,this.browserStorage,0);this.performanceClient.addFields({oldAccountCount:t.length,oldAccessCount:a.accessToken.length,oldIdCount:a.idToken.length,oldRefreshCount:a.refreshToken.length},e);const s=Dl(this.browserStorage,1),l=Pl(this.clientId,this.browserStorage,1);this.performanceClient.addFields({currAccountCount:s.length,currAccessCount:l.accessToken.length,currIdCount:l.idToken.length,currRefreshCount:l.refreshToken.length},e),await Promise.all([this.updateV0ToCurrent(G0,t,s,e),this.updateV0ToCurrent(gi,a.idToken,l.idToken,e),this.updateV0ToCurrent(gi,a.accessToken,l.accessToken,e),this.updateV0ToCurrent(gi,a.refreshToken,l.refreshToken,e)]),t.length>0?this.browserStorage.setItem(fa(0),JSON.stringify(t)):this.browserStorage.removeItem(fa(0)),s.length>0?this.browserStorage.setItem(fa(1),JSON.stringify(s)):this.browserStorage.removeItem(fa(1)),this.setTokenKeys(a,e,0),this.setTokenKeys(l,e,1)}async updateV0ToCurrent(e,t,a,s){const l=[];for(const c of[...t]){const h=this.browserStorage.getItem(c),d=this.validateAndParseJson(h||"");if(!d){aT(t,c);continue}d.lastUpdatedAt||(d.lastUpdatedAt=Date.now().toString(),this.setItem(c,JSON.stringify(d),s));const g=K0(d)?await this.browserStorage.decryptData(c,d,s):d;let p;if(g&&(Ly(g)||Uy(g))&&(p=g.expiresOn),!g||pb(d.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)||p&&ih(p,rx)){this.browserStorage.removeItem(c),aT(t,c),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},s);continue}if(this.cacheConfig.cacheLocation!==sn.LocalStorage||K0(d)){const v=`${dn}.${e}${T0}${c}`,T=this.browserStorage.getItem(v);if(T){const x=this.validateAndParseJson(T);if(Number(d.lastUpdatedAt)>Number(x.lastUpdatedAt)){l.push(this.setUserData(v,JSON.stringify(g),s,d.lastUpdatedAt).then(()=>{this.performanceClient.incrementFields({updatedCacheFromV0Count:1},s)}));continue}}else{l.push(this.setUserData(v,JSON.stringify(g),s,d.lastUpdatedAt).then(()=>{a.push(v),this.performanceClient.incrementFields({upgradedCacheCount:1},s)}));continue}}}return Promise.all(l)}trackVersionChanges(e){const t=this.browserStorage.getItem(Zy);t&&(this.logger.info(`MSAL.js was last initialized by version: ${t}`),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==rs&&this.setItem(Zy,rs,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}setItem(e,t,a){let s=0,l=[];const c=20;for(let h=0;h<=c;h++)try{this.browserStorage.setItem(e,t),h>0&&(h<=s?this.removeAccessTokenKeys(l.slice(0,h),a,0):(this.removeAccessTokenKeys(l.slice(0,s),a,0),this.removeAccessTokenKeys(l.slice(s,h),a)));break}catch(d){const g=F0(d);if(g.errorCode===eh&&h<c){if(!l.length){const p=e===Zi(this.clientId,0)?JSON.parse(t).accessToken:this.getTokenKeys(0).accessToken,v=e===Zi(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken;l=[...p,...v],s=p.length}if(l.length<=h)throw g;this.removeAccessToken(l[h],a,!1)}else throw g}}async setUserData(e,t,a,s){let l=0,c=[];const h=20;for(let d=0;d<=h;d++)try{await ve(this.browserStorage.setUserData.bind(this.browserStorage),Y.SetUserData,this.logger,this.performanceClient)(e,t,a,s),d>0&&(d<=l?this.removeAccessTokenKeys(c.slice(0,d),a,0):(this.removeAccessTokenKeys(c.slice(0,l),a,0),this.removeAccessTokenKeys(c.slice(l,d),a)));break}catch(g){const p=F0(g);if(p.errorCode===eh&&d<h){if(!c.length){const v=this.getTokenKeys(0).accessToken,T=this.getTokenKeys().accessToken;c=[...v,...T],l=v.length}if(c.length<=d)throw p;this.removeAccessToken(c[d],a,!1)}else throw p}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const a=this.browserStorage.getUserData(e);if(!a)return this.removeAccountKeyFromMap(e,t),null;const s=this.validateAndParseJson(a);return!s||!Jr.isAccountEntity(s)?null:L0.toObject(new Jr,s)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const a=this.generateAccountKey(e.getAccountInfo()),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.addAccountKeyToMap(a,t);this.cacheConfig.cacheLocation===sn.LocalStorage&&l&&this.eventHandler.emitEvent($e.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return Dl(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const a=this.getAccountKeys();return a.indexOf(e)===-1?(a.push(e),this.setItem(fa(),JSON.stringify(a),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const a=this.getAccountKeys(),s=a.indexOf(e);if(s>-1){if(a.splice(s,1),a.length===0){this.removeItem(fa());return}else this.setItem(fa(),JSON.stringify(a),t);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const a=this.getActiveAccount(t);a?.homeAccountId===e.homeAccountId&&a?.environment===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(s=>{s.includes(e.homeAccountId)&&s.includes(e.environment)&&this.browserStorage.removeItem(s)}),this.cacheConfig.cacheLocation===sn.LocalStorage&&this.eventHandler.emitEvent($e.ACCOUNT_REMOVED,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const a=this.getTokenKeys(),s=a.idToken.indexOf(e);s>-1&&(this.logger.info("idToken removed from tokenKeys map"),a.idToken.splice(s,1),this.setTokenKeys(a,t))}removeAccessToken(e,t,a=!0){super.removeAccessToken(e,t),a&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t,a=gi){this.logger.trace("removeAccessTokenKey called");const s=this.getTokenKeys(a);let l=0;if(e.forEach(c=>{const h=s.accessToken.indexOf(c);h>-1&&(s.accessToken.splice(h,1),l++)}),l>0){this.logger.info(`removed ${l} accessToken keys from tokenKeys map`),this.setTokenKeys(s,t,a);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const a=this.getTokenKeys(),s=a.refreshToken.indexOf(e);s>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),a.refreshToken.splice(s,1),this.setTokenKeys(a,t))}getTokenKeys(e=gi){return Pl(this.clientId,this.browserStorage,e)}setTokenKeys(e,t,a=gi){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(Zi(this.clientId,a));return}else this.setItem(Zi(this.clientId,a),JSON.stringify(e),t)}getIdTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const s=this.validateAndParseJson(a);return!s||!yb(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),s)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys();l.idToken.indexOf(a)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),l.idToken.push(a),this.setTokenKeys(l,t))}getAccessTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const s=this.validateAndParseJson(a);return!s||!Ly(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),s)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys(),c=l.accessToken.indexOf(a);c!==-1&&l.accessToken.splice(c,1),this.logger.trace(`access token ${c===-1?"added to":"updated in"} map`),l.accessToken.push(a),this.setTokenKeys(l,t)}getRefreshTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const s=this.validateAndParseJson(a);return!s||!Uy(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),s)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys();l.refreshToken.indexOf(a)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),l.refreshToken.push(a),this.setTokenKeys(l,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!Sb(e,a)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),a)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const a=_b(e);this.setItem(a,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!Tb(e,a)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),a)}setServerTelemetry(e,t,a){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),a)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(t);return a&&Cb(e,a)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),a):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(Iu.WRAPPER_SKU,e),this.internalStorage.setItem(Iu.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(Iu.WRAPPER_SKU)||ye.EMPTY_STRING,t=this.internalStorage.getItem(Iu.WRAPPER_VER)||ye.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(Ey.ACTIVE_ACCOUNT_FILTERS),a=this.browserStorage.getItem(t);if(!a)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const s=this.validateAndParseJson(a);return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:s.homeAccountId,localAccountId:s.localAccountId,tenantId:s.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const a=this.generateCacheKey(Ey.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const s={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:rr().toString()};this.setItem(a,JSON.stringify(s),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(a);this.eventHandler.emitEvent($e.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!xb(e,a)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),a)}setThrottlingCache(e,t,a){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),a)}getTemporaryCache(e,t){const a=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const l=this.cookieStorage.getItem(a);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),l}const s=this.temporaryCacheStorage.getItem(a);if(!s){if(this.cacheConfig.cacheLocation===sn.LocalStorage){const l=this.browserStorage.getItem(a);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),l}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,a){const s=a?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(t=>{(t.indexOf(dn)!==-1||t.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(t)}),this.browserStorage.getKeys().forEach(t=>{(t.indexOf(dn)!==-1||t.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(t)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(Y.ClearTokensAndKeysWithClaims,e);const t=this.getTokenKeys();let a=0;t.accessToken.forEach(s=>{const l=this.getAccessTokenCredential(s,e);l?.requestedClaimsHash&&s.includes(l.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(s,e),a++)}),a>0&&this.logger.warning(`${a} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return xr.startsWith(e,dn)?e:`${dn}.${this.clientId}.${e}`}generateCredentialKey(e){const t=e.credentialType===An.REFRESH_TOKEN&&e.familyId||e.clientId,a=e.tokenType&&e.tokenType.toLowerCase()!==Tt.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return[`${dn}.${gi}`,e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",a].join(T0).toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return[`${dn}.${G0}`,e.homeAccountId,e.environment,t||e.tenantId||""].join(T0).toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Jt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Jt.VERIFIER)),this.removeTemporaryItem(this.generateCacheKey(Jt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Jt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Jt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const a=ql(JSON.stringify(e));if(this.setTemporaryCache(Jt.REQUEST_PARAMS,a,!0),t){const s=ql(t);this.setTemporaryCache(Jt.VERIFIER,s,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Jt.REQUEST_PARAMS,!0);if(!e)throw Ue(b_);const t=this.getTemporaryCache(Jt.VERIFIER,!0);let a,s="";try{a=JSON.parse(Wr(e)),t&&(s=Wr(t))}catch(l){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${l}`),Ue(I_)}return[a,s]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Jt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${dn}.${Jt.INTERACTION_STATUS_KEY}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch{return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),J_(window),null}}setInteractionInProgress(e,t=mi.SIGNIN){const a=`${dn}.${Jt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Ue(T_);this.setTemporaryCache(a,JSON.stringify({clientId:this.clientId,type:t}),!1)}else!e&&this.getInteractionInProgress()?.clientId===this.clientId&&this.removeTemporaryItem(a)}async hydrateCache(e,t){const a=Dh(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const l=Ph(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?Fy(e.expiresOn):0,e.extExpiresOn?Fy(e.extExpiresOn):0,Wr,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),c={idToken:a,accessToken:l};return this.saveCacheRecord(c,e.correlationId)}async saveCacheRecord(e,t,a){try{await super.saveCacheRecord(e,t,a)}catch(s){if(s instanceof ro&&this.performanceClient&&t)try{const l=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:l.refreshToken.length,cacheIdCount:l.idToken.length,cacheAtCount:l.accessToken.length},t)}catch{}throw s}}}function iT(n,e,t,a){try{switch(e){case sn.LocalStorage:return new MI(n,t,a);case sn.SessionStorage:return new DI;case sn.MemoryStorage:default:break}}catch(s){t.error(s)}return new Gh}const PI=(n,e,t,a)=>{const s={cacheLocation:sn.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:sn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new V0(n,s,Qu,e,t,a)};/*! @azure/msal-browser v4.22.1 2025-09-09 */function FI(n,e,t,a,s){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(s||{},a):[]}function LI(n,e,t,a){const s=t.getAccountInfoFilteredBy(n,a);return s?(e.verbose("getAccount: Account matching provided filter found, returning"),s):(e.verbose("getAccount: No matching account found, returning null"),null)}function UI(n,e,t,a){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const s=t.getAccountInfoFilteredBy({username:n},a);return s?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),s):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function BI(n,e,t,a){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const s=t.getAccountInfoFilteredBy({homeAccountId:n},a);return s?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),s):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function HI(n,e,t,a){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const s=t.getAccountInfoFilteredBy({localAccountId:n},a);return s?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),s):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function jI(n,e,t){e.setActiveAccount(n,t)}function zI(n,e){return n.getActiveAccount(e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const GI="msal.broadcast.event";class $I{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Ci({}),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(GI)),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,a){if(typeof window<"u"){const s=a||TI();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,a,s){const l={eventType:e,interactionType:t||null,payload:a||null,error:s||null,timestamp:Date.now()};switch(e){case $e.ACCOUNT_ADDED:case $e.ACCOUNT_REMOVED:case $e.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(l);break;default:this.invokeCallbacks(l);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,a],s)=>{(a.length===0||a.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${s}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class aS{constructor(e,t,a,s,l,c,h,d,g){this.config=e,this.browserStorage=t,this.browserCrypto=a,this.networkClient=this.config.system.networkClient,this.eventHandler=l,this.navigationClient=c,this.platformAuthProvider=d,this.correlationId=g||Zr(),this.logger=s.clone(er.MSAL_SKU,rs,this.correlationId),this.performanceClient=h}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return ft.getAbsoluteUrl(t,Pa())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const a={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Kl(a,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,a=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(Y.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},l=e.requestAuthority||this.config.auth.authority,c=a?.length?a==="true":this.config.auth.instanceAware,h=t&&c?this.config.auth.authority.replace(ft.getDomainFromUrl(l),t.environment):l,d=Pn.generateAuthority(h,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),g=await ve(a_,Y.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(d,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!g.isAlias(t.environment))throw Dt(Mx);return g}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function em(n,e,t,a){t.addQueueMeasurement(Y.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,l=[...n&&n.scopes||[]],c={...n,correlationId:n.correlationId,authority:s,scopes:l};if(!c.authenticationScheme)c.authenticationScheme=Tt.BEARER,a.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(c.authenticationScheme===Tt.SSH){if(!n.sshJwk)throw Dt(Nh);if(!n.sshKid)throw Dt(Nx)}a.verbose(`Authentication Scheme set to "${c.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!xr.isEmptyObj(n.claims)&&(c.requestedClaimsHash=await W_(n.claims)),c}async function KI(n,e,t,a,s){a.addQueueMeasurement(Y.InitializeSilentRequest,n.correlationId);const l=await ve(em,Y.InitializeBaseRequest,s,a,n.correlationId)(n,t,a,s);return{...n,...l,account:e,forceRefresh:n.forceRefresh||!1}}function iS(n,e){let t;const a=n.httpMethod;if(e===tr.EAR){if(t=a||Ji.POST,t!==Ji.POST)throw Dt(Dx)}else t=a||Ji.GET;if(n.authorizePostBodyParameters&&t!==Ji.POST)throw Dt(Px);return t}/*! @azure/msal-browser v4.22.1 2025-09-09 */class To extends aS{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||Zr(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const a=this.getLogoutHintFromIdTokenClaims(e.account);a&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=a)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=ft.getAbsoluteUrl(e.postLogoutRedirectUri,Pa())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=ft.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Pa())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=ft.getAbsoluteUrl(Pa(),Pa())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(Y.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await ve(this.getClientConfiguration.bind(this),Y.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new c_(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:a,requestAzureCloudOptions:s,requestExtraQueryParameters:l,account:c}=e;this.performanceClient.addQueueMeasurement(Y.StandardInteractionClientGetClientConfiguration,this.correlationId);const h=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:a,requestAzureCloudOptions:s,requestExtraQueryParameters:l,account:c}),d=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:h,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:d.loggerCallback,piiLoggingEnabled:d.piiLoggingEnabled,logLevel:d.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:er.MSAL_SKU,version:rs,cpu:ye.EMPTY_STRING,os:ye.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(Y.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const a=this.getRedirectUri(e.redirectUri),s={interactionType:t},l=vo.setRequestState(this.browserCrypto,e&&e.state||ye.EMPTY_STRING,s),h={...await ve(em,Y.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:a,state:l,nonce:e.nonce||Zr(),responseMode:this.config.auth.OIDCOptions.serverResponseType},d={...h,httpMethod:iS(h,this.config.auth.protocolMode)};if(e.loginHint||e.sid)return d;const g=e.account||this.browserStorage.getActiveAccount(this.correlationId);return g&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${g.homeAccountId}`,this.correlationId),d.account=g),d}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function VI(n,e){if(!e)return null;try{return vo.parseRequestState(n,e).libraryState.meta}catch{throw we(uo)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Fl(n,e,t){const a=Ju(n);if(!a)throw Lx(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Ue(p_)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Ue(m_));return a}function qI(n,e,t){if(!n.state)throw Ue(Ug);const a=VI(e,n.state);if(!a)throw Ue(v_);if(a.interactionType!==t)throw Ue(y_)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class sS{constructor(e,t,a,s,l){this.authModule=e,this.browserStorage=t,this.authCodeRequest=a,this.logger=s,this.performanceClient=l}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(Y.HandleCodeResponse,t.correlationId);let a;try{a=Ub(e,t.state)}catch(s){throw s instanceof ls&&s.subError===Vl?Ue(Vl):s}return ve(this.handleCodeResponseFromServer.bind(this),Y.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(a,t)}async handleCodeResponseFromServer(e,t,a=!0){if(this.performanceClient.addQueueMeasurement(Y.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await ve(this.authModule.updateAuthority.bind(this.authModule),Y.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),a&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const l=this.createCcsCredentials(t);l&&(this.authCodeRequest.ccsCredential=l)}return await ve(this.authModule.acquireToken.bind(this.authModule),Y.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Yr.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Yr.UPN}:null}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const YI="ContentError",oS="user_switch";/*! @azure/msal-browser v4.22.1 2025-09-09 */const XI="USER_INTERACTION_REQUIRED",WI="USER_CANCEL",QI="NO_NETWORK",JI="DISABLED",ZI="ACCOUNT_UNAVAILABLE",eR="UX_NOT_ALLOWED";/*! @azure/msal-browser v4.22.1 2025-09-09 */const tR=-2147186943,nR={[oS]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class ga extends Nt{constructor(e,t,a){super(e,t),Object.setPrototypeOf(this,ga.prototype),this.name="NativeAuthError",this.ext=a}}function eo(n){if(n.ext&&n.ext.status&&n.ext.status===JI||n.ext&&n.ext.error&&n.ext.error===tR)return!0;switch(n.errorCode){case YI:return!0;default:return!1}}function hh(n,e,t){if(t&&t.status)switch(t.status){case ZI:return oh(s_);case XI:return new Lr(n,e);case WI:return Ue(Vl);case QI:return Ue(lh);case eR:return oh(kg)}return new ga(n,nR[n]||e,t)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class lS extends To{async acquireToken(e){this.performanceClient.addQueueMeasurement(Y.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Rt.acquireTokenSilent_silentFlow),a=await ve(this.getClientConfiguration.bind(this),Y.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new Pb(a,this.performanceClient);this.logger.verbose("Silent auth client created");try{const c=(await ve(s.acquireCachedToken.bind(s),Y.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),c}catch(l){throw l instanceof nc&&l.errorCode===Bg&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),l}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,t?.account)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Vu extends aS{constructor(e,t,a,s,l,c,h,d,g,p,v,T){super(e,t,a,s,l,c,d,g,T),this.apiId=h,this.accountId=p,this.platformAuthProvider=g,this.nativeStorageManager=v,this.silentCacheClient=new lS(e,this.nativeStorageManager,a,s,l,c,d,g,T);const x=this.platformAuthProvider.getExtensionName();this.skus=Kl.makeExtraSkuString({libraryName:er.MSAL_SKU,libraryVersion:rs,extensionName:x,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[W2]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(Y.NativeInteractionClientAcquireToken,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const a=this.performanceClient.startMeasurement(Y.NativeInteractionClientAcquireToken,this.correlationId),s=rr(),l=this.initializeServerTelemetryManager(this.apiId);try{const c=await this.initializeNativeRequest(e);try{const d=await this.acquireTokensFromCache(this.accountId,c);return a.end({success:!0,isNativeBroker:!1,fromCache:!0}),d}catch(d){if(t===$n.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),a.end({success:!1,brokerErrorCode:"cache_request_failed"}),d;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const h=await this.platformAuthProvider.sendMessage(c);return await this.handleNativeResponse(h,c,s).then(d=>(a.end({success:!0,isNativeBroker:!0,requestId:d.requestId}),l.clearNativeBrokerErrorCode(),d)).catch(d=>{throw a.end({success:!1,errorCode:d.errorCode,subErrorCode:d.subError}),d})}catch(c){throw c instanceof ga&&l.setNativeBrokerErrorCode(c.errorCode),a.end({success:!1}),c}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:an.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),we(D0);const a=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!a)throw we(D0);try{const s=this.createSilentCacheRequest(t,a),l=await this.silentCacheClient.acquireToken(s),c={...a,idTokenClaims:l?.idTokenClaims,idToken:l?.idToken};return{...l,account:c}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...a}=e;delete a.onRedirectNavigate;const s=await this.initializeNativeRequest(a);try{await this.platformAuthProvider.sendMessage(s)}catch(h){if(h instanceof ga&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(h.errorCode),eo(h)))throw h}this.browserStorage.setTemporaryCache(Jt.NATIVE_REQUEST,JSON.stringify(s),!0);const l={apiId:Rt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},c=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(c,l)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const a=this.browserStorage.getCachedNativeRequest();if(!a)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:s,...l}=a;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Jt.NATIVE_REQUEST));const c=rr();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const h=await this.platformAuthProvider.sendMessage(l),d=await this.handleNativeResponse(h,l,c);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),d}catch(h){throw h}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,a){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=po(e.id_token,Wr),l=this.createHomeAccountIdentifier(e,s),c=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(l!==c&&e.account.id!==t.accountId)throw hh(oS);const h=await this.getDiscoveredAuthority({requestAuthority:t.authority}),d=Og(this.browserStorage,h,l,Wr,this.correlationId,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const g=await this.generateAuthenticationResult(e,t,s,d,h.canonicalAuthority,a);return await this.cacheAccount(d,this.correlationId),await this.cacheNativeTokens(e,t,l,s,e.access_token,g.tenantId,a),g}createHomeAccountIdentifier(e,t){return Jr.generateHomeAccountId(e.client_info||ye.EMPTY_STRING,Vr.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?an.fromString(t):an.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===Tt.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const a=new ho(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw we(sg);return a.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,a,s,l,c){const h=this.addTelemetryFromNativeResponse(e.properties.MATS),d=this.generateScopes(t.scope,e.scope),g=e.account.properties||{},p=g.UID||a.oid||a.sub||ye.EMPTY_STRING,v=g.TenantId||a.tid||ye.EMPTY_STRING,T=mg(s.getAccountInfo(),void 0,a,e.id_token);T.nativeAccountId!==e.account.id&&(T.nativeAccountId=e.account.id);const x=await this.generatePopAccessToken(e,t),C=t.tokenType===Tt.POP?Tt.POP:Tt.BEARER;return{authority:l,uniqueId:p,tenantId:v,scopes:d.asArray(),account:T,idToken:e.id_token,idTokenClaims:a,accessToken:x,fromCache:h?this.isResponseFromCache(h):!1,expiresOn:io(c+e.expires_in),tokenType:C,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e.getAccountInfo(),t)}cacheNativeTokens(e,t,a,s,l,c,h){const d=Dh(a,t.authority,e.id_token||"",t.clientId,s.tid||""),g=t.tokenType===Tt.POP?ye.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,p=h+g,v=this.generateScopes(e.scope,t.scope),T=Ph(a,t.authority,l,t.clientId,s.tid||c,v.printScopes(),p,0,Wr,void 0,t.tokenType,void 0,t.keyId),x={idToken:d,accessToken:T};return this.nativeStorageManager.saveCacheRecord(x,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===Tt.POP?ye.SHR_NONCE_VALIDITY:(typeof t=="string"?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:a,...s}=e,l=new an(a||[]);l.appendScopes(mo);const c={...s,accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:l.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(c.signPopToken&&e.popKid)throw Ue(H_);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=Fr.MATS_TELEMETRY,e.authenticationScheme===Tt.POP){const h={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},d=new ho(this.browserCrypto);let g;if(c.keyId)g=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{const p=await ve(d.generateCnf.bind(d),Y.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(h,this.logger);g=p.reqCnfString,c.keyId=p.kid,c.signPopToken=!0}c.reqCnf=g}return this.addRequestSKUs(c),c}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const a=new ft(t);return a.validateAsUri(),a}getPrompt(e){switch(this.apiId){case Rt.ssoSilent:case Rt.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Yn.NONE}if(!e){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e){case Yn.NONE:case Yn.CONSENT:case Yn.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),Ue(U_)}}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(nh)&&e.extraParameters.hasOwnProperty(rh)&&e.extraParameters.hasOwnProperty(ts);if(!e.embeddedClientId&&!t)return;let a="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,a=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[rh],a=e.extraParameters[ts]),e.extraParameters={child_client_id:a,child_redirect_uri:s},this.performanceClient?.addFields({embeddedClientId:a,embeddedRedirectUri:s},this.correlationId)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function tm(n,e,t,a,s){const l=Lb({...n.auth,authority:e},t,a,s);if(Eg(l,{sku:er.MSAL_SKU,version:rs,os:"",cpu:""}),n.auth.protocolMode!==tr.OIDC&&Ag(l,n.telemetry.application),t.platformBroker&&(eb(l),s.addFields({isPlatformAuthorizeRequest:!0},t.correlationId),t.authenticationScheme===Tt.POP)){const c=new Ba(a,s),h=new ho(c);let d;t.popKid?d=c.encodeKid(t.popKid):d=(await ve(h.generateCnf.bind(h),Y.PopTokenGenerateCnf,a,s,t.correlationId)(t,a)).reqCnfString,bg(l,d)}return kh(l,t.correlationId,s),l}async function nm(n,e,t,a,s){if(!t.codeChallenge)throw Dt(hg);const l=await ve(tm,Y.GetStandardParams,a,s,t.correlationId)(n,e,t,a,s);return yg(l,Z0.CODE),qx(l,t.codeChallenge,ye.S256_CODE_CHALLENGE_METHOD),_i(l,t.extraQueryParameters||{}),Mg(e,l,n.auth.encodeExtraQueryParams,t.extraQueryParameters)}async function rm(n,e,t,a,s,l){if(!a.earJwk)throw Ue(Lg);const c=await tm(e,t,a,s,l);yg(c,Z0.IDTOKEN_TOKEN_REFRESHTOKEN),hb(c,a.earJwk);const h=new Map;_i(h,a.extraQueryParameters||{});const d=Mg(t,h,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return cS(n,d,c)}async function am(n,e,t,a,s,l){const c=await tm(e,t,a,s,l);yg(c,Z0.CODE),qx(c,a.codeChallenge,a.codeChallengeMethod||ye.S256_CODE_CHALLENGE_METHOD),fb(c,a.authorizePostBodyParameters||{});const h=new Map;_i(h,a.extraQueryParameters||{});const d=Mg(t,h,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return cS(n,d,c)}function cS(n,e,t){const a=n.createElement("form");return a.method="post",a.action=e,t.forEach((s,l)=>{const c=n.createElement("input");c.hidden=!0,c.name=l,c.value=s,a.appendChild(c)}),n.body.appendChild(a),a}async function uS(n,e,t,a,s,l,c,h,d,g){if(h.verbose("Account id found, calling WAM for token"),!g)throw Ue(jg);const p=new Ba(h,d),v=new Vu(a,s,p,h,c,a.system.navigationClient,t,d,g,e,l,n.correlationId),{userRequestState:T}=vo.parseRequestState(p,n.state);return ve(v.acquireToken.bind(v),Y.NativeInteractionClientAcquireToken,h,d,n.correlationId)({...n,state:T,prompt:void 0})}async function fh(n,e,t,a,s,l,c,h,d,g,p,v){if(da.removeThrottle(c,s.auth.clientId,n),e.accountId)return ve(uS,Y.HandleResponsePlatformBroker,g,p,n.correlationId)(n,e.accountId,a,s,c,h,d,g,p,v);const T={...n,code:e.code||"",codeVerifier:t},x=new sS(l,c,T,g,p);return await ve(x.handleCodeResponse.bind(x),Y.HandleCodeResponse,g,p,n.correlationId)(e,n)}async function im(n,e,t,a,s,l,c,h,d,g,p){if(da.removeThrottle(l,a.auth.clientId,n),u_(e,n.state),!e.ear_jwe)throw Ue(g_);if(!n.earJwk)throw Ue(Lg);const v=JSON.parse(await ve(hI,Y.DecryptEarResponse,d,g,n.correlationId)(n.earJwk,e.ear_jwe));if(v.accountId)return ve(uS,Y.HandleResponsePlatformBroker,d,g,n.correlationId)(n,v.accountId,t,a,l,c,h,d,g,p);const T=new ns(a.auth.clientId,l,new Ba(d,g),d,null,null,g);T.validateTokenResponse(v);const x={code:"",state:n.state,nonce:n.nonce,client_info:v.client_info,cloud_graph_host_name:v.cloud_graph_host_name,cloud_instance_host_name:v.cloud_instance_host_name,cloud_instance_name:v.cloud_instance_name,msgraph_host:v.msgraph_host};return await ve(T.handleServerTokenResponse.bind(T),Y.HandleServerTokenResponse,d,g,n.correlationId)(v,s,rr(),n,x,void 0,void 0,void 0,void 0)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const rR=32;async function $h(n,e,t){n.addQueueMeasurement(Y.GeneratePkceCodes,t);const a=_r(aR,Y.GenerateCodeVerifier,e,n,t)(n,e,t),s=await ve(iR,Y.GenerateCodeChallengeFromVerifier,e,n,t)(a,n,e,t);return{verifier:a,challenge:s}}function aR(n,e,t){try{const a=new Uint8Array(rR);return _r(sI,Y.GetRandomValues,e,n,t)(a),Ei(a)}catch{throw Ue(Fg)}}async function iR(n,e,t,a){e.addQueueMeasurement(Y.GenerateCodeChallengeFromVerifier,a);try{const s=await ve(q_,Y.Sha256Digest,t,e,a)(n,e,a);return Ei(new Uint8Array(s))}catch{throw Ue(Fg)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class dh{constructor(e,t,a,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=a,this.handshakeEvent=a.startMeasurement(Y.NativeMessageHandlerHandshake),this.platformAuthType=Fr.PLATFORM_EXTENSION_PROVIDER}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:Al.GetToken,request:e},a={channel:Fr.CHANNEL_ID,extensionId:this.extensionId,responseId:Zr(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(a)}`),this.messageChannel.port1.postMessage(a);const s=await new Promise((c,h)=>{this.resolvers.set(a.responseId,{resolve:c,reject:h})});return this.validatePlatformBrokerResponse(s)}static async createProvider(e,t,a){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const s=new dh(e,t,a,Fr.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const l=new dh(e,t,a);return await l.sendHandshakeRequest(),l}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Fr.CHANNEL_ID,extensionId:this.extensionId,responseId:Zr(),body:{method:Al.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,a)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:a}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),a(Ue(F_)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Fr.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Al.HandshakeRequest){const a=this.handshakeResolvers.get(t.responseId);if(!a){this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),a.reject(Ue(L_))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,a=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const l=t.body.method;if(l===Al.Response){if(!a)return;const c=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(c)}`),c.status!=="Success")a.reject(hh(c.code,c.description,c.ext));else if(c.result)c.result.code&&c.result.description?a.reject(hh(c.result.code,c.result.description,c.result.ext)):a.resolve(c.result);else throw k0(Wu,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(l===Al.HandshakeResponse){if(!s){this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(l){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${l}`),this.logger.errorPii(`Unable to parse ${e}`),a?a.reject(l):s&&s.reject(l)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw k0(Wu,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===Fr.PREFERRED_EXTENSION_ID?"chrome":this.getExtensionId()?.length?"unknown":void 0}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class sm{constructor(e,t,a){this.logger=e,this.performanceClient=t,this.correlationId=a,this.platformAuthType=Fr.PLATFORM_DOM_PROVIDER}static async createProvider(e,t,a){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication&&(await window.navigator.platformAuthentication.getSupportedContracts(Fr.MICROSOFT_ENTRA_BROKERID))?.includes(Fr.PLATFORM_DOM_APIS))return e.trace("Platform auth api available in DOM"),new sm(e,t,a)}getExtensionId(){return Fr.MICROSOFT_ENTRA_BROKERID}getExtensionVersion(){return""}getExtensionName(){return Fr.DOM_API_NAME}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),a=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(a)}catch(t){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),t}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:a,authority:s,scope:l,redirectUri:c,correlationId:h,state:d,storeInCache:g,embeddedClientId:p,extraParameters:v,...T}=e,x=this.getDOMExtraParams(T);return{accountId:t,brokerId:this.getExtensionId(),authority:s,clientId:a,correlationId:h||this.correlationId,extraParameters:{...v,...x},isSecurityTokenService:!1,redirectUri:c,scope:l,state:d,storeInCache:g,embeddedClientId:p}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(t.isSuccess===!1&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),hh(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw k0(Wu,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((s,[l,c])=>(s[l]=String(c),s),{})}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function sR(n,e,t,a){n.trace("getPlatformAuthProvider called",t);const s=oR();n.trace("Has client allowed platform auth via DOM API: "+s);let l;try{s&&(l=await sm.createProvider(n,e,t)),l||(n.trace("Platform auth via DOM API not available, checking for extension"),l=await dh.createProvider(n,a||nS,e))}catch(c){n.trace("Platform auth not available",c)}return l}function oR(){let n;try{return n=window[sn.SessionStorage],n?.getItem(bI)==="true"}catch{return!1}}function Yl(n,e,t,a){if(e.trace("isPlatformAuthAllowed called"),!n.system.allowPlatformBroker)return e.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!t)return e.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(a)switch(a){case Tt.BEARER:case Tt.POP:return e.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return e.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}/*! @azure/msal-browser v4.22.1 2025-09-09 */class lR extends To{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,h,g,p),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=d,this.eventHandler=l}acquireToken(e,t){let a;try{if(a={popupName:this.generatePopupName(e.scopes||mo,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,a,t);{const l={...e,httpMethod:iS(e,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),a.popup=this.openSizedPopup("about:blank",a),this.acquireTokenPopupAsync(l,a,t)}}catch(s){return Promise.reject(s)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),a={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},s=e&&e.authority,l=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,a,s,l)):(this.logger.verbose("asyncPopup set to false, opening popup"),a.popup=this.openSizedPopup("about:blank",a),this.logoutPopupAsync(t,a,s,l))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,a){this.logger.verbose("acquireTokenPopupAsync called");const s=await ve(this.initializeAuthorizationRequest.bind(this),Y.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qe.Popup);t.popup&&tS(s.authority);const l=Yl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return s.platformBroker=l,this.config.auth.protocolMode===tr.EAR?this.executeEarFlow(s,t):this.executeCodeFlow(s,t,a)}async executeCodeFlow(e,t,a){const s=e.correlationId,l=this.initializeServerTelemetryManager(Rt.acquireTokenPopup),c=a||await ve($h,Y.GeneratePkceCodes,this.logger,this.performanceClient,s)(this.performanceClient,this.logger,s),h={...e,codeChallenge:c.challenge};try{const d=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,s)({serverTelemetryManager:l,requestAuthority:h.authority,requestAzureCloudOptions:h.azureCloudOptions,requestExtraQueryParameters:h.extraQueryParameters,account:h.account});if(h.httpMethod===Ji.POST)return await this.executeCodeFlowWithPost(h,t,d,c.verifier);{const g=await ve(nm,Y.GetAuthCodeUrl,this.logger,this.performanceClient,s)(this.config,d.authority,h,this.logger,this.performanceClient),p=this.initiateAuthRequest(g,t);this.eventHandler.emitEvent($e.POPUP_OPENED,qe.Popup,{popupWindow:p},null);const v=await this.monitorPopupForHash(p,t.popupWindowParent),T=_r(Fl,Y.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(v,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await ve(fh,Y.HandleResponseCode,this.logger,this.performanceClient,s)(e,T,c.verifier,Rt.acquireTokenPopup,this.config,d,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(d){throw t.popup?.close(),d instanceof Nt&&(d.setCorrelationId(this.correlationId),l.cacheFailedRequest(d)),d}}async executeEarFlow(e,t){const a=e.correlationId,s=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,a)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),l=await ve(Vg,Y.GenerateEarKey,this.logger,this.performanceClient,a)(),c={...e,earJwk:l},h=t.popup||this.openPopup("about:blank",t);(await rm(h.document,this.config,s,c,this.logger,this.performanceClient)).submit();const g=await ve(this.monitorPopupForHash.bind(this),Y.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(h,t.popupWindowParent),p=_r(Fl,Y.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);return ve(im,Y.HandleResponseEar,this.logger,this.performanceClient,a)(c,p,Rt.acquireTokenPopup,this.config,s,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,a,s){const l=e.correlationId,c=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,l)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),h=t.popup||this.openPopup("about:blank",t);(await am(h.document,this.config,c,e,this.logger,this.performanceClient)).submit();const g=await ve(this.monitorPopupForHash.bind(this),Y.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,l)(h,t.popupWindowParent),p=_r(Fl,Y.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);return ve(fh,Y.HandleResponseCode,this.logger,this.performanceClient,l)(e,p,s,Rt.acquireTokenPopup,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,a,s){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent($e.LOGOUT_START,qe.Popup,e);const l=this.initializeServerTelemetryManager(Rt.logoutPopup);try{await this.clearCacheOnLogout(this.correlationId,e.account);const c=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:l,requestAuthority:a,account:e.account||void 0});try{c.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===tr.OIDC){if(this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Popup,e),s){const g={apiId:Rt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ft.getAbsoluteUrl(s,Pa());await this.navigationClient.navigateInternal(p,g)}t.popup?.close();return}}const h=c.getLogoutUri(e);this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Popup,e);const d=this.openPopup(h,t);if(this.eventHandler.emitEvent($e.POPUP_OPENED,qe.Popup,{popupWindow:d},null),await this.monitorPopupForHash(d,t.popupWindowParent).catch(()=>{}),s){const g={apiId:Rt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=ft.getAbsoluteUrl(s,Pa());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${p}`),await this.navigationClient.navigateInternal(p,g)}else this.logger.verbose("No main window navigation requested")}catch(c){throw t.popup?.close(),c instanceof Nt&&(c.setCorrelationId(this.correlationId),l.cacheFailedRequest(c)),this.eventHandler.emitEvent($e.LOGOUT_FAILURE,qe.Popup,null,c),this.eventHandler.emitEvent($e.LOGOUT_END,qe.Popup),c}this.eventHandler.emitEvent($e.LOGOUT_END,qe.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ue(Bh)}monitorPopupForHash(e,t){return new Promise((a,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const l=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(l),s(Ue(Vl));return}let c="";try{c=e.location.href}catch{}if(!c||c==="about:blank")return;clearInterval(l);let h="";const d=this.config.auth.OIDCOptions.serverResponseType;e&&(d===Rh.QUERY?h=e.location.search:h=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a(h)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let a;if(t.popup?(a=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),a.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),a=this.openSizedPopup(e,t)),!a)throw Ue(__);return a.focus&&a.focus(),this.currentWindow=a,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),a}catch(a){throw this.logger.error("error opening popup "+a.message),Ue(x_)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:a,popupWindowParent:s}){const l=s.screenLeft?s.screenLeft:s.screenX,c=s.screenTop?s.screenTop:s.screenY,h=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let g=a.popupSize?.width,p=a.popupSize?.height,v=a.popupPosition?.top,T=a.popupPosition?.left;return(!g||g<0||g>h)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),g=er.POPUP_WIDTH),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),p=er.POPUP_HEIGHT),(!v||v<0||v>d)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),v=Math.max(0,d/2-er.POPUP_HEIGHT/2+c)),(!T||T<0||T>h)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),T=Math.max(0,h/2-er.POPUP_WIDTH/2+l)),s.open(e,t,`width=${g}, height=${p}, top=${v}, left=${T}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${er.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${er.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function cR(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation");return(n.length?n[0]:void 0)?.type}class uR extends To{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,h,g,p),this.nativeStorage=d}async acquireToken(e){const t=await ve(this.initializeAuthorizationRequest.bind(this),Y.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qe.Redirect);t.platformBroker=Yl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const a=l=>{l.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent($e.RESTORE_FROM_BFCACHE,qe.Redirect))},s=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${s}`),this.browserStorage.setTemporaryCache(Jt.ORIGIN_URI,s,!0),window.addEventListener("pageshow",a);try{this.config.auth.protocolMode===tr.EAR?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(l){throw l instanceof Nt&&l.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",a),l}}async executeCodeFlow(e,t){const a=e.correlationId,s=this.initializeServerTelemetryManager(Rt.acquireTokenRedirect),l=await ve($h,Y.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),c={...e,codeChallenge:l.challenge};this.browserStorage.cacheAuthorizeRequest(c,l.verifier);try{if(c.httpMethod===Ji.POST)return await this.executeCodeFlowWithPost(c);{const h=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:c.authority,requestAzureCloudOptions:c.azureCloudOptions,requestExtraQueryParameters:c.extraQueryParameters,account:c.account}),d=await ve(nm,Y.GetAuthCodeUrl,this.logger,this.performanceClient,e.correlationId)(this.config,h.authority,c,this.logger,this.performanceClient);return await this.initiateAuthRequest(d,t)}}catch(h){throw h instanceof Nt&&(h.setCorrelationId(this.correlationId),s.cacheFailedRequest(h)),h}}async executeEarFlow(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=await ve(Vg,Y.GenerateEarKey,this.logger,this.performanceClient,t)(),l={...e,earJwk:s};return this.browserStorage.cacheAuthorizeRequest(l),(await rm(document,this.config,a,l,this.logger,this.performanceClient)).submit(),new Promise((h,d)=>{setTimeout(()=>{d(Ue(ch,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return this.browserStorage.cacheAuthorizeRequest(e),(await am(document,this.config,a,e,this.logger,this.performanceClient)).submit(),new Promise((l,c)=>{setTimeout(()=>{c(Ue(ch,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(e="",t,a,s){const l=this.initializeServerTelemetryManager(Rt.handleRedirectPromise);try{const[c,h]=this.getRedirectResponse(e||"");if(!c)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),cR()!=="back_forward"?s.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const d=this.browserStorage.getTemporaryCache(Jt.ORIGIN_URI,!0)||ye.EMPTY_STRING,g=Ny(d),p=Ny(window.location.href);if(g===p&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),d.indexOf("#")>-1&&dI(d),await this.handleResponse(c,t,a,l);if(this.config.auth.navigateToLoginRequestUrl){if(!Wg()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Jt.URL_HASH,h,!0);const v={apiId:Rt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let T=!0;if(!d||d==="null"){const x=mI();this.browserStorage.setTemporaryCache(Jt.ORIGIN_URI,x,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),T=await this.navigationClient.navigateInternal(x,v)}else this.logger.verbose(`Navigating to loginRequestUrl: ${d}`),T=await this.navigationClient.navigateInternal(d,v);if(!T)return await this.handleResponse(c,t,a,l)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(c,t,a,l);return null}catch(c){throw c instanceof Nt&&(c.setCorrelationId(this.correlationId),l.cacheFailedRequest(c)),c}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===Rh.QUERY?t=window.location.search:t=window.location.hash);let a=Ju(t);if(a){try{qI(a,this.browserCrypto,qe.Redirect)}catch(l){return l instanceof Nt&&this.logger.error(`Interaction type validation failed due to ${l.errorCode}: ${l.errorMessage}`),[null,""]}return J_(window),this.logger.verbose("Hash contains known properties, returning response hash"),[a,t]}const s=this.browserStorage.getTemporaryCache(Jt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Jt.URL_HASH)),s&&(a=Ju(s),a)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[a,s]):[null,""]}async handleResponse(e,t,a,s){if(!e.state)throw Ue(Ug);if(e.ear_jwe){const h=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return ve(im,Y.HandleResponseEar,this.logger,this.performanceClient,t.correlationId)(t,e,Rt.acquireTokenRedirect,this.config,h,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const c=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:t.authority});return ve(fh,Y.HandleResponseCode,this.logger,this.performanceClient,t.correlationId)(t,e,a,Rt.acquireTokenRedirect,this.config,c,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const a={apiId:Rt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=t||this.config.auth.onRedirectNavigate;if(typeof s=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),s(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await this.navigationClient.navigateExternal(e,a);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await this.navigationClient.navigateExternal(e,a);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ue(Bh)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),a=this.initializeServerTelemetryManager(Rt.logout);try{this.eventHandler.emitEvent($e.LOGOUT_START,qe.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const s={apiId:Rt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},l=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(l.authority.protocolMode===tr.OIDC)try{l.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Redirect,t);return}}const c=l.getLogoutUri(t);if(this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(c)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,mi.SIGNOUT),await this.navigationClient.navigateExternal(c,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,mi.SIGNOUT),await this.navigationClient.navigateExternal(c,s);return}}catch(s){throw s instanceof Nt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),this.eventHandler.emitEvent($e.LOGOUT_FAILURE,qe.Redirect,null,s),this.eventHandler.emitEvent($e.LOGOUT_END,qe.Redirect),s}this.eventHandler.emitEvent($e.LOGOUT_END,qe.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return ft.getAbsoluteUrl(t,Pa())}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function hR(n,e,t,a,s){if(e.addQueueMeasurement(Y.SilentHandlerInitiateAuthRequest,a),!n)throw t.info("Navigate url is empty"),Ue(Bh);return s?ve(gR,Y.SilentHandlerLoadFrame,t,e,a)(n,s,e,a):_r(mR,Y.SilentHandlerLoadFrameSync,t,e,a)(n)}async function fR(n,e,t,a,s){const l=Kh();if(!l.contentDocument)throw"No document associated with iframe!";return(await am(l.contentDocument,n,e,t,a,s)).submit(),l}async function dR(n,e,t,a,s){const l=Kh();if(!l.contentDocument)throw"No document associated with iframe!";return(await rm(l.contentDocument,n,e,t,a,s)).submit(),l}async function sT(n,e,t,a,s,l,c){return a.addQueueMeasurement(Y.SilentHandlerMonitorIframeForHash,l),new Promise((h,d)=>{e<z0&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${z0}ms). This may result in timeouts.`);const g=window.setTimeout(()=>{window.clearInterval(p),d(Ue(S_))},e),p=window.setInterval(()=>{let v="";const T=n.contentWindow;try{v=T?T.location.href:""}catch{}if(!v||v==="about:blank")return;let x="";T&&(c===Rh.QUERY?x=T.location.search:x=T.location.hash),window.clearTimeout(g),window.clearInterval(p),h(x)},t)}).finally(()=>{_r(pR,Y.RemoveHiddenIframe,s,a,l)(n)})}function gR(n,e,t,a){return t.addQueueMeasurement(Y.SilentHandlerLoadFrame,a),new Promise((s,l)=>{const c=Kh();window.setTimeout(()=>{if(!c){l("Unable to load iframe");return}c.src=n,s(c)},e)})}function mR(n){const e=Kh();return e.src=n,e}function Kh(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function pR(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class vR extends To{constructor(e,t,a,s,l,c,h,d,g,p,v){super(e,t,a,s,l,c,d,p,v),this.apiId=h,this.nativeStorage=g}async acquireToken(e){this.performanceClient.addQueueMeasurement(Y.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Yn.NONE&&t.prompt!==Yn.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Yn.NONE}`),t.prompt=Yn.NONE):t.prompt=Yn.NONE;const a=await ve(this.initializeAuthorizationRequest.bind(this),Y.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,qe.Silent);return a.platformBroker=Yl(this.config,this.logger,this.platformAuthProvider,a.authenticationScheme),tS(a.authority),this.config.auth.protocolMode===tr.EAR?this.executeEarFlow(a):this.executeCodeFlow(a)}async executeCodeFlow(e){let t;const a=this.initializeServerTelemetryManager(this.apiId);try{return t=await ve(this.createAuthCodeClient.bind(this),Y.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await ve(this.silentTokenHelper.bind(this),Y.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(s){if(s instanceof Nt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),!t||!(s instanceof Nt)||s.errorCode!==er.INVALID_GRANT_ERROR)throw s;return this.performanceClient.addFields({retryError:s.errorCode},this.correlationId),await ve(this.silentTokenHelper.bind(this),Y.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),Y.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=await ve(Vg,Y.GenerateEarKey,this.logger,this.performanceClient,t)(),l={...e,earJwk:s},c=await ve(dR,Y.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,t)(this.config,a,l,this.logger,this.performanceClient),h=this.config.auth.OIDCOptions.serverResponseType,d=await ve(sT,Y.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,t)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,h),g=_r(Fl,Y.DeserializeResponse,this.logger,this.performanceClient,t)(d,h,this.logger);return ve(im,Y.HandleResponseEar,this.logger,this.performanceClient,t)(l,g,this.apiId,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(Ue(Hh))}async silentTokenHelper(e,t){const a=t.correlationId;this.performanceClient.addQueueMeasurement(Y.SilentIframeClientTokenHelper,a);const s=await ve($h,Y.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),l={...t,codeChallenge:s.challenge};let c;if(t.httpMethod===Ji.POST)c=await ve(fR,Y.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(this.config,e.authority,l,this.logger,this.performanceClient);else{const p=await ve(nm,Y.GetAuthCodeUrl,this.logger,this.performanceClient,a)(this.config,e.authority,l,this.logger,this.performanceClient);c=await ve(hR,Y.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(p,this.performanceClient,this.logger,a,this.config.system.navigateFrameWait)}const h=this.config.auth.OIDCOptions.serverResponseType,d=await ve(sT,Y.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,a,h),g=_r(Fl,Y.DeserializeResponse,this.logger,this.performanceClient,a)(d,h,this.logger);return ve(fh,Y.HandleResponseCode,this.logger,this.performanceClient,a)(t,g,s.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class yR extends To{async acquireToken(e){this.performanceClient.addQueueMeasurement(Y.SilentRefreshClientAcquireToken,e.correlationId);const t=await ve(em,Y.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),a={...e,...t};e.redirectUri&&(a.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(Rt.acquireTokenSilent_silentFlow),l=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:a.authority,azureCloudOptions:a.azureCloudOptions,account:a.account});return ve(l.acquireTokenByRefreshToken.bind(l),Y.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(a).catch(c=>{throw c.setCorrelationId(this.correlationId),s.cacheFailedRequest(c),c})}logout(){return Promise.reject(Ue(Hh))}async createRefreshTokenClient(e){const t=await ve(this.getClientConfiguration.bind(this),Y.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Db(t,this.performanceClient)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class TR{constructor(e,t,a,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=a,this.cryptoObj=s}async loadExternalTokens(e,t,a){if(!this.isBrowserEnvironment)throw Ue(jh);const s=e.correlationId||Zr(),l=t.id_token?po(t.id_token,Wr):void 0,c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},h=e.authority?new Pn(Pn.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,c,this.logger,e.correlationId||Zr()):void 0,d=await this.loadAccount(e,a.clientInfo||t.client_info||"",s,l,h),g=await this.loadIdToken(t,d.homeAccountId,d.environment,d.realm,s),p=await this.loadAccessToken(e,t,d.homeAccountId,d.environment,d.realm,a,s),v=await this.loadRefreshToken(t,d.homeAccountId,d.environment,s);return this.generateAuthenticationResult(e,{account:d,idToken:g,accessToken:p,refreshToken:v},l,h)}async loadAccount(e,t,a,s,l){if(this.logger.verbose("TokenCache - loading account"),e.account){const g=Jr.createFromAccountInfo(e.account);return await this.storage.setAccount(g,a),g}else if(!l||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ue(k_);const c=Jr.generateHomeAccountId(t,l.authorityType,this.logger,this.cryptoObj,s),h=s?.tid,d=Og(this.storage,l,c,Wr,a,s,t,l.hostnameAndPort,h,void 0,void 0,this.logger);return await this.storage.setAccount(d,a),d}async loadIdToken(e,t,a,s,l){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const c=Dh(t,a,e.id_token,this.config.auth.clientId,s);return await this.storage.setIdTokenCredential(c,l),c}async loadAccessToken(e,t,a,s,l,c,h){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const d=t.scope?an.fromString(t.scope):new an(e.scopes),g=c.expiresOn||t.expires_in+rr(),p=c.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+rr(),v=Ph(a,s,t.access_token,this.config.auth.clientId,l,d.printScopes(),g,p,Wr);return await this.storage.setAccessTokenCredential(v,h),v}async loadRefreshToken(e,t,a,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const l=n_(t,a,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(l,s),l}generateAuthenticationResult(e,t,a,s){let l="",c=[],h=null,d;t?.accessToken&&(l=t.accessToken.secret,c=an.fromString(t.accessToken.target).asArray(),h=io(t.accessToken.expiresOn),d=io(t.accessToken.extendedExpiresOn));const g=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:c,account:g.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:a||{},accessToken:l,fromCache:!0,expiresOn:h,correlationId:e.correlationId||"",requestId:"",extExpiresOn:d,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:g.cloudGraphHostName||"",msGraphHost:g.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class xR extends c_{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class _R extends To{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,d,g,p),this.apiId=h}async acquireToken(e){if(!e.code)throw Ue(O_);const t=await ve(this.initializeAuthorizationRequest.bind(this),Y.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,qe.Silent),a=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},l=await ve(this.getClientConfiguration.bind(this),Y.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),c=new xR(l);this.logger.verbose("Auth code client created");const h=new sS(c,this.browserStorage,s,this.logger,this.performanceClient);return await ve(h.handleCodeResponseFromServer.bind(h),Y.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof Nt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Ue(Hh))}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function SR(n,e,t){const a=window.msal?.clientIds||[],s=a.length,l=a.filter(c=>c===n).length;l>1&&t.warning("There is already an instance of MSAL.js in the window with the same client id."),e.add({msalInstanceCount:s,sameClientIdInstanceCount:l})}/*! @azure/msal-browser v4.22.1 2025-09-09 */function la(n){const e=n?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Nu(n,e){try{Qg(n)}catch(t){throw e.end({success:!1},t),t}}class Vh{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ba(this.logger,this.performanceClient):Qu,this.eventHandler=new $I(this.logger),this.browserStorage=this.isBrowserEnvironment?new V0(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,Ab(this.config.auth)):PI(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:sn.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:sn.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new V0(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new TR(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const a=new Vh(e);return await a.initialize(t),a}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent($e.INITIALIZE_END);return}const a=e?.correlationId||this.getRequestCorrelationId(),s=this.config.system.allowPlatformBroker,l=this.performanceClient.startMeasurement(Y.InitializeClientApplication,a);if(this.eventHandler.emitEvent($e.INITIALIZE_START),!t)try{this.logMultipleInstances(l)}catch{}if(await ve(this.browserStorage.initialize.bind(this.browserStorage),Y.InitializeCache,this.logger,this.performanceClient,a)(a),s)try{this.platformAuthProvider=await sR(this.logger,this.performanceClient,a,this.config.system.nativeBrokerHandshakeTimeout)}catch(c){this.logger.verbose(c)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),_r(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),Y.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,a)(a)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(a),this.initialized=!0,this.eventHandler.emitEvent($e.INITIALIZE_END),l.end({allowPlatformBroker:s,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),eS(this.initialized),this.isBrowserEnvironment){const t=e||"";let a=this.redirectResponse.get(t);return typeof a>"u"?(a=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,a),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),a}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if(this.browserStorage.getInteractionInProgress()?.type===mi.SIGNOUT)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const a=this.getAllAccounts(),s=this.browserStorage.getCachedNativeRequest(),l=s&&this.platformAuthProvider&&!e;let c;this.eventHandler.emitEvent($e.HANDLE_REDIRECT_START,qe.Redirect);let h;try{if(l&&this.platformAuthProvider){c=this.performanceClient.startMeasurement(Y.AcquireTokenRedirect,s?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),c.add({isPlatformBrokerRequest:!0});const d=new Vu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Rt.handleRedirectPromise,this.performanceClient,this.platformAuthProvider,s.accountId,this.nativeInternalStorage,s.correlationId);h=ve(d.handleRedirectPromise.bind(d),Y.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,c.event.correlationId)(this.performanceClient,c.event.correlationId)}else{const[d,g]=this.browserStorage.getCachedRequest(),p=d.correlationId;c=this.performanceClient.startMeasurement(Y.AcquireTokenRedirect,p),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const v=this.createRedirectClient(p);h=ve(v.handleRedirectPromise.bind(v),Y.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,c.event.correlationId)(e,d,g,c)}}catch(d){throw this.browserStorage.resetRequestCache(),d}return h.then(d=>(d?(this.browserStorage.resetRequestCache(),a.length<this.getAllAccounts().length?(this.eventHandler.emitEvent($e.LOGIN_SUCCESS,qe.Redirect,d),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Redirect,d),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),c.end({success:!0,accountType:la(d.account)})):c.event.errorCode?c.end({success:!1}):c.discard(),this.eventHandler.emitEvent($e.HANDLE_REDIRECT_END,qe.Redirect),d)).catch(d=>{this.browserStorage.resetRequestCache();const g=d;throw a.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Redirect,null,g):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Redirect,null,g),this.eventHandler.emitEvent($e.HANDLE_REDIRECT_END,qe.Redirect),c.end({success:!1},g),d})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const a=this.performanceClient.startMeasurement(Y.AcquireTokenPreRedirect,t);a.add({accountType:la(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=c=>{const h=typeof s=="function"?s(c):void 0;return a.add({navigateCallbackResult:h!==!1}),a.event=a.end({success:!0})||a.event,h};else{const c=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=h=>{const d=typeof c=="function"?c(h):void 0;return a.add({navigateCallbackResult:d!==!1}),a.event=a.end({success:!0})||a.event,d}}const l=this.getAllAccounts().length>0;try{Wy(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,mi.SIGNIN),l?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Redirect,e):this.eventHandler.emitEvent($e.LOGIN_START,qe.Redirect,e);let c;return this.platformAuthProvider&&this.canUsePlatformBroker(e)?c=new Vu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Rt.acquireTokenRedirect,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,a).catch(d=>{if(a.add({brokerErrorName:d.name,brokerErrorCode:d.errorCode}),d instanceof ga&&eo(d))return this.platformAuthProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(d instanceof Lr)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw d}):c=this.createRedirectClient(t).acquireToken(e),await c}catch(c){throw this.browserStorage.resetRequestCache(),a.event.status===2?this.performanceClient.startMeasurement(Y.AcquireTokenRedirect,t).end({success:!1},c):a.end({success:!1},c),l?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Redirect,null,c):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Redirect,null,c),c}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(Y.AcquireTokenPopup,t);a.add({scenarioId:e.scenarioId,accountType:la(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Nu(this.initialized,a),this.browserStorage.setInteractionInProgress(!0,mi.SIGNIN)}catch(h){return Promise.reject(h)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Popup,e):this.eventHandler.emitEvent($e.LOGIN_START,qe.Popup,e);let l;const c=this.getPreGeneratedPkceCodes(t);return this.canUsePlatformBroker(e)?(a.add({isPlatformBrokerRequest:!0}),l=this.acquireTokenNative({...e,correlationId:t},Rt.acquireTokenPopup).then(h=>(a.end({success:!0,accountType:la(h.account)}),h)).catch(h=>{if(a.add({brokerErrorName:h.name,brokerErrorCode:h.errorCode}),h instanceof ga&&eo(h))return this.platformAuthProvider=void 0,this.createPopupClient(t).acquireToken(e,c);if(h instanceof Lr)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,c);throw h})):l=this.createPopupClient(t).acquireToken(e,c),l.then(h=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent($e.LOGIN_SUCCESS,qe.Popup,h):this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Popup,h),a.end({success:!0,accessTokenSize:h.accessToken.length,idTokenSize:h.idToken.length,accountType:la(h.account)}),h)).catch(h=>(s.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Popup,null,h):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Popup,null,h),a.end({success:!1},h),Promise.reject(h))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),a={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(Y.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:la(e.account)}),Nu(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent($e.SSO_SILENT_START,qe.Silent,a);let s;return this.canUsePlatformBroker(a)?(this.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),s=this.acquireTokenNative(a,Rt.ssoSilent).catch(l=>{if(this.ssoSilentMeasurement?.add({brokerErrorName:l.name,brokerErrorCode:l.errorCode}),l instanceof ga&&eo(l))return this.platformAuthProvider=void 0,this.createSilentIframeClient(a.correlationId).acquireToken(a);throw l})):s=this.createSilentIframeClient(a.correlationId).acquireToken(a),s.then(l=>(this.eventHandler.emitEvent($e.SSO_SILENT_SUCCESS,qe.Silent,l),this.ssoSilentMeasurement?.end({success:!0,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length,accountType:la(l.account)}),l)).catch(l=>{throw this.eventHandler.emitEvent($e.SSO_SILENT_FAILURE,qe.Silent,null,l),this.ssoSilentMeasurement?.end({success:!1},l),l}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const a=this.performanceClient.startMeasurement(Y.AcquireTokenByCode,t);Nu(this.initialized,a),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_START,qe.Silent,e),a.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ue(D_);if(e.code){const s=e.code;let l=this.hybridAuthCodeResponses.get(s);return l?(this.logger.verbose("Existing acquireTokenByCode request found",t),a.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),l=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(c=>(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_SUCCESS,qe.Silent,c),this.hybridAuthCodeResponses.delete(s),a.end({success:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,accountType:la(c.account)}),c)).catch(c=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_FAILURE,qe.Silent,null,c),a.end({success:!1},c),c}),this.hybridAuthCodeResponses.set(s,l)),await l}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){a.add({isPlatformBrokerRequest:!0});const s=await this.acquireTokenNative({...e,correlationId:t},Rt.acquireTokenByCode,e.nativeAccountId).catch(l=>{throw l instanceof ga&&eo(l)&&(this.platformAuthProvider=void 0),a.add({brokerErrorName:l.name,brokerErrorCode:l.errorCode}),l});return a.end({accountType:la(s.account),success:!0}),s}else throw Ue(P_);else throw Ue(M_)}catch(s){throw this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_FAILURE,qe.Silent,null,s),a.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(Y.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(s=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:s.fromCache}),s)).catch(s=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},s),s}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(Y.AcquireTokenFromCache,e.correlationId),t){case $n.Default:case $n.AccessToken:case $n.AccessTokenAndRefreshToken:const a=this.createSilentCacheClient(e.correlationId);return ve(a.acquireToken.bind(a),Y.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw we(xi)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(Y.AcquireTokenByRefreshToken,e.correlationId),t){case $n.Default:case $n.AccessTokenAndRefreshToken:case $n.RefreshToken:case $n.RefreshTokenAndNetwork:const a=this.createSilentRefreshClient(e.correlationId);return ve(a.acquireToken.bind(a),Y.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw we(xi)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(Y.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return ve(t.acquireToken.bind(t),Y.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Wy(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,mi.SIGNOUT),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Qg(this.initialized),this.browserStorage.setInteractionInProgress(!0,mi.SIGNOUT),this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return FI(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return LI(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return UI(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return BI(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return HI(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();jI(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return zI(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const a=Jr.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(a,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,a,s){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Ue(jg);return new Vu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,a||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,s)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Yl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Yn.NONE:case Yn.CONSENT:case Yn.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new lR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new uR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new vR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Rt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new lS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new yR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new _R(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Rt.acquireTokenByCode,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return Z_(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==sn.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==sn.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Zr():ye.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Ky})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Ky})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(Y.AcquireTokenSilent,t);a.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Nu(this.initialized,a),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Ue(w_);return a.add({accountType:la(s)}),this.acquireTokenSilentDeduped(e,s,t).then(l=>(a.end({success:!0,fromCache:l.fromCache,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),{...l,state:e.state,correlationId:t})).catch(l=>{throw l instanceof Nt&&l.setCorrelationId(t),a.end({success:!1},l),l})}async acquireTokenSilentDeduped(e,t,a){const s=Fh(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority},t.homeAccountId),l=JSON.stringify(s),c=this.activeSilentTokenRequests.get(l);if(typeof c>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",a),this.performanceClient.addFields({deduped:!1},a);const h=ve(this.acquireTokenSilentAsync.bind(this),Y.AcquireTokenSilentAsync,this.logger,this.performanceClient,a)({...e,correlationId:a},t);return this.activeSilentTokenRequests.set(l,h),h.finally(()=>{this.activeSilentTokenRequests.delete(l)})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",a),this.performanceClient.addFields({deduped:!0},a),c}async acquireTokenSilentAsync(e,t){const a=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(Y.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",a);const s=await ve(KI,Y.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),l=e.cacheLookupPolicy||$n.Default;return this.acquireTokenSilentNoIframe(s,l).catch(async h=>{if(CR(h,l))if(this.activeIframeRequest)if(l!==$n.Skip){const[g,p]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${p}`,s.correlationId);const v=this.performanceClient.startMeasurement(Y.AwaitConcurrentIframe,s.correlationId);v.add({awaitIframeCorrelationId:p});const T=await g;if(v.end({success:T}),T)return this.logger.verbose(`Parallel iframe request with correlationId: ${p} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,l);throw this.logger.info(`Iframe request with correlationId: ${p} failed. Interaction is required.`),h}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),ve(this.acquireTokenBySilentIframe.bind(this),Y.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let g;return this.activeIframeRequest=[new Promise(p=>{g=p}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),ve(this.acquireTokenBySilentIframe.bind(this),Y.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(p=>(g(!0),p)).catch(p=>{throw g(!1),p}).finally(()=>{this.activeIframeRequest=void 0})}else throw h}).then(h=>(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Silent,h),e.correlationId&&this.performanceClient.addFields({fromCache:h.fromCache},e.correlationId),h)).catch(h=>{throw this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Silent,null,h),h}).finally(()=>{document.removeEventListener("visibilitychange",a)})}async acquireTokenSilentNoIframe(e,t){return Yl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,Rt.acquireTokenSilent_silentFlow,e.account.nativeAccountId,t).catch(async a=>{throw this.performanceClient.addFields({brokerErrorName:a.name,brokerErrorCode:a.errorCode},e.correlationId),a instanceof ga&&eo(a)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,we(xi)):a})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===$n.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),ve(this.acquireTokenFromCache.bind(this),Y.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(a=>{if(t===$n.AccessToken)throw a;return this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_NETWORK_START,qe.Silent,e),ve(this.acquireTokenByRefreshToken.bind(this),Y.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await ve($h,Y.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),SR(t,e,this.logger)}}function CR(n,e){const t=!(n instanceof Lr&&n.subError!==Uh),a=n.errorCode===er.INVALID_GRANT_ERROR||n.errorCode===xi,s=t&&a||n.errorCode===sh||n.errorCode===Ng,l=Zb.includes(e);return s&&l}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function ER(n,e){const t=new as(n);return await t.initialize(),Vh.createController(t,e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class om{static async createPublicClientApplication(e){const t=await ER(e);return new om(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new Vh(new as(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}let oT=!1;const ma=new om({auth:{clientId:"60d9a880-0f6c-4e14-b17a-1cc06ea9ba8a",authority:"https://login.microsoftonline.com/cd48ecd9-7e15-4f4b-97d9-ec813ee42b2c",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage"}});async function qh(){oT||(await ma.initialize(),oT=!0)}const q0=["openid","profile","email","User.Read","Sites.ReadWrite.All"];function lm(){const n=ma.getActiveAccount()??ma.getAllAccounts()[0]??null;return n&&ma.setActiveAccount(n),n}async function AR(){await qh();let n=lm();return n||(n=(await ma.loginPopup({scopes:q0,prompt:"select_account"})).account??ma.getAllAccounts()[0],ma.setActiveAccount(n)),n}async function wR(){await qh();const n=lm();if(!n)throw new Error("No hay sesión. Llama a ensureLogin() primero.");try{return(await ma.acquireTokenSilent({scopes:q0,account:n})).accessToken}catch(e){if(e instanceof Lr)return(await ma.acquireTokenPopup({scopes:q0,account:n})).accessToken;throw e}}async function bR(){await qh();const n=lm();await ma.logoutPopup({account:n})}const hS=K.createContext(null),IR=({children:n})=>{const[e,t]=K.useState(!1),[a,s]=K.useState(null);K.useEffect(()=>{let g=!1;return(async()=>{try{if(await qh(),!g){const p=(window._skip_auto_login,null);t(!0)}}catch(p){console.error("[AuthProvider] auto-login error:",p),g||t(!0)}})(),()=>{g=!0}},[]);const l=K.useCallback(async()=>{const g=await AR();s(g),t(!0)},[]),c=K.useCallback(async()=>{await bR(),s(null),t(!0)},[]),h=K.useCallback(async()=>wR(),[]),d=K.useMemo(()=>({ready:e,account:a,getToken:h,signIn:l,signOut:c}),[e,a,h,l,c]);return y.jsx(hS.Provider,{value:d,children:n})};function xo(){const n=K.useContext(hS);if(!n)throw new Error("useAuth must be used within <AuthProvider>");return n}class fo{getToken;baseUrl;constructor(e,t="https://graph.microsoft.com/v1.0"){this.getToken=e,this.baseUrl=t}async call(e,t,a){const s=await this.getToken(),l=`${this.baseUrl}${t}`,c=await fetch(l,{method:e,headers:{Authorization:`Bearer ${s}`,...a?{"Content-Type":"application/json"}:{}},body:a?JSON.stringify(a):void 0});if(!c.ok){const d=await c.text().catch(()=>"");throw new Error(`${e} ${t} -> ${c.status} ${c.statusText} ${d?":: "+d:""}`)}if(c.status===204)return;const h=c.headers.get("content-type")||"";if(!h||!h.toLowerCase().includes("application/json")){const d=await c.text().catch(()=>"");return d?JSON.parse(d):void 0}return await c.json()}get(e){return this.call("GET",e)}post(e,t){return this.call("POST",e,t)}patch(e,t){return this.call("PATCH",e,t)}delete(e){return this.call("DELETE",e)}async getAllPages(e){let t=`${this.baseUrl}${e}`;const a=await this.getToken(),s=[];for(;t;){const l=await fetch(t,{headers:{Authorization:`Bearer ${a}`}});if(!l.ok)throw new Error(`GET ${t} -> ${l.status} ${await l.text()}`);const c=await l.json();Array.isArray(c?.value)&&s.push(...c.value),t=c["@odata.nextLink"]||""}return s}async getBlob(e){const t=await this.getToken(),a=await fetch(`${this.baseUrl}${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error(`GET ${e} -> ${a.status} ${await a.text()}`);return await a.blob()}}class fS{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="ParkingSlots"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title,TipoCelda:t.TipoCelda,Itinerancia:t.Itinerancia,Activa:t.Activa}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByCodigo(e,t=1){await this.ensureIds();const a=new URLSearchParams({$expand:"fields",$filter:`fields/Codigo eq '${this.esc(e)}'`,$top:String(t)});return((await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${a.toString()}`)).value??[]).map(l=>this.toModel(l))}async getDisponibles(e=100){return this.getAll({filter:"fields/Disponible eq true",orderby:"fields/Codigo asc",top:e})}}class dS{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Colaboradores fijos"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:Number(e?.id??NaN),Title:t.Title,Correo:t.Correo,Tipodevehiculo:t.Tipodevehiculo,Placa:t.Placa,CodigoCelda:t.CodigoCelda,SpotAsignado:t.SpotAsignado}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async getAllPaged(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return{data:(a.value??[]).map(s=>this.toModel(s)),nextLink:a["@odata.nextLink"]}}async getNextPage(e){const t=await this.graph.get(e.replace("https://graph.microsoft.com/v1.0",""));return{data:(t.value??[]).map(a=>this.toModel(a)),nextLink:t["@odata.nextLink"]}}}class cm{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Reservations"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title??"",NombreUsuario:t.NombreUsuario??void 0,Date:t.Date??void 0,Turn:t.Turn??void 0,SpotIdLookupId:typeof t.SpotIdLookupId=="number"?t.SpotIdLookupId:null,SpotId:t.SpotId??null,VehivleType:t.VehivleType??void 0,Status:t.Status??void 0,OData__ColorTag:t.OData__ColorTag??void 0,Modified:t.Modified??void 0,Created:t.Created??void 0,AuthorLookupId:typeof t.AuthorLookupId=="number"?t.AuthorLookupId:null,EditorLookupId:typeof t.EditorLookupId=="number"?t.EditorLookupId:null}}async create(e){await this.ensureIds();const t={Title:e.Title,NombreUsuario:e.NombreUsuario,Date:e.Date,Turn:e.Turn,SpotIdLookupId:e.SpotIdLookupId??void 0,VehivleType:e.VehivleType,Status:e.Status,OData__ColorTag:e.OData__ColorTag},a=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:t});return this.toModel(a)}async update(e,t){await this.ensureIds();const a={};t.Title!==void 0&&(a.Title=t.Title),t.NombreUsuario!==void 0&&(a.NombreUsuario=t.NombreUsuario),t.Date!==void 0&&(a.Date=t.Date),t.Turn!==void 0&&(a.Turn=t.Turn),t.SpotIdLookupId!==void 0&&(a.SpotIdLookupId=t.SpotIdLookupId),t.VehivleType!==void 0&&(a.VehivleType=t.VehivleType),t.Status!==void 0&&(a.Status=t.Status),t.OData__ColorTag!==void 0&&(a.OData__ColorTag=t.OData__ColorTag),Object.keys(a).length>0&&await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,a);const l=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(l)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findBySpotId(e,t=100){return this.getAll({filter:`fields/SpotIdLookupId eq ${e}`,orderby:"fields/Date asc",top:t})}async findByDateRange(e,t,a=200){const s=this.esc(e),l=this.esc(t);return this.getAll({filter:`(fields/Date ge '${s}' and fields/Date le '${l}')`,orderby:"fields/Date asc",top:a})}async findByUser(e,t=100){return this.getAll({filter:`fields/NombreUsuario eq '${this.esc(e)}'`,orderby:"fields/Date desc",top:t})}}class RR{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Settings"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),VisibleDays:t.VisibleDays!=null?Number(t.VisibleDays):void 0,InicioManana:t.InicioManana!=null?String(t.InicioManana):"07:00",FinalManana:t.FinalManana!=null?String(t.FinalManana):"12:00",InicioTarde:t.InicioTarde!=null?String(t.InicioTarde):"12:00",FinalTarde:t.FinalTarde!=null?String(t.FinalTarde):"18:00",TerminosyCondiciones:t.TerminosyCondiciones!=null?String(t.TerminosyCondiciones):"",PicoPlaca:!!t.PicoPlaca}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e}),a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${t?.id}?$expand=fields`);return this.toModel(a)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getById(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async getByTitle(e){return(await this.getAll({filter:`fields/Title eq '${this.esc(e)}'`,top:1}))[0]??null}async getVisibleDaysFromId1(){const e=await this.get("1");return Number(e.VisibleDays??0)}}class NR{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="UsuariosParking"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:Number(e?.id??""),Title:t.Title,Rol:t.Rol}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByCorreo(e,t=10){return this.getAll({filter:`fields/Correo eq '${this.esc(e)}'`,orderby:"fields/Title asc",top:t})}}class kR{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Pico y Placa"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title,Moto:t.Moto,Carro:t.Carro}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByDia(e,t,a=!0){await this.ensureIds();const s=[`fields/Dia eq '${this.esc(e)}'`];t&&s.push(`fields/TipoVehiculo eq '${this.esc(t)}'`),a&&s.push("(fields/Activo eq true or not(fields/Activo))");const l=new URLSearchParams({$expand:"fields",$filter:s.join(" and "),$orderby:"fields/Inicio asc",$top:"100"});return((await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${l.toString()}`)).value??[]).map(h=>this.toModel(h))}async isRestringido(e,t,a){const l=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"][t.getDay()],c=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`,h=await this.findByDia(l,a,!0),d=e.replace(/\D/g,"").slice(-1);if(!d)return!1;const g=v=>{if(!v||!/^\d{2}:\d{2}$/.test(v))return null;const[T,x]=v.split(":").map(Number);return T*60+x},p=g(c);for(const v of h){if(!String(v.Digitos??"").split(/[,\s]+/).filter(Boolean).some(A=>{if(/^\d$/.test(A))return A===d;if(/^\d-\d$/.test(A)){const[B,I]=A.split("-").map(Number);return Number(d)>=B&&Number(d)<=I}return!1}))continue;const C=g(v.Inicio),_=g(v.Fin);if(C==null||_==null||p==null||p>=C&&p<=_)return!0}return!1}}class OR{usuariosSvc;constructor(e){this.usuariosSvc=e}async getRole(e){if(!e)return"Usuario";const a=String(e).replace(/'/g,"''").toLowerCase();try{const l=(await this.usuariosSvc.getAll({filter:`tolower(fields/Correo) eq '${a}'`,orderby:"fields/Title asc",top:1}))[0];if(l?.Rol)return l.Rol;const h=(await this.usuariosSvc.getAll({filter:`tolower(fields/Title) eq '${a}'`,orderby:"fields/Title asc",top:1}))[0];return h?.Rol?h.Rol:"Usuario"}catch(s){return console.error("[SharedServices.getRole] error:",s),"Usuario"}}}const gS=K.createContext(null),MR={hostname:"estudiodemoda.sharepoint.com",sitePath:"/sites/TransformacionDigital/IN/SA",lists:{parkingSlots:"parkingslots",colaboradoresFijos:"Colaboradores fijos",reservations:"reservations",usuariosParking:"usuariosparking",settings:"settings",picoYPlaca:"pico y placa"}},DR=({children:n,config:e})=>{const{getToken:t}=xo(),a=K.useMemo(()=>{const c=MR,h=e?.sitePath??c.sitePath;return{hostname:e?.hostname??c.hostname,sitePath:h.startsWith("/")?h:`/${h}`,lists:{parkingSlots:e?.lists?.parkingSlots??c.lists.parkingSlots,colaboradoresFijos:e?.lists?.colaboradoresFijos??c.lists.colaboradoresFijos,reservations:e?.lists?.reservations??c.lists.reservations,usuariosParking:e?.lists?.usuariosParking??c.lists.usuariosParking,settings:e?.lists?.settings??c.lists.settings,picoYPlaca:e?.lists?.picoYPlaca??c.lists.picoYPlaca}}},[e]),s=K.useMemo(()=>new fo(t),[t]),l=K.useMemo(()=>{const{hostname:c,sitePath:h,lists:d}=a,g=new fS(s,c,h,d.parkingSlots),p=new dS(s,c,h,d.colaboradoresFijos),v=new cm(s,c,h,d.reservations),T=new NR(s,c,h,d.usuariosParking),x=new RR(s,c,h,d.settings),C=new kR(s,c,h,d.picoYPlaca),_=new OR(T);return{graph:s,parkingSlots:g,colaboradoresFijos:p,reservations:v,usuariosParking:T,settings:x,picoYPlaca:C,shared:_}},[s,a]);return y.jsx(gS.Provider,{value:l,children:n})};function pa(){const n=K.useContext(gS);if(!n)throw new Error("useGraphServices debe usarse dentro de <GraphServicesProvider>.");return n}const PR=({open:n,title:e="Confirmar",children:t,confirmText:a="Confirmar",cancelText:s="Cancelar",onConfirm:l,onClose:c,showTerms:h=!1,settingsItemId:d="1",termsField:g="TerminosyCondiciones"})=>{const{settings:p}=pa(),[v,T]=K.useState(""),[x,C]=K.useState(!1),[_,A]=K.useState(null),[B,I]=K.useState(!1);if(K.useEffect(()=>{n&&(I(!1),T(""),A(null))},[n]),K.useEffect(()=>{if(!n||!h)return;let X=!1;return(async()=>{try{C(!0),A(null);const W=await p.get(String(d)),N=W?.[g]??W?.TerminosyCondiciones??"";if(X)return;if(!N||typeof N!="string")throw new Error(`No se encontró contenido en Settings.${g}`);T(N)}catch(W){X||A(W?.message??"Error al cargar Términos y Condiciones.")}finally{X||C(!1)}})(),()=>{X=!0}},[n,h,d,g,p]),!n)return null;const k=X=>{X.target===X.currentTarget&&c()},z=!h||B&&!x&&!_;return y.jsx("div",{className:oa.backdrop,onMouseDown:k,"aria-modal":"true",role:"dialog","aria-label":e,children:y.jsxs("div",{className:oa.modal,role:"document",children:[y.jsxs("header",{className:oa.header,children:[y.jsx("h3",{className:oa.title,children:e}),y.jsx("button",{className:oa.close,onClick:c,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{className:oa.body,children:[t,h&&y.jsxs("section",{style:{marginTop:12},children:[y.jsx("h4",{style:{margin:"8px 0"},children:"Términos y Condiciones"}),x&&y.jsx("div",{className:"muted",style:{fontSize:12},children:"Cargando Términos y Condiciones…"}),_&&y.jsx("div",{style:{color:"crimson",fontSize:12},children:_}),!x&&!_&&y.jsx("div",{className:oa.termsBox,dangerouslySetInnerHTML:{__html:v}}),y.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,marginTop:10,fontSize:13},children:[y.jsx("input",{type:"checkbox",checked:B,onChange:X=>I(X.target.checked),disabled:x||!!_}),"Acepto los Términos y Condiciones"]})]})]}),y.jsxs("footer",{className:oa.footer,children:[y.jsx("button",{className:oa.btnGhost,onClick:c,children:s}),y.jsx("button",{className:oa.btnPrimary,onClick:l,disabled:!z,title:z?void 0:"Debes aceptar los Términos y Condiciones",children:a})]})]})})};var FR=tx();const LR="_container_1dr80_1",UR="_toast_1dr80_19",BR="_slideIn_1dr80_1",HR="_success_1dr80_45",jR="_error_1dr80_47",zR="_info_1dr80_49",x0={container:LR,toast:UR,slideIn:BR,success:HR,error:jR,info:zR},mS=K.createContext(null),GR=()=>{const n=K.useContext(mS);if(!n)throw new Error("useToast debe usarse dentro de <ToastProvider>");return n},$R=({children:n})=>{const[e,t]=K.useState([]),a=c=>t(h=>h.filter(d=>d.id!==c)),s=K.useCallback((c,h="info",d=3500)=>{const g=crypto.randomUUID?.()??String(Date.now()+Math.random()),p={id:g,kind:h,message:c,duration:d};t(v=>[...v,p]),window.setTimeout(()=>a(g),d)},[]),l=K.useMemo(()=>({show:(c,h="info",d=3500)=>s(c,h,d),success:(c,h=3500)=>s(c,"success",h),error:(c,h=4500)=>s(c,"error",h),info:(c,h=3500)=>s(c,"info",h)}),[s]);return y.jsxs(mS.Provider,{value:l,children:[n,FR.createPortal(y.jsx("div",{className:x0.container,children:e.map(c=>y.jsx("div",{className:`${x0.toast} ${x0[c.kind]}`,onMouseEnter:()=>a(c.id),role:"status","aria-live":"polite",children:c.message},c.id))}),document.body)]})};function ku(n){if(n==null)return NaN;if(typeof n=="number")return _0(n);const e=String(n).trim(),t=/^(\d{1,2})(?::\d{1,2})?$/.exec(e);if(t)return _0(parseInt(t[1],10));const a=parseInt(e,10);return _0(isFinite(a)?a:NaN)}function _0(n){return isFinite(n)?Math.max(0,Math.min(23,Math.floor(n))):NaN}function pS(){const{settings:n}=pa(),[e,t]=K.useState(null),[a,s]=K.useState(!0),[l,c]=K.useState(null),h=K.useCallback(async()=>{try{s(!0),c(null);const d=await n.get("1"),g={InicioManana:ku(d?.InicioManana??"07:00"),FinalManana:ku(d?.FinalManana??"12:00"),InicioTarde:ku(d?.InicioTarde??"12:00"),FinalTarde:ku(d?.FinalTarde??"18:00")};if([g.InicioManana,g.FinalManana,g.InicioTarde,g.FinalTarde].some(Number.isNaN))throw new Error("Los horarios en Settings no tienen un formato válido.");t(g)}catch(d){c(d?.message??"No se pudieron cargar los horarios."),t(null)}finally{s(!1)}},[n]);return K.useEffect(()=>{h()},[h]),{hours:e,loading:a,error:l,reload:h}}const KR=4;function VR(n,e,t,a,s,l){const[c,h]=K.useState(null),[d,g]=K.useState(null),[p,v]=K.useState(!0),[T,x]=K.useState(null);K.useEffect(()=>{const B=new Date;(async()=>{try{v(!0);const k=(await t.get("1"))?.VisibleDays??3;h(Ew(B,k)),g(B)}catch(I){x(I?.message??"Error cargando configuración")}finally{v(!1)}})()},[t]);const C=K.useCallback(async(B,I,k)=>{const z=await n.getAll({filter:[`fields/SpotIdLookupId eq ${Number(B)}`,`fields/Date eq '${I}'`,`fields/Turn eq '${k}'`,"(fields/Status ne 'Cancelada')"].join(" and "),top:1e3,orderby:"fields/ID asc"});return Array.isArray(z)?z.length:0},[n]),_=K.useCallback(async(B,I,k)=>{if(!B?.trim()||!I)return!1;const z=B.replace(/'/g,"''"),X=await n.getAll({filter:[`fields/Title eq '${z}'`,`fields/Date eq '${I}'`,"(fields/Status ne 'Cancelada')",`fields/Turn eq '${k}'`].join(" and "),top:1,orderby:"fields/ID asc"});return Array.isArray(X)&&X.length>0},[n]),A=K.useCallback(async({vehicle:B,turn:I,dateISO:k})=>{if(await _(a,k,I))return{ok:!1,message:`No puedes reservar: ya tienes una reserva activa para el ${k} en el turno de la ${I}.`};const z=await e.getAll({filter:["(fields/Activa eq 'Activa')",`fields/TipoCelda eq '${B}'`,"fields/Itinerancia eq 'Empleado Itinerante'"].join(" and "),top:2e3,orderby:"fields/Title asc"});if(!Array.isArray(z)||z.length===0)return{ok:!1,message:`No existen celdas activas para ${B}.`};const X=I==="Dia"?["Manana","Tarde"]:[I];for(const N of z){const G=N.ID??N.Id??N.id;if(G==null)continue;let V=!0;for(const J of X){const he=await C(G,k,J);if(B==="Carro"){if(he>=1){V=!1;break}}else if(he>=KR){V=!1;break}}if(!V)continue;const ie=I==="Dia"?["Manana","Tarde"]:[I];try{let J=null;for(const je of ie){const ke={Title:a,Date:k,Turn:je,SpotIdLookupId:Number(G),VehicleType:B,Status:"Activa",NombreUsuario:s};J=await n.create(ke)}await l?.onAfterReserve?.();const he=N.Title??N.Code??N.Name??G;return{ok:!0,message:I==="Dia"?`Reserva de día completo creada en celda ${he} para ${k}.`:`Reserva creada en celda ${he} para ${k} (${I}).`,reservation:J}}catch{continue}}const W=I==="Dia"?"día completo":String(I).toLowerCase();return{ok:!1,message:`No hay parqueaderos disponibles para ${B} el ${k} en ${W}.`}},[n,e,_,C,a,s,l]);return{minDate:d,maxDate:c,loading:p,error:T,reservar:A}}const qR=({userEmail:n,userName:e})=>{const{reservations:t,settings:a,parkingSlots:s}=pa(),{minDate:l,maxDate:c,reservar:h,loading:d,error:g}=VR(t,s,a,n,e),{hours:p,loading:v,error:T}=pS(),x=K.useMemo(()=>_y(l),[l]),C=K.useMemo(()=>_y(c),[c]),[_,A]=K.useState("Carro"),[B,I]=K.useState("Manana"),[k,z]=K.useState(""),X=Te=>{if(Te==null||Number.isNaN(Te))return"--:--";const U=Math.max(0,Math.min(23,Math.floor(Te)));return`${String(U).padStart(2,"0")}:00`},[W,N]=K.useState(!1),[G,V]=K.useState(!1),[ie,J]=K.useState(null),he=!k||!x||!C||v||!!T||!p;K.useEffect(()=>{if(!x||!C)return;const Te=new Date().toISOString().slice(0,10),U=(ue,b,L)=>ue<b?b:ue>L?L:ue;z(ue=>ue||U(Te,x,C))},[x,C]);const Ae=GR();async function je(){try{V(!0),J(null);const Te=await h({vehicle:_,turn:B,dateISO:k,userEmail:n});Te.ok?(N(!1),Ae.success(Te.message)):(J(Te.message),Ae.error(Te.message))}catch(Te){const U=Te?.message??"Error inesperado al reservar";J(U),Ae.error(U)}finally{V(!1)}}if(d||v)return y.jsx("div",{className:gr.wrapper,children:"Cargando…"});if(g||T)return y.jsx("div",{className:gr.wrapper,children:y.jsxs("div",{className:gr.error,children:["Error: ",g||T]})});if(!p)return y.jsx("div",{className:gr.wrapper,children:"Sin configuración de horarios."});const{InicioManana:ke,FinalManana:re,InicioTarde:_e,FinalTarde:fe}=p;return y.jsxs("div",{className:gr.wrapper,children:[y.jsxs("div",{className:gr.toolbar,children:[y.jsxs("label",{className:gr.label,children:["Fecha:",y.jsx("input",{className:gr.input,type:"date",min:x||void 0,max:C||void 0,value:k,onChange:Te=>z(Te.target.value)})]}),y.jsxs("label",{className:gr.label,children:["Turno:",y.jsxs("select",{className:gr.select,value:B,onChange:Te=>I(Te.target.value),children:[y.jsxs("option",{value:"Manana",children:["Mañana (",X(ke),"–",X(re),")"]}),y.jsxs("option",{value:"Tarde",children:["Tarde (",X(_e),"–",X(fe),")"]}),y.jsx("option",{value:"Dia",children:"Día completo"})]})]}),y.jsxs("label",{className:gr.label,children:["Vehículo:",y.jsxs("select",{className:gr.select,value:_,onChange:Te=>A(Te.target.value),children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsx("button",{className:gr.button,onClick:()=>N(!0),disabled:he,children:"Reservar"})]}),y.jsxs(PR,{open:W,title:"Confirmar reserva",onClose:()=>!G&&N(!1),onConfirm:je,confirmText:G?"Guardando…":"Confirmar",cancelText:"Cancelar",showTerms:!0,settingsItemId:"1",termsField:"TerminosyCondiciones",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Fecha:"})," ",k]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Turno:"})," ",B==="Dia"?"Día completo":B]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Vehículo:"})," ",_]}),ie&&y.jsx("p",{style:{color:"red",marginTop:"8px"},children:ie})]})]})},YR="_section_1v7dn_3",XR="_card_1v7dn_5",WR="_title_1v7dn_25",QR="_tableWrap_1v7dn_27",JR="_table_1v7dn_27",ZR="_theadRow_1v7dn_31",eN="_th_1v7dn_31",tN="_td_1v7dn_33",nN="_pill_1v7dn_35",rN="_cancelBtn_1v7dn_37",aN="_form_1v7dn_51",iN="_label_1v7dn_89",sN="_input_1v7dn_107",oN="_info_1v7dn_139",lN="_error_1v7dn_141",cN="_paginationBar_1v7dn_161",uN="_paginationLeft_1v7dn_177",hN="_paginationRight_1v7dn_195",fN="_pageBtn_1v7dn_209",dN="_pageInfo_1v7dn_237",gN="_pageSizeLabel_1v7dn_243",mN="_pageSizeSelect_1v7dn_257",pN="_topBar_1v7dn_283",vN="_segmented_1v7dn_305",yN="_segmentBtn_1v7dn_321",TN="_segmentBtnActive_1v7dn_383",Qe={section:YR,card:XR,title:WR,tableWrap:QR,table:JR,theadRow:ZR,th:eN,td:tN,pill:nN,cancelBtn:rN,form:aN,label:iN,input:sN,info:oN,error:lN,paginationBar:cN,paginationLeft:uN,paginationRight:hN,pageBtn:fN,pageInfo:dN,pageSizeLabel:gN,pageSizeSelect:mN,topBar:pN,segmented:vN,segmentBtn:yN,segmentBtnActive:TN},xN=n=>{const e=String(n.Date??"").slice(0,10),t=Number(n.SpotIdLookupId??n.SpotId??0),a=String(n.SpotId??(t?String(t):"")),s={Id:Number(n.ID??n.Id??n.id??0),Date:/^\d{4}-\d{2}-\d{2}$/.test(e)?e:"",Turn:String(n.Turn??""),SpotId:t,Spot:a,VehicleType:String(n.VehicleType??n.VehivleType??""),Status:String(n.Status??""),User:String(n.NombreUsuario??"")},l=n.Title??n.Usuario??n.UserMail??n.Correo??null;return l&&(s.__UserMail=String(l)),s};function _N(n,e,t=!1){const[a,s]=K.useState([]),[l,c]=K.useState([]),[h,d]=K.useState([]),[g,p]=K.useState(!1),[v,T]=K.useState(null),[x,C]=K.useState(Cw),_=!x.from||!x.to||x.from>x.to,[A,B]=K.useState(20),[I,k]=K.useState(0),[z,X]=K.useState(!1),[W,N]=K.useState("upcoming-active"),G=(e??"").replace(/'/g,"''"),V=(()=>{const fe=new Date,Te=fe.getFullYear(),U=String(fe.getMonth()+1).padStart(2,"0"),ue=String(fe.getDate()).padStart(2,"0");return`${Te}-${U}-${ue}`})(),ie=K.useCallback(fe=>{let Te=fe;W==="upcoming-active"?Te=fe.filter(ue=>ue.Status==="Activa"&&ue.Date>=V):W==="history"&&(Te=fe.filter(ue=>ue.Status!=="Activa")),c(Te);const U=Te.slice(0,A);d(U),k(0),X(Te.length>A)},[W,A,V]),J=K.useCallback(async()=>{if(n){if(!t&&!G){s([]),c([]),d([]),T("No hay email de usuario para cargar las reservas.");return}if(_){T("Rango de fechas inválido.");return}p(!0),T(null);try{const Te=[];t||Te.push(`fields/Title eq '${G}'`),W==="upcoming-active"?Te.push(`fields/Date ge '${V}'`):(Te.push(`fields/Date ge '${x.from}'`),Te.push(`fields/Date le '${x.to}'`));const U=Te.join(" and "),b=(await n.getAll({filter:U,orderby:"fields/Date desc",top:2e3})).map(xN);s(b),ie(b)}catch(fe){console.error("[useMisReservas] fetchAllForRange error:",fe),s([]),c([]),d([]),T(fe?.message??"Error al cargar"),X(!1)}finally{p(!1)}}},[n,t,G,x.from,x.to,_,W,V,ie]),he=K.useCallback(()=>{if(_){T('El rango seleccionado es inválido. "Desde" no puede ser mayor que "Hasta".');return}J()},[_,J]),Ae=K.useCallback(fe=>{const Te=Number.isFinite(fe)&&fe>0?Math.floor(fe):20;B(Te);const U=l.slice(0,Te);d(U),k(0),X(l.length>Te)},[l]),je=K.useCallback(()=>{if(g)return;const fe=I+1,Te=fe*A,U=Te+A;Te>=l.length||(d(l.slice(Te,U)),k(fe),X(U<l.length))},[g,I,A,l]),ke=K.useCallback(()=>{if(g||I===0)return;const fe=I-1,Te=fe*A,U=Te+A;d(l.slice(Te,U)),k(fe),X(l.length>U)},[g,I,A,l]),re=K.useCallback(()=>{const fe=I*A,Te=fe+A;d(l.slice(fe,Te)),X(Te<l.length)},[l,I,A]),_e=K.useCallback(async fe=>{if(!fe){alert("ID de reserva inválido");return}try{p(!0),await n.update(String(fe),{Status:"Cancelada"}),await J()}catch(Te){console.error("[useMisReservas] cancelReservation error:",Te),alert("No se pudo cancelar la reserva: "+(Te?.message??"error desconocido"))}finally{p(!1)}},[n,J]);return K.useEffect(()=>{ie(a)},[W]),K.useEffect(()=>{N("upcoming-active")},[t]),K.useEffect(()=>{let fe=!1;return(async()=>fe||await J())(),()=>{fe=!0}},[J]),K.useEffect(()=>{let Te=null;const U=()=>{J()},ue=()=>{Te==null&&(Te=window.setInterval(U,3e5))},b=()=>{Te!=null&&(window.clearInterval(Te),Te=null)};document.hidden||ue();const L=()=>{document.hidden?b():(U(),ue())};return document.addEventListener("visibilitychange",L),()=>{b(),document.removeEventListener("visibilitychange",L)}},[J]),{rows:h,loading:g,error:v,range:x,setRange:C,rangeInvalid:_,applyRange:he,pageSize:A,setPageSize:Ae,pageIndex:I,hasNext:z,nextPage:je,prevPage:ke,reload:re,cancelReservation:_e,filterMode:W,setFilterMode:N}}const SN=n=>{const e=(n||"").toLowerCase();return e.includes("cancel")?"#f87171":e.includes("termin")?"#a3a3a3":e.includes("act")?"#34d399":"#60a5fa"},lT=({userMail:n,isAdmin:e=!1})=>{const{reservations:t}=pa(),{rows:a,loading:s,error:l,range:c,setRange:h,applyRange:d,pageSize:g,setPageSize:p,pageIndex:v,hasNext:T,nextPage:x,prevPage:C,cancelReservation:_,filterMode:A,setFilterMode:B}=_N(t,n,e);return y.jsx("section",{className:Qe.section,children:y.jsxs("div",{className:Qe.card,children:[y.jsx("h1",{className:Qe.title,children:"Mis reservas"}),y.jsx("div",{className:Qe.topBar,children:y.jsxs("div",{className:Qe.segmented,children:[y.jsx("button",{type:"button",className:`${Qe.segmentBtn} ${A==="upcoming-active"?Qe.segmentBtnActive:""}`,onClick:()=>B("upcoming-active"),disabled:s,title:"Mostrar próximas con estado Activa",children:"Próximas activas"}),y.jsx("button",{type:"button",className:`${Qe.segmentBtn} ${A==="history"?Qe.segmentBtnActive:""}`,onClick:()=>B("history"),disabled:s,title:"Ver pasadas y canceladas (con rango de fechas)",children:"Historial"})]})}),A==="history"&&y.jsxs("form",{className:Qe.form,onSubmit:I=>{I.preventDefault(),d()},children:[y.jsxs("label",{className:Qe.label,children:["Desde",y.jsx("input",{className:Qe.input,type:"date",value:c.from,max:c.to||void 0,onChange:I=>h(k=>({...k,from:I.target.value}))})]}),y.jsxs("label",{className:Qe.label,children:["Hasta",y.jsx("input",{className:Qe.input,type:"date",value:c.to,min:c.from||void 0,onChange:I=>h(k=>({...k,to:I.target.value}))})]})]}),s&&y.jsx("div",{className:Qe.info,children:"Cargando…"}),l&&y.jsx("div",{className:Qe.error,children:l}),!s&&!l&&a.length>0&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:Qe.tableWrap,children:y.jsxs("table",{className:Qe.table,children:[y.jsx("thead",{children:y.jsxs("tr",{className:Qe.theadRow,children:[e?y.jsx("th",{className:Qe.th,children:"Usuario"}):null,y.jsx("th",{className:Qe.th,children:"Fecha"}),y.jsx("th",{className:Qe.th,children:"Turno"}),y.jsx("th",{className:Qe.th,children:"Celda"}),y.jsx("th",{className:Qe.th,children:"Vehículo"}),y.jsx("th",{className:Qe.th,children:"Estado"}),y.jsx("th",{className:Qe.th,children:"Acciones"})]})}),y.jsx("tbody",{children:a.map(I=>y.jsxs("tr",{children:[e?y.jsx("td",{className:Qe.td,children:I.User}):null,y.jsx("td",{className:Qe.td,children:I.Date}),y.jsx("td",{className:Qe.td,children:I.Turn}),y.jsx("td",{className:Qe.td,children:I.Spot}),y.jsx("td",{className:Qe.td,children:I.VehicleType}),y.jsx("td",{className:Qe.td,children:y.jsx("span",{className:Qe.pill,style:{background:SN(I.Status)},children:I.Status})}),y.jsx("td",{className:Qe.td,children:I.Status==="Activa"?y.jsx("button",{className:Qe.cancelBtn,onClick:()=>{_(I.Id)},disabled:s,title:"Cancelar esta reserva",children:"Cancelar"}):y.jsx("p",{children:"No hay acciones disponibles"})})]},I.Id))})]})}),y.jsxs("div",{className:Qe.paginationBar,children:[y.jsxs("div",{className:Qe.paginationLeft,children:[y.jsx("button",{className:Qe.pageBtn,onClick:C,disabled:s||v===0,children:"← Anterior"}),y.jsx("button",{className:Qe.pageBtn,onClick:x,disabled:s||!T,children:"Siguiente →"}),y.jsxs("span",{className:Qe.pageInfo,children:["Página ",v+1]})]}),y.jsx("div",{className:Qe.paginationRight,children:y.jsxs("label",{className:Qe.pageSizeLabel,children:["Filas por página",y.jsxs("select",{className:Qe.pageSizeSelect,value:g,onChange:I=>p(Number(I.target.value)||20),disabled:s,children:[y.jsx("option",{value:5,children:"5"}),y.jsx("option",{value:10,children:"10"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]})})]})]}),!s&&!l&&a.length===0&&y.jsx("div",{className:Qe.info,children:n?"No hay reservas para los filtros seleccionados.":"Proporciona un email para ver reservas."})]})})},CN="_wrapper_1l0bv_33",EN="_h3_1l0bv_45",AN="_filtersBar_1l0bv_61",wN="_searchBox_1l0bv_97",bN="_searchInput_1l0bv_113",IN="_pageSizeBox_1l0bv_141",RN="_pageSizeSelect_1l0bv_157",NN="_cardGrid_1l0bv_185",kN="_card_1l0bv_185",ON="_cardHeader_1l0bv_225",MN="_cardCode_1l0bv_245",DN="_badgeInactive_1l0bv_267",PN="_metaLabel_1l0bv_289",FN="_btnPrimary_1l0bv_299",LN="_emptyGrid_1l0bv_315",UN="_badgeGroup_1l0bv_327",BN="_badge_1l0bv_255",HN="_badgeFree_1l0bv_385",jN="_badgeReserved_1l0bv_397",zN="_badgeInUse_1l0bv_409",GN="_celdaTitle_1l0bv_433",$N="_btnLink_1l0bv_445",KN="_btn_1l0bv_299",VN="_paginationBar_1l0bv_493",qN="_pageBtn_1l0bv_509",YN="_pageInfo_1l0bv_531",XN="_capacityCard_1l0bv_577",WN="_capacityHeader_1l0bv_603",QN="_turnPill_1l0bv_617",JN="_capacityGrid_1l0bv_635",ZN="_capacityItem_1l0bv_651",ek="_capacityLabel_1l0bv_669",tk="_capacityValue_1l0bv_681",nk="_capacityTotal_1l0bv_693",rk="_modalBackdrop_1l0bv_721",ak="_modal_1l0bv_721",ik="_field_1l0bv_763",sk="_modalActions_1l0bv_775",ok="_actionsRight_1l0bv_789",lk="_btnGhost_1l0bv_801",He={wrapper:CN,h3:EN,filtersBar:AN,searchBox:wN,searchInput:bN,pageSizeBox:IN,pageSizeSelect:RN,cardGrid:NN,card:kN,cardHeader:ON,cardCode:MN,badgeInactive:DN,metaLabel:PN,btnPrimary:FN,emptyGrid:LN,badgeGroup:UN,badge:BN,badgeFree:HN,badgeReserved:jN,badgeInUse:zN,celdaTitle:GN,btnLink:$N,btn:KN,paginationBar:VN,pageBtn:qN,pageInfo:YN,capacityCard:XN,capacityHeader:WN,turnPill:QN,capacityGrid:JN,capacityItem:ZN,capacityLabel:ek,capacityValue:tk,capacityTotal:nk,modalBackdrop:rk,modal:ak,field:ik,modalActions:sk,actionsRight:ok,btnGhost:lk},ck=n=>({Id:Number(n.ID??n.Id??n.id??0),Title:String(n.Title??n.title??""),TipoCelda:n.TipoCelda??n.tipoCelda??"-",Activa:n.Activa??n.estado??"-",Raw:n,Itinerancia:n.Itinerancia});function uk(n){const[e,t]=K.useState([]),[a,s]=K.useState([]),[l,c]=K.useState(!1),[h,d]=K.useState(null),[g,p]=K.useState(""),[v,T]=K.useState("all"),[x,C]=K.useState("all"),[_,A]=K.useState(50),[B,I]=K.useState(0),[k,z]=K.useState(!1),[X,W]=K.useState(!1),[N,G]=K.useState(!1),[V,ie]=K.useState(null),[J,he]=K.useState({Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"}),Ae=J.Title.trim().length>0&&(J.TipoCelda==="Carro"||J.TipoCelda==="Moto")&&(J.Activa==="Activa"||J.Activa==="Inactiva")&&(J.Itinerancia==="Empleado Itinerante"||J.Itinerancia==="Directivo"||J.Itinerancia==="Empleado Fijo"),je=()=>{he({Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"}),ie(null),W(!0)},ke=()=>{W(!1),ie(null)},re=K.useCallback(async(b,L)=>{if(!b){alert("ID inválido");return}try{c(!0);const P=L==="Activa"?"No Activa":"Activa";await n.update(String(b),{Activa:P}),t(j=>j.map(Z=>Z.Id===Number(b)?{...Z,Activa:P}:Z)),s(j=>j.map(Z=>Z.Id===Number(b)?{...Z,Activa:P}:Z))}catch(P){console.error("[useCeldas] toggleEstado error:",P),alert(P?.message??"No se pudo actualizar el estado")}finally{c(!1)}},[n]),_e=async()=>{if(Ae){G(!0),ie(null);try{const b=J.Title.trim(),L={TipoCelda:J.TipoCelda,Activa:J.Activa,Itinerancia:J.Itinerancia};if(J.TipoCelda==="Moto"){const j=["A","B","C","D","E"].map(Ce=>({Title:`${b}${Ce}`,...L})),be=(await Promise.allSettled(j.map(Ce=>n.create(Ce)))).map((Ce,Pe)=>({r:Ce,i:Pe})).filter(({r:Ce})=>Ce.status==="rejected");if(be.length>0){const Ce=be.map(({i:Pe})=>String(j[Pe].Title)).join(", ");throw new Error(`No se pudieron crear estas celdas: ${Ce}. Verifica duplicados o permisos.`)}}else{const P={Title:b,...L};await n.create(P)}ke(),await fe()}catch(b){ie(b?.message??"No se pudo crear la celda")}finally{G(!1)}}},fe=K.useCallback(async()=>{c(!0),d(null);try{const L=g.trim().toLowerCase().replace(/'/g,"''"),P=[];L&&P.push(`contains(tolower(fields/Title),'${L}')`),v!=="all"&&P.push(`fields/TipoCelda eq '${v}'`),x!=="all"&&P.push(`fields/Itinerancia eq '${x}'`);const Z=(await n.getAll({orderby:"fields/Title asc",top:2e3,...P.length?{filter:P.join(" and ")}:{}})).map(ck);t(Z),s(Z.slice(0,_)),I(0),z(Z.length>_)}catch(b){console.error("[useCeldas] reloadAll error:",b),t([]),s([]),d(b?.message??"Error al cargar celdas"),z(!1)}finally{c(!1)}},[n,g,_,v,x]),Te=K.useCallback(b=>{const L=Number.isFinite(b)&&b>0?Math.floor(b):20;A(L);const P=e.slice(0,L);s(P),I(0),z(e.length>L)},[e]),U=K.useCallback(()=>{if(l)return;const b=B+1,L=b*_,P=L+_;L>=e.length||(s(e.slice(L,P)),I(b),z(P<e.length))},[l,B,_,e]),ue=K.useCallback(()=>{if(l||B===0)return;const b=B-1,L=b*_,P=L+_;s(e.slice(L,P)),I(b),z(e.length>P)},[l,B,_,e]);return K.useEffect(()=>{let b=!1;return(async()=>b||await fe())(),()=>{b=!0}},[fe]),K.useEffect(()=>{fe()},[v,x]),{rows:a,loading:l,error:h,search:g,setSearch:p,tipo:v,setTipo:T,itinerancia:x,setItinerancia:C,pageSize:_,setPageSize:Te,pageIndex:B,hasNext:k,nextPage:U,prevPage:ue,reloadAll:fe,toggleEstado:re,createOpen:X,createSaving:N,createError:V,createForm:J,setCreateForm:he,canCreate:Ae,openModal:je,closeModal:ke,create:_e}}function hk(n){const[e,t]=K.useState({}),[a,s]=K.useState(!1),[l,c]=K.useState(null),h=K.useCallback(async()=>{try{s(!0),c(null);const d=new Date,g=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`,p=await n.getAll({filter:`fields/Date eq '${g}' and (fields/Status ne 'Cancelada')`,top:5e3,orderby:"fields/Turn asc"}),v={};for(const T of p){const x=Number(T.SpotIdLookupId??T.SpotId??NaN);if(!Number.isFinite(x))continue;const C=String(T.Turn??"").toLowerCase(),_=T.NombreUsuario??"";v[x]||(v[x]={}),C==="manana"||C==="mañana"?(v[x].Manana=!0,v[x].PorManana=_):C==="tarde"?(v[x].Tarde=!0,v[x].PorTarde=_):(v[x].Manana=!0,v[x].Tarde=!0,v[x].PorManana=_,v[x].PorTarde=_)}t(v)}catch(d){c(d?.message??"No se pudo cargar ocupación"),t({})}finally{s(!1)}},[n]);return K.useEffect(()=>{h()},[h]),{occByTurn:e,loading:a,error:l,reload:h}}const cT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),ca={};function vS(n){return JSON.stringify({onlyEnabled:n.onlyEnabled??!0,domainFilter:(n.domainFilter??"").toLowerCase()})}function fk(n,e){const t=n.id??n.userPrincipalName??n.mail??e;return{id:String(t),displayName:String(n.displayName??"—"),mail:String(n.mail??n.userPrincipalName??""),jobTitle:String(n.jobTitle??"")}}async function dk(n,e){const t=vS(e);if(ca[t]?.data)return ca[t].data;if(ca[t]||(ca[t]={data:null,promise:null}),!ca[t].promise){const a=e.onlyEnabled??!0,s=(e.domainFilter??"").toLowerCase(),l=encodeURIComponent("id,displayName,mail,userPrincipalName,jobTitle,accountEnabled"),c=999,h=[];a&&h.push("accountEnabled eq true");let d=`/users?$select=${l}&$top=${c}`+(h.length?`&$filter=${encodeURIComponent(h.join(" and "))}`:"");const g=[];async function p(){for(;d;){const v=await n.get(d),T=Array.isArray(v?.value)?v.value:[];g.push(...T);const x=v?.["@odata.nextLink"];d=x?x.replace("https://graph.microsoft.com/v1.0",""):""}}ca[t].promise=p().then(()=>{const v=new Map;for(const x of g){const C=String(x.mail||x.userPrincipalName||"").trim().toLowerCase();C&&(s&&!C.endsWith(`@${s}`)||v.has(C)||v.set(C,x))}const T=Array.from(v.values()).map(fk);return ca[t].data=T,T}).finally(()=>{ca[t].promise=null})}return ca[t].promise}function yS(n={}){const{ready:e,getToken:t}=xo(),[a,s]=K.useState([]),[l,c]=K.useState(!0),[h,d]=K.useState(null),g=vS(n),p=K.useCallback(async()=>{if(e){c(!0),d(null);try{const x=new fo(t),C=await dk(x,n);s(typeof n.previewLimit=="number"?C.slice(0,n.previewLimit):C)}catch(x){s([]),d(x?.message??"Error cargando usuarios")}finally{c(!1)}}},[e,t,n]);K.useEffect(()=>{p()},[p,g]);const v=K.useCallback(x=>{if(!x)return a;const C=cT(x);return a.filter(_=>cT(`${_.displayName} ${_.jobTitle??""} ${_.mail??""}`).includes(C))},[a]),T=K.useCallback(async()=>{e&&(ca[g]={data:null,promise:null},await p())},[e,p,g]);return{workers:a,loading:l,error:h,filter:v,refresh:T}}const Rl=n=>{const e=Number.isFinite(n)?Math.floor(Number(n)):0;return Math.min(23,Math.max(0,e))},Ou=n=>`${String(Rl(n)).padStart(2,"0")}:00`;function gk(n){return{amStart:Ou(n?.InicioManana??6),amEnd:Ou(n?.FinalManana??12),pmStart:Ou(n?.InicioTarde??13),pmEnd:Ou(n?.FinalTarde??19)}}function mk(n){const e={h:Rl(n?.InicioManana??6),m:0},t={h:Rl(n?.FinalManana??12),m:59},a={h:Rl(n?.InicioTarde??13),m:0},s={h:Rl(n?.FinalTarde??19),m:0},l=new Date,c=l.getHours()*60+l.getMinutes(),h=(d,g)=>c>=d.h*60+d.m&&c<=g.h*60+g.m;return h(e,t)?"Manana":h(a,s)?"Tarde":null}const pk=()=>{const{ready:n,getToken:e}=xo(),t=K.useMemo(()=>{if(!n)return null;const W=new fo(e);return new fS(W,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","parkingslots")},[n,e]),a=K.useMemo(()=>{if(!n)return null;const W=new fo(e);return new cm(W,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","reservations")},[n,e]),s=t?uk(t):{rows:[],loading:!0,error:null,search:"",setSearch:W=>{},tipo:"all",setTipo:W=>{},itinerancia:"all",setItinerancia:W=>{},pageSize:50,setPageSize:W=>{},pageIndex:0,hasNext:!1,nextPage:()=>{},prevPage:()=>{},reloadAll:async()=>{},toggleEstado:async()=>{},createOpen:!1,createSaving:!1,createError:null,createForm:{Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"},setCreateForm:()=>{},canCreate:!1,openModal:()=>{},closeModal:()=>{},create:async()=>{}},l=pS(),c=a?hk(a):{occByTurn:{},loading:!0,error:null,reload:async()=>{}},{workers:h,loading:d}=yS(),g=K.useMemo(()=>s.rows.map(W=>({...W,__occ:c.occByTurn[W.Id]})),[s.rows,c.occByTurn]),p=K.useMemo(()=>l.hours?mk(l.hours):null,[l.hours]),v=K.useMemo(()=>{if(!l.hours)return"Cargando horarios…";const W=gk(l.hours);return`Mañana: ${W.amStart}–${W.amEnd} · Tarde: ${W.pmStart}–${W.pmEnd}`},[l.hours]),T=K.useMemo(()=>{const W=g.filter(je=>je.Activa==="Activa"),N=je=>{const ke=c.occByTurn[je]||{};return p?p==="Manana"?!!ke?.Manana:!!ke?.Tarde:!!(ke?.Manana||ke?.Tarde)},G=W.filter(je=>je.TipoCelda==="Carro").length,V=W.filter(je=>je.TipoCelda==="Carro"&&N(je.Id)).length,ie=Math.max(0,G-V),J=W.filter(je=>je.TipoCelda==="Moto").length,he=W.filter(je=>je.TipoCelda==="Moto"&&N(je.Id)).length,Ae=Math.max(0,J-he);return{turno:p,totalCarros:G,libresCarros:ie,totalMotos:J,libresMotos:Ae}},[g,c.occByTurn,p]),[x,C]=K.useState(!1),[_,A]=K.useState(null),B=W=>{A(W),C(!0)},I=()=>{A(null),C(!1)};K.useEffect(()=>{let N=null;const G=()=>{s.reloadAll(),c.reload()},V=()=>{N==null&&(N=window.setInterval(G,3e5))},ie=()=>{N!=null&&(window.clearInterval(N),N=null)};document.hidden||V();const J=()=>document.hidden?ie():(G(),V());return document.addEventListener("visibilitychange",J),()=>{ie(),document.removeEventListener("visibilitychange",J)}},[s.reloadAll,c.reload]);const k=W=>{W.key==="Enter"&&(W.preventDefault(),s.reloadAll())},z=s.loading||l.loading||c.loading,X=s.createSaving;return{loading:z,error:s.error||l.error||null,rows:g,search:s.search,setSearch:s.setSearch,onSearchEnter:k,tipo:s.tipo,setTipo:s.setTipo,itinerancia:s.itinerancia,setItinerancia:s.setItinerancia,pageSize:s.pageSize,setPageSize:s.setPageSize,pageIndex:s.pageIndex,hasNext:s.hasNext,nextPage:s.nextPage,prevPage:s.prevPage,createOpen:s.createOpen,createSaving:s.createSaving,createError:s.createError,createForm:s.createForm,canCreate:s.canCreate,openModal:s.openModal,closeModal:s.closeModal,setCreateForm:s.setCreateForm,create:s.create,occLoading:c.loading,capacidadAhora:T,currentTurn:p,hoursLabel:v,open:x,selected:_,openDetails:B,closeDetails:I,workers:h,workersLoading:d,actionsDisabled:X}},vk=2e3;async function TS(n,e){if(!e)return null;const a=(await n.getAll({filter:`fields/SpotAsignado eq ${Number(e)}`,top:1,orderby:"fields/Title asc"}))?.[0];return a?{id:Number(a.ID??""),name:String(a.Title??""),email:a.Correo??void 0,slotAsignado:a.SpotAsignado??null}:null}async function yk(n,e,t,a){if(!e||!t)throw new Error("Parámetros inválidos para asignación.");await n.update(String(t),{SpotAsignado:Number(e),CodigoCelda:a})}async function Tk(n,e){if(!e)throw new Error("ID de celda inválido.");const t=await TS(n,e);t&&await n.update(String(t.id),{SpotAsignado:null,CodigoCelda:null})}async function xk(n,e,t){const a=(e||"").replace(/'/g,"''").toLowerCase(),s=[];s.push("(fields/SpotAsignado eq null or fields/SpotAsignado eq 0)"),a&&s.push(`(contains(tolower(fields/Title),'${a}') or contains(tolower(fields/Correo),'${a}'))`);const l=s.join(" and ");return(await n.getAll({filter:l,top:vk,orderby:"fields/Title asc"})).map(d=>({id:String(d.ID??""),name:String(d.Title??""),email:d.Correo??void 0,slotAsignado:d.SpotAsignado??null}))}const xS=n=>n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase("es"),_k=["practicante","aprendiz","auxiliar","admin","administrativa","administrativo","callcenter","facturas","cedi","facturacion"],uT=_k.map(xS);async function _S(n){const e=(n??"").trim();if(!e)return!1;const t=xS(e),a=t.split(/[^\p{L}\d]+/u).filter(Boolean),s=new Set(a);for(const l of uT)if(s.has(l))return!1;for(const l of uT)if(t.includes(l))return!1;return!0}const Je={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center"},modal:{background:"#fff",width:"min(900px, 96vw)",maxHeight:"90vh",overflow:"auto",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,.2)",border:"1px solid #e5e7eb"},header:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},title:{margin:0,fontSize:18,fontWeight:700},closeBtn:{background:"transparent",border:0,fontSize:20,lineHeight:1,cursor:"pointer"},body:{padding:"12px 16px",display:"grid",gap:10,fontSize:14},footer:{padding:"12px 16px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},muted:{color:"#6b7280"},card:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,display:"grid",gap:10},rowBetween:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},btnPrimary:{background:"#2563eb",color:"#fff",border:0,padding:"8px 12px",borderRadius:8,cursor:"pointer"},btnGhost:{background:"transparent",border:"1px solid #e5e7eb",padding:"8px 12px",borderRadius:8,cursor:"pointer"},btnDanger:{background:"#dc2626",color:"#fff",border:0,padding:"8px 12px",borderRadius:8,cursor:"pointer"},input:{width:"90%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:14},select:{width:"93%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:14,background:"#fff"},pickerPanel:{marginTop:8,border:"1px solid #e5e7eb",borderRadius:8,padding:10,display:"grid",gap:10},list:{listStyle:"none",margin:0,padding:0},listItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderTop:"1px solid #f3f4f6"},labelCol:{display:"grid",gap:6}},hT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim();function Sk({open:n,slot:e,workers:t=[],workersLoading:a=!1,onClose:s,onChanged:l}){const{ready:c,getToken:h}=xo(),d=K.useMemo(()=>{if(!c)return null;const Me=new fo(h);return new cm(Me,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","reservations")},[c,h]),g=K.useMemo(()=>{if(!c)return null;const Me=new fo(h);return new dS(Me,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","Colaboradores fijos")},[c,h]),[p,v]=K.useState(!1),[T,x]=K.useState(null),[C,_]=K.useState(null),[A,B]=K.useState(!1),[I,k]=K.useState(""),[z,X]=K.useState([]),[W,N]=K.useState(!1),G=K.useMemo(()=>new Date().toISOString().slice(0,10),[]),[V,ie]=K.useState(G),[J,he]=K.useState("Manana"),[Ae,je]=K.useState(!1),[ke,re]=K.useState(null),[_e,fe]=K.useState(""),[Te,U]=K.useState(""),[ue,b]=K.useState({name:!1,mail:!1}),L=Me=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Me.trim()),P=_e.trim()?null:"El nombre es obligatorio.",j=Te.trim()?L(Te)?null:"El correo no tiene un formato válido.":"El correo es obligatorio.",Z=!Ae&&!P&&!j,be=K.useMemo(()=>(t??[]).map((Me,Ot)=>({key:String(Me.id??Me.mail??Me.displayName??Ot),id:Me.id,name:Me.displayName??"",email:Me.mail??"",job:Me.jobTitle??""})),[t]),[Ce,Pe]=K.useState(""),[De,ot]=K.useState(""),et=K.useMemo(()=>{if(!Ce)return be;const Me=hT(Ce);return be.filter(Ot=>hT(`${Ot.name} ${Ot.email} ${Ot.job}`).includes(Me))},[be,Ce]),jt=K.useRef(null),lt=K.useCallback(async Me=>{ot(Me);const Ot=be.find(Hn=>Hn.key===Me);if(!Ot)return;const vn=Symbol();jt.current=vn;try{const Hn=await _S(Ot.name);if(jt.current!==vn)return;fe(Hn?Ot.name??"":""),U(Ot.email??""),re(null),b(jn=>({...jn,name:!0,mail:!!Ot.email||jn.mail}))}catch(Hn){console.error("[onSelectWorker] nameProve error:",Hn),fe(""),U(Ot.email??"")}},[be]),Un=K.useMemo(()=>String(e?.Itinerancia??"").toLowerCase().includes("itinerante")?"reserva":"fijar",[e?.Itinerancia]);K.useEffect(()=>{if(!n||!e||!g)return;let Me=!1;return(async()=>{try{v(!0),x(null);const Ot=await TS(g,e.Id);Me||_(Ot)}catch(Ot){Me||x(Ot?.message??"Error al cargar asignación")}finally{Me||v(!1)}})(),()=>{Me=!0}},[n,e?.Id,g]),K.useEffect(()=>{n&&(C?(fe(C.name??""),U(C.email??"")):(fe(""),U("")),ie(G),he("Manana"),re(null),b({name:!1,mail:!1}),Pe(""),ot(""))},[n,C,G]);const kt=K.useCallback(async()=>{if(g){N(!0),x(null);try{const Me=await xk(g,I);X(Me)}catch(Me){x(Me?.message??"Error buscando colaboradores"),X([])}finally{N(!1)}}},[I,g]),Fe=K.useCallback(async Me=>{if(!(!Me||!e||!g)){v(!0),x(null);try{await yk(g,e.Id,Me.id,e.Title),_(Me),B(!1),k(""),X([]),await l?.()}catch(Ot){x(Ot?.message??"No se pudo asignar la celda")}finally{v(!1)}}},[e,l,g]),Nn=K.useCallback(async()=>{if(!(!C||!g)){if(!C.slotAsignado){console.warn("[onUnassign] assignee sin slot",C),x("Asignado inválido: falta ID de la celda.");return}v(!0),x(null);try{await Tk(g,Number(C.slotAsignado)),_(null),await l?.()}catch(Me){console.error("[onUnassign] error",Me),x(Me?.message??"No se pudo desasignar la celda")}finally{v(!1)}}},[C,l,g]),Bn=K.useCallback(async(Me,Ot,vn)=>{if(!d)return!1;const Hn=await d.getAll({select:["ID"],top:1,filter:`SpotId eq ${Me} and Date eq '${Ot}' and Turn eq '${vn}' and (Status ne 'Cancelada')`}),jn=Hn?.data??Hn?.value??[];return Array.isArray(jn)&&jn.length>0},[d]),Cr=K.useCallback(async()=>{if(!(!e||!d)){if(b({name:!0,mail:!0}),P||j){re(P||j);return}je(!0),re(null);try{if(await Bn(e.Id,V,J)){re("Ya existe una reserva para esa fecha y turno en esta celda."),je(!1);return}await d.create({SpotId:{Id:Number(e.Id)},Date:V,Turn:J,Status:"Activa",NombreUsuario:_e,Title:Te,VehicleType:e.TipoCelda}),await l?.(),alert("Reserva creada correctamente."),s()}catch(Me){re(Me?.message??"No fue posible crear la reserva.")}finally{je(!1)}}},[e,V,J,_e,Te,Bn,l,s,P,j,d]);if(!n||!e)return null;const sr=Me=>{Me.target===Me.currentTarget&&s()};return y.jsx("div",{style:Je.backdrop,onMouseDown:sr,children:y.jsxs("div",{style:Je.modal,children:[y.jsxs("header",{style:Je.header,children:[y.jsxs("h3",{style:Je.title,children:["Celda ",e.Title]}),y.jsx("button",{style:Je.closeBtn,onClick:s,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{style:Je.body,children:[y.jsxs("div",{children:[y.jsx("strong",{children:"Tipo:"})," ",e.TipoCelda]}),y.jsxs("div",{children:[y.jsx("strong",{children:"Estado:"})," ",e.Activa]}),y.jsxs("div",{style:Je.muted,children:[y.jsx("strong",{children:"Itinerancia:"})," ",e.Itinerancia??"—","  → ",y.jsx("strong",{children:Un==="reserva"?"Modo Reserva (turno)":"Modo Asignación fija"})]}),Un==="fijar"&&y.jsxs("div",{style:Je.card,children:[y.jsx("h4",{style:{margin:0},children:"Asignación fija"}),p&&y.jsx("div",{style:Je.muted,children:"Cargando…"}),T&&y.jsx("div",{style:{color:"crimson"},children:T}),!p&&y.jsx(y.Fragment,{children:C?y.jsxs("div",{style:Je.rowBetween,children:[y.jsxs("div",{children:[y.jsxs("div",{children:[y.jsx("strong",{children:"Asignado a:"})," ",C.name]}),C.email&&y.jsx("div",{style:Je.muted,children:C.email})]}),y.jsx("button",{type:"button",style:Je.btnDanger,onClick:()=>Nn(),children:"Desasignar"})]}):y.jsxs("div",{style:Je.rowBetween,children:[y.jsx("div",{style:Je.muted,children:"Sin asignación"}),y.jsx("button",{style:Je.btnPrimary,onClick:()=>B(!0),children:"Asignar"})]})}),A&&y.jsxs("div",{style:Je.pickerPanel,children:[y.jsxs("div",{style:{display:"flex",gap:8},children:[y.jsx("input",{style:Je.input,placeholder:"Buscar colaborador (nombre o correo)…",value:I,onChange:Me=>k(Me.target.value),onKeyDown:Me=>Me.key==="Enter"&&kt()}),y.jsx("button",{style:Je.btnPrimary,onClick:kt,disabled:W||!g,children:W?"Buscando…":"Buscar"}),y.jsx("button",{style:Je.btnGhost,onClick:()=>{B(!1),k(""),X([])},children:"Cerrar"})]}),y.jsxs("ul",{style:Je.list,children:[z.length===0&&!W&&y.jsx("li",{style:Je.muted,children:"Sin resultados"}),z.map(Me=>y.jsxs("li",{style:Je.listItem,children:[y.jsxs("div",{children:[y.jsx("div",{style:{fontWeight:600},children:Me?.name}),Me?.email&&y.jsx("div",{style:Je.muted,children:Me.email})]}),y.jsx("button",{style:Je.btnPrimary,onClick:()=>Fe(Me),children:"Asignar"})]},Me?.id))]})]})]}),Un==="reserva"&&y.jsxs("div",{style:Je.card,children:[y.jsx("h4",{style:{margin:0},children:"Reserva puntual por turno"}),y.jsxs("div",{style:{...Je.muted,marginBottom:8},children:["Crea una reserva para un ",y.jsx("strong",{children:"día"})," y ",y.jsx("strong",{children:"turno"})," (AM/PM)."]}),y.jsxs("fieldset",{style:{border:0,padding:0,margin:0},children:[y.jsxs("label",{style:{...Je.labelCol,marginBottom:6},children:[y.jsx("span",{children:y.jsx("strong",{children:"Colaborador"})}),y.jsx("input",{style:Je.input,type:"text",placeholder:"Buscar por nombre/correo/cargo…",value:Ce,onChange:Me=>Pe(Me.target.value),disabled:a})]}),y.jsxs("select",{style:Je.select,value:De,onChange:Me=>lt(Me.target.value),disabled:a,children:[y.jsx("option",{value:"",children:a?"Cargando colaboradores…":et.length===0?"Sin resultados":"Selecciona un colaborador (opcional)"}),et.map(Me=>y.jsxs("option",{value:Me.key,children:[Me.name,Me.job?` · ${Me.job}`:""]},Me.key))]}),y.jsx("br",{}),y.jsx("small",{style:Je.muted,children:"Al seleccionar, se rellenan Nombre y Correo (puedes editarlos)."})]}),ke&&y.jsx("div",{style:{color:"crimson"},children:ke}),y.jsxs("div",{style:{display:"grid",gap:10,marginTop:8},children:[y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Fecha"})}),y.jsx("input",{type:"date",style:Je.input,value:V,onChange:Me=>ie(Me.target.value),min:G})]}),y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Turno"})}),y.jsxs("select",{style:Je.select,value:J,onChange:Me=>he(Me.target.value),children:[y.jsx("option",{value:"Manana",children:"AM (06:00–12:59)"}),y.jsx("option",{value:"Tarde",children:"PM (13:00–19:00)"})]})]}),y.jsxs("div",{style:{display:"grid",gap:8},children:[y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Nombre"})}),y.jsx("input",{style:{...Je.input,borderColor:ue.name&&P?"#dc2626":Je.input.borderColor,outlineColor:ue.name&&P?"#dc2626":void 0},value:_e,onChange:Me=>{fe(Me.target.value),ke&&re(null)},onBlur:()=>b(Me=>({...Me,name:!0})),placeholder:"Nombre del usuario",required:!0,"aria-required":"true","aria-invalid":!!(ue.name&&P)}),ue.name&&P&&y.jsx("small",{style:{color:"#dc2626"},children:P})]}),y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Correo"})}),y.jsx("input",{style:{...Je.input,borderColor:ue.mail&&j?"#dc2626":Je.input.borderColor,outlineColor:ue.mail&&j?"#dc2626":void 0},type:"email",value:Te,onChange:Me=>{U(Me.target.value),ke&&re(null)},onBlur:()=>b(Me=>({...Me,mail:!0})),placeholder:"correo@empresa.com",required:!0,"aria-required":"true","aria-invalid":!!(ue.mail&&j)}),ue.mail&&j&&y.jsx("small",{style:{color:"#dc2626"},children:j})]})]}),y.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[y.jsx("button",{style:Je.btnGhost,type:"button",onClick:()=>{ie(G),he("Manana"),fe(C?.name??""),U(C?.email??""),re(null),b({name:!1,mail:!1}),Pe(""),ot("")},children:"Limpiar"}),y.jsx("button",{style:Je.btnPrimary,type:"button",onClick:Cr,disabled:!Z||!d,children:Ae?"Creando…":"Crear reserva"})]})]})]})]}),y.jsx("footer",{style:Je.footer,children:y.jsx("button",{style:Je.btnGhost,onClick:s,children:"Cerrar"})})]})})}const Ck=()=>{const{loading:n,error:e,rows:t,pageIndex:a,hasNext:s,search:l,setSearch:c,onSearchEnter:h,tipo:d,setTipo:g,itinerancia:p,setItinerancia:v,pageSize:T,setPageSize:x,nextPage:C,prevPage:_,createOpen:A,createSaving:B,createError:I,createForm:k,canCreate:z,openModal:X,closeModal:W,setCreateForm:N,create:G,occLoading:V,capacidadAhora:ie,currentTurn:J,hoursLabel:he,openDetails:Ae,closeDetails:je,open:ke,selected:re,workers:_e,workersLoading:fe,actionsDisabled:Te}=pk(),U=K.useMemo(()=>{const b=String(J??"").toLowerCase();return b==="manana"||b==="mañana"?"Manana":b==="tarde"?"Tarde":"Fuera"},[J]),ue=(b,L,P,j,Z)=>{let be=He.badge,Ce="Disponible";return b?L?j?(be=`${He.badge} ${He.badgeInUse}`,Ce="En uso"):(be=`${He.badge} ${He.badgeReserved}`,Ce="Reservada"):(be=`${He.badge} ${He.badgeFree}`,Ce="Disponible"):(be=`${He.badge} ${He.badgeInactive}`,Ce="Inactiva"),y.jsxs("span",{className:be,"aria-label":`${P}: ${Ce}${Z?` por ${Z}`:""}`,children:[y.jsxs("span",{className:He.badgeLine,children:[P,": ",Ce]}),y.jsx("br",{}),Z&&y.jsx("small",{className:He.badgeWho,children:Z})]})};return y.jsxs("section",{className:He.wrapper,children:[n&&y.jsx("div",{className:He.loadingBar,role:"status",children:"Cargando…"}),e&&y.jsxs("div",{className:He.error,role:"alert",children:["Error: ",e]}),y.jsx("h3",{className:He.h3,children:"Listado de celdas"}),y.jsxs("div",{className:He.capacityCard,children:[y.jsxs("div",{className:He.capacityHeader,children:[y.jsx("strong",{children:"Capacidad hoy"}),y.jsx("span",{className:He.turnPill,children:U==="Manana"?"Turno actual: AM":U==="Tarde"?"Turno actual: PM":"Fuera de horario"})]}),y.jsxs("div",{className:He.capacityGrid,children:[y.jsxs("div",{className:He.capacityItem,children:[y.jsx("div",{className:He.capacityLabel,children:"Carros disponibles"}),y.jsxs("div",{className:He.capacityValue,children:[ie.libresCarros,y.jsxs("span",{className:He.capacityTotal,children:["/ ",ie.totalCarros]})]})]}),y.jsxs("div",{className:He.capacityItem,children:[y.jsx("div",{className:He.capacityLabel,children:"Motos disponibles"}),y.jsxs("div",{className:He.capacityValue,children:[ie.libresMotos,y.jsxs("span",{className:He.capacityTotal,children:["/ ",ie.totalMotos]})]})]})]}),y.jsx("div",{style:{marginTop:6},children:y.jsx("small",{children:he})})]}),y.jsxs("div",{className:He.filtersBar,children:[y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Tipo de celda"}),y.jsxs("select",{className:He.pageSizeSelect,value:d,onChange:b=>g(b.target.value),children:[y.jsx("option",{value:"all",children:"Todas"}),y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Itinerancia"}),y.jsxs("select",{className:He.pageSizeSelect,value:p,onChange:b=>v(b.target.value),children:[y.jsx("option",{value:"all",children:"Todas"}),y.jsx("option",{value:"Empleado Fijo",children:"Empleado Fijo"}),y.jsx("option",{value:"Empleado Itinerante",children:"Empleado Itinerante"}),y.jsx("option",{value:"Directivo",children:"Directivo"})]})]}),y.jsx("div",{className:He.searchBox,children:y.jsx("input",{className:He.searchInput,type:"text",placeholder:"Buscar por código…",value:l,onChange:b=>c(b.target.value),onKeyDown:h,"aria-label":"Buscar celda por código"})}),y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Registros por página"}),y.jsxs("select",{className:He.pageSizeSelect,value:T,onChange:b=>x(Number(b.target.value)||50),children:[y.jsx("option",{value:6,children:"6"}),y.jsx("option",{value:12,children:"12"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]}),y.jsx("div",{className:He.actionsRight,children:y.jsx("button",{type:"button",className:`${He.btn} ${He.btnPrimary} ${He.btnAdd}`,onClick:X,disabled:Te,children:"Añadir celda"})})]}),t.length===0?y.jsx("div",{className:He.emptyGrid,children:"Sin resultados."}):y.jsx("ul",{className:He.cardGrid,children:t.map(b=>{const L=b.Activa==="Activa",P=b.__occ||{},j=!!P.Manana,Z=!!P.Tarde,be=ue(L,j,"AM",U==="Manana"&&j,P.PorManana),Ce=ue(L,Z,"PM",U==="Tarde"&&Z,P.PorTarde);return y.jsx("li",{className:He.card,children:y.jsxs("div",{className:He.cardHeader,children:[y.jsxs("div",{className:He.celdaTitle,children:[y.jsx("span",{className:He.cardCode,children:b.Title}),y.jsx("br",{}),y.jsxs("span",{className:He.metaLabel,children:["Tipo: ",b.TipoCelda]}),y.jsx("br",{}),y.jsxs("span",{className:He.metaLabel,children:["Itinerancia: ",b.Itinerancia]})]}),y.jsx("button",{type:"button",className:He.btnLink,onClick:()=>Ae(b),disabled:V,"aria-disabled":V,children:"Detalles"}),y.jsxs("div",{className:He.badgeGroup,children:[be,Ce]})]})},b.Id)})}),y.jsxs("div",{className:He.paginationBar,children:[y.jsx("button",{type:"button",className:He.pageBtn,onClick:_,disabled:a===0,children:"← Anterior"}),y.jsxs("span",{className:He.pageInfo,children:["Página ",a+1]}),y.jsx("button",{type:"button",className:He.pageBtn,onClick:C,disabled:!s,children:"Siguiente →"})]}),A&&y.jsx("div",{className:He.modalBackdrop,onClick:W,children:y.jsxs("div",{className:He.modal,onClick:b=>b.stopPropagation(),children:[y.jsx("h4",{children:"Nueva celda"}),I&&y.jsx("div",{className:He.error,children:I}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Código"}),y.jsx("input",{className:He.searchInput,value:k.Title,onChange:b=>N(L=>({...L,Title:b.target.value})),placeholder:"Ej: A-02"})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Tipo"}),y.jsxs("select",{className:He.pageSizeSelect,value:k.TipoCelda,onChange:b=>N(L=>({...L,TipoCelda:b.target.value})),children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Estado"}),y.jsxs("select",{className:He.pageSizeSelect,value:k.Activa,onChange:b=>N(L=>({...L,Activa:b.target.value})),children:[y.jsx("option",{value:"Activa",children:"Activa"}),y.jsx("option",{value:"Inactiva",children:"Inactiva"})]})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Itinerancia"}),y.jsxs("select",{className:He.pageSizeSelect,value:k.Itinerancia,onChange:b=>N(L=>({...L,Itinerancia:b.target.value})),children:[y.jsx("option",{value:"Empleado Fijo",children:"Empleado Fijo"}),y.jsx("option",{value:"Empleado Itinerante",children:"Empleado Itinerante"}),y.jsx("option",{value:"Directivo",children:"Directivo"})]})]}),y.jsxs("div",{className:He.modalActions,children:[y.jsx("button",{type:"button",className:He.btnGhost,onClick:W,disabled:B,children:"Cancelar"}),y.jsx("button",{type:"button",className:He.btn,onClick:G,disabled:!z||B,children:B?"Creando…":"Crear"})]})]})}),ke&&re&&y.jsx(Sk,{open:ke,slot:re,onClose:je,workers:_e,workersLoading:fe})]})},Ek="_card_4727i_57",Ak="_title_4727i_77",wk="_field_4727i_105",bk="_error_4727i_309",Ik="_ok_4727i_329",Rk="_actions_4727i_351",$t={card:Ek,title:Ak,field:wk,error:bk,ok:Ik,actions:Rk},qu=n=>Number.isFinite(n)?Math.max(0,Math.min(23,Math.floor(n))):0,Mu=n=>String(qu(n)).padStart(2,"0")+":00",Du=(n,e=0)=>{if(typeof n=="number")return qu(n);const t=String(n??"").trim(),a=/^(\d{1,2})/.exec(t);return qu(a?Number(a[1]):e)},Nk=({settingsSvc:n,settingsItemId:e="1"})=>{const[t,a]=K.useState(!0),[s,l]=K.useState(!1),[c,h]=K.useState(null),[d,g]=K.useState(null),[p,v]=K.useState({VisibleDays:7,TyC:"",InicioManana:7,FinalManana:12,InicioTarde:12,FinalTarde:18,PicoPlaca:!1});K.useEffect(()=>{let I=!1;return(async()=>{try{a(!0),h(null),g(null);const k=await n.get(e),z={VisibleDays:Number(k?.VisibleDays??7),TyC:String(k?.TerminosyCondiciones??k?.TyC??""),InicioManana:Du(k?.InicioManana,7),FinalManana:Du(k?.FinalManana,12),InicioTarde:Du(k?.InicioTarde,12),FinalTarde:Du(k?.FinalTarde,18),PicoPlaca:!!(k?.PicoPlaca??!1)};I||v(z)}catch(k){I||h(k?.message??"No se pudo cargar la configuración.")}finally{I||a(!1)}})(),()=>{I=!0}},[n,e]);const T=I=>k=>{const z=k.target.value,X=Number(z);v(W=>({...W,[I]:Number.isFinite(X)?X:W[I]})),g(null),h(null)},x=I=>k=>{v(z=>({...z,[I]:k.target.checked})),g(null),h(null)},C=I=>k=>{v(z=>({...z,[I]:k.target.value})),g(null),h(null)},_=!(p.InicioManana<p.FinalManana)||!(p.InicioTarde<p.FinalTarde),A=!t&&!s&&!_,B=async()=>{try{if(!A)return;l(!0),g(null),h(null);const I={VisibleDays:Number(p.VisibleDays)||0,TerminosyCondiciones:p.TyC,InicioManana:Mu(p.InicioManana),FinalManana:Mu(p.FinalManana),InicioTarde:Mu(p.InicioTarde),FinalTarde:Mu(p.FinalTarde),PicoPlaca:!!p.PicoPlaca};await n.update(e,I),g("Configuración guardada.")}catch(I){h(I?.message??"No se pudo guardar la configuración.")}finally{l(!1)}};return t?y.jsx("div",{className:$t.card,children:"Cargando configuración…"}):y.jsx("section",{className:$t.section,children:y.jsxs("div",{className:$t.card,children:[y.jsx("h3",{className:$t.title,children:"Ajustes de Parqueadero"}),c&&y.jsx("div",{className:$t.error,children:c}),d&&y.jsx("div",{className:$t.ok,children:d}),y.jsxs("div",{className:$t.grid,children:[y.jsxs("label",{className:$t.field,children:[y.jsx("span",{children:"Días visibles para reservar"}),y.jsx("input",{type:"number",min:1,max:60,value:p.VisibleDays,onChange:T("VisibleDays")})]}),y.jsxs("label",{className:$t.field,style:{alignItems:"center",gap:8},children:[y.jsx("input",{type:"checkbox",checked:p.PicoPlaca,onChange:x("PicoPlaca")}),y.jsx("span",{children:"Activar Pico y Placa"})]}),y.jsxs("fieldset",{className:$t.fieldset,children:[y.jsx("legend",{children:"Horario de Mañana"}),y.jsxs("div",{className:$t.row,children:[y.jsxs("label",{className:$t.inlineField,children:["Inicio",y.jsx("input",{type:"number",min:0,max:23,value:p.InicioManana,onChange:T("InicioManana")})]}),y.jsxs("label",{className:$t.inlineField,children:["Fin",y.jsx("input",{type:"number",min:0,max:23,value:p.FinalManana,onChange:T("FinalManana")})]})]})]}),y.jsxs("fieldset",{className:$t.fieldset,children:[y.jsx("legend",{children:"Horario de Tarde"}),y.jsxs("div",{className:$t.row,children:[y.jsxs("label",{className:$t.inlineField,children:["Inicio",y.jsx("input",{type:"number",min:0,max:23,value:p.InicioTarde,onChange:T("InicioTarde")})]}),y.jsxs("label",{className:$t.inlineField,children:["Fin",y.jsx("input",{type:"number",min:0,max:23,value:p.FinalTarde,onChange:T("FinalTarde")})]})]})]}),_&&y.jsx("div",{className:$t.warn,children:"Revisa los horarios: el inicio debe ser menor que el fin en cada turno."}),y.jsxs("label",{className:$t.field,style:{gridColumn:"1 / -1"},children:[y.jsx("span",{children:"Términos y Condiciones (HTML)"}),y.jsx("textarea",{className:$t.textarea,rows:10,value:p.TyC,onChange:C("TyC"),placeholder:"<p>Contenido HTML de Términos y Condiciones…</p>"})]})]}),y.jsx("div",{className:$t.actions,children:y.jsx("button",{className:$t.btnPrimary,onClick:B,disabled:!A,"aria-busy":s||void 0,title:!A&&_?"Corrige los horarios":void 0,children:s?"Guardando…":"Guardar cambios"})})]})})},kk="_section_ibg0g_3",Ok="_card_ibg0g_15",Mk="_title_ibg0g_33",Dk="_topBarGrid_ibg0g_49",Pk="_groupLeft_ibg0g_65",Fk="_groupCenter_ibg0g_67",Lk="_groupRight_ibg0g_69",Uk="_segmented_ibg0g_75",Bk="_segmentBtn_ibg0g_91",Hk="_segmentBtnActive_ibg0g_123",jk="_searchForm_ibg0g_129",zk="_searchInput_ibg0g_143",Gk="_searchClear_ibg0g_173",$k="_button_ibg0g_197",Kk="_tableWrap_ibg0g_231",Vk="_table_ibg0g_231",qk="_theadRow_ibg0g_259",Yk="_th_ibg0g_259",Xk="_td_ibg0g_291",Wk="_paginationBar_ibg0g_309",Qk="_paginationLeft_ibg0g_325",Jk="_pageBtn_ibg0g_327",Zk="_pageInfo_ibg0g_349",eO="_paginationRight_ibg0g_353",tO="_pageSizeLabel_ibg0g_355",nO="_pageSizeSelect_ibg0g_357",rO="_info_ibg0g_375",aO="_error_ibg0g_385",iO="_iconBtn_ibg0g_463",sO="_iconBtnDanger_ibg0g_505",Xe={section:kk,card:Ok,title:Mk,topBarGrid:Dk,groupLeft:Pk,groupCenter:Fk,groupRight:Lk,segmented:Uk,segmentBtn:Bk,segmentBtnActive:Hk,searchForm:jk,searchInput:zk,searchClear:Gk,button:$k,tableWrap:Kk,table:Vk,theadRow:qk,th:Yk,td:Xk,paginationBar:Wk,paginationLeft:Qk,pageBtn:Jk,pageInfo:Zk,paginationRight:eO,pageSizeLabel:tO,pageSizeSelect:nO,info:rO,error:aO,iconBtn:iO,iconBtnDanger:sO},oO="_overlay_1ly26_51",lO="_modal_1ly26_51",cO="_header_1ly26_105",uO="_title_1ly26_113",hO="_closeBtn_1ly26_115",fO="_body_1ly26_133",dO="_label_1ly26_151",gO="_fieldset_1ly26_153",mO="_comboColab_1ly26_179",pO="_input_1ly26_199",vO="_select_1ly26_199",yO="_hint_1ly26_237",TO="_actions_1ly26_251",xO="_btnPrimary_1ly26_267",_O="_btnGhost_1ly26_267",SO="_row2_1ly26_311",bt={overlay:oO,modal:lO,header:cO,title:uO,closeBtn:hO,body:fO,label:dO,fieldset:gO,comboColab:mO,input:pO,select:vO,hint:yO,actions:TO,btnPrimary:xO,btnGhost:_O,row2:SO},fT={nombre:"",correo:"",tipoVehiculo:"Carro",placa:"",codigoCelda:"",IdSpot:""},dT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),CO=n=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(n).trim()),EO=n=>/^[A-Z]{3}\d{3}$/i.test(String(n).trim()),AO=({isOpen:n,onClose:e,onSave:t,workers:a=[],workersLoading:s=!1})=>{const[l,c]=K.useState(fT),[h,d]=K.useState(!1),[g,p]=K.useState(null),[v,T]=K.useState(""),[x,C]=K.useState(""),_=K.useRef(null);K.useEffect(()=>{n&&(c(fT),T(""),C(""),p(null),setTimeout(()=>_.current?.focus(),0))},[n]),K.useEffect(()=>{if(!n)return;const N=G=>{G.key==="Escape"&&!h&&e()};return window.addEventListener("keydown",N),()=>window.removeEventListener("keydown",N)},[n,h,e]);const A=K.useMemo(()=>{if(!v)return a;const N=dT(v);return a.filter(G=>dT(`${G.displayName} ${G.mail??""} ${G.jobTitle??""}`).includes(N))},[a,v]),B=K.useRef(null),I=async N=>{C(N);const G=a.find(J=>String(J.id)===String(N));if(!G){c(J=>({...J,nombre:"",correo:""}));return}const V=Symbol();B.current=V;let ie=G.displayName||"";try{const J=await _S(ie);if(B.current!==V)return;J||(ie="")}catch{if(B.current!==V)return;ie=""}c(J=>({...J,nombre:ie,correo:G.mail||""})),p(null)},k=K.useMemo(()=>{const N={};return l.nombre.trim()||(N.nombre="El nombre es obligatorio."),CO(l.correo)||(N.correo="Correo inválido."),EO(l.placa)||(N.placa="Formato de placa inválido (ej: ABC123)."),N},[l]),z=Object.keys(k).length>0,X=async N=>{if(N.preventDefault(),!(h||z))try{d(!0),p(null),await t?.(l),e()}catch(G){p(G?.message??"No se pudo guardar el colaborador.")}finally{d(!1)}};if(!n)return null;const W=N=>{N.target===N.currentTarget&&!h&&e()};return y.jsx("div",{className:bt.overlay,role:"dialog","aria-modal":"true",onMouseDown:W,children:y.jsxs("div",{className:bt.modal,onMouseDown:N=>N.stopPropagation(),children:[y.jsxs("header",{className:bt.header,children:[y.jsx("h2",{className:bt.title,children:"Agregar colaborador"}),y.jsx("button",{className:bt.closeBtn,onClick:e,"aria-label":"Cerrar",disabled:h,children:"×"})]}),y.jsxs("form",{className:bt.body,onSubmit:X,noValidate:!0,children:[y.jsxs("fieldset",{className:bt.fieldset,children:[y.jsx("label",{className:bt.label,children:"Colaborador"}),y.jsxs("div",{className:bt.comboColab,children:[y.jsx("input",{ref:_,className:bt.input,type:"text",placeholder:"Buscar por nombre, correo o cargo…",value:v,onChange:N=>T(N.target.value),disabled:s||h,autoComplete:"off"}),y.jsxs("select",{className:bt.select,value:x,onChange:N=>I(N.target.value),disabled:s||h,children:[y.jsx("option",{value:"",children:s?"Cargando colaboradores…":A.length===0?"Sin resultados":"Selecciona un colaborador (opcional)"}),A.map(N=>y.jsxs("option",{value:String(N.id),children:[N.displayName,N.mail?` · ${N.mail}`:"",N.jobTitle?` · ${N.jobTitle}`:""]},String(N.id)))]})]}),y.jsx("small",{className:bt.hint,children:"Al seleccionar un colaborador, se llenan Nombre y Correo (puedes editarlos)."})]}),y.jsxs("label",{className:bt.label,children:["Nombre",y.jsx("input",{className:bt.input,type:"text",value:l.nombre,onChange:N=>c(G=>({...G,nombre:N.target.value})),required:!0,"aria-invalid":!!k.nombre}),k.nombre&&y.jsx("small",{className:bt.error,children:k.nombre})]}),y.jsxs("label",{className:bt.label,children:["Correo electrónico",y.jsx("input",{className:bt.input,type:"email",value:l.correo,onChange:N=>c(G=>({...G,correo:N.target.value})),required:!0,"aria-invalid":!!k.correo}),k.correo&&y.jsx("small",{className:bt.error,children:k.correo})]}),y.jsxs("div",{className:bt.row2,children:[y.jsxs("label",{className:bt.label,children:["Tipo de vehículo",y.jsxs("select",{className:bt.select,value:l.tipoVehiculo,onChange:N=>c(G=>({...G,tipoVehiculo:N.target.value})),disabled:h,children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("label",{className:bt.label,children:["Placa del vehículo",y.jsx("input",{className:bt.input,type:"text",value:l.placa,onChange:N=>c(G=>({...G,placa:N.target.value.toUpperCase()})),placeholder:"Ej: ABC123",required:!0,"aria-invalid":!!k.placa}),k.placa&&y.jsx("small",{className:bt.error,children:k.placa})]})]}),g&&y.jsx("div",{className:bt.error,children:g}),y.jsxs("div",{className:bt.actions,children:[y.jsx("button",{type:"button",className:bt.btnGhost,onClick:e,disabled:h,children:"Cancelar"}),y.jsx("button",{type:"submit",className:bt.btnPrimary,disabled:h||z,children:h?"Guardando…":"Guardar"})]})]})]})})},wO="_overlay_1bwmb_1",bO="_modal_1bwmb_19",IO="_header_1bwmb_35",RO="_title_1bwmb_43",NO="_closeBtn_1bwmb_45",kO="_body_1bwmb_57",OO="_label_1bwmb_67",MO="_actions_1bwmb_97",DO="_btnGhost_1bwmb_123",Dn={overlay:wO,modal:bO,header:IO,title:RO,closeBtn:NO,body:kO,label:OO,actions:MO,btnGhost:DO},PO=({isOpen:n,onClose:e,collaborator:t})=>!n||!t?null:y.jsx("div",{className:Dn.overlay,role:"dialog","aria-modal":"true",children:y.jsxs("div",{className:Dn.modal,children:[y.jsxs("header",{className:Dn.header,children:[y.jsx("h2",{className:Dn.title,children:"Detalle del colaborador"}),y.jsx("button",{className:Dn.closeBtn,onClick:e,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{className:Dn.body,children:[y.jsxs("div",{style:{display:"grid",gap:12},children:[y.jsxs("div",{children:[y.jsx("div",{className:Dn.label,children:"Nombre"}),y.jsx("div",{className:Dn.value,children:t.nombre})]}),y.jsxs("div",{children:[y.jsx("div",{className:Dn.label,children:"Correo electrónico"}),y.jsx("div",{className:Dn.value,children:t.correo})]}),y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[y.jsxs("div",{children:[y.jsx("div",{className:Dn.label,children:"Tipo de vehículo"}),y.jsx("div",{className:Dn.value,children:y.jsx("span",{className:"pill",children:t.tipoVehiculo})})]}),y.jsxs("div",{children:[y.jsx("div",{className:Dn.label,children:"Placa"}),y.jsx("div",{className:Dn.value,children:t.placa||"-"})]})]})]}),y.jsx("div",{className:Dn.actions,children:y.jsx("button",{type:"button",className:Dn.btnGhost,onClick:e,children:"Cerrar"})})]})]})}),FO=n=>({id:Number(n.ID??n.Id??n.id??0),nombre:String(n.Title??n.title??""),correo:String(n.Correo??n.correo??"-"),tipoVehiculo:n.Tipodevehiculo??n.tipoVehiculo,placa:String(n.Placa??n.placa??""),CodigoCelda:String(n.CodigoCelda??"")});function LO(n){const[e,t]=K.useState([]),[a,s]=K.useState([]),[l,c]=K.useState(!1),[h,d]=K.useState(null),[g,p]=K.useState(""),[v,T]=K.useState(20),[x,C]=K.useState(0),[_,A]=K.useState(!1),B=K.useCallback(async N=>{if(N)try{c(!0),d(null),await n.delete(String(N)),t(G=>{const V=G.filter(he=>String(he.id)!==String(N)),ie=Math.min(x*v,Math.max(0,V.length-1)),J=Math.floor(ie/v)*v;return s(V.slice(J,J+v)),C(J/v),A(J+v<V.length),V})}catch(G){throw console.error("[useCollaborators] deleteCollaborator error:",G),d(G?.message??"Error al eliminar colaborador"),G}finally{c(!1)}},[n,x,v]),I=K.useCallback(async N=>{try{c(!0),d(null);const G={Title:N.nombre,Correo:N.correo,Tipodevehiculo:N.tipoVehiculo,Placa:N.placa,CodigoCelda:N.codigoCelda},V=await n.create(G),ie=V?{id:Number(V.ID??Date.now()),nombre:String(V.Title??N.nombre),correo:String(V.Correo??N.correo),tipoVehiculo:V.Tipodevehiculo??N.tipoVehiculo,placa:String(V.Placa??N.placa),CodigoCelda:String(V.CodigoCelda??N.codigoCelda??"")}:{id:Date.now(),nombre:N.nombre,correo:N.correo,tipoVehiculo:N.tipoVehiculo,placa:N.placa,CodigoCelda:String(N.codigoCelda??"")};t(J=>{const he=[ie,...J];return s(he.slice(0,v)),A(he.length>v),C(0),he})}catch(G){console.error("[useCollaborators] addCollaborator error:",G),d(G?.message??"No se pudo agregar el colaborador")}finally{c(!1)}},[n,v]),k=K.useCallback(async()=>{c(!0),d(null);try{const G=g.trim().toLowerCase().replace(/'/g,"''"),V=[];G&&V.push(`(contains(tolower(fields/Title),'${G}') or contains(tolower(fields/Correo),'${G}'))`);const J=(await n.getAll({top:2e3,orderby:"fields/Title asc",...V.length?{filter:V.join(" and ")}:{}})).map(FO);t(J),s(J.slice(0,v)),C(0),A(J.length>v)}catch(N){console.error("[useCollaborators] reloadAll error:",N),t([]),s([]),d(N?.message??"Error al cargar colaboradores"),A(!1)}finally{c(!1)}},[n,g,v]),z=K.useCallback(N=>{const G=Number.isFinite(N)&&N>0?Math.floor(N):20;T(G);const V=e.slice(0,G);s(V),C(0),A(e.length>G)},[e]),X=K.useCallback(()=>{if(l)return;const N=x+1,G=N*v,V=G+v;G>=e.length||(s(e.slice(G,V)),C(N),A(V<e.length))},[l,x,v,e]),W=K.useCallback(()=>{if(l||x===0)return;const N=x-1,G=N*v,V=G+v;s(e.slice(G,V)),C(N),A(e.length>V)},[l,x,v,e]);return K.useEffect(()=>{let N=!1;return(async()=>N||await k())(),()=>{N=!0}},[k]),{rows:a,loading:l,error:h,search:g,setSearch:p,pageSize:v,setPageSize:z,pageIndex:x,hasNext:_,nextPage:X,prevPage:W,reloadAll:k,addCollaborator:I,deleteCollaborator:B}}const UO=()=>{const{colaboradoresFijos:n}=pa(),{rows:e,loading:t,error:a,search:s,setSearch:l,pageSize:c,setPageSize:h,pageIndex:d,hasNext:g,nextPage:p,prevPage:v,reloadAll:T,addCollaborator:x,deleteCollaborator:C}=LO(n),{workers:_,loading:A,refresh:B}=yS(),[I,k]=K.useState(!1),[z,X]=K.useState(!1),[W,N]=K.useState(null),[G]=K.useState([]),[V]=K.useState(!1),[ie,J]=K.useState("all"),he=async()=>{try{(!_||_.length===0)&&await B()}finally{k(!0)}},Ae=()=>k(!1),je=()=>{X(!1),N(null)},ke=K.useMemo(()=>ie==="all"?e:e.filter(fe=>fe.tipoVehiculo===ie),[e,ie]),re=fe=>{fe.key==="Enter"&&(fe.preventDefault(),T())},_e=async fe=>{!fe?.id||!window.confirm(`¿Eliminar a "${fe.nombre}"? Esta acción no se puede deshacer.`)||await C(String(fe.id))};return y.jsx("section",{className:Xe.section,children:y.jsxs("div",{className:Xe.card,children:[y.jsx("h1",{className:Xe.title,children:"Colaboradores inscritos"}),y.jsxs("div",{className:Xe.topBarGrid,children:[y.jsx("div",{className:Xe.groupLeft,children:y.jsxs("div",{className:Xe.segmented,children:[y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="all"?Xe.segmentBtnActive:""}`,onClick:()=>J("all"),disabled:t,title:"Ver todos",children:"Todos"}),y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="Carro"?Xe.segmentBtnActive:""}`,onClick:()=>J("Carro"),disabled:t,title:"Solo Carro",children:"Carro"}),y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="Moto"?Xe.segmentBtnActive:""}`,onClick:()=>J("Moto"),disabled:t,title:"Solo Moto",children:"Moto"})]})}),y.jsx("div",{className:Xe.groupCenter,children:y.jsxs("div",{className:Xe.searchForm,children:[y.jsx("input",{className:Xe.searchInput,type:"text",placeholder:"Buscar por nombre, correo o placa…",value:s,onChange:fe=>l(fe.target.value),onKeyDown:re}),s&&y.jsx("button",{type:"button",className:Xe.searchClear,onClick:()=>l(""),"aria-label":"Limpiar búsqueda",children:"✕"})]})}),y.jsx("div",{className:Xe.groupRight,children:y.jsx("button",{className:Xe.button,type:"button",onClick:he,children:"Agregar colaborador"})})]}),t&&y.jsx("div",{className:Xe.info,children:"Cargando…"}),a&&y.jsx("div",{className:Xe.error,children:a}),!t&&!a&&y.jsxs(y.Fragment,{children:[ke.length===0?y.jsx("div",{className:Xe.empty,children:"No hay colaboradores que coincidan."}):y.jsx("div",{className:Xe.tableWrap,children:y.jsxs("table",{className:Xe.table,children:[y.jsx("thead",{children:y.jsxs("tr",{className:Xe.theadRow,children:[y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Nombre"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Correo electrónico"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Tipo de vehículo"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Placa del vehículo"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Celda Asignada"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Acciones"})]})}),y.jsx("tbody",{children:ke.map(fe=>y.jsxs("tr",{children:[y.jsx("td",{className:Xe.td,children:fe.nombre}),y.jsx("td",{className:Xe.td,children:fe.correo}),y.jsx("td",{className:Xe.td,children:fe.tipoVehiculo}),y.jsx("td",{className:Xe.td,children:fe.placa}),y.jsx("td",{className:Xe.td,children:fe.CodigoCelda}),y.jsx("td",{className:Xe.td,children:y.jsx("button",{type:"button",className:`${Xe.iconBtn} ${Xe.iconBtnDanger}`,title:"Eliminar colaborador","aria-label":`Eliminar ${fe.nombre}`,onClick:()=>_e(fe),disabled:t,children:y.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24","aria-hidden":"true",children:y.jsx("path",{d:"M9 3h6a1 1 0 0 1 1 1v1h4v2H4V5h4V4a1 1 0 0 1 1-1zm2 0v1h2V3h-2zM6 9h12l-1 11a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2L6 9zm4 2v8h2v-8h-2zm-4 0h2v8H8v-8zm8 0h2v8h-2v-8z"})})})})]},fe.id))})]})}),y.jsxs("div",{className:Xe.paginationBar,children:[y.jsxs("div",{className:Xe.paginationLeft,children:[y.jsx("button",{className:Xe.pageBtn,onClick:v,disabled:d===0,children:"← Anterior"}),y.jsx("button",{className:Xe.pageBtn,onClick:p,disabled:!g,children:"Siguiente →"}),y.jsxs("span",{className:Xe.pageInfo,children:["Página ",d+1]})]}),y.jsx("div",{className:Xe.paginationRight,children:y.jsxs("label",{className:Xe.pageSizeLabel,children:["Filas por página",y.jsxs("select",{className:Xe.pageSizeSelect,value:c,onChange:fe=>h(Number(fe.target.value)||10),children:[y.jsx("option",{value:5,children:"5"}),y.jsx("option",{value:10,children:"10"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]})})]})]}),y.jsx(AO,{isOpen:I,onClose:Ae,onSave:async fe=>{await x(fe),Ae()},slots:G,slotsLoading:V,workers:_,workersLoading:A}),y.jsx(PO,{isOpen:z,onClose:je,collaborator:W})]})})},BO="_wrapper_19t0b_29",HO="_header_19t0b_39",jO="_title_19t0b_53",zO="_aforo_19t0b_65",GO="_aforoCap_19t0b_75",$O="_filters_19t0b_79",KO="_field_19t0b_101",VO="_actions_19t0b_161",qO="_btn_19t0b_177",YO="_btnPrimary_19t0b_179",XO="_info_19t0b_231",WO="_error_19t0b_233",QO="_tableWrap_19t0b_237",JO="_table_19t0b_237",ZO="_empty_19t0b_301",fn={wrapper:BO,header:HO,title:jO,aforo:zO,aforoCap:GO,filters:$O,field:KO,actions:VO,btn:qO,btnPrimary:YO,info:XO,error:WO,tableWrap:QO,table:JO,empty:ZO};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var gh={};gh.version="0.18.5";var SS=1252,e4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],CS=function(n){e4.indexOf(n)!=-1&&(SS=n)};function t4(){CS(1252)}var Xl=function(n){CS(n)};function n4(){Xl(1200),t4()}var Pu=function(e){return String.fromCharCode(e)},gT=function(e){return String.fromCharCode(e)},mh,vi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function Wl(n){for(var e="",t=0,a=0,s=0,l=0,c=0,h=0,d=0,g=0;g<n.length;)t=n.charCodeAt(g++),l=t>>2,a=n.charCodeAt(g++),c=(t&3)<<4|a>>4,s=n.charCodeAt(g++),h=(a&15)<<2|s>>6,d=s&63,isNaN(a)?h=d=64:isNaN(s)&&(d=64),e+=vi.charAt(l)+vi.charAt(c)+vi.charAt(h)+vi.charAt(d);return e}function Ha(n){var e="",t=0,a=0,s=0,l=0,c=0,h=0,d=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<n.length;)l=vi.indexOf(n.charAt(g++)),c=vi.indexOf(n.charAt(g++)),t=l<<2|c>>4,e+=String.fromCharCode(t),h=vi.indexOf(n.charAt(g++)),a=(c&15)<<4|h>>2,h!==64&&(e+=String.fromCharCode(a)),d=vi.indexOf(n.charAt(g++)),s=(h&3)<<6|d,d!==64&&(e+=String.fromCharCode(s));return e}var gt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),za=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function is(n){return gt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function mT(n){return gt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var qr=function(e){return gt?za(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Yh(n){if(typeof ArrayBuffer>"u")return qr(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),a=0;a!=n.length;++a)t[a]=n.charCodeAt(a)&255;return e}function rc(n){if(Array.isArray(n))return n.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function r4(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var wn=gt?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:za(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var a=new Uint8Array(t),s=0;for(e=0,t=0;e<n.length;t+=s,++e)if(s=n[e].length,n[e]instanceof Uint8Array)a.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";a.set(new Uint8Array(n[e]),t)}return a}return[].concat.apply([],n.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function a4(n){for(var e=[],t=0,a=n.length+250,s=is(n.length+255),l=0;l<n.length;++l){var c=n.charCodeAt(l);if(c<128)s[t++]=c;else if(c<2048)s[t++]=192|c>>6&31,s[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var h=n.charCodeAt(++l)&1023;s[t++]=240|c>>8&7,s[t++]=128|c>>2&63,s[t++]=128|h>>6&15|(c&3)<<4,s[t++]=128|h&63}else s[t++]=224|c>>12&15,s[t++]=128|c>>6&63,s[t++]=128|c&63;t>a&&(e.push(s.slice(0,t)),t=0,s=is(65535),a=65530)}return e.push(s.slice(0,t)),wn(e)}var Ll=/\u0000/g,Fu=/[\u0001-\u0006]/g;function so(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Xr(n,e){var t=""+n;return t.length>=e?t:Kt("0",e-t.length)+t}function um(n,e){var t=""+n;return t.length>=e?t:Kt(" ",e-t.length)+t}function ph(n,e){var t=""+n;return t.length>=e?t:t+Kt(" ",e-t.length)}function i4(n,e){var t=""+Math.round(n);return t.length>=e?t:Kt("0",e-t.length)+t}function s4(n,e){var t=""+n;return t.length>=e?t:Kt("0",e-t.length)+t}var pT=Math.pow(2,32);function Ws(n,e){if(n>pT||n<-pT)return i4(n,e);var t=Math.round(n);return s4(t,e)}function vh(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var vT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],S0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function o4(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var Vt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},yT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},l4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function yh(n,e,t){for(var a=n<0?-1:1,s=n*a,l=0,c=1,h=0,d=1,g=0,p=0,v=Math.floor(s);g<e&&(v=Math.floor(s),h=v*c+l,p=v*g+d,!(s-v<5e-8));)s=1/(s-v),l=c,c=h,d=g,g=p;if(p>e&&(g>e?(p=d,h=l):(p=g,h=c)),!t)return[0,a*h,p];var T=Math.floor(a*h/p);return[T,a*h-T*p,p]}function Lu(n,e,t){if(n>2958465||n<0)return null;var a=n|0,s=Math.floor(86400*(n-a)),l=0,c=[],h={D:a,T:s,u:86400*(n-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),e&&e.date1904&&(a+=1462),h.u>.9999&&(h.u=0,++s==86400&&(h.T=s=0,++a,++h.D)),a===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),a<60&&(l=(l+6)%7),t&&(l=m4(d,c))}return h.y=c[0],h.m=c[1],h.d=c[2],h.S=s%60,s=Math.floor(s/60),h.M=s%60,s=Math.floor(s/60),h.H=s,h.q=l,h}var ES=new Date(1899,11,31,0,0,0),c4=ES.getTime(),u4=new Date(1900,2,1,0,0,0);function AS(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=u4&&(t+=1440*60*1e3),(t-(c4+(n.getTimezoneOffset()-ES.getTimezoneOffset())*6e4))/(1440*60*1e3)}function hm(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function h4(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function f4(n){var e=n<0?12:11,t=hm(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function d4(n){var e=hm(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function g4(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=f4(n):e===10?t=n.toFixed(10).substr(0,12):t=d4(n),hm(h4(t.toUpperCase()))}function Y0(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):g4(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return Ai(14,AS(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function m4(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function p4(n,e,t,a){var s="",l=0,c=0,h=t.y,d,g=0;switch(n){case 98:h=t.y+543;case 121:switch(e.length){case 1:case 2:d=h%100,g=2;break;default:d=h%1e4,g=4;break}break;case 109:switch(e.length){case 1:case 2:d=t.m,g=e.length;break;case 3:return S0[t.m-1][1];case 5:return S0[t.m-1][0];default:return S0[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=t.d,g=e.length;break;case 3:return vT[t.q][0];default:return vT[t.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(t.H+11)%12,g=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=t.H,g=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=t.M,g=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Xr(t.S,e.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),e==="s"?l===0?"0":""+l/c:(s=Xr(l,2+a),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}g=e.length===3?1:2;break;case 101:d=h,g=1;break}var p=g>0?Xr(d,g):"";return p}function yi(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,a=n.substr(0,t);t!=n.length;t+=e)a+=(a.length>0?",":"")+n.substr(t,e);return a}var wS=/%/g;function v4(n,e,t){var a=e.replace(wS,""),s=e.length-a.length;return Fa(n,a,t*Math.pow(10,2*s))+Kt("%",s)}function y4(n,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return Fa(n,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function bS(n,e){var t,a=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+bS(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(e/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),t.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,d,g,p){return d+g+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=e.toExponential(a);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var IS=/# (\?+)( ?)\/( ?)(\d+)/;function T4(n,e,t){var a=parseInt(n[4],10),s=Math.round(e*a),l=Math.floor(s/a),c=s-l*a,h=a;return t+(l===0?"":""+l)+" "+(c===0?Kt(" ",n[1].length+1+n[4].length):um(c,n[1].length)+n[2]+"/"+n[3]+Xr(h,n[4].length))}function x4(n,e,t){return t+(e===0?"":""+e)+Kt(" ",n[1].length+2+n[4].length)}var RS=/^#*0*\.([0#]+)/,NS=/\).*[0#]/,kS=/\(###\) ###\\?-####/;function Vn(n){for(var e="",t,a=0;a!=n.length;++a)switch(t=n.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function TT(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function xT(n,e){var t=n-Math.floor(n),a=Math.pow(10,e);return e<(""+Math.round(t*a)).length?0:Math.round(t*a)}function _4(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function S4(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Dr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(NS)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Dr("n",a,t):"("+Dr("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return y4(n,e,t);if(e.indexOf("%")!==-1)return v4(n,e,t);if(e.indexOf("E")!==-1)return bS(e,t);if(e.charCodeAt(0)===36)return"$"+Dr(n,e.substr(e.charAt(1)==" "?2:1),t);var s,l,c,h,d=Math.abs(t),g=t<0?"-":"";if(e.match(/^00+$/))return g+Ws(d,e.length);if(e.match(/^[#?]+$/))return s=Ws(t,0),s==="0"&&(s=""),s.length>e.length?s:Vn(e.substr(0,e.length-s.length))+s;if(l=e.match(IS))return T4(l,d,g);if(e.match(/^#+0+$/))return g+Ws(d,e.length-e.indexOf("0"));if(l=e.match(RS))return s=TT(t,l[1].length).replace(/^([^\.]+)$/,"$1."+Vn(l[1])).replace(/\.$/,"."+Vn(l[1])).replace(/\.(\d*)$/,function(C,_){return"."+_+Kt("0",Vn(l[1]).length-_.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return g+TT(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return g+yi(Ws(d,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Dr(n,e,-t):yi(""+(Math.floor(t)+_4(t,l[1].length)))+"."+Xr(xT(t,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return Dr(n,e.replace(/^#,#*,/,""),t);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=so(Dr(n,e.replace(/[\\-]/g,""),t)),c=0,so(so(e.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<s.length?s.charAt(c++):C==="0"?"0":""}));if(e.match(kS))return s=Dr(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),h=yh(d,Math.pow(10,c)-1,!1),s=""+g,p=Fa("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ph(h[2],c),p.length<l[4].length&&(p=Vn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),h=yh(d,Math.pow(10,c)-1,!0),g+(h[0]||(h[1]?"":"0"))+" "+(h[1]?um(h[1],c)+l[2]+"/"+l[3]+ph(h[2],c):Kt(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return s=Ws(t,0),e.length<=s.length?s:Vn(e.substr(0,e.length-s.length))+s;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=e.indexOf(".")-c,T=e.length-s.length-v;return Vn(e.substr(0,v)+s+e.substr(e.length-T))}if(l=e.match(/^00,000\.([#0]*0)$/))return c=xT(t,l[1].length),t<0?"-"+Dr(n,e,-t):yi(S4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?Xr(0,3-C.length):"")+C})+"."+Xr(c,l[1].length);switch(e){case"###,##0.00":return Dr(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var x=yi(Ws(d,0));return x!=="0"?g+x:"";case"###,###.00":return Dr(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Dr(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function C4(n,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return Fa(n,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function E4(n,e,t){var a=e.replace(wS,""),s=e.length-a.length;return Fa(n,a,t*Math.pow(10,2*s))+Kt("%",s)}function OS(n,e){var t,a=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+OS(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(e/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!t.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,d,g,p){return d+g+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=e.toExponential(a);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function ua(n,e,t){if(n.charCodeAt(0)===40&&!e.match(NS)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?ua("n",a,t):"("+ua("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return C4(n,e,t);if(e.indexOf("%")!==-1)return E4(n,e,t);if(e.indexOf("E")!==-1)return OS(e,t);if(e.charCodeAt(0)===36)return"$"+ua(n,e.substr(e.charAt(1)==" "?2:1),t);var s,l,c,h,d=Math.abs(t),g=t<0?"-":"";if(e.match(/^00+$/))return g+Xr(d,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:Vn(e.substr(0,e.length-s.length))+s;if(l=e.match(IS))return x4(l,d,g);if(e.match(/^#+0+$/))return g+Xr(d,e.length-e.indexOf("0"));if(l=e.match(RS))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Vn(l[1])).replace(/\.$/,"."+Vn(l[1])),s=s.replace(/\.(\d*)$/,function(C,_){return"."+_+Kt("0",Vn(l[1]).length-_.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return g+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return g+yi(""+d);if(l=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+ua(n,e,-t):yi(""+t)+"."+Kt("0",l[1].length);if(l=e.match(/^#,#*,#0/))return ua(n,e.replace(/^#,#*,/,""),t);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=so(ua(n,e.replace(/[\\-]/g,""),t)),c=0,so(so(e.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<s.length?s.charAt(c++):C==="0"?"0":""}));if(e.match(kS))return s=ua(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),h=yh(d,Math.pow(10,c)-1,!1),s=""+g,p=Fa("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=ph(h[2],c),p.length<l[4].length&&(p=Vn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),h=yh(d,Math.pow(10,c)-1,!0),g+(h[0]||(h[1]?"":"0"))+" "+(h[1]?um(h[1],c)+l[2]+"/"+l[3]+ph(h[2],c):Kt(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:Vn(e.substr(0,e.length-s.length))+s;if(l=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=e.indexOf(".")-c,T=e.length-s.length-v;return Vn(e.substr(0,v)+s+e.substr(e.length-T))}if(l=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+ua(n,e,-t):yi(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?Xr(0,3-C.length):"")+C})+"."+Xr(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var x=yi(""+d);return x!=="0"?g+x:"";default:if(e.match(/\.[0#?]*$/))return ua(n,e.slice(0,e.lastIndexOf(".")),t)+Vn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function Fa(n,e,t){return(t|0)===t?ua(n,e,t):Dr(n,e,t)}function A4(n){for(var e=[],t=!1,a=0,s=0;a<n.length;++a)switch(n.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=n.substr(s,a-s),s=a+1}if(e[e.length]=n.substr(s),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var MS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function DS(n){for(var e=0,t="",a="";e<n.length;)switch(t=n.charAt(e)){case"G":vh(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(a=t;n.charAt(e++)!=="]"&&e<n.length;)a+=n.charAt(e);if(a.match(MS))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function w4(n,e,t,a){for(var s=[],l="",c=0,h="",d="t",g,p,v,T="H";c<n.length;)switch(h=n.charAt(c)){case"G":if(!vh(n,c))throw new Error("unrecognized character "+h+" in "+n);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(v=n.charCodeAt(++c))!==34&&c<n.length;)l+=String.fromCharCode(v);s[s.length]={t:"t",v:l},++c;break;case"\\":var x=n.charAt(++c),C=x==="("||x===")"?x:"t";s[s.length]={t:C,v:x},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:e},++c;break;case"B":case"b":if(n.charAt(c+1)==="1"||n.charAt(c+1)==="2"){if(g==null&&(g=Lu(e,t,n.charAt(c+1)==="2"),g==null))return"";s[s.length]={t:"X",v:n.substr(c,2)},d=h,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||g==null&&(g=Lu(e,t),g==null))return"";for(l=h;++c<n.length&&n.charAt(c).toLowerCase()===h;)l+=h;h==="m"&&d.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=T),s[s.length]={t:h,v:l},d=h;break;case"A":case"a":case"上":var _={t:h,v:h};if(g==null&&(g=Lu(e,t)),n.substr(c,3).toUpperCase()==="A/P"?(g!=null&&(_.v=g.H>=12?"P":"A"),_.t="T",T="h",c+=3):n.substr(c,5).toUpperCase()==="AM/PM"?(g!=null&&(_.v=g.H>=12?"PM":"AM"),_.t="T",c+=5,T="h"):n.substr(c,5).toUpperCase()==="上午/下午"?(g!=null&&(_.v=g.H>=12?"下午":"上午"),_.t="T",c+=5,T="h"):(_.t="t",++c),g==null&&_.t==="T")return"";s[s.length]=_,d=h;break;case"[":for(l=h;n.charAt(c++)!=="]"&&c<n.length;)l+=n.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(MS)){if(g==null&&(g=Lu(e,t),g==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",DS(n)||(s[s.length]={t:"t",v:l}));break;case".":if(g!=null){for(l=h;++c<n.length&&(h=n.charAt(c))==="0";)l+=h;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++c<n.length&&"0#?.,E+-%".indexOf(h=n.charAt(c))>-1;)l+=h;s[s.length]={t:"n",v:l};break;case"?":for(l=h;n.charAt(++c)===h;)l+=h;s[s.length]={t:h,v:l},d=h;break;case"*":++c,(n.charAt(c)==" "||n.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":h,v:h},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;c<n.length&&"0123456789".indexOf(n.charAt(++c))>-1;)l+=n.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:h,v:h},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+n);s[s.length]={t:"t",v:h},++c;break}var A=0,B=0,I;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=T,d="h",A<1&&(A=1);break;case"s":(I=s[c].v.match(/\.0+$/))&&(B=Math.max(B,I[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":d==="s"&&(s[c].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&s[c].v.match(/[Hh]/)&&(A=1),A<2&&s[c].v.match(/[Mm]/)&&(A=2),A<3&&s[c].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var k="",z;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=p4(s[c].t.charCodeAt(0),s[c].v,g,B),s[c].t="t";break;case"n":case"?":for(z=c+1;s[z]!=null&&((h=s[z].t)==="?"||h==="D"||(h===" "||h==="t")&&s[z+1]!=null&&(s[z+1].t==="?"||s[z+1].t==="t"&&s[z+1].v==="/")||s[c].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(s[z].v==="/"||s[z].v===" "&&s[z+1]!=null&&s[z+1].t=="?"));)s[c].v+=s[z].v,s[z]={v:"",t:";"},++z;k+=s[c].v,c=z-1;break;case"G":s[c].t="t",s[c].v=Y0(e,t);break}var X="",W,N;if(k.length>0){k.charCodeAt(0)==40?(W=e<0&&k.charCodeAt(0)===45?-e:e,N=Fa("n",k,W)):(W=e<0&&a>1?-e:e,N=Fa("n",k,W),W<0&&s[0]&&s[0].t=="t"&&(N=N.substr(1),s[0].v="-"+s[0].v)),z=N.length-1;var G=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){G=c;break}var V=s.length;if(G===s.length&&N.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(z>=s[c].v.length-1?(z-=s[c].v.length,s[c].v=N.substr(z+1,s[c].v.length)):z<0?s[c].v="":(s[c].v=N.substr(0,z+1),z=-1),s[c].t="t",V=c);z>=0&&V<s.length&&(s[V].v=N.substr(0,z+1)+s[V].v)}else if(G!==s.length&&N.indexOf("E")===-1){for(z=N.indexOf(".")-1,c=G;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===G?s[c].v.indexOf(".")-1:s[c].v.length-1,X=s[c].v.substr(p+1);p>=0;--p)z>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(X=N.charAt(z--)+X);s[c].v=X,s[c].t="t",V=c}for(z>=0&&V<s.length&&(s[V].v=N.substr(0,z+1)+s[V].v),z=N.indexOf(".")+1,c=G;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==G)){for(p=s[c].v.indexOf(".")>-1&&c===G?s[c].v.indexOf(".")+1:0,X=s[c].v.substr(0,p);p<s[c].v.length;++p)z<N.length&&(X+=N.charAt(z++));s[c].v=X,s[c].t="t",V=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(W=a>1&&e<0&&c>0&&s[c-1].v==="-"?-e:e,s[c].v=Fa(s[c].t,s[c].v,W),s[c].t="t");var ie="";for(c=0;c!==s.length;++c)s[c]!=null&&(ie+=s[c].v);return ie}var _T=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function ST(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function b4(n,e){var t=A4(n),a=t.length,s=t[a-1].indexOf("@");if(a<4&&s>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(_T),h=t[1].match(_T);return ST(e,c)?[a,t[0]]:ST(e,h)?[a,t[1]]:[a,t[c!=null&&h!=null?2:1]]}return[a,l]}function Ai(n,e,t){t==null&&(t={});var a="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?a=t.dateNF:a=n;break;case"number":n==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:Vt)[n],a==null&&(a=t.table&&t.table[yT[n]]||Vt[yT[n]]),a==null&&(a=l4[n]||"General");break}if(vh(a,0))return Y0(e,t);e instanceof Date&&(e=AS(e,t.date1904));var s=b4(a,e);if(vh(s[1]))return Y0(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return w4(s[1],e,t,s[0])}function PS(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(Vt[t]==null){e<0&&(e=t);continue}if(Vt[t]==n){e=t;break}}e<0&&(e=391)}return Vt[e]=n,e}function Xh(n){for(var e=0;e!=392;++e)n[e]!==void 0&&PS(n[e],e)}function Wh(){Vt=o4()}var FS=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function I4(n){var e=typeof n=="number"?Vt[n]:n;return e=e.replace(FS,"(\\d+)"),new RegExp("^"+e+"$")}function R4(n,e,t){var a=-1,s=-1,l=-1,c=-1,h=-1,d=-1;(e.match(FS)||[]).forEach(function(v,T){var x=parseInt(t[T+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=x;break;case"d":l=x;break;case"h":c=x;break;case"s":d=x;break;case"m":c>=0?h=x:s=x;break}}),d>=0&&h==-1&&s>=0&&(h=s,s=-1);var g=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&h==-1&&d==-1?g:a==-1&&s==-1&&l==-1?p:g+"T"+p}var N4=(function(){var n={};n.version="1.2.0";function e(){for(var N=0,G=new Array(256),V=0;V!=256;++V)N=V,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,G[V]=N;return typeof Int32Array<"u"?new Int32Array(G):G}var t=e();function a(N){var G=0,V=0,ie=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)J[ie]=N[ie];for(ie=0;ie!=256;++ie)for(V=N[ie],G=256+ie;G<4096;G+=256)V=J[G]=V>>>8^N[V&255];var he=[];for(ie=1;ie!=16;++ie)he[ie-1]=typeof Int32Array<"u"?J.subarray(ie*256,ie*256+256):J.slice(ie*256,ie*256+256);return he}var s=a(t),l=s[0],c=s[1],h=s[2],d=s[3],g=s[4],p=s[5],v=s[6],T=s[7],x=s[8],C=s[9],_=s[10],A=s[11],B=s[12],I=s[13],k=s[14];function z(N,G){for(var V=G^-1,ie=0,J=N.length;ie<J;)V=V>>>8^t[(V^N.charCodeAt(ie++))&255];return~V}function X(N,G){for(var V=G^-1,ie=N.length-15,J=0;J<ie;)V=k[N[J++]^V&255]^I[N[J++]^V>>8&255]^B[N[J++]^V>>16&255]^A[N[J++]^V>>>24]^_[N[J++]]^C[N[J++]]^x[N[J++]]^T[N[J++]]^v[N[J++]]^p[N[J++]]^g[N[J++]]^d[N[J++]]^h[N[J++]]^c[N[J++]]^l[N[J++]]^t[N[J++]];for(ie+=15;J<ie;)V=V>>>8^t[(V^N[J++])&255];return~V}function W(N,G){for(var V=G^-1,ie=0,J=N.length,he=0,Ae=0;ie<J;)he=N.charCodeAt(ie++),he<128?V=V>>>8^t[(V^he)&255]:he<2048?(V=V>>>8^t[(V^(192|he>>6&31))&255],V=V>>>8^t[(V^(128|he&63))&255]):he>=55296&&he<57344?(he=(he&1023)+64,Ae=N.charCodeAt(ie++)&1023,V=V>>>8^t[(V^(240|he>>8&7))&255],V=V>>>8^t[(V^(128|he>>2&63))&255],V=V>>>8^t[(V^(128|Ae>>6&15|(he&3)<<4))&255],V=V>>>8^t[(V^(128|Ae&63))&255]):(V=V>>>8^t[(V^(224|he>>12&15))&255],V=V>>>8^t[(V^(128|he>>6&63))&255],V=V>>>8^t[(V^(128|he&63))&255]);return~V}return n.table=t,n.bstr=z,n.buf=X,n.str=W,n})(),It=(function(){var e={};e.version="1.2.1";function t(E,D){for(var R=E.split("/"),O=D.split("/"),M=0,F=0,ae=Math.min(R.length,O.length);M<ae;++M){if(F=R[M].length-O[M].length)return F;if(R[M]!=O[M])return R[M]<O[M]?-1:1}return R.length-O.length}function a(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:a(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(0,D+1)}function s(E){if(E.charAt(E.length-1)=="/")return s(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(D+1)}function l(E,D){typeof D=="string"&&(D=new Date(D));var R=D.getHours();R=R<<6|D.getMinutes(),R=R<<5|D.getSeconds()>>>1,E.write_shift(2,R);var O=D.getFullYear()-1980;O=O<<4|D.getMonth()+1,O=O<<5|D.getDate(),E.write_shift(2,O)}function c(E){var D=E.read_shift(2)&65535,R=E.read_shift(2)&65535,O=new Date,M=R&31;R>>>=5;var F=R&15;R>>>=4,O.setMilliseconds(0),O.setFullYear(R+1980),O.setMonth(F-1),O.setDate(M);var ae=D&31;D>>>=5;var de=D&63;return D>>>=6,O.setHours(D),O.setMinutes(de),O.setSeconds(ae<<1),O}function h(E){vr(E,0);for(var D={},R=0;E.l<=E.length-4;){var O=E.read_shift(2),M=E.read_shift(2),F=E.l+M,ae={};switch(O){case 21589:R=E.read_shift(1),R&1&&(ae.mtime=E.read_shift(4)),M>5&&(R&2&&(ae.atime=E.read_shift(4)),R&4&&(ae.ctime=E.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}E.l=F,D[O]=ae}return D}var d;function g(){return d||(d={})}function p(E,D){if(E[0]==80&&E[1]==75)return wo(E,D);if((E[0]|32)==109&&(E[1]|32)==105)return nf(E,D);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var R=3,O=512,M=0,F=0,ae=0,de=0,ee=0,se=[],le=E.slice(0,512);vr(le,0);var Ee=v(le);switch(R=Ee[0],R){case 3:O=512;break;case 4:O=4096;break;case 0:if(Ee[1]==0)return wo(E,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}O!==512&&(le=E.slice(0,O),vr(le,28));var Re=E.slice(0,O);T(le,R);var Be=le.read_shift(4,"i");if(R===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),de=le.read_shift(4,"i"),M=le.read_shift(4,"i"),ee=le.read_shift(4,"i"),F=le.read_shift(4,"i");for(var Ie=-1,Le=0;Le<109&&(Ie=le.read_shift(4,"i"),!(Ie<0));++Le)se[Le]=Ie;var We=x(E,O);A(ee,F,We,O,se);var St=I(We,ae,se,O);St[ae].name="!Directory",M>0&&de!==Ae&&(St[de].name="!MiniFAT"),St[se[0]].name="!FAT",St.fat_addrs=se,St.ssz=O;var Ct={},Pt=[],ya=[],$a=[];k(ae,St,We,Pt,M,Ct,ya,de),C(ya,$a,Pt),Pt.shift();var Er={FileIndex:ya,FullPaths:$a};return D&&D.raw&&(Er.raw={header:Re,sectors:We}),Er}function v(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(je,"Header Signature: "),E.l+=16;var D=E.read_shift(2,"u");return[E.read_shift(2,"u"),D]}function T(E,D){var R=9;switch(E.l+=2,R=E.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function x(E,D){for(var R=Math.ceil(E.length/D)-1,O=[],M=1;M<R;++M)O[M-1]=E.slice(M*D,(M+1)*D);return O[R-1]=E.slice(R*D),O}function C(E,D,R){for(var O=0,M=0,F=0,ae=0,de=0,ee=R.length,se=[],le=[];O<ee;++O)se[O]=le[O]=O,D[O]=R[O];for(;de<le.length;++de)O=le[de],M=E[O].L,F=E[O].R,ae=E[O].C,se[O]===O&&(M!==-1&&se[M]!==M&&(se[O]=se[M]),F!==-1&&se[F]!==F&&(se[O]=se[F])),ae!==-1&&(se[ae]=O),M!==-1&&O!=se[O]&&(se[M]=se[O],le.lastIndexOf(M)<de&&le.push(M)),F!==-1&&O!=se[O]&&(se[F]=se[O],le.lastIndexOf(F)<de&&le.push(F));for(O=1;O<ee;++O)se[O]===O&&(F!==-1&&se[F]!==F?se[O]=se[F]:M!==-1&&se[M]!==M&&(se[O]=se[M]));for(O=1;O<ee;++O)if(E[O].type!==0){if(de=O,de!=se[de])do de=se[de],D[O]=D[de]+"/"+D[O];while(de!==0&&se[de]!==-1&&de!=se[de]);se[O]=-1}for(D[0]+="/",O=1;O<ee;++O)E[O].type!==2&&(D[O]+="/")}function _(E,D,R){for(var O=E.start,M=E.size,F=[],ae=O;R&&M>0&&ae>=0;)F.push(D.slice(ae*he,ae*he+he)),M-=he,ae=Qi(R,ae*4);return F.length===0?ge(0):wn(F).slice(0,E.size)}function A(E,D,R,O,M){var F=Ae;if(E===Ae){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var ae=R[E],de=(O>>>2)-1;if(!ae)return;for(var ee=0;ee<de&&(F=Qi(ae,ee*4))!==Ae;++ee)M.push(F);A(Qi(ae,O-4),D-1,R,O,M)}}function B(E,D,R,O,M){var F=[],ae=[];M||(M=[]);var de=O-1,ee=0,se=0;for(ee=D;ee>=0;){M[ee]=!0,F[F.length]=ee,ae.push(E[ee]);var le=R[Math.floor(ee*4/O)];if(se=ee*4&de,O<4+se)throw new Error("FAT boundary crossed: "+ee+" 4 "+O);if(!E[le])break;ee=Qi(E[le],se)}return{nodes:F,data:NT([ae])}}function I(E,D,R,O){var M=E.length,F=[],ae=[],de=[],ee=[],se=O-1,le=0,Ee=0,Re=0,Be=0;for(le=0;le<M;++le)if(de=[],Re=le+D,Re>=M&&(Re-=M),!ae[Re]){ee=[];var Ie=[];for(Ee=Re;Ee>=0;){Ie[Ee]=!0,ae[Ee]=!0,de[de.length]=Ee,ee.push(E[Ee]);var Le=R[Math.floor(Ee*4/O)];if(Be=Ee*4&se,O<4+Be)throw new Error("FAT boundary crossed: "+Ee+" 4 "+O);if(!E[Le]||(Ee=Qi(E[Le],Be),Ie[Ee]))break}F[Re]={nodes:de,data:NT([ee])}}return F}function k(E,D,R,O,M,F,ae,de){for(var ee=0,se=O.length?2:0,le=D[E].data,Ee=0,Re=0,Be;Ee<le.length;Ee+=128){var Ie=le.slice(Ee,Ee+128);vr(Ie,64),Re=Ie.read_shift(2),Be=pm(Ie,0,Re-se),O.push(Be);var Le={name:Be,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},We=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);We!==0&&(Le.ct=z(Ie,Ie.l-8));var St=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);St!==0&&(Le.mt=z(Ie,Ie.l-8)),Le.start=Ie.read_shift(4,"i"),Le.size=Ie.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=Ae,Le.name=""),Le.type===5?(ee=Le.start,M>0&&ee!==Ae&&(D[ee].name="!StreamData")):Le.size>=4096?(Le.storage="fat",D[Le.start]===void 0&&(D[Le.start]=B(R,Le.start,D.fat_addrs,D.ssz)),D[Le.start].name=Le.name,Le.content=D[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ee!==Ae&&Le.start!==Ae&&D[ee]&&(Le.content=_(Le,D[ee].data,(D[de]||{}).data))),Le.content&&vr(Le.content,0),F[Be]=Le,ae.push(Le)}}function z(E,D){return new Date((Tr(E,D+4)/1e7*Math.pow(2,32)+Tr(E,D)/1e7-11644473600)*1e3)}function X(E,D){return g(),p(d.readFileSync(E),D)}function W(E,D){var R=D&&D.type;switch(R||gt&&Buffer.isBuffer(E)&&(R="buffer"),R||"base64"){case"file":return X(E,D);case"base64":return p(qr(Ha(E)),D);case"binary":return p(qr(E),D)}return p(E,D)}function N(E,D){var R=D||{},O=R.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=O+"/",E.FileIndex[0]={name:O,type:5}),R.CLSID&&(E.FileIndex[0].clsid=R.CLSID),G(E)}function G(E){var D="Sh33tJ5";if(!It.find(E,"/"+D)){var R=ge(4);R[0]=55,R[1]=R[3]=50,R[2]=54,E.FileIndex.push({name:D,type:2,content:R,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+D),V(E)}}function V(E,D){N(E);for(var R=!1,O=!1,M=E.FullPaths.length-1;M>=0;--M){var F=E.FileIndex[M];switch(F.type){case 0:O?R=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:O=!0,isNaN(F.R*F.L*F.C)&&(R=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!D)){var ae=new Date(1987,1,19),de=0,ee=Object.create?Object.create(null):{},se=[];for(M=0;M<E.FullPaths.length;++M)ee[E.FullPaths[M]]=!0,E.FileIndex[M].type!==0&&se.push([E.FullPaths[M],E.FileIndex[M]]);for(M=0;M<se.length;++M){var le=a(se[M][0]);O=ee[le],O||(se.push([le,{name:s(le).replace("/",""),type:1,clsid:re,ct:ae,mt:ae,content:null}]),ee[le]=!0)}for(se.sort(function(Be,Ie){return t(Be[0],Ie[0])}),E.FullPaths=[],E.FileIndex=[],M=0;M<se.length;++M)E.FullPaths[M]=se[M][0],E.FileIndex[M]=se[M][1];for(M=0;M<se.length;++M){var Ee=E.FileIndex[M],Re=E.FullPaths[M];if(Ee.name=s(Re).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||re,M===0)Ee.C=se.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Re.slice(-1)=="/"){for(de=M+1;de<se.length&&a(E.FullPaths[de])!=Re;++de);for(Ee.C=de>=se.length?-1:de,de=M+1;de<se.length&&a(E.FullPaths[de])!=a(Re);++de);Ee.R=de>=se.length?-1:de,Ee.type=1}else a(E.FullPaths[M+1]||"")==a(Re)&&(Ee.R=M+1),Ee.type=2}}}function ie(E,D){var R=D||{};if(R.fileType=="mad")return ta(E,R);switch(V(E),R.fileType){case"zip":return Oi(E,R)}var O=(function(Be){for(var Ie=0,Le=0,We=0;We<Be.FileIndex.length;++We){var St=Be.FileIndex[We];if(St.content){var Ct=St.content.length;Ct>0&&(Ct<4096?Ie+=Ct+63>>6:Le+=Ct+511>>9)}}for(var Pt=Be.FullPaths.length+3>>2,ya=Ie+7>>3,$a=Ie+127>>7,Er=ya+Le+Pt+$a,Br=Er+127>>7,Mi=Br<=109?0:Math.ceil((Br-109)/127);Er+Br+Mi+127>>7>Br;)Mi=++Br<=109?0:Math.ceil((Br-109)/127);var Hr=[1,Mi,Br,$a,Pt,Le,Ie,0];return Be.FileIndex[0].size=Ie<<6,Hr[7]=(Be.FileIndex[0].start=Hr[0]+Hr[1]+Hr[2]+Hr[3]+Hr[4]+Hr[5])+(Hr[6]+7>>3),Hr})(E),M=ge(O[7]<<9),F=0,ae=0;{for(F=0;F<8;++F)M.write_shift(1,ke[F]);for(F=0;F<8;++F)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),F=0;F<3;++F)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,O[2]),M.write_shift(4,O[0]+O[1]+O[2]+O[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,O[3]?O[0]+O[1]+O[2]-1:Ae),M.write_shift(4,O[3]),M.write_shift(-4,O[1]?O[0]-1:Ae),M.write_shift(4,O[1]),F=0;F<109;++F)M.write_shift(-4,F<O[2]?O[1]+F:-1)}if(O[1])for(ae=0;ae<O[1];++ae){for(;F<236+ae*127;++F)M.write_shift(-4,F<O[2]?O[1]+F:-1);M.write_shift(-4,ae===O[1]-1?Ae:ae+1)}var de=function(Be){for(ae+=Be;F<ae-1;++F)M.write_shift(-4,F+1);Be&&(++F,M.write_shift(-4,Ae))};for(ae=F=0,ae+=O[1];F<ae;++F)M.write_shift(-4,_e.DIFSECT);for(ae+=O[2];F<ae;++F)M.write_shift(-4,_e.FATSECT);de(O[3]),de(O[4]);for(var ee=0,se=0,le=E.FileIndex[0];ee<E.FileIndex.length;++ee)le=E.FileIndex[ee],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ae,de(se+511>>9)));for(de(O[6]+7>>3);M.l&511;)M.write_shift(-4,_e.ENDOFCHAIN);for(ae=F=0,ee=0;ee<E.FileIndex.length;++ee)le=E.FileIndex[ee],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ae,de(se+63>>6)));for(;M.l&511;)M.write_shift(-4,_e.ENDOFCHAIN);for(F=0;F<O[4]<<2;++F){var Ee=E.FullPaths[F];if(!Ee||Ee.length===0){for(ee=0;ee<17;++ee)M.write_shift(4,0);for(ee=0;ee<3;++ee)M.write_shift(4,-1);for(ee=0;ee<12;++ee)M.write_shift(4,0);continue}le=E.FileIndex[F],F===0&&(le.start=le.size?le.start-1:Ae);var Re=F===0&&R.root||le.name;if(se=2*(Re.length+1),M.write_shift(64,Re,"utf16le"),M.write_shift(2,se),M.write_shift(1,le.type),M.write_shift(1,le.color),M.write_shift(-4,le.L),M.write_shift(-4,le.R),M.write_shift(-4,le.C),le.clsid)M.write_shift(16,le.clsid,"hex");else for(ee=0;ee<4;++ee)M.write_shift(4,0);M.write_shift(4,le.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,le.start),M.write_shift(4,le.size),M.write_shift(4,0)}for(F=1;F<E.FileIndex.length;++F)if(le=E.FileIndex[F],le.size>=4096)if(M.l=le.start+1<<9,gt&&Buffer.isBuffer(le.content))le.content.copy(M,M.l,0,le.size),M.l+=le.size+511&-512;else{for(ee=0;ee<le.size;++ee)M.write_shift(1,le.content[ee]);for(;ee&511;++ee)M.write_shift(1,0)}for(F=1;F<E.FileIndex.length;++F)if(le=E.FileIndex[F],le.size>0&&le.size<4096)if(gt&&Buffer.isBuffer(le.content))le.content.copy(M,M.l,0,le.size),M.l+=le.size+63&-64;else{for(ee=0;ee<le.size;++ee)M.write_shift(1,le.content[ee]);for(;ee&63;++ee)M.write_shift(1,0)}if(gt)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function J(E,D){var R=E.FullPaths.map(function(ee){return ee.toUpperCase()}),O=R.map(function(ee){var se=ee.split("/");return se[se.length-(ee.slice(-1)=="/"?2:1)]}),M=!1;D.charCodeAt(0)===47?(M=!0,D=R[0].slice(0,-1)+D):M=D.indexOf("/")!==-1;var F=D.toUpperCase(),ae=M===!0?R.indexOf(F):O.indexOf(F);if(ae!==-1)return E.FileIndex[ae];var de=!F.match(Fu);for(F=F.replace(Ll,""),de&&(F=F.replace(Fu,"!")),ae=0;ae<R.length;++ae)if((de?R[ae].replace(Fu,"!"):R[ae]).replace(Ll,"")==F||(de?O[ae].replace(Fu,"!"):O[ae]).replace(Ll,"")==F)return E.FileIndex[ae];return null}var he=64,Ae=-2,je="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",_e={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ae,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(E,D,R){g();var O=ie(E,R);d.writeFileSync(D,O)}function Te(E){for(var D=new Array(E.length),R=0;R<E.length;++R)D[R]=String.fromCharCode(E[R]);return D.join("")}function U(E,D){var R=ie(E,D);switch(D&&D.type||"buffer"){case"file":return g(),d.writeFileSync(D.filename,R),R;case"binary":return typeof R=="string"?R:Te(R);case"base64":return Wl(typeof R=="string"?R:Te(R));case"buffer":if(gt)return Buffer.isBuffer(R)?R:za(R);case"array":return typeof R=="string"?qr(R):R}return R}var ue;function b(E){try{var D=E.InflateRaw,R=new D;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)ue=E;else throw new Error("zlib does not expose bytesRead")}catch(O){console.error("cannot use native zlib: "+(O.message||O))}}function L(E,D){if(!ue)return fc(E,D);var R=ue.InflateRaw,O=new R,M=O._processChunk(E.slice(E.l),O._finishFlushFlag);return E.l+=O.bytesRead,M}function P(E){return ue?ue.deflateRawSync(E):cc(E)}var j=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(E){var D=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(D>>16|D>>8|D)&255}for(var Pe=typeof Uint8Array<"u",De=Pe?new Uint8Array(256):[],ot=0;ot<256;++ot)De[ot]=Ce(ot);function et(E,D){var R=De[E&255];return D<=8?R>>>8-D:(R=R<<8|De[E>>8&255],D<=16?R>>>16-D:(R=R<<8|De[E>>16&255],R>>>24-D))}function jt(E,D){var R=D&7,O=D>>>3;return(E[O]|(R<=6?0:E[O+1]<<8))>>>R&3}function lt(E,D){var R=D&7,O=D>>>3;return(E[O]|(R<=5?0:E[O+1]<<8))>>>R&7}function Un(E,D){var R=D&7,O=D>>>3;return(E[O]|(R<=4?0:E[O+1]<<8))>>>R&15}function kt(E,D){var R=D&7,O=D>>>3;return(E[O]|(R<=3?0:E[O+1]<<8))>>>R&31}function Fe(E,D){var R=D&7,O=D>>>3;return(E[O]|(R<=1?0:E[O+1]<<8))>>>R&127}function Nn(E,D,R){var O=D&7,M=D>>>3,F=(1<<R)-1,ae=E[M]>>>O;return R<8-O||(ae|=E[M+1]<<8-O,R<16-O)||(ae|=E[M+2]<<16-O,R<24-O)||(ae|=E[M+3]<<24-O),ae&F}function Bn(E,D,R){var O=D&7,M=D>>>3;return O<=5?E[M]|=(R&7)<<O:(E[M]|=R<<O&255,E[M+1]=(R&7)>>8-O),D+3}function Cr(E,D,R){var O=D&7,M=D>>>3;return R=(R&1)<<O,E[M]|=R,D+1}function sr(E,D,R){var O=D&7,M=D>>>3;return R<<=O,E[M]|=R&255,R>>>=8,E[M+1]=R,D+8}function Me(E,D,R){var O=D&7,M=D>>>3;return R<<=O,E[M]|=R&255,R>>>=8,E[M+1]=R&255,E[M+2]=R>>>8,D+16}function Ot(E,D){var R=E.length,O=2*R>D?2*R:D+5,M=0;if(R>=D)return E;if(gt){var F=mT(O);if(E.copy)E.copy(F);else for(;M<E.length;++M)F[M]=E[M];return F}else if(Pe){var ae=new Uint8Array(O);if(ae.set)ae.set(E);else for(;M<R;++M)ae[M]=E[M];return ae}return E.length=O,E}function vn(E){for(var D=new Array(E),R=0;R<E;++R)D[R]=0;return D}function Hn(E,D,R){var O=1,M=0,F=0,ae=0,de=0,ee=E.length,se=Pe?new Uint16Array(32):vn(32);for(F=0;F<32;++F)se[F]=0;for(F=ee;F<R;++F)E[F]=0;ee=E.length;var le=Pe?new Uint16Array(ee):vn(ee);for(F=0;F<ee;++F)se[M=E[F]]++,O<M&&(O=M),le[F]=0;for(se[0]=0,F=1;F<=O;++F)se[F+16]=de=de+se[F-1]<<1;for(F=0;F<ee;++F)de=E[F],de!=0&&(le[F]=se[de+16]++);var Ee=0;for(F=0;F<ee;++F)if(Ee=E[F],Ee!=0)for(de=et(le[F],O)>>O-Ee,ae=(1<<O+4-Ee)-1;ae>=0;--ae)D[de|ae<<Ee]=Ee&15|F<<4;return O}var jn=Pe?new Uint16Array(512):vn(512),yn=Pe?new Uint16Array(32):vn(32);if(!Pe){for(var kn=0;kn<512;++kn)jn[kn]=0;for(kn=0;kn<32;++kn)yn[kn]=0}(function(){for(var E=[],D=0;D<32;D++)E.push(5);Hn(E,yn,32);var R=[];for(D=0;D<=143;D++)R.push(8);for(;D<=255;D++)R.push(9);for(;D<=279;D++)R.push(7);for(;D<=287;D++)R.push(8);Hn(R,jn,288)})();var zn=(function(){for(var D=Pe?new Uint8Array(32768):[],R=0,O=0;R<be.length-1;++R)for(;O<be[R+1];++O)D[O]=R;for(;O<32768;++O)D[O]=29;var M=Pe?new Uint8Array(259):[];for(R=0,O=0;R<Z.length-1;++R)for(;O<Z[R+1];++O)M[O]=R;function F(de,ee){for(var se=0;se<de.length;){var le=Math.min(65535,de.length-se),Ee=se+le==de.length;for(ee.write_shift(1,+Ee),ee.write_shift(2,le),ee.write_shift(2,~le&65535);le-- >0;)ee[ee.l++]=de[se++]}return ee.l}function ae(de,ee){for(var se=0,le=0,Ee=Pe?new Uint16Array(32768):[];le<de.length;){var Re=Math.min(65535,de.length-le);if(Re<10){for(se=Bn(ee,se,+(le+Re==de.length)),se&7&&(se+=8-(se&7)),ee.l=se/8|0,ee.write_shift(2,Re),ee.write_shift(2,~Re&65535);Re-- >0;)ee[ee.l++]=de[le++];se=ee.l*8;continue}se=Bn(ee,se,+(le+Re==de.length)+2);for(var Be=0;Re-- >0;){var Ie=de[le];Be=(Be<<5^Ie)&32767;var Le=-1,We=0;if((Le=Ee[Be])&&(Le|=le&-32768,Le>le&&(Le-=32768),Le<le))for(;de[Le+We]==de[le+We]&&We<250;)++We;if(We>2){Ie=M[We],Ie<=22?se=sr(ee,se,De[Ie+1]>>1)-1:(sr(ee,se,3),se+=5,sr(ee,se,De[Ie-23]>>5),se+=3);var St=Ie<8?0:Ie-4>>2;St>0&&(Me(ee,se,We-Z[Ie]),se+=St),Ie=D[le-Le],se=sr(ee,se,De[Ie]>>3),se-=3;var Ct=Ie<4?0:Ie-2>>1;Ct>0&&(Me(ee,se,le-Le-be[Ie]),se+=Ct);for(var Pt=0;Pt<We;++Pt)Ee[Be]=le&32767,Be=(Be<<5^de[le])&32767,++le;Re-=We-1}else Ie<=143?Ie=Ie+48:se=Cr(ee,se,1),se=sr(ee,se,De[Ie]),Ee[Be]=le&32767,++le}se=sr(ee,se,0)-1}return ee.l=(se+7)/8|0,ee.l}return function(ee,se){return ee.length<8?F(ee,se):ae(ee,se)}})();function cc(E){var D=ge(50+Math.floor(E.length*1.1)),R=zn(E,D);return D.slice(0,R)}var uc=Pe?new Uint16Array(32768):vn(32768),hc=Pe?new Uint16Array(32768):vn(32768),Ri=Pe?new Uint16Array(128):vn(128),Ni=1,ea=1;function gs(E,D){var R=kt(E,D)+257;D+=5;var O=kt(E,D)+1;D+=5;var M=Un(E,D)+4;D+=4;for(var F=0,ae=Pe?new Uint8Array(19):vn(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,se=Pe?new Uint8Array(8):vn(8),le=Pe?new Uint8Array(8):vn(8),Ee=ae.length,Re=0;Re<M;++Re)ae[j[Re]]=F=lt(E,D),ee<F&&(ee=F),se[F]++,D+=3;var Be=0;for(se[0]=0,Re=1;Re<=ee;++Re)le[Re]=Be=Be+se[Re-1]<<1;for(Re=0;Re<Ee;++Re)(Be=ae[Re])!=0&&(de[Re]=le[Be]++);var Ie=0;for(Re=0;Re<Ee;++Re)if(Ie=ae[Re],Ie!=0){Be=De[de[Re]]>>8-Ie;for(var Le=(1<<7-Ie)-1;Le>=0;--Le)Ri[Be|Le<<Ie]=Ie&7|Re<<3}var We=[];for(ee=1;We.length<R+O;)switch(Be=Ri[Fe(E,D)],D+=Be&7,Be>>>=3){case 16:for(F=3+jt(E,D),D+=2,Be=We[We.length-1];F-- >0;)We.push(Be);break;case 17:for(F=3+lt(E,D),D+=3;F-- >0;)We.push(0);break;case 18:for(F=11+Fe(E,D),D+=7;F-- >0;)We.push(0);break;default:We.push(Be),ee<Be&&(ee=Be);break}var St=We.slice(0,R),Ct=We.slice(R);for(Re=R;Re<286;++Re)St[Re]=0;for(Re=O;Re<30;++Re)Ct[Re]=0;return Ni=Hn(St,uc,286),ea=Hn(Ct,hc,30),D}function ki(E,D){if(E[0]==3&&!(E[1]&3))return[is(D),2];for(var R=0,O=0,M=mT(D||1<<18),F=0,ae=M.length>>>0,de=0,ee=0;(O&1)==0;){if(O=lt(E,R),R+=3,O>>>1)O>>1==1?(de=9,ee=5):(R=gs(E,R),de=Ni,ee=ea);else{R&7&&(R+=8-(R&7));var se=E[R>>>3]|E[(R>>>3)+1]<<8;if(R+=32,se>0)for(!D&&ae<F+se&&(M=Ot(M,F+se),ae=M.length);se-- >0;)M[F++]=E[R>>>3],R+=8;continue}for(;;){!D&&ae<F+32767&&(M=Ot(M,F+32767),ae=M.length);var le=Nn(E,R,de),Ee=O>>>1==1?jn[le]:uc[le];if(R+=Ee&15,Ee>>>=4,(Ee>>>8&255)===0)M[F++]=Ee;else{if(Ee==256)break;Ee-=257;var Re=Ee<8?0:Ee-4>>2;Re>5&&(Re=0);var Be=F+Z[Ee];Re>0&&(Be+=Nn(E,R,Re),R+=Re),le=Nn(E,R,ee),Ee=O>>>1==1?yn[le]:hc[le],R+=Ee&15,Ee>>>=4;var Ie=Ee<4?0:Ee-2>>1,Le=be[Ee];for(Ie>0&&(Le+=Nn(E,R,Ie),R+=Ie),!D&&ae<Be&&(M=Ot(M,Be+100),ae=M.length);F<Be;)M[F]=M[F-Le],++F}}}return D?[M,R+7>>>3]:[M.slice(0,F),R+7>>>3]}function fc(E,D){var R=E.slice(E.l||0),O=ki(R,D);return E.l+=O[1],O[0]}function Ao(E,D){if(E)typeof console<"u"&&console.error(D);else throw new Error(D)}function wo(E,D){var R=E;vr(R,0);var O=[],M=[],F={FileIndex:O,FullPaths:M};N(F,{root:D.root});for(var ae=R.length-4;(R[ae]!=80||R[ae+1]!=75||R[ae+2]!=5||R[ae+3]!=6)&&ae>=0;)--ae;R.l=ae+4,R.l+=4;var de=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,ae=0;ae<de;++ae){R.l+=20;var se=R.read_shift(4),le=R.read_shift(4),Ee=R.read_shift(2),Re=R.read_shift(2),Be=R.read_shift(2);R.l+=8;var Ie=R.read_shift(4),Le=h(R.slice(R.l+Ee,R.l+Ee+Re));R.l+=Ee+Re+Be;var We=R.l;R.l=Ie+4,bo(R,se,le,F,Le),R.l=We}return F}function bo(E,D,R,O,M){E.l+=2;var F=E.read_shift(2),ae=E.read_shift(2),de=c(E);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var ee=E.read_shift(4),se=E.read_shift(4),le=E.read_shift(4),Ee=E.read_shift(2),Re=E.read_shift(2),Be="",Ie=0;Ie<Ee;++Ie)Be+=String.fromCharCode(E[E.l++]);if(Re){var Le=h(E.slice(E.l,E.l+Re));(Le[21589]||{}).mt&&(de=Le[21589].mt),((M||{})[21589]||{}).mt&&(de=M[21589].mt)}E.l+=Re;var We=E.slice(E.l,E.l+se);switch(ae){case 8:We=L(E,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var St=!1;F&8&&(ee=E.read_shift(4),ee==134695760&&(ee=E.read_shift(4),St=!0),se=E.read_shift(4),le=E.read_shift(4)),se!=D&&Ao(St,"Bad compressed size: "+D+" != "+se),le!=R&&Ao(St,"Bad uncompressed size: "+R+" != "+le),ln(O,Be,We,{unsafe:!0,mt:de})}function Oi(E,D){var R=D||{},O=[],M=[],F=ge(1),ae=R.compression?8:0,de=0,ee=0,se=0,le=0,Ee=0,Re=E.FullPaths[0],Be=Re,Ie=E.FileIndex[0],Le=[],We=0;for(ee=1;ee<E.FullPaths.length;++ee)if(Be=E.FullPaths[ee].slice(Re.length),Ie=E.FileIndex[ee],!(!Ie.size||!Ie.content||Be=="Sh33tJ5")){var St=le,Ct=ge(Be.length);for(se=0;se<Be.length;++se)Ct.write_shift(1,Be.charCodeAt(se)&127);Ct=Ct.slice(0,Ct.l),Le[Ee]=N4.buf(Ie.content,0);var Pt=Ie.content;ae==8&&(Pt=P(Pt)),F=ge(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,de),F.write_shift(2,ae),Ie.mt?l(F,Ie.mt):F.write_shift(4,0),F.write_shift(-4,Le[Ee]),F.write_shift(4,Pt.length),F.write_shift(4,Ie.content.length),F.write_shift(2,Ct.length),F.write_shift(2,0),le+=F.length,O.push(F),le+=Ct.length,O.push(Ct),le+=Pt.length,O.push(Pt),F=ge(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,de),F.write_shift(2,ae),F.write_shift(4,0),F.write_shift(-4,Le[Ee]),F.write_shift(4,Pt.length),F.write_shift(4,Ie.content.length),F.write_shift(2,Ct.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,St),We+=F.l,M.push(F),We+=Ct.length,M.push(Ct),++Ee}return F=ge(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,Ee),F.write_shift(2,Ee),F.write_shift(4,We),F.write_shift(4,le),F.write_shift(2,0),wn([wn(O),wn(M),F])}var ms={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function dc(E,D){if(E.ctype)return E.ctype;var R=E.name||"",O=R.match(/\.([^\.]+)$/);return O&&ms[O[1]]||D&&(O=(R=D).match(/[\.\\]([^\.\\])+$/),O&&ms[O[1]])?ms[O[1]]:"application/octet-stream"}function gc(E){for(var D=Wl(E),R=[],O=0;O<D.length;O+=76)R.push(D.slice(O,O+76));return R.join(`\r
`)+`\r
`}function Io(E){var D=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],O=D.split(`\r
`),M=0;M<O.length;++M){var F=O[M];if(F.length==0){R.push("");continue}for(var ae=0;ae<F.length;){var de=76,ee=F.slice(ae,ae+de);ee.charAt(de-1)=="="?de--:ee.charAt(de-2)=="="?de-=2:ee.charAt(de-3)=="="&&(de-=3),ee=F.slice(ae,ae+de),ae+=de,ae<F.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function Ro(E){for(var D=[],R=0;R<E.length;++R){for(var O=E[R];R<=E.length&&O.charAt(O.length-1)=="=";)O=O.slice(0,O.length-1)+E[++R];D.push(O)}for(var M=0;M<D.length;++M)D[M]=D[M].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return qr(D.join(`\r
`))}function mc(E,D,R){for(var O="",M="",F="",ae,de=0;de<10;++de){var ee=D[de];if(!ee||ee.match(/^\s*$/))break;var se=ee.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":O=se[2].trim();break;case"content-type":F=se[2].trim();break;case"content-transfer-encoding":M=se[2].trim();break}}switch(++de,M.toLowerCase()){case"base64":ae=qr(Ha(D.slice(de).join("")));break;case"quoted-printable":ae=Ro(D.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var le=ln(E,O.slice(R.length),ae,{unsafe:!0});F&&(le.ctype=F)}function nf(E,D){if(Te(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=D&&D.root||"",O=(gt&&Buffer.isBuffer(E)?E.toString("binary"):Te(E)).split(`\r
`),M=0,F="";for(M=0;M<O.length;++M)if(F=O[M],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),R||(R=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),F.slice(0,R.length)!=R););var ae=(O[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var de="--"+(ae[1]||""),ee=[],se=[],le={FileIndex:ee,FullPaths:se};N(le);var Ee,Re=0;for(M=0;M<O.length;++M){var Be=O[M];Be!==de&&Be!==de+"--"||(Re++&&mc(le,O.slice(Ee,M),R),Ee=M)}return le}function ta(E,D){var R=D||{},O=R.boundary||"SheetJS";O="------="+O;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+O.slice(2)+'"',"","",""],F=E.FullPaths[0],ae=F,de=E.FileIndex[0],ee=1;ee<E.FullPaths.length;++ee)if(ae=E.FullPaths[ee].slice(F.length),de=E.FileIndex[ee],!(!de.size||!de.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var se=de.content,le=gt&&Buffer.isBuffer(se)?se.toString("binary"):Te(se),Ee=0,Re=Math.min(1024,le.length),Be=0,Ie=0;Ie<=Re;++Ie)(Be=le.charCodeAt(Ie))>=32&&Be<128&&++Ee;var Le=Ee>=Re*4/5;M.push(O),M.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+ae),M.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),M.push("Content-Type: "+dc(de,ae)),M.push(""),M.push(Le?Io(le):gc(le))}return M.push(O+`--\r
`),M.join(`\r
`)}function on(E){var D={};return N(D,E),D}function ln(E,D,R,O){var M=O&&O.unsafe;M||N(E);var F=!M&&It.find(E,D);if(!F){var ae=E.FullPaths[0];D.slice(0,ae.length)==ae?ae=D:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+D).replace("//","/")),F={name:s(D),type:2},E.FileIndex.push(F),E.FullPaths.push(ae),M||It.utils.cfb_gc(E)}return F.content=R,F.size=R?R.length:0,O&&(O.CLSID&&(F.clsid=O.CLSID),O.mt&&(F.mt=O.mt),O.ct&&(F.ct=O.ct)),F}function Ga(E,D){N(E);var R=It.find(E,D);if(R){for(var O=0;O<E.FileIndex.length;++O)if(E.FileIndex[O]==R)return E.FileIndex.splice(O,1),E.FullPaths.splice(O,1),!0}return!1}function No(E,D,R){N(E);var O=It.find(E,D);if(O){for(var M=0;M<E.FileIndex.length;++M)if(E.FileIndex[M]==O)return E.FileIndex[M].name=s(R),E.FullPaths[M]=R,!0}return!1}function rf(E){V(E,!0)}return e.find=J,e.read=W,e.parse=p,e.write=U,e.writeFile=fe,e.utils={cfb_new:on,cfb_add:ln,cfb_del:Ga,cfb_mov:No,cfb_gc:rf,ReadShift:Bl,CheckField:eC,prep_blob:vr,bconcat:wn,use_zlib:b,_deflateRaw:cc,_inflateRaw:fc,consts:_e},e})();function k4(n){return typeof n=="string"?Yh(n):Array.isArray(n)?r4(n):n}function ac(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Yh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var a=t=="utf8"?Jl(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,n);if(typeof Blob<"u"){var s=new Blob([k4(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,n);if(typeof saveAs<"u")return saveAs(s,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:n,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=n,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(n);return h.open("w"),h.encoding="binary",Array.isArray(e)&&(e=rc(e)),h.write(e),h.close(),e}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+n)}function Rn(n){for(var e=Object.keys(n),t=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(n,e[a])&&t.push(e[a]);return t}function CT(n,e){for(var t=[],a=Rn(n),s=0;s!==a.length;++s)t[n[a[s]][e]]==null&&(t[n[a[s]][e]]=a[s]);return t}function fm(n){for(var e=[],t=Rn(n),a=0;a!==t.length;++a)e[n[t[a]]]=t[a];return e}function Qh(n){for(var e=[],t=Rn(n),a=0;a!==t.length;++a)e[n[t[a]]]=parseInt(t[a],10);return e}function O4(n){for(var e=[],t=Rn(n),a=0;a!==t.length;++a)e[n[t[a]]]==null&&(e[n[t[a]]]=[]),e[n[t[a]]].push(t[a]);return e}var Th=new Date(1899,11,30,0,0,0);function ar(n,e){var t=n.getTime(),a=Th.getTime()+(n.getTimezoneOffset()-Th.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var LS=new Date,M4=Th.getTime()+(LS.getTimezoneOffset()-Th.getTimezoneOffset())*6e4,ET=LS.getTimezoneOffset();function US(n){var e=new Date;return e.setTime(n*24*60*60*1e3+M4),e.getTimezoneOffset()!==ET&&e.setTime(e.getTime()+(e.getTimezoneOffset()-ET)*6e4),e}var AT=new Date("2017-02-19T19:06:09.000Z"),BS=isNaN(AT.getFullYear())?new Date("2/19/17"):AT,D4=BS.getFullYear()==2017;function Xn(n,e){var t=new Date(n);if(D4)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(BS.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return n.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var s=n.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return n.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function Jh(n,e){if(gt&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return t[l]||l})}catch{}for(var a=[],s=0;s!=n.length;++s)a.push(String.fromCharCode(n[s]));return a.join("")}function ir(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=ir(n[t]));return e}function Kt(n,e){for(var t="";t.length<e;)t+=n;return t}function La(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,a=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return t=-t,l}),!isNaN(e=Number(a)))?e/t:e}var P4=["january","february","march","april","may","june","july","august","september","october","november","december"];function Ql(n){var e=new Date(n),t=new Date(NaN),a=e.getYear(),s=e.getMonth(),l=e.getDate();if(isNaN(l))return t;var c=n.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&P4.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return a<0||a>8099?t:(s>0||l>1)&&a!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var a;return gt?a=za(t):a=a4(t),It.utils.cfb_add(n,e,a)}It.utils.cfb_add(n,e,t)}else n.file(e,t)}function dm(){return It.utils.cfb_new()}var en=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,F4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},gm=fm(F4),mm=/[&<>'"]/g,L4=/[\u0000-\u0008\u000b-\u001f]/g;function xt(n){var e=n+"";return e.replace(mm,function(t){return gm[t]}).replace(L4,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function wT(n){return xt(n).replace(/ /g,"_x0020_")}var HS=/[\u0000-\u001f]/g;function U4(n){var e=n+"";return e.replace(mm,function(t){return gm[t]}).replace(/\n/g,"<br/>").replace(HS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function B4(n){var e=n+"";return e.replace(mm,function(t){return gm[t]}).replace(HS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function H4(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function j4(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function C0(n){for(var e="",t=0,a=0,s=0,l=0,c=0,h=0;t<n.length;){if(a=n.charCodeAt(t++),a<128){e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),a>191&&a<224){c=(a&31)<<6,c|=s&63,e+=String.fromCharCode(c);continue}if(l=n.charCodeAt(t++),a<240){e+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=n.charCodeAt(t++),h=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(h>>>10&1023)),e+=String.fromCharCode(56320+(h&1023))}return e}function bT(n){var e=is(2*n.length),t,a,s=1,l=0,c=0,h;for(a=0;a<n.length;a+=s)s=1,(h=n.charCodeAt(a))<128?t=h:h<224?(t=(h&31)*64+(n.charCodeAt(a+1)&63),s=2):h<240?(t=(h&15)*4096+(n.charCodeAt(a+1)&63)*64+(n.charCodeAt(a+2)&63),s=3):(s=4,t=(h&7)*262144+(n.charCodeAt(a+1)&63)*4096+(n.charCodeAt(a+2)&63)*64+(n.charCodeAt(a+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(e[l++]=c&255,e[l++]=c>>>8,c=0),e[l++]=t%256,e[l++]=t>>>8;return e.slice(0,l).toString("ucs2")}function IT(n){return za(n,"binary").toString("utf8")}var Uu="foo bar bazâð£",Ul=gt&&(IT(Uu)==C0(Uu)&&IT||bT(Uu)==C0(Uu)&&bT)||C0,Jl=gt?function(n){return za(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,a=0,s=0;t<n.length;)switch(a=n.charCodeAt(t++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=n.charCodeAt(t++)-56320+(a<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},z4=(function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<n.length;++s)a=a.replace(n[s][0],n[s][1]);return a}})(),jS=/(^\s|\s$|\n)/;function bn(n,e){return"<"+n+(e.match(jS)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function Zl(n){return Rn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Ne(n,e,t){return"<"+n+(t!=null?Zl(t):"")+(e!=null?(e.match(jS)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function X0(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function G4(n,e){switch(typeof n){case"string":var t=Ne("vt:lpwstr",xt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ne((n|0)==n?"vt:i4":"vt:r8",xt(String(n)));case"boolean":return Ne("vt:bool",n?"true":"false")}if(n instanceof Date)return Ne("vt:filetime",X0(n));throw new Error("Unable to serialize "+n)}var gn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},_o=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],yr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function $4(n,e){for(var t=1-2*(n[e+7]>>>7),a=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),s=n[e+6]&15,l=5;l>=0;--l)s=s*256+n[e+l];return a==2047?s==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),t*Math.pow(2,a-52)*s)}function K4(n,e,t){var a=(e<0||1/e==-1/0?1:0)<<7,s=0,l=0,c=a?-e:e;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(e)?26985:0);for(var h=0;h<=5;++h,l/=256)n[t+h]=l&255;n[t+6]=(s&15)<<4|l&15,n[t+7]=s>>4|a}var RT=function(n){for(var e=[],t=10240,a=0;a<n[0].length;++a)if(n[0][a])for(var s=0,l=n[0][a].length;s<l;s+=t)e.push.apply(e,n[0][a].slice(s,s+t));return e},NT=gt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:za(e)})):RT(n)}:RT,kT=function(n,e,t){for(var a=[],s=e;s<t;s+=2)a.push(String.fromCharCode(Nl(n,s)));return a.join("").replace(Ll,"")},pm=gt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(Ll,""):kT(n,e,t)}:kT,OT=function(n,e,t){for(var a=[],s=e;s<e+t;++s)a.push(("0"+n[s].toString(16)).slice(-2));return a.join("")},zS=gt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):OT(n,e,t)}:OT,MT=function(n,e,t){for(var a=[],s=e;s<t;s++)a.push(String.fromCharCode(to(n,s)));return a.join("")},ic=gt?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):MT(e,t,a)}:MT,GS=function(n,e){var t=Tr(n,e);return t>0?ic(n,e+4,e+4+t-1):""},$S=GS,KS=function(n,e){var t=Tr(n,e);return t>0?ic(n,e+4,e+4+t-1):""},VS=KS,qS=function(n,e){var t=2*Tr(n,e);return t>0?ic(n,e+4,e+4+t-1):""},YS=qS,XS=function(e,t){var a=Tr(e,t);return a>0?pm(e,t+4,t+4+a):""},WS=XS,QS=function(n,e){var t=Tr(n,e);return t>0?ic(n,e+4,e+4+t):""},JS=QS,ZS=function(n,e){return $4(n,e)},xh=ZS,vm=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};gt&&($S=function(e,t){if(!Buffer.isBuffer(e))return GS(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},VS=function(e,t){if(!Buffer.isBuffer(e))return KS(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},YS=function(e,t){if(!Buffer.isBuffer(e))return qS(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},WS=function(e,t){if(!Buffer.isBuffer(e))return XS(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},JS=function(e,t){if(!Buffer.isBuffer(e))return QS(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},xh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):ZS(e,t)},vm=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var to=function(n,e){return n[e]},Nl=function(n,e){return n[e+1]*256+n[e]},V4=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Tr=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},Qi=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},q4=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Bl(n,e){var t="",a,s,l=[],c,h,d,g;switch(e){case"dbcs":if(g=this.l,gt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(d=0;d<n;++d)t+=String.fromCharCode(Nl(this,g)),g+=2;n*=2;break;case"utf8":t=ic(this,this.l,this.l+n);break;case"utf16le":n*=2,t=pm(this,this.l,this.l+n);break;case"wstr":return Bl.call(this,n,"dbcs");case"lpstr-ansi":t=$S(this,this.l),n=4+Tr(this,this.l);break;case"lpstr-cp":t=VS(this,this.l),n=4+Tr(this,this.l);break;case"lpwstr":t=YS(this,this.l),n=4+2*Tr(this,this.l);break;case"lpp4":n=4+Tr(this,this.l),t=WS(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Tr(this,this.l),t=JS(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(c=to(this,this.l+n++))!==0;)l.push(Pu(c));t=l.join("");break;case"_wstr":for(n=0,t="";(c=Nl(this,this.l+n))!==0;)l.push(Pu(c)),n+=2;n+=2,t=l.join("");break;case"dbcs-cont":for(t="",g=this.l,d=0;d<n;++d){if(this.lens&&this.lens.indexOf(g)!==-1)return c=to(this,g),this.l=g+1,h=Bl.call(this,n-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Pu(Nl(this,g))),g+=2}t=l.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,d=0;d!=n;++d){if(this.lens&&this.lens.indexOf(g)!==-1)return c=to(this,g),this.l=g+1,h=Bl.call(this,n-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Pu(to(this,g))),g+=1}t=l.join("");break;default:switch(n){case 1:return a=to(this,this.l),this.l++,a;case 2:return a=(e==="i"?V4:Nl)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(n>0?Qi:q4)(this,this.l),this.l+=4,a):(s=Tr(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return n==8?s=xh(this,this.l):s=xh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;n=8;case 16:t=zS(this,this.l,n);break}}return this.l+=n,t}var Y4=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},X4=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},W4=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function Q4(n,e,t){var a=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)W4(this,e.charCodeAt(s),this.l+2*s);a=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;a=e.length}else if(t==="hex"){for(;s<n;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+n,this.length);for(s=0;s<Math.min(e.length,n);++s){var c=e.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(n){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,Y4(this,e,this.l);break;case 8:if(a=8,t==="f"){K4(this,e,this.l);break}case 16:break;case-4:a=4,X4(this,e,this.l);break}return this.l+=a,this}function eC(n,e){var t=zS(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function vr(n,e){n.l=e,n.read_shift=Bl,n.chk=eC,n.write_shift=Q4}function va(n,e){n.l+=e}function ge(n){var e=is(n);return vr(e,0),e}function nr(){var n=[],e=gt?256:2048,t=function(g){var p=ge(g);return vr(p,0),p},a=t(e),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&n.push(a),a=null)},l=function(g){return a&&g<a.length-a.l?a:(s(),a=t(Math.max(g+1,e)))},c=function(){return s(),wn(n)},h=function(g){s(),a=g,a.l==null&&(a.l=a.length),l(e)};return{next:l,push:h,end:c,_bufs:n}}function Se(n,e,t,a){var s=+e,l;if(!isNaN(s)){a||(a=$F[s].p||(t||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=n.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var h=0;h!=4;++h)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&vm(t)&&n.push(t)}}function Hl(n,e,t){var a=ir(n);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function DT(n,e,t){var a=ir(n);return a.s=Hl(a.s,e.s,t),a.e=Hl(a.e,e.s,t),a}function jl(n,e){if(n.cRel&&n.c<0)for(n=ir(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=ir(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=_t(n);return!n.cRel&&n.cRel!=null&&(t=eM(t)),!n.rRel&&n.rRel!=null&&(t=J4(t)),t}function E0(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Fn(n.s.c)+":"+(n.e.cRel?"":"$")+Fn(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+In(n.s.r)+":"+(n.e.rRel?"":"$")+In(n.e.r):jl(n.s,e.biff)+":"+jl(n.e,e.biff)}function ym(n){return parseInt(Z4(n),10)-1}function In(n){return""+(n+1)}function J4(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function Z4(n){return n.replace(/\$(\d+)$/,"$1")}function Tm(n){for(var e=tM(n),t=0,a=0;a!==e.length;++a)t=26*t+e.charCodeAt(a)-64;return t-1}function Fn(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function eM(n){return n.replace(/^([A-Z])/,"$$$1")}function tM(n){return n.replace(/^\$([A-Z])/,"$1")}function nM(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function mn(n){for(var e=0,t=0,a=0;a<n.length;++a){var s=n.charCodeAt(a);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function _t(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Sr(n){var e=n.indexOf(":");return e==-1?{s:mn(n),e:mn(n)}:{s:mn(n.slice(0,e)),e:mn(n.slice(e+1))}}function Zt(n,e){return typeof e>"u"||typeof e=="number"?Zt(n.s,n.e):(typeof n!="string"&&(n=_t(n)),typeof e!="string"&&(e=_t(e)),n==e?n:n+":"+e)}function Lt(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,s=0,l=n.length;for(t=0;a<l&&!((s=n.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.s.c=--t,t=0;a<l&&!((s=n.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;if(e.s.r=--t,a===l||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,t=0;a!=l&&!((s=n.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.e.c=--t,t=0;a!=l&&!((s=n.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;return e.e.r=--t,e}function PT(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=Ai(n.z,t?ar(e):e)}catch{}try{return n.w=Ai((n.XF||{}).numFmtId||(t?14:0),t?ar(e):e)}catch{return""+e}}function ja(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?sc[n.v]||n.v:e==null?PT(n,n.v):PT(n,e))}function cs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",a={};return a[t]=n,{SheetNames:[t],Sheets:a}}function tC(n,e,t){var a=t||{},s=n?Array.isArray(n):a.dense,l=n||(s?[]:{}),c=0,h=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var d=typeof a.origin=="string"?mn(a.origin):a.origin;c=d.r,h=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Lt(l["!ref"]);g.s.c=p.s.c,g.s.r=p.s.r,g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),c==-1&&(g.e.r=c=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var T=0;T!=e[v].length;++T)if(!(typeof e[v][T]>"u")){var x={v:e[v][T]},C=c+v,_=h+T;if(g.s.r>C&&(g.s.r=C),g.s.c>_&&(g.s.c=_),g.e.r<C&&(g.e.r=C),g.e.c<_&&(g.e.c=_),e[v][T]&&typeof e[v][T]=="object"&&!Array.isArray(e[v][T])&&!(e[v][T]instanceof Date))x=e[v][T];else if(Array.isArray(x.v)&&(x.f=e[v][T][1],x.v=x.v[0]),x.v===null)if(x.f)x.t="n";else if(a.nullError)x.t="e",x.v=0;else if(a.sheetStubs)x.t="z";else continue;else typeof x.v=="number"?x.t="n":typeof x.v=="boolean"?x.t="b":x.v instanceof Date?(x.z=a.dateNF||Vt[14],a.cellDates?(x.t="d",x.w=Ai(x.z,ar(x.v))):(x.t="n",x.v=ar(x.v),x.w=Ai(x.z,x.v))):x.t="s";if(s)l[C]||(l[C]=[]),l[C][_]&&l[C][_].z&&(x.z=l[C][_].z),l[C][_]=x;else{var A=_t({c:_,r:C});l[A]&&l[A].z&&(x.z=l[A].z),l[A]=x}}}return g.s.c<1e7&&(l["!ref"]=Zt(g)),l}function So(n,e){return tC(null,n,e)}function rM(n){return n.read_shift(4,"i")}function Qr(n,e){return e||(e=ge(4)),e.write_shift(4,n),e}function Ln(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function pn(n,e){var t=!1;return e==null&&(t=!0,e=ge(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function aM(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function iM(n,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function xm(n,e){var t=n.l,a=n.read_shift(1),s=Ln(n),l=[],c={t:s,h:s};if((a&1)!==0){for(var h=n.read_shift(4),d=0;d!=h;++d)l.push(aM(n));c.r=l}else c.r=[{ich:0,ifnt:0}];return n.l=t+e,c}function sM(n,e){var t=!1;return e==null&&(t=!0,e=ge(15+4*n.t.length)),e.write_shift(1,0),pn(n.t,e),t?e.slice(0,e.l):e}var oM=xm;function lM(n,e){var t=!1;return e==null&&(t=!0,e=ge(23+4*n.t.length)),e.write_shift(1,1),pn(n.t,e),e.write_shift(4,1),iM({},e),t?e.slice(0,e.l):e}function Ur(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function us(n,e){return e==null&&(e=ge(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function hs(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function fs(n,e){return e==null&&(e=ge(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var cM=Ln,nC=pn;function _m(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function _h(n,e){var t=!1;return e==null&&(t=!0,e=ge(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var uM=Ln,W0=_m,Sm=_h;function rC(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,a=e[0]&2;n.l+=4;var s=a===0?xh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):Qi(e,0)>>2;return t?s/100:s}function aC(n,e){e==null&&(e=ge(4));var t=0,a=0,s=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,t=1),a)e.write_shift(-4,((t?s:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function iC(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function hM(n,e){return e||(e=ge(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var ds=iC,Co=hM;function Eo(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function ss(n,e){return(e||ge(8)).write_shift(8,n,"f")}function fM(n){var e={},t=n.read_shift(1),a=t>>>1,s=n.read_shift(1),l=n.read_shift(2,"i"),c=n.read_shift(1),h=n.read_shift(1),d=n.read_shift(1);switch(n.l++,a){case 0:e.auto=1;break;case 1:e.index=s;var g=_M[s];g&&(e.rgb=VT(g));break;case 2:e.rgb=VT([c,h,d]);break;case 3:e.theme=s;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function Sh(n,e){if(e||(e=ge(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=n.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function dM(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function gM(n,e){e||(e=ge(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var sC=2,pr=3,Bu=11,Ch=19,Hu=64,mM=65,pM=71,vM=4108,yM=4126,En=80,FT={1:{n:"CodePage",t:sC},2:{n:"Category",t:En},3:{n:"PresentationFormat",t:En},4:{n:"ByteCount",t:pr},5:{n:"LineCount",t:pr},6:{n:"ParagraphCount",t:pr},7:{n:"SlideCount",t:pr},8:{n:"NoteCount",t:pr},9:{n:"HiddenCount",t:pr},10:{n:"MultimediaClipCount",t:pr},11:{n:"ScaleCrop",t:Bu},12:{n:"HeadingPairs",t:vM},13:{n:"TitlesOfParts",t:yM},14:{n:"Manager",t:En},15:{n:"Company",t:En},16:{n:"LinksUpToDate",t:Bu},17:{n:"CharacterCount",t:pr},19:{n:"SharedDoc",t:Bu},22:{n:"HyperlinksChanged",t:Bu},23:{n:"AppVersion",t:pr,p:"version"},24:{n:"DigSig",t:mM},26:{n:"ContentType",t:En},27:{n:"ContentStatus",t:En},28:{n:"Language",t:En},29:{n:"Version",t:En},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}},LT={1:{n:"CodePage",t:sC},2:{n:"Title",t:En},3:{n:"Subject",t:En},4:{n:"Author",t:En},5:{n:"Keywords",t:En},6:{n:"Comments",t:En},7:{n:"Template",t:En},8:{n:"LastAuthor",t:En},9:{n:"RevNumber",t:En},10:{n:"EditTime",t:Hu},11:{n:"LastPrinted",t:Hu},12:{n:"CreatedDate",t:Hu},13:{n:"ModifiedDate",t:Hu},14:{n:"PageCount",t:pr},15:{n:"WordCount",t:pr},16:{n:"CharCount",t:pr},17:{n:"Thumbnail",t:pM},18:{n:"Application",t:En},19:{n:"DocSecurity",t:pr},255:{},2147483648:{n:"Locale",t:Ch},2147483651:{n:"Behavior",t:Ch},1919054434:{}};function TM(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var xM=TM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),_M=ir(xM),sc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},SM={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},ju={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function oC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function lC(n,e){var t=O4(SM),a=[],s;a[a.length]=en,a[a.length]=Ne("Types",null,{xmlns:gn.CT,"xmlns:xsd":gn.xsd,"xmlns:xsi":gn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ne("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){n[d]&&n[d].length>0&&(s=n[d][0],a[a.length]=Ne("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:ju[d][e.bookType]||ju[d].xlsx}))},c=function(d){(n[d]||[]).forEach(function(g){a[a.length]=Ne("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:ju[d][e.bookType]||ju[d].xlsx})})},h=function(d){(n[d]||[]).forEach(function(g){a[a.length]=Ne("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:t[d][0]})})};return l("workbooks"),c("sheets"),c("charts"),h("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),c("metadata"),h("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ht={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function cC(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function oo(n){var e=[en,Ne("Relationships",null,{xmlns:gn.RELS})];return Rn(n["!id"]).forEach(function(t){e[e.length]=Ne("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function yt(n,e,t,a,s,l){if(s||(s={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,s.Id="rId"+e,s.Type=a,s.Target=t,[ht.HLINK,ht.XPATH,ht.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),n["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][s.Id]=s,n[("/"+s.Target).replace("//","/")]=s,e}function CM(n){var e=[en];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function UT(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function EM(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function AM(n){var e=[en];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(UT(n[t][0],n[t][1])),e.push(EM("",n[t][0]));return e.push(UT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function uC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+gh.version+"</meta:generator></office:meta></office:document-meta>"}var es=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function A0(n,e,t,a,s){s[n]!=null||e==null||e===""||(s[n]=e,e=xt(e),a[a.length]=t?Ne(n,e,t):bn(n,e))}function hC(n,e){var t=e||{},a=[en,Ne("cp:coreProperties",null,{"xmlns:cp":gn.CORE_PROPS,"xmlns:dc":gn.dc,"xmlns:dcterms":gn.dcterms,"xmlns:dcmitype":gn.dcmitype,"xmlns:xsi":gn.xsi})],s={};if(!n&&!t.Props)return a.join("");n&&(n.CreatedDate!=null&&A0("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:X0(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),n.ModifiedDate!=null&&A0("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:X0(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=es.length;++l){var c=es[l],h=t.Props&&t.Props[c[1]]!=null?t.Props[c[1]]:n?n[c[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&A0(c[0],h,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var lo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],fC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function dC(n){var e=[],t=Ne;return n||(n={}),n.Application="SheetJS",e[e.length]=en,e[e.length]=Ne("Properties",null,{xmlns:gn.EXT_PROPS,"xmlns:vt":gn.vt}),lo.forEach(function(a){if(n[a[1]]!==void 0){var s;switch(a[2]){case"string":s=xt(String(n[a[1]]));break;case"bool":s=n[a[1]]?"true":"false";break}s!==void 0&&(e[e.length]=t(a[0],s))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(a){return"<vt:lpstr>"+xt(a)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function gC(n){var e=[en,Ne("Properties",null,{xmlns:gn.CUST_PROPS,"xmlns:vt":gn.vt})];if(!n)return e.join("");var t=1;return Rn(n).forEach(function(s){++t,e[e.length]=Ne("property",G4(n[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:xt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var BT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function wM(n,e){var t=[];return Rn(BT).map(function(a){for(var s=0;s<es.length;++s)if(es[s][1]==a)return es[s];for(s=0;s<lo.length;++s)if(lo[s][1]==a)return lo[s];throw a}).forEach(function(a){if(n[a[1]]!=null){var s=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:n[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(bn(BT[a[1]]||a[1],s))}}),Ne("DocumentProperties",t.join(""),{xmlns:yr.o})}function bM(n,e){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return n&&Rn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)){for(var c=0;c<es.length;++c)if(l==es[c][1])return;for(c=0;c<lo.length;++c)if(l==lo[c][1])return;for(c=0;c<t.length;++c)if(l==t[c])return;var h=n[l],d="string";typeof h=="number"?(d="float",h=String(h)):h===!0||h===!1?(d="boolean",h=h?"1":"0"):h=String(h),s.push(Ne(wT(l),h,{"dt:dt":d}))}}),e&&Rn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)&&!(n&&Object.prototype.hasOwnProperty.call(n,l))){var c=e[l],h="string";typeof c=="number"?(h="float",c=String(c)):c===!0||c===!1?(h="boolean",c=c?"1":"0"):c instanceof Date?(h="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Ne(wT(l),c,{"dt:dt":h}))}}),"<"+a+' xmlns="'+yr.o+'">'+s.join("")+"</"+a+">"}function IM(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,a=t%Math.pow(2,32),s=(t-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=ge(8);return c.write_shift(4,a),c.write_shift(4,s),c}function HT(n,e){var t=ge(4),a=ge(4);switch(t.write_shift(4,n==80?31:n),n){case 3:a.write_shift(-4,e);break;case 5:a=ge(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=IM(e);break;case 31:case 80:for(a=ge(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return wn([t,a])}var mC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function RM(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function jT(n,e,t){var a=ge(8),s=[],l=[],c=8,h=0,d=ge(8),g=ge(8);if(d.write_shift(4,2),d.write_shift(4,1200),g.write_shift(4,1),l.push(d),s.push(g),c+=8+d.length,!e){g=ge(8),g.write_shift(4,0),s.unshift(g);var p=[ge(4)];for(p[0].write_shift(4,n.length),h=0;h<n.length;++h){var v=n[h][0];for(d=ge(8+2*(v.length+1)+(v.length%2?0:2)),d.write_shift(4,h+2),d.write_shift(4,v.length+1),d.write_shift(0,v,"dbcs");d.l!=d.length;)d.write_shift(1,0);p.push(d)}d=wn(p),l.unshift(d),c+=8+d.length}for(h=0;h<n.length;++h)if(!(e&&!e[n[h][0]])&&!(mC.indexOf(n[h][0])>-1||fC.indexOf(n[h][0])>-1)&&n[h][1]!=null){var T=n[h][1],x=0;if(e){x=+e[n[h][0]];var C=t[x];if(C.p=="version"&&typeof T=="string"){var _=T.split(".");T=(+_[0]<<16)+(+_[1]||0)}d=HT(C.t,T)}else{var A=RM(T);A==-1&&(A=31,T=String(T)),d=HT(A,T)}l.push(d),g=ge(8),g.write_shift(4,e?x:2+h),s.push(g),c+=8+d.length}var B=8*(l.length+1);for(h=0;h<l.length;++h)s[h].write_shift(4,B),B+=l[h].length;return a.write_shift(4,c),a.write_shift(4,l.length),wn([a].concat(s).concat(l))}function zT(n,e,t,a,s,l){var c=ge(s?68:48),h=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,It.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,e,"hex"),c.write_shift(4,s?68:48);var d=jT(n,t,a);if(h.push(d),s){var g=jT(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+d.length),h.push(g)}return wn(h)}function NM(n,e){e||(e=ge(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function kM(n,e){return n.read_shift(e)===1}function qn(n,e){return e||(e=ge(2)),e.write_shift(2,+!!n),e}function pC(n){return n.read_shift(2,"u")}function Pr(n,e){return e||(e=ge(2)),e.write_shift(2,n),e}function vC(n,e,t){return t||(t=ge(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function yC(n,e,t){var a=n.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=n.read_shift(1);l&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var c=a?n.read_shift(a,s):"";return c}function OM(n){var e=n.t||"",t=ge(3);t.write_shift(2,e.length),t.write_shift(1,1);var a=ge(2*e.length);a.write_shift(2*e.length,e,"utf16le");var s=[t,a];return wn(s)}function MM(n,e,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var s=n.read_shift(1);return s===0?a=n.read_shift(e,"sbcs-cont"):a=n.read_shift(e,"dbcs-cont"),a}function DM(n,e,t){var a=n.read_shift(t&&t.biff==2?1:2);return a===0?(n.l++,""):MM(n,a,t)}function PM(n,e,t){if(t.biff>5)return DM(n,e,t);var a=n.read_shift(1);return a===0?(n.l++,""):n.read_shift(a,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function TC(n,e,t){return t||(t=ge(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function GT(n,e){e||(e=ge(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function FM(n){var e=ge(512),t=0,a=n.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}e.write_shift(4,2),e.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(t=0;t<c.length;++t)e.write_shift(4,c[t]);if(l==28)a=a.slice(1),GT(a,e);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));var h=s>-1?a.slice(0,s):a;for(e.write_shift(4,2*(h.length+1)),t=0;t<h.length;++t)e.write_shift(2,h.charCodeAt(t));e.write_shift(2,0),l&8&&GT(s>-1?a.slice(s+1):"",e)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(e.write_shift(2,d),e.write_shift(4,a.length-3*d+1),t=0;t<a.length-3*d;++t)e.write_shift(1,a.charCodeAt(t+3*d)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function os(n,e,t,a){return a||(a=ge(6)),a.write_shift(2,n),a.write_shift(2,e),a.write_shift(2,t||0),a}function LM(n,e,t){var a=t.biff>8?4:2,s=n.read_shift(a),l=n.read_shift(a,"i"),c=n.read_shift(a,"i");return[s,l,c]}function UM(n){var e=n.read_shift(2),t=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2);return{s:{c:a,r:e},e:{c:s,r:t}}}function xC(n,e){return e||(e=ge(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Cm(n,e,t){var a=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ge(s);return l.write_shift(2,a),l.write_shift(2,e),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function BM(n,e){var t=!e||e.biff==8,a=ge(t?112:54);for(a.write_shift(e.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function HM(n,e){var t=!e||e.biff>=8?2:1,a=ge(8+t*n.name.length);a.write_shift(4,n.pos),a.write_shift(1,n.hs||0),a.write_shift(1,n.dt),a.write_shift(1,n.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function jM(n,e){var t=ge(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var a=[],s=0;s<n.length;++s)a[s]=OM(n[s]);var l=wn([t].concat(a));return l.parts=[t.length].concat(a.map(function(c){return c.length})),l}function zM(){var n=ge(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function GM(n){var e=ge(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function $M(n,e){var t=n.name||"Arial",a=e&&e.biff==5,s=a?15+t.length:16+2*t.length,l=ge(s);return l.write_shift(2,n.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,t.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),l}function KM(n,e,t,a){var s=ge(10);return os(n,e,a,s),s.write_shift(4,t),s}function VM(n,e,t,a,s){var l=!s||s.biff==8,c=ge(8+ +l+(1+l)*t.length);return os(n,e,a,c),c.write_shift(2,t.length),l&&c.write_shift(1,1),c.write_shift((1+l)*t.length,t,l?"utf16le":"sbcs"),c}function qM(n,e,t,a){var s=t&&t.biff==5;a||(a=ge(s?3+e.length:5+2*e.length)),a.write_shift(2,n),a.write_shift(s?1:2,e.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}function YM(n,e){var t=e.biff==8||!e.biff?4:2,a=ge(2*t+6);return a.write_shift(t,n.s.r),a.write_shift(t,n.e.r+1),a.write_shift(2,n.s.c),a.write_shift(2,n.e.c+1),a.write_shift(2,0),a}function $T(n,e,t,a){var s=t&&t.biff==5;a||(a=ge(s?16:20)),a.write_shift(2,0),n.style?(a.write_shift(2,n.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,n.numFmtId||0),a.write_shift(2,e<<4));var l=0;return n.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function XM(n){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function WM(n,e,t,a,s,l){var c=ge(8);return os(n,e,a,c),vC(t,l,c),c}function QM(n,e,t,a){var s=ge(14);return os(n,e,a,s),ss(t,s),s}function JM(n,e,t){if(t.biff<8)return ZM(n,e,t);for(var a=[],s=n.l+e,l=n.read_shift(t.biff>8?4:2);l--!==0;)a.push(LM(n,t.biff>8?12:6,t));if(n.l!=s)throw new Error("Bad ExternSheet: "+n.l+" != "+s);return a}function ZM(n,e,t){n[n.l+1]==3&&n[n.l]++;var a=yC(n,e,t);return a.charCodeAt(0)==3?a.slice(1):a}function e3(n){var e=ge(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)xC(n[t],e);return e}function t3(n){var e=ge(24),t=mn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(a[s],16));return wn([e,FM(n[1])])}function n3(n){var e=n[1].Tooltip,t=ge(10+2*(e.length+1));t.write_shift(2,2048);var a=mn(n[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function r3(n){return n||(n=ge(4)),n.write_shift(2,1),n.write_shift(2,1),n}function a3(n,e,t){if(!t.cellStyles)return va(n,e);var a=t&&t.biff>=12?4:2,s=n.read_shift(a),l=n.read_shift(a),c=n.read_shift(a),h=n.read_shift(a),d=n.read_shift(2);a==2&&(n.l+=2);var g={s,e:l,w:c,ixfe:h,flags:d};return(t.biff>=5||!t.biff)&&(g.level=d>>8&7),g}function i3(n,e){var t=ge(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var a=0;return n.hidden&&(a|=1),t.write_shift(1,a),a=n.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function s3(n){for(var e=ge(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function o3(n,e,t){var a=ge(15);return lc(a,n,e),a.write_shift(8,t,"f"),a}function l3(n,e,t){var a=ge(9);return lc(a,n,e),a.write_shift(2,t),a}var c3=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=fm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(h,d){var g=[],p=is(1);switch(d.type){case"base64":p=qr(Ha(h));break;case"binary":p=qr(h);break;case"buffer":case"array":p=h;break}vr(p,0);var v=p.read_shift(1),T=!!(v&136),x=!1,C=!1;switch(v){case 2:break;case 3:break;case 48:x=!0,T=!0;break;case 49:x=!0,T=!0;break;case 131:break;case 139:break;case 140:C=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var _=0,A=521;v==2&&(_=p.read_shift(2)),p.l+=3,v!=2&&(_=p.read_shift(4)),_>1048576&&(_=1e6),v!=2&&(A=p.read_shift(2));var B=p.read_shift(2),I=d.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(I=n[p[p.l]]),p.l+=1,p.l+=2),C&&(p.l+=36);for(var k=[],z={},X=Math.min(p.length,v==2?521:A-10-(x?264:0)),W=C?32:11;p.l<X&&p[p.l]!=13;)switch(z={},z.name=mh.utils.decode(I,p.slice(p.l,p.l+W)).replace(/[\u0000\r\n].*$/g,""),p.l+=W,z.type=String.fromCharCode(p.read_shift(1)),v!=2&&!C&&(z.offset=p.read_shift(4)),z.len=p.read_shift(1),v==2&&(z.offset=p.read_shift(2)),z.dec=p.read_shift(1),z.name.length&&k.push(z),v!=2&&(p.l+=C?13:14),z.type){case"B":(!x||z.len!=8)&&d.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+z.name+":"+z.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+z.type)}if(p[p.l]!==13&&(p.l=A-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=A;var N=0,G=0;for(g[0]=[],G=0;G!=k.length;++G)g[0][G]=k[G].name;for(;_-- >0;){if(p[p.l]===42){p.l+=B;continue}for(++p.l,g[++N]=[],G=0,G=0;G!=k.length;++G){var V=p.slice(p.l,p.l+k[G].len);p.l+=k[G].len,vr(V,0);var ie=mh.utils.decode(I,V);switch(k[G].type){case"C":ie.trim().length&&(g[N][G]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?g[N][G]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):g[N][G]=ie;break;case"F":g[N][G]=parseFloat(ie.trim());break;case"+":case"I":g[N][G]=C?V.read_shift(-4,"i")^2147483648:V.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":g[N][G]=!0;break;case"N":case"F":g[N][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!T)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));g[N][G]="##MEMO##"+(C?parseInt(ie.trim(),10):V.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(g[N][G]=+ie||0);break;case"@":g[N][G]=new Date(V.read_shift(-8,"f")-621356832e5);break;case"T":g[N][G]=new Date((V.read_shift(4)-2440588)*864e5+V.read_shift(4));break;case"Y":g[N][G]=V.read_shift(4,"i")/1e4+V.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[N][G]=-V.read_shift(-8,"f");break;case"B":if(x&&k[G].len==8){g[N][G]=V.read_shift(8,"f");break}case"G":case"P":V.l+=k[G].len;break;case"0":if(k[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+k[G].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),d.DBF=k,g}function a(h,d){var g=d||{};g.dateNF||(g.dateNF="yyyymmdd");var p=So(t(h,g),g);return p["!cols"]=g.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete g.DBF,p}function s(h,d){try{return cs(a(h,d),d)}catch(g){if(d&&d.WTF)throw g}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(h,d){var g=d||{};if(+g.codepage>=0&&Xl(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var p=nr(),v=Ih(h,{header:1,raw:!0,cellDates:!0}),T=v[0],x=v.slice(1),C=h["!cols"]||[],_=0,A=0,B=0,I=1;for(_=0;_<T.length;++_){if(((C[_]||{}).DBF||{}).name){T[_]=C[_].DBF.name,++B;continue}if(T[_]!=null){if(++B,typeof T[_]=="number"&&(T[_]=T[_].toString(10)),typeof T[_]!="string")throw new Error("DBF Invalid column name "+T[_]+" |"+typeof T[_]+"|");if(T.indexOf(T[_])!==_){for(A=0;A<1024;++A)if(T.indexOf(T[_]+"_"+A)==-1){T[_]+="_"+A;break}}}}var k=Lt(h["!ref"]),z=[],X=[],W=[];for(_=0;_<=k.e.c-k.s.c;++_){var N="",G="",V=0,ie=[];for(A=0;A<x.length;++A)x[A][_]!=null&&ie.push(x[A][_]);if(ie.length==0||T[_]==null){z[_]="?";continue}for(A=0;A<ie.length;++A){switch(typeof ie[A]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=ie[A]instanceof Date?"D":"C";break;default:G="C"}V=Math.max(V,String(ie[A]).length),N=N&&N!=G?"C":G}V>250&&(V=250),G=((C[_]||{}).DBF||{}).type,G=="C"&&C[_].DBF.len>V&&(V=C[_].DBF.len),N=="B"&&G=="N"&&(N="N",W[_]=C[_].DBF.dec,V=C[_].DBF.len),X[_]=N=="C"||G=="N"?V:l[N]||0,I+=X[_],z[_]=N}var J=p.next(32);for(J.write_shift(4,318902576),J.write_shift(4,x.length),J.write_shift(2,296+32*B),J.write_shift(2,I),_=0;_<4;++_)J.write_shift(4,0);for(J.write_shift(4,0|(+e[SS]||3)<<8),_=0,A=0;_<T.length;++_)if(T[_]!=null){var he=p.next(32),Ae=(T[_].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);he.write_shift(1,Ae,"sbcs"),he.write_shift(1,z[_]=="?"?"C":z[_],"sbcs"),he.write_shift(4,A),he.write_shift(1,X[_]||l[z[_]]||0),he.write_shift(1,W[_]||0),he.write_shift(1,2),he.write_shift(4,0),he.write_shift(1,0),he.write_shift(4,0),he.write_shift(4,0),A+=X[_]||l[z[_]]||0}var je=p.next(264);for(je.write_shift(4,13),_=0;_<65;++_)je.write_shift(4,0);for(_=0;_<x.length;++_){var ke=p.next(I);for(ke.write_shift(1,0),A=0;A<T.length;++A)if(T[A]!=null)switch(z[A]){case"L":ke.write_shift(1,x[_][A]==null?63:x[_][A]?84:70);break;case"B":ke.write_shift(8,x[_][A]||0,"f");break;case"N":var re="0";for(typeof x[_][A]=="number"&&(re=x[_][A].toFixed(W[A]||0)),B=0;B<X[A]-re.length;++B)ke.write_shift(1,32);ke.write_shift(1,re,"sbcs");break;case"D":x[_][A]?(ke.write_shift(4,("0000"+x[_][A].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(x[_][A].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+x[_][A].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var _e=String(x[_][A]!=null?x[_][A]:"").slice(0,X[A]);for(ke.write_shift(1,_e,"sbcs"),B=0;B<X[A]-_e.length;++B)ke.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),u3=(function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+Rn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(T,x){var C=n[x];return typeof C=="number"?gT(C):C},a=function(T,x,C){var _=x.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return _==59?T:gT(_)};n["|"]=254;function s(T,x){switch(x.type){case"base64":return l(Ha(T),x);case"binary":return l(T,x);case"buffer":return l(gt&&Buffer.isBuffer(T)?T.toString("binary"):rc(T),x);case"array":return l(Jh(T),x)}throw new Error("Unrecognized type "+x.type)}function l(T,x){var C=T.split(/[\n\r]+/),_=-1,A=-1,B=0,I=0,k=[],z=[],X=null,W={},N=[],G=[],V=[],ie=0,J;for(+x.codepage>=0&&Xl(+x.codepage);B!==C.length;++B){ie=0;var he=C[B].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,t),Ae=he.replace(/;;/g,"\0").split(";").map(function(j){return j.replace(/\u0000/g,";")}),je=Ae[0],ke;if(he.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ae[1].charAt(0)=="P"&&z.push(he.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,_e=!1,fe=!1,Te=!1,U=-1,ue=-1;for(I=1;I<Ae.length;++I)switch(Ae[I].charAt(0)){case"A":break;case"X":A=parseInt(Ae[I].slice(1))-1,_e=!0;break;case"Y":for(_=parseInt(Ae[I].slice(1))-1,_e||(A=0),J=k.length;J<=_;++J)k[J]=[];break;case"K":ke=Ae[I].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(La(ke))?isNaN(Ql(ke).getDate())||(ke=Xn(ke)):(ke=La(ke),X!==null&&DS(X)&&(ke=US(ke))),re=!0;break;case"E":Te=!0;var b=lD(Ae[I].slice(1),{r:_,c:A});k[_][A]=[k[_][A],b];break;case"S":fe=!0,k[_][A]=[k[_][A],"S5S"];break;case"G":break;case"R":U=parseInt(Ae[I].slice(1))-1;break;case"C":ue=parseInt(Ae[I].slice(1))-1;break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}if(re&&(k[_][A]&&k[_][A].length==2?k[_][A][0]=ke:k[_][A]=ke,X=null),fe){if(Te)throw new Error("SYLK shared formula cannot have own formula");var L=U>-1&&k[U][ue];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");k[_][A][1]=cD(L[1],{r:_-U,c:A-ue})}break;case"F":var P=0;for(I=1;I<Ae.length;++I)switch(Ae[I].charAt(0)){case"X":A=parseInt(Ae[I].slice(1))-1,++P;break;case"Y":for(_=parseInt(Ae[I].slice(1))-1,J=k.length;J<=_;++J)k[J]=[];break;case"M":ie=parseInt(Ae[I].slice(1))/20;break;case"F":break;case"G":break;case"P":X=z[parseInt(Ae[I].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(V=Ae[I].slice(1).split(" "),J=parseInt(V[0],10);J<=parseInt(V[1],10);++J)ie=parseInt(V[2],10),G[J-1]=ie===0?{hidden:!0}:{wch:ie},Em(G[J-1]);break;case"C":A=parseInt(Ae[I].slice(1))-1,G[A]||(G[A]={});break;case"R":_=parseInt(Ae[I].slice(1))-1,N[_]||(N[_]={}),ie>0?(N[_].hpt=ie,N[_].hpx=AC(ie)):ie===0&&(N[_].hidden=!0);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}P<1&&(X=null);break;default:if(x&&x.WTF)throw new Error("SYLK bad record "+he)}}return N.length>0&&(W["!rows"]=N),G.length>0&&(W["!cols"]=G),x&&x.sheetRows&&(k=k.slice(0,x.sheetRows)),[k,W]}function c(T,x){var C=s(T,x),_=C[0],A=C[1],B=So(_,x);return Rn(A).forEach(function(I){B[I]=A[I]}),B}function h(T,x){return cs(c(T,x),x)}function d(T,x,C,_){var A="C;Y"+(C+1)+";X"+(_+1)+";K";switch(T.t){case"n":A+=T.v||0,T.f&&!T.F&&(A+=";E"+wm(T.f,{r:C,c:_}));break;case"b":A+=T.v?"TRUE":"FALSE";break;case"e":A+=T.w||T.v;break;case"d":A+='"'+(T.w||T.v)+'"';break;case"s":A+='"'+T.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function g(T,x){x.forEach(function(C,_){var A="F;W"+(_+1)+" "+(_+1)+" ";C.hidden?A+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=Eh(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=Ah(C.wpx)),typeof C.wch=="number"&&(A+=Math.round(C.wch))),A.charAt(A.length-1)!=" "&&T.push(A)})}function p(T,x){x.forEach(function(C,_){var A="F;";C.hidden?A+="M0;":C.hpt?A+="M"+20*C.hpt+";":C.hpx&&(A+="M"+20*wh(C.hpx)+";"),A.length>2&&T.push(A+"R"+(_+1))})}function v(T,x){var C=["ID;PWXL;N;E"],_=[],A=Lt(T["!ref"]),B,I=Array.isArray(T),k=`\r
`;C.push("P;PGeneral"),C.push("F;P0;DG0G8;M255"),T["!cols"]&&g(C,T["!cols"]),T["!rows"]&&p(C,T["!rows"]),C.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var z=A.s.r;z<=A.e.r;++z)for(var X=A.s.c;X<=A.e.c;++X){var W=_t({r:z,c:X});B=I?(T[z]||[])[X]:T[W],!(!B||B.v==null&&(!B.f||B.F))&&_.push(d(B,T,z,X))}return C.join(k)+k+_.join(k)+k+"E"+k}return{to_workbook:h,to_sheet:c,from_sheet:v}})(),h3=(function(){function n(l,c){switch(c.type){case"base64":return e(Ha(l),c);case"binary":return e(l,c);case"buffer":return e(gt&&Buffer.isBuffer(l)?l.toString("binary"):rc(l),c);case"array":return e(Jh(l),c)}throw new Error("Unrecognized type "+c.type)}function e(l,c){for(var h=l.split(`
`),d=-1,g=-1,p=0,v=[];p!==h.length;++p){if(h[p].trim()==="BOT"){v[++d]=[],g=0;continue}if(!(d<0)){var T=h[p].trim().split(","),x=T[0],C=T[1];++p;for(var _=h[p]||"";(_.match(/["]/g)||[]).length&1&&p<h.length-1;)_+=`
`+h[++p];switch(_=_.trim(),+x){case-1:if(_==="BOT"){v[++d]=[],g=0;continue}else if(_!=="EOD")throw new Error("Unrecognized DIF special command "+_);break;case 0:_==="TRUE"?v[d][g]=!0:_==="FALSE"?v[d][g]=!1:isNaN(La(C))?isNaN(Ql(C).getDate())?v[d][g]=C:v[d][g]=Xn(C):v[d][g]=La(C),++g;break;case 1:_=_.slice(1,_.length-1),_=_.replace(/""/g,'"'),_&&_.match(/^=".*"$/)&&(_=_.slice(2,-1)),v[d][g++]=_!==""?_:null;break}if(_==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function t(l,c){return So(n(l,c),c)}function a(l,c){return cs(t(l,c),c)}var s=(function(){var l=function(d,g,p,v,T){d.push(g),d.push(p+","+v),d.push('"'+T.replace(/"/g,'""')+'"')},c=function(d,g,p,v){d.push(g+","+p),d.push(g==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var g=[],p=Lt(d["!ref"]),v,T=Array.isArray(d);l(g,"TABLE",0,1,"sheetjs"),l(g,"VECTORS",0,p.e.r-p.s.r+1,""),l(g,"TUPLES",0,p.e.c-p.s.c+1,""),l(g,"DATA",0,0,"");for(var x=p.s.r;x<=p.e.r;++x){c(g,-1,0,"BOT");for(var C=p.s.c;C<=p.e.c;++C){var _=_t({r:x,c:C});if(v=T?(d[x]||[])[C]:d[_],!v){c(g,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?c(g,1,0,"="+v.f):c(g,1,0,""):c(g,0,A,"V");break;case"b":c(g,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(g,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=Ai(v.z||Vt[14],ar(Xn(v.v)))),c(g,0,v.w,"V");break;default:c(g,1,0,"")}}}c(g,-1,0,"EOD");var B=`\r
`,I=g.join(B);return I}})();return{to_workbook:a,to_sheet:t,from_sheet:s}})(),_C=(function(){function n(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,T){for(var x=v.split(`
`),C=-1,_=-1,A=0,B=[];A!==x.length;++A){var I=x[A].trim().split(":");if(I[0]==="cell"){var k=mn(I[1]);if(B.length<=k.r)for(C=B.length;C<=k.r;++C)B[C]||(B[C]=[]);switch(C=k.r,_=k.c,I[2]){case"t":B[C][_]=n(I[3]);break;case"v":B[C][_]=+I[3];break;case"vtf":var z=I[I.length-1];case"vtc":switch(I[3]){case"nl":B[C][_]=!!+I[4];break;default:B[C][_]=+I[4];break}I[2]=="vtf"&&(B[C][_]=[B[C][_],z])}}}return T&&T.sheetRows&&(B=B.slice(0,T.sheetRows)),B}function a(v,T){return So(t(v,T),T)}function s(v,T){return cs(a(v,T),T)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function g(v){if(!v||!v["!ref"])return"";for(var T=[],x=[],C,_="",A=Sr(v["!ref"]),B=Array.isArray(v),I=A.s.r;I<=A.e.r;++I)for(var k=A.s.c;k<=A.e.c;++k)if(_=_t({r:I,c:k}),C=B?(v[I]||[])[k]:v[_],!(!C||C.v==null||C.t==="z")){switch(x=["cell",_,"t"],C.t){case"s":case"str":x.push(e(C.v));break;case"n":C.f?(x[2]="vtf",x[3]="n",x[4]=C.v,x[5]=e(C.f)):(x[2]="v",x[3]=C.v);break;case"b":x[2]="vt"+(C.f?"f":"c"),x[3]="nl",x[4]=C.v?"1":"0",x[5]=e(C.f||(C.v?"TRUE":"FALSE"));break;case"d":var z=ar(Xn(C.v));x[2]="vtc",x[3]="nd",x[4]=""+z,x[5]=C.w||Ai(C.z||Vt[14],z);break;case"e":continue}T.push(x.join(":"))}return T.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),T.push("valueformat:1:text-wiki"),T.join(`
`)}function p(v){return[l,c,h,c,g(v),d].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:p}})(),f3=(function(){function n(p,v,T,x,C){C.raw?v[T][x]=p:p===""||(p==="TRUE"?v[T][x]=!0:p==="FALSE"?v[T][x]=!1:isNaN(La(p))?isNaN(Ql(p).getDate())?v[T][x]=p:v[T][x]=Xn(p):v[T][x]=La(p))}function e(p,v){var T=v||{},x=[];if(!p||p.length===0)return x;for(var C=p.split(/[\r\n]/),_=C.length-1;_>=0&&C[_].length===0;)--_;for(var A=10,B=0,I=0;I<=_;++I)B=C[I].indexOf(" "),B==-1?B=C[I].length:B++,A=Math.max(A,B);for(I=0;I<=_;++I){x[I]=[];var k=0;for(n(C[I].slice(0,A).trim(),x,I,k,T),k=1;k<=(C[I].length-A)/10+1;++k)n(C[I].slice(A+(k-1)*10,A+k*10).trim(),x,I,k,T)}return T.sheetRows&&(x=x.slice(0,T.sheetRows)),x}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(p){for(var v={},T=!1,x=0,C=0;x<p.length;++x)(C=p.charCodeAt(x))==34?T=!T:!T&&C in t&&(v[C]=(v[C]||0)+1);C=[];for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&C.push([v[x],x]);if(!C.length){v=a;for(x in v)Object.prototype.hasOwnProperty.call(v,x)&&C.push([v[x],x])}return C.sort(function(_,A){return _[0]-A[0]||a[_[1]]-a[A[1]]}),t[C.pop()[1]]||44}function l(p,v){var T=v||{},x="",C=T.dense?[]:{},_={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(x=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(x=p.charAt(4),p=p.slice(6)):x=s(p.slice(0,1024)):T&&T.FS?x=T.FS:x=s(p.slice(0,1024));var A=0,B=0,I=0,k=0,z=0,X=x.charCodeAt(0),W=!1,N=0,G=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var V=T.dateNF!=null?I4(T.dateNF):null;function ie(){var J=p.slice(k,z),he={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)he.t="z";else if(T.raw)he.t="s",he.v=J;else if(J.trim().length===0)he.t="s",he.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(he.t="s",he.v=J.slice(2,-1).replace(/""/g,'"')):uD(J)?(he.t="n",he.f=J.slice(1)):(he.t="s",he.v=J);else if(J=="TRUE")he.t="b",he.v=!0;else if(J=="FALSE")he.t="b",he.v=!1;else if(!isNaN(I=La(J)))he.t="n",T.cellText!==!1&&(he.w=J),he.v=I;else if(!isNaN(Ql(J).getDate())||V&&J.match(V)){he.z=T.dateNF||Vt[14];var Ae=0;V&&J.match(V)&&(J=R4(J,T.dateNF,J.match(V)||[]),Ae=1),T.cellDates?(he.t="d",he.v=Xn(J,Ae)):(he.t="n",he.v=ar(Xn(J,Ae))),T.cellText!==!1&&(he.w=Ai(he.z,he.v instanceof Date?ar(he.v):he.v)),T.cellNF||delete he.z}else he.t="s",he.v=J;if(he.t=="z"||(T.dense?(C[A]||(C[A]=[]),C[A][B]=he):C[_t({c:B,r:A})]=he),k=z+1,G=p.charCodeAt(k),_.e.c<B&&(_.e.c=B),_.e.r<A&&(_.e.r=A),N==X)++B;else if(B=0,++A,T.sheetRows&&T.sheetRows<=A)return!0}e:for(;z<p.length;++z)switch(N=p.charCodeAt(z)){case 34:G===34&&(W=!W);break;case X:case 10:case 13:if(!W&&ie())break e;break}return z-k>0&&ie(),C["!ref"]=Zt(_),C}function c(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):So(e(p,v),v)}function h(p,v){var T="",x=v.type=="string"?[0,0,0,0]:E8(p,v);switch(v.type){case"base64":T=Ha(p);break;case"binary":T=p;break;case"buffer":v.codepage==65001?T=p.toString("utf8"):v.codepage&&typeof mh<"u"||(T=gt&&Buffer.isBuffer(p)?p.toString("binary"):rc(p));break;case"array":T=Jh(p);break;case"string":T=p;break;default:throw new Error("Unrecognized type "+v.type)}return x[0]==239&&x[1]==187&&x[2]==191?T=Ul(T.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?T=Ul(T):v.type=="binary"&&typeof mh<"u",T.slice(0,19)=="socialcalc:version:"?_C.to_sheet(v.type=="string"?T:Ul(T),v):c(T,v)}function d(p,v){return cs(h(p,v),v)}function g(p){for(var v=[],T=Lt(p["!ref"]),x,C=Array.isArray(p),_=T.s.r;_<=T.e.r;++_){for(var A=[],B=T.s.c;B<=T.e.c;++B){var I=_t({r:_,c:B});if(x=C?(p[_]||[])[B]:p[I],!x||x.v==null){A.push("          ");continue}for(var k=(x.w||(ja(x),x.w)||"").slice(0,10);k.length<10;)k+=" ";A.push(k+(B===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:h,from_sheet:g}})(),KT=(function(){function n(b,L,P){if(b){vr(b,b.l||0);for(var j=P.Enum||U;b.l<b.length;){var Z=b.read_shift(2),be=j[Z]||j[65535],Ce=b.read_shift(2),Pe=b.l+Ce,De=be.f&&be.f(b,Ce,P);if(b.l=Pe,L(De,be,Z))return}}}function e(b,L){switch(L.type){case"base64":return t(qr(Ha(b)),L);case"binary":return t(qr(b),L);case"buffer":case"array":return t(b,L)}throw"Unsupported type "+L.type}function t(b,L){if(!b)return b;var P=L||{},j=P.dense?[]:{},Z="Sheet1",be="",Ce=0,Pe={},De=[],ot=[],et={s:{r:0,c:0},e:{r:0,c:0}},jt=P.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)P.Enum=U,n(b,function(Fe,Nn,Bn){switch(Bn){case 0:P.vers=Fe,Fe>=4096&&(P.qpro=!0);break;case 6:et=Fe;break;case 204:Fe&&(be=Fe);break;case 222:be=Fe;break;case 15:case 51:P.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:Bn==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=P.dateNF||Vt[14],P.cellDates&&(Fe[1].t="d",Fe[1].v=US(Fe[1].v))),P.qpro&&Fe[3]>Ce&&(j["!ref"]=Zt(et),Pe[Z]=j,De.push(Z),j=P.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Fe[3],Z=be||"Sheet"+(Ce+1),be="");var Cr=P.dense?(j[Fe[0].r]||[])[Fe[0].c]:j[_t(Fe[0])];if(Cr){Cr.t=Fe[1].t,Cr.v=Fe[1].v,Fe[1].z!=null&&(Cr.z=Fe[1].z),Fe[1].f!=null&&(Cr.f=Fe[1].f);break}P.dense?(j[Fe[0].r]||(j[Fe[0].r]=[]),j[Fe[0].r][Fe[0].c]=Fe[1]):j[_t(Fe[0])]=Fe[1];break}},P);else if(b[2]==26||b[2]==14)P.Enum=ue,b[2]==14&&(P.qpro=!0,b.l=0),n(b,function(Fe,Nn,Bn){switch(Bn){case 204:Z=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>Ce&&(j["!ref"]=Zt(et),Pe[Z]=j,De.push(Z),j=P.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Fe[3],Z="Sheet"+(Ce+1)),jt>0&&Fe[0].r>=jt)break;P.dense?(j[Fe[0].r]||(j[Fe[0].r]=[]),j[Fe[0].r][Fe[0].c]=Fe[1]):j[_t(Fe[0])]=Fe[1],et.e.c<Fe[0].c&&(et.e.c=Fe[0].c),et.e.r<Fe[0].r&&(et.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(ot[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:ot[Fe[0]]=Fe[1],Fe[0]==Ce&&(Z=Fe[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(j["!ref"]=Zt(et),Pe[be||Z]=j,De.push(be||Z),!ot.length)return{SheetNames:De,Sheets:Pe};for(var lt={},Un=[],kt=0;kt<ot.length;++kt)Pe[De[kt]]?(Un.push(ot[kt]||De[kt]),lt[ot[kt]]=Pe[ot[kt]]||Pe[De[kt]]):(Un.push(ot[kt]),lt[ot[kt]]={"!ref":"A1"});return{SheetNames:Un,Sheets:lt}}function a(b,L){var P=L||{};if(+P.codepage>=0&&Xl(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var j=nr(),Z=Lt(b["!ref"]),be=Array.isArray(b),Ce=[];Oe(j,0,l(1030)),Oe(j,6,d(Z));for(var Pe=Math.min(Z.e.r,8191),De=Z.s.r;De<=Pe;++De)for(var ot=In(De),et=Z.s.c;et<=Z.e.c;++et){De===Z.s.r&&(Ce[et]=Fn(et));var jt=Ce[et]+ot,lt=be?(b[De]||[])[et]:b[jt];if(!(!lt||lt.t=="z"))if(lt.t=="n")(lt.v|0)==lt.v&&lt.v>=-32768&&lt.v<=32767?Oe(j,13,x(De,et,lt.v)):Oe(j,14,_(De,et,lt.v));else{var Un=ja(lt);Oe(j,15,v(De,et,Un.slice(0,239)))}}return Oe(j,1),j.end()}function s(b,L){var P=L||{};if(+P.codepage>=0&&Xl(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var j=nr();Oe(j,0,c(b));for(var Z=0,be=0;Z<b.SheetNames.length;++Z)(b.Sheets[b.SheetNames[Z]]||{})["!ref"]&&Oe(j,27,Te(b.SheetNames[Z],be++));var Ce=0;for(Z=0;Z<b.SheetNames.length;++Z){var Pe=b.Sheets[b.SheetNames[Z]];if(!(!Pe||!Pe["!ref"])){for(var De=Lt(Pe["!ref"]),ot=Array.isArray(Pe),et=[],jt=Math.min(De.e.r,8191),lt=De.s.r;lt<=jt;++lt)for(var Un=In(lt),kt=De.s.c;kt<=De.e.c;++kt){lt===De.s.r&&(et[kt]=Fn(kt));var Fe=et[kt]+Un,Nn=ot?(Pe[lt]||[])[kt]:Pe[Fe];if(!(!Nn||Nn.t=="z"))if(Nn.t=="n")Oe(j,23,ie(lt,kt,Ce,Nn.v));else{var Bn=ja(Nn);Oe(j,22,N(lt,kt,Ce,Bn.slice(0,239)))}}++Ce}}return Oe(j,1),j.end()}function l(b){var L=ge(2);return L.write_shift(2,b),L}function c(b){var L=ge(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var P=0,j=0,Z=0,be=0;be<b.SheetNames.length;++be){var Ce=b.SheetNames[be],Pe=b.Sheets[Ce];if(!(!Pe||!Pe["!ref"])){++Z;var De=Sr(Pe["!ref"]);P<De.e.r&&(P=De.e.r),j<De.e.c&&(j=De.e.c)}}return P>8191&&(P=8191),L.write_shift(2,P),L.write_shift(1,Z),L.write_shift(1,j),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function h(b,L,P){var j={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&P.qpro?(j.s.c=b.read_shift(1),b.l++,j.s.r=b.read_shift(2),j.e.c=b.read_shift(1),b.l++,j.e.r=b.read_shift(2),j):(j.s.c=b.read_shift(2),j.s.r=b.read_shift(2),L==12&&P.qpro&&(b.l+=2),j.e.c=b.read_shift(2),j.e.r=b.read_shift(2),L==12&&P.qpro&&(b.l+=2),j.s.c==65535&&(j.s.c=j.e.c=j.s.r=j.e.r=0),j)}function d(b){var L=ge(8);return L.write_shift(2,b.s.c),L.write_shift(2,b.s.r),L.write_shift(2,b.e.c),L.write_shift(2,b.e.r),L}function g(b,L,P){var j=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(j[0].c=b.read_shift(1),j[3]=b.read_shift(1),j[0].r=b.read_shift(2),b.l+=2):(j[2]=b.read_shift(1),j[0].c=b.read_shift(2),j[0].r=b.read_shift(2)),j}function p(b,L,P){var j=b.l+L,Z=g(b,L,P);if(Z[1].t="s",P.vers==20768){b.l++;var be=b.read_shift(1);return Z[1].v=b.read_shift(be,"utf8"),Z}return P.qpro&&b.l++,Z[1].v=b.read_shift(j-b.l,"cstr"),Z}function v(b,L,P){var j=ge(7+P.length);j.write_shift(1,255),j.write_shift(2,L),j.write_shift(2,b),j.write_shift(1,39);for(var Z=0;Z<j.length;++Z){var be=P.charCodeAt(Z);j.write_shift(1,be>=128?95:be)}return j.write_shift(1,0),j}function T(b,L,P){var j=g(b,L,P);return j[1].v=b.read_shift(2,"i"),j}function x(b,L,P){var j=ge(7);return j.write_shift(1,255),j.write_shift(2,L),j.write_shift(2,b),j.write_shift(2,P,"i"),j}function C(b,L,P){var j=g(b,L,P);return j[1].v=b.read_shift(8,"f"),j}function _(b,L,P){var j=ge(13);return j.write_shift(1,255),j.write_shift(2,L),j.write_shift(2,b),j.write_shift(8,P,"f"),j}function A(b,L,P){var j=b.l+L,Z=g(b,L,P);if(Z[1].v=b.read_shift(8,"f"),P.qpro)b.l=j;else{var be=b.read_shift(2);z(b.slice(b.l,b.l+be),Z),b.l+=be}return Z}function B(b,L,P){var j=L&32768;return L&=-32769,L=(j?b:0)+(L>=8192?L-16384:L),(j?"":"$")+(P?Fn(L):In(L))}var I={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},k=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function z(b,L){vr(b,0);for(var P=[],j=0,Z="",be="",Ce="",Pe="";b.l<b.length;){var De=b[b.l++];switch(De){case 0:P.push(b.read_shift(8,"f"));break;case 1:be=B(L[0].c,b.read_shift(2),!0),Z=B(L[0].r,b.read_shift(2),!1),P.push(be+Z);break;case 2:{var ot=B(L[0].c,b.read_shift(2),!0),et=B(L[0].r,b.read_shift(2),!1);be=B(L[0].c,b.read_shift(2),!0),Z=B(L[0].r,b.read_shift(2),!1),P.push(ot+et+":"+be+Z)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(b.read_shift(2));break;case 6:{for(var jt="";De=b[b.l++];)jt+=String.fromCharCode(De);P.push('"'+jt.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Pe=P.pop(),Ce=P.pop(),P.push(["AND","OR"][De-20]+"("+Ce+","+Pe+")");break;default:if(De<32&&k[De])Pe=P.pop(),Ce=P.pop(),P.push(Ce+k[De]+Pe);else if(I[De]){if(j=I[De][1],j==69&&(j=b[b.l++]),j>P.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+P.join("|")+"|");return}var lt=P.slice(-j);P.length-=j,P.push(I[De][0]+"("+lt.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}P.length==1?L[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function X(b){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=b.read_shift(2),L[3]=b[b.l++],L[0].c=b[b.l++],L}function W(b,L){var P=X(b);return P[1].t="s",P[1].v=b.read_shift(L-4,"cstr"),P}function N(b,L,P,j){var Z=ge(6+j.length);Z.write_shift(2,b),Z.write_shift(1,P),Z.write_shift(1,L),Z.write_shift(1,39);for(var be=0;be<j.length;++be){var Ce=j.charCodeAt(be);Z.write_shift(1,Ce>=128?95:Ce)}return Z.write_shift(1,0),Z}function G(b,L){var P=X(b);P[1].v=b.read_shift(2);var j=P[1].v>>1;if(P[1].v&1)switch(j&7){case 0:j=(j>>3)*5e3;break;case 1:j=(j>>3)*500;break;case 2:j=(j>>3)/20;break;case 3:j=(j>>3)/200;break;case 4:j=(j>>3)/2e3;break;case 5:j=(j>>3)/2e4;break;case 6:j=(j>>3)/16;break;case 7:j=(j>>3)/64;break}return P[1].v=j,P}function V(b,L){var P=X(b),j=b.read_shift(4),Z=b.read_shift(4),be=b.read_shift(2);if(be==65535)return j===0&&Z===3221225472?(P[1].t="e",P[1].v=15):j===0&&Z===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Ce=be&32768;return be=(be&32767)-16446,P[1].v=(1-Ce*2)*(Z*Math.pow(2,be+32)+j*Math.pow(2,be)),P}function ie(b,L,P,j){var Z=ge(14);if(Z.write_shift(2,b),Z.write_shift(1,P),Z.write_shift(1,L),j==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var be=0,Ce=0,Pe=0,De=0;return j<0&&(be=1,j=-j),Ce=Math.log2(j)|0,j/=Math.pow(2,Ce-31),De=j>>>0,(De&2147483648)==0&&(j/=2,++Ce,De=j>>>0),j-=De,De|=2147483648,De>>>=0,j*=Math.pow(2,32),Pe=j>>>0,Z.write_shift(4,Pe),Z.write_shift(4,De),Ce+=16383+(be?32768:0),Z.write_shift(2,Ce),Z}function J(b,L){var P=V(b);return b.l+=L-14,P}function he(b,L){var P=X(b),j=b.read_shift(4);return P[1].v=j>>6,P}function Ae(b,L){var P=X(b),j=b.read_shift(8,"f");return P[1].v=j,P}function je(b,L){var P=Ae(b);return b.l+=L-10,P}function ke(b,L){return b[b.l+L-1]==0?b.read_shift(L,"cstr"):""}function re(b,L){var P=b[b.l++];P>L-1&&(P=L-1);for(var j="";j.length<P;)j+=String.fromCharCode(b[b.l++]);return j}function _e(b,L,P){if(!(!P.qpro||L<21)){var j=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var Z=b.read_shift(L-21,"cstr");return[j,Z]}}function fe(b,L){for(var P={},j=b.l+L;b.l<j;){var Z=b.read_shift(2);if(Z==14e3){for(P[Z]=[0,""],P[Z][0]=b.read_shift(2);b[b.l];)P[Z][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return P}function Te(b,L){var P=ge(5+b.length);P.write_shift(2,14e3),P.write_shift(2,L);for(var j=0;j<b.length;++j){var Z=b.charCodeAt(j);P[P.l++]=Z>127?95:Z}return P[P.l++]=0,P}var U={0:{n:"BOF",f:pC},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:T},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:W},23:{n:"NUMBER17",f:V},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:he},38:{n:"??"},39:{n:"NUMBER27",f:Ae},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:_e},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:e}})(),d3=/^\s|\s$|[\t\n\r]/;function SC(n,e){if(!e.bookSST)return"";var t=[en];t[t.length]=Ne("sst",null,{xmlns:_o[0],count:n.Count,uniqueCount:n.Unique});for(var a=0;a!=n.length;++a)if(n[a]!=null){var s=n[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(d3)&&(l+=' xml:space="preserve"'),l+=">"+xt(s.t)+"</t>"),l+="</si>",t[t.length]=l}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function g3(n){return[n.read_shift(4),n.read_shift(4)]}function m3(n,e){return e||(e=ge(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var p3=sM;function v3(n){var e=nr();Se(e,159,m3(n));for(var t=0;t<n.length;++t)Se(e,19,p3(n[t]));return Se(e,160),e.end()}function y3(n){for(var e=[],t=n.split(""),a=0;a<t.length;++a)e[a]=t[a].charCodeAt(0);return e}function CC(n){var e=0,t,a=y3(n),s=a.length+1,l,c,h,d,g;for(t=is(s),t[0]=a.length,l=1;l!=s;++l)t[l]=a[l-1];for(l=s-1;l>=0;--l)c=t[l],h=(e&16384)===0?0:1,d=e<<1&32767,g=h|d,e=g^c;return e^52811}var T3=(function(){function n(s,l){switch(l.type){case"base64":return e(Ha(s),l);case"binary":return e(s,l);case"buffer":return e(gt&&Buffer.isBuffer(s)?s.toString("binary"):rc(s),l);case"array":return e(Jh(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){var c=l||{},h=c.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,v){Array.isArray(h)&&(h[v]=[]);for(var T=/\\\w+\b/g,x=0,C,_=-1;C=T.exec(p);){switch(C[0]){case"\\cell":var A=p.slice(x,T.lastIndex-C[0].length);if(A[0]==" "&&(A=A.slice(1)),++_,A.length){var B={v:A,t:"s"};Array.isArray(h)?h[v][_]=B:h[_t({r:v,c:_})]=B}break}x=T.lastIndex}_>g.e.c&&(g.e.c=_)}),h["!ref"]=Zt(g),h}function t(s,l){return cs(n(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Lt(s["!ref"]),h,d=Array.isArray(s),g=c.s.r;g<=c.e.r;++g){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var v=_t({r:g,c:p});h=d?(s[g]||[])[p]:s[v],!(!h||h.v==null&&(!h.f||h.F))&&(l.push(" "+(h.w||(ja(h),h.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:a}})();function VT(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var x3=6,Ua=x3;function Eh(n){return Math.floor((n+Math.round(128/Ua)/256)*Ua)}function Ah(n){return Math.floor((n-5)/Ua*100+.5)/100}function Q0(n){return Math.round((n*Ua+5)/Ua*256)/256}function Em(n){n.width?(n.wpx=Eh(n.width),n.wch=Ah(n.wpx),n.MDW=Ua):n.wpx?(n.wch=Ah(n.wpx),n.width=Q0(n.wch),n.MDW=Ua):typeof n.wch=="number"&&(n.width=Q0(n.wch),n.wpx=Eh(n.width),n.MDW=Ua),n.customWidth&&delete n.customWidth}var _3=96,EC=_3;function wh(n){return n*96/EC}function AC(n){return n*EC/96}function S3(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)n[a]!=null&&(e[e.length]=Ne("numFmt",null,{numFmtId:a,formatCode:xt(n[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ne("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function C3(n){var e=[];return e[e.length]=Ne("cellXfs",null),n.forEach(function(t){e[e.length]=Ne("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ne("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function wC(n,e){var t=[en,Ne("styleSheet",null,{xmlns:_o[0],"xmlns:vt":gn.vt})],a;return n.SSF&&(a=S3(n.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=C3(e.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function E3(n,e){var t=n.read_shift(2),a=Ln(n);return[t,a]}function A3(n,e,t){t||(t=ge(6+4*e.length)),t.write_shift(2,n),pn(e,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function w3(n,e,t){var a={};a.sz=n.read_shift(2)/20;var s=dM(n);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=n.read_shift(2);switch(l===700&&(a.bold=1),n.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=n.read_shift(1);c!=0&&(a.underline=c);var h=n.read_shift(1);h>0&&(a.family=h);var d=n.read_shift(1);switch(d>0&&(a.charset=d),n.l++,a.color=fM(n),n.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Ln(n),a}function b3(n,e){e||(e=ge(153)),e.write_shift(2,n.sz*20),gM(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Sh(n.color,e);var a=0;return a=2,e.write_shift(1,a),pn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var I3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],w0,R3=va;function qT(n,e){e||(e=ge(84)),w0||(w0=fm(I3));var t=w0[n.patternType];t==null&&(t=40),e.write_shift(4,t);var a=0;if(t!=40)for(Sh({auto:1},e),Sh({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function N3(n,e){var t=n.l+e,a=n.read_shift(2),s=n.read_shift(2);return n.l=t,{ixfe:a,numFmtId:s}}function bC(n,e,t){t||(t=ge(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function wl(n,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var k3=va;function O3(n,e){return e||(e=ge(51)),e.write_shift(1,0),wl(null,e),wl(null,e),wl(null,e),wl(null,e),wl(null,e),e.length>e.l?e.slice(0,e.l):e}function M3(n,e){return e||(e=ge(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),_h(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function D3(n,e,t){var a=ge(2052);return a.write_shift(4,n),_h(e,a),_h(t,a),a.length>a.l?a.slice(0,a.l):a}function P3(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&++t}),t!=0&&(Se(n,615,Qr(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&Se(n,44,A3(s,e[s]))}),Se(n,616))}}function F3(n){var e=1;Se(n,611,Qr(e)),Se(n,43,b3({sz:12,color:{theme:1},name:"Calibri",family:2})),Se(n,612)}function L3(n){var e=2;Se(n,603,Qr(e)),Se(n,45,qT({patternType:"none"})),Se(n,45,qT({patternType:"gray125"})),Se(n,604)}function U3(n){var e=1;Se(n,613,Qr(e)),Se(n,46,O3()),Se(n,614)}function B3(n){var e=1;Se(n,626,Qr(e)),Se(n,47,bC({numFmtId:0},65535)),Se(n,627)}function H3(n,e){Se(n,617,Qr(e.length)),e.forEach(function(t){Se(n,47,bC(t,0))}),Se(n,618)}function j3(n){var e=1;Se(n,619,Qr(e)),Se(n,48,M3({xfId:0,name:"Normal"})),Se(n,620)}function z3(n){var e=0;Se(n,505,Qr(e)),Se(n,506)}function G3(n){var e=0;Se(n,508,D3(e,"TableStyleMedium9","PivotStyleMedium4")),Se(n,509)}function $3(n,e){var t=nr();return Se(t,278),P3(t,n.SSF),F3(t),L3(t),U3(t),B3(t),H3(t,e.cellXfs),j3(t),z3(t),G3(t),Se(t,279),t.end()}function IC(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[en];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function K3(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Ln(n)}}function V3(n){var e=ge(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),pn(n.name,e),e.slice(0,e.l)}function q3(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function Y3(n){var e=ge(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function X3(n,e){var t=ge(8+2*e.length);return t.write_shift(4,n),pn(e,t),t.slice(0,t.l)}function W3(n){return n.l+=4,n.read_shift(4)!=0}function Q3(n,e){var t=ge(8);return t.write_shift(4,n),t.write_shift(4,1),t}function J3(){var n=nr();return Se(n,332),Se(n,334,Qr(1)),Se(n,335,V3({name:"XLDAPR",version:12e4,flags:3496657072})),Se(n,336),Se(n,339,X3(1,"XLDAPR")),Se(n,52),Se(n,35,Qr(514)),Se(n,4096,Qr(0)),Se(n,4097,Pr(1)),Se(n,36),Se(n,53),Se(n,340),Se(n,337,Q3(1)),Se(n,51,Y3([[1,0]])),Se(n,338),Se(n,333),n.end()}function RC(){var n=[en];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function Z3(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=_t(t);var a=n.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}var no=1024;function NC(n,e){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Ne("xml",null,{"xmlns:v":yr.v,"xmlns:o":yr.o,"xmlns:x":yr.x,"xmlns:mv":yr.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];no<n*1e3;)no+=1e3;return e.forEach(function(l){var c=mn(l[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var d=h.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,g=Ne("v:fill",d,h),p={on:"t",obscured:"t"};++no,s=s.concat(["<v:shape"+Zl({id:"_x0000_s"+no,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",g,Ne("v:shadow",null,p),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",bn("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),bn("x:AutoFill","False"),bn("x:Row",String(c.r)),bn("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function kC(n){var e=[en,Ne("comments",null,{xmlns:_o[0]})],t=[];return e.push("<authors>"),n.forEach(function(a){a[1].forEach(function(s){var l=xt(s.a);t.indexOf(l)==-1&&(t.push(l),e.push("<author>"+l+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(s=t.indexOf(xt(d.a))),l.push(d.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)e.push(bn("t",xt(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,h=1;h<l.length;++h)c+=`Reply:
    `+l[h]+`
`;e.push(bn("t",xt(c)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function eD(n,e,t){var a=[en,Ne("ThreadedComments",null,{xmlns:gn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,h){if(!c.T){delete c.ID;return}c.a&&e.indexOf(c.a)==-1&&e.push(c.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};h==0?l=d.id:d.parentId=l,c.ID=d.id,c.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(c.a)).slice(-12)+"}"),a.push(Ne("threadedComment",bn("text",c.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function tD(n){var e=[en,Ne("personList",null,{xmlns:gn.TCMNT,"xmlns:x":_o[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,a){e.push(Ne("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function nD(n){var e={};e.iauthor=n.read_shift(4);var t=ds(n);return e.rfx=t.s,e.ref=_t(t.s),n.l+=16,e}function rD(n,e){return e==null&&(e=ge(36)),e.write_shift(4,n[1].iauthor),Co(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var aD=Ln;function iD(n){return pn(n.slice(0,54))}function sD(n){var e=nr(),t=[];return Se(e,628),Se(e,630),n.forEach(function(a){a[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Se(e,632,iD(s.a)))})}),Se(e,631),Se(e,633),n.forEach(function(a){a[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var l={s:mn(a[0]),e:mn(a[0])};Se(e,635,rD([l,s])),s.t&&s.t.length>0&&Se(e,637,lM(s)),Se(e,636),delete s.iauthor})}),Se(e,634),Se(e,629),e.end()}function oD(n,e){e.FullPaths.forEach(function(t,a){if(a!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&It.utils.cfb_add(n,s,e.FileIndex[a].content)}})}var OC=["xlsb","xlsm","xlam","biff8","xla"],lD=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(a,s,l,c){var h=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),c.length==0?h=!0:c.charAt(0)=="["&&(h=!0,c=c.slice(1,-1));var g=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return h?p+=e.c:--p,d?g+=e.r:--g,s+(h?"":"$")+Fn(p)+(d?"":"$")+In(g)}return function(s,l){return e=l,s.replace(n,t)}})(),Am=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,wm=(function(){return function(e,t){return e.replace(Am,function(a,s,l,c,h,d){var g=Tm(c)-(l?0:t.c),p=ym(d)-(h?0:t.r),v=p==0?"":h?p+1:"["+p+"]",T=g==0?"":l?g+1:"["+g+"]";return s+"R"+v+"C"+T})}})();function cD(n,e){return n.replace(Am,function(t,a,s,l,c,h){return a+(s=="$"?s+l:Fn(Tm(l)+e.c))+(c=="$"?c+h:In(ym(h)+e.r))})}function uD(n){return n.length!=1}function Qt(n){n.l+=1}function wi(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function MC(n,e,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return DC(n);t.biff==12&&(a=4)}var s=n.read_shift(a),l=n.read_shift(a),c=wi(n),h=wi(n);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:h[0],cRel:h[1],rRel:h[2]}}}function DC(n){var e=wi(n),t=wi(n),a=n.read_shift(1),s=n.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function hD(n,e,t){if(t.biff<8)return DC(n);var a=n.read_shift(t.biff==12?4:2),s=n.read_shift(t.biff==12?4:2),l=wi(n),c=wi(n);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function PC(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return fD(n);var a=n.read_shift(t&&t.biff==12?4:2),s=wi(n);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function fD(n){var e=wi(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function dD(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function gD(n,e,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return mD(n);var s=n.read_shift(a>=12?4:2),l=n.read_shift(2),c=(l&16384)>>14,h=(l&32768)>>15;if(l&=16383,h==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:h}}function mD(n){var e=n.read_shift(2),t=n.read_shift(1),a=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:a}}function pD(n,e,t){var a=(n[n.l++]&96)>>5,s=MC(n,t.biff>=2&&t.biff<=5?6:8,t);return[a,s]}function vD(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}var c=MC(n,l,t);return[a,s,c]}function yD(n,e,t){var a=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function TD(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2),l=8;if(t)switch(t.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}return n.l+=l,[a,s]}function xD(n,e,t){var a=(n[n.l++]&96)>>5,s=hD(n,e-1,t);return[a,s]}function _D(n,e,t){var a=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[a]}function YT(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function SD(n,e,t){n.l+=2;for(var a=n.read_shift(t&&t.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(n.read_shift(t&&t.biff==2?1:2));return s}function CD(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=2,[a,n.read_shift(t&&t.biff==2?1:2)]}function ED(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=2,[a,n.read_shift(t&&t.biff==2?1:2)]}function AD(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function wD(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[a]}function FC(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function bD(n){return n.read_shift(2),FC(n)}function ID(n){return n.read_shift(2),FC(n)}function RD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=PC(n,0,t);return[a,s]}function ND(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=gD(n,0,t);return[a,s]}function kD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var l=PC(n,0,t);return[a,s,l]}function OD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(t&&t.biff<=3?1:2);return[OP[s],BC[s],a]}function MD(n,e,t){var a=n[n.l++],s=n.read_shift(1),l=t&&t.biff<=3?[a==88?-1:0,n.read_shift(1)]:DD(n);return[s,(l[0]===0?BC:kP)[l[1]]]}function DD(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function PD(n,e,t){n.l+=t&&t.biff==2?3:4}function FD(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var a=n.read_shift(2),s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function LD(n){return n.l++,sc[n.read_shift(1)]}function UD(n){return n.l++,n.read_shift(2)}function BD(n){return n.l++,n.read_shift(1)!==0}function HD(n){return n.l++,Eo(n)}function jD(n,e,t){return n.l++,yC(n,e-1,t)}function zD(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=kM(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=sc[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=Eo(n);break;case 2:t[1]=PM(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function GD(n,e,t){for(var a=n.read_shift(t.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((t.biff==12?ds:UM)(n));return s}function $D(n,e,t){var a=0,s=0;t.biff==12?(a=n.read_shift(4),s=n.read_shift(4)):(s=1+n.read_shift(1),a=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var h=0;h!=s;++h)c[l][h]=zD(n,t.biff);return c}function KD(n,e,t){var a=n.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,l=n.read_shift(s);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[a,0,l]}function VD(n,e,t){if(t.biff==5)return qD(n);var a=n.read_shift(1)>>>5&3,s=n.read_shift(2),l=n.read_shift(4);return[a,s,l]}function qD(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var a=n.read_shift(2);return n.l+=12,[e,t,a]}function YD(n,e,t){var a=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function XD(n,e,t){var a=n.read_shift(1)>>>5&3,s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function WD(n,e,t){var a=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[a]}function QD(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return n.l+=l,[a,s]}var JD=va,ZD=va,eP=va;function oc(n,e,t){return n.l+=2,[dD(n)]}function bm(n){return n.l+=6,[]}var tP=oc,nP=bm,rP=bm,aP=oc;function LC(n){return n.l+=2,[pC(n),n.read_shift(2)&1]}var iP=oc,sP=LC,oP=bm,lP=oc,cP=oc,uP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function hP(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),a=n.read_shift(4),s=n.read_shift(2),l=n.read_shift(2),c=uP[t>>2&31];return{ixti:e,coltype:t&3,rt:c,idx:a,c:s,C:l}}function fP(n){return n.l+=2,[n.read_shift(4)]}function dP(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function gP(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function mP(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function pP(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function vP(n){return n.l+=4,[0,0]}var XT={1:{n:"PtgExp",f:FD},2:{n:"PtgTbl",f:eP},3:{n:"PtgAdd",f:Qt},4:{n:"PtgSub",f:Qt},5:{n:"PtgMul",f:Qt},6:{n:"PtgDiv",f:Qt},7:{n:"PtgPower",f:Qt},8:{n:"PtgConcat",f:Qt},9:{n:"PtgLt",f:Qt},10:{n:"PtgLe",f:Qt},11:{n:"PtgEq",f:Qt},12:{n:"PtgGe",f:Qt},13:{n:"PtgGt",f:Qt},14:{n:"PtgNe",f:Qt},15:{n:"PtgIsect",f:Qt},16:{n:"PtgUnion",f:Qt},17:{n:"PtgRange",f:Qt},18:{n:"PtgUplus",f:Qt},19:{n:"PtgUminus",f:Qt},20:{n:"PtgPercent",f:Qt},21:{n:"PtgParen",f:Qt},22:{n:"PtgMissArg",f:Qt},23:{n:"PtgStr",f:jD},26:{n:"PtgSheet",f:dP},27:{n:"PtgEndSheet",f:gP},28:{n:"PtgErr",f:LD},29:{n:"PtgBool",f:BD},30:{n:"PtgInt",f:UD},31:{n:"PtgNum",f:HD},32:{n:"PtgArray",f:_D},33:{n:"PtgFunc",f:OD},34:{n:"PtgFuncVar",f:MD},35:{n:"PtgName",f:KD},36:{n:"PtgRef",f:RD},37:{n:"PtgArea",f:pD},38:{n:"PtgMemArea",f:YD},39:{n:"PtgMemErr",f:JD},40:{n:"PtgMemNoMem",f:ZD},41:{n:"PtgMemFunc",f:XD},42:{n:"PtgRefErr",f:WD},43:{n:"PtgAreaErr",f:yD},44:{n:"PtgRefN",f:ND},45:{n:"PtgAreaN",f:xD},46:{n:"PtgMemAreaN",f:mP},47:{n:"PtgMemNoMemN",f:pP},57:{n:"PtgNameX",f:VD},58:{n:"PtgRef3d",f:kD},59:{n:"PtgArea3d",f:vD},60:{n:"PtgRefErr3d",f:QD},61:{n:"PtgAreaErr3d",f:TD},255:{}},yP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},TP={1:{n:"PtgElfLel",f:LC},2:{n:"PtgElfRw",f:lP},3:{n:"PtgElfCol",f:tP},6:{n:"PtgElfRwV",f:cP},7:{n:"PtgElfColV",f:aP},10:{n:"PtgElfRadical",f:iP},11:{n:"PtgElfRadicalS",f:oP},13:{n:"PtgElfColS",f:nP},15:{n:"PtgElfColSV",f:rP},16:{n:"PtgElfRadicalLel",f:sP},25:{n:"PtgList",f:hP},29:{n:"PtgSxName",f:fP},255:{}},xP={0:{n:"PtgAttrNoop",f:vP},1:{n:"PtgAttrSemi",f:wD},2:{n:"PtgAttrIf",f:ED},4:{n:"PtgAttrChoose",f:SD},8:{n:"PtgAttrGoto",f:CD},16:{n:"PtgAttrSum",f:PD},32:{n:"PtgAttrBaxcel",f:YT},33:{n:"PtgAttrBaxcel",f:YT},64:{n:"PtgAttrSpace",f:bD},65:{n:"PtgAttrSpaceSemi",f:ID},128:{n:"PtgAttrIfError",f:AD},255:{}};function _P(n,e,t,a){if(a.biff<8)return va(n,e);for(var s=n.l+e,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=$D(n,0,a),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=GD(n,t[c][1],a),l.push(t[c][2]);break;case"PtgExp":a&&a.biff==12&&(t[c][1][1]=n.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return e=s-n.l,e!==0&&l.push(va(n,e)),l}function SP(n,e,t){for(var a=n.l+e,s,l,c=[];a!=n.l;)e=a-n.l,l=n[n.l],s=XT[l]||XT[yP[l]],(l===24||l===25)&&(s=(l===24?TP:xP)[n[n.l+1]]),!s||!s.f?va(n,e):c.push([s.n,s.f(n,e,t)]);return c}function CP(n){for(var e=[],t=0;t<n.length;++t){for(var a=n[t],s=[],l=0;l<a.length;++l){var c=a[l];if(c)switch(c[0]){case 2:s.push('"'+c[1].replace(/"/g,'""')+'"');break;default:s.push(c[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var EP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function AP(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function UC(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var a=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!a)return"SH33TJSERR1";var s="";if(t.biff>8)switch(n[a[0]][0]){case 357:return s=a[1]==-1?"#REF":n.SheetNames[a[1]],a[1]==a[2]?s:s+":"+n.SheetNames[a[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[a[0]][0];case 355:default:return"SH33TJSSRC"+n[a[0]][0]}switch(n[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":n.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+n.SheetNames[a[2]];case 14849:return n[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return n[a[0]][0][3]?(s=a[1]==-1?"#REF":n[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+n[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function WT(n,e,t){var a=UC(n,e,t);return a=="#REF"?a:AP(a,t)}function go(n,e,t,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},h=[],d,g,p,v=0,T=0,x,C="";if(!n[0]||!n[0][0])return"";for(var _=-1,A="",B=0,I=n[0].length;B<I;++B){var k=n[0][B];switch(k[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=h.pop(),g=h.pop(),_>=0){switch(n[0][_][1][0]){case 0:A=Kt(" ",n[0][_][1][1]);break;case 1:A=Kt("\r",n[0][_][1][1]);break;default:if(A="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}g=g+A,_=-1}h.push(g+EP[k[0]]+d);break;case"PtgIsect":d=h.pop(),g=h.pop(),h.push(g+" "+d);break;case"PtgUnion":d=h.pop(),g=h.pop(),h.push(g+","+d);break;case"PtgRange":d=h.pop(),g=h.pop(),h.push(g+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=Hl(k[1][1],c,s),h.push(jl(p,l));break;case"PtgRefN":p=t?Hl(k[1][1],t,s):k[1][1],h.push(jl(p,l));break;case"PtgRef3d":v=k[1][1],p=Hl(k[1][2],c,s),C=WT(a,v,s),h.push(C+"!"+jl(p,l));break;case"PtgFunc":case"PtgFuncVar":var z=k[1][0],X=k[1][1];z||(z=0),z&=127;var W=z==0?[]:h.slice(-z);h.length-=z,X==="User"&&(X=W.shift()),h.push(X+"("+W.join(",")+")");break;case"PtgBool":h.push(k[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(k[1]);break;case"PtgNum":h.push(String(k[1]));break;case"PtgStr":h.push('"'+k[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(k[1]);break;case"PtgAreaN":x=DT(k[1][1],t?{s:t}:c,s),h.push(E0(x,s));break;case"PtgArea":x=DT(k[1][1],c,s),h.push(E0(x,s));break;case"PtgArea3d":v=k[1][1],x=k[1][2],C=WT(a,v,s),h.push(C+"!"+E0(x,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":T=k[1][2];var N=(a.names||[])[T-1]||(a[0]||[])[T],G=N?N.Name:"SH33TJSNAME"+String(T);G&&G.slice(0,6)=="_xlfn."&&!s.xlfn&&(G=G.slice(6)),h.push(G);break;case"PtgNameX":var V=k[1][1];T=k[1][2];var ie;if(s.biff<=5)V<0&&(V=-V),a[V]&&(ie=a[V][T]);else{var J="";if(((a[V]||[])[0]||[])[0]==14849||(((a[V]||[])[0]||[])[0]==1025?a[V][T]&&a[V][T].itab>0&&(J=a.SheetNames[a[V][T].itab-1]+"!"):J=a.SheetNames[T-1]+"!"),a[V]&&a[V][T])J+=a[V][T].Name;else if(a[0]&&a[0][T])J+=a[0][T].Name;else{var he=(UC(a,V,s)||"").split(";;");he[T-1]?J=he[T-1]:J+="SH33TJSERRX"}h.push(J);break}ie||(ie={Name:"SH33TJSERRY"}),h.push(ie.Name);break;case"PtgParen":var Ae="(",je=")";if(_>=0){switch(A="",n[0][_][1][0]){case 2:Ae=Kt(" ",n[0][_][1][1])+Ae;break;case 3:Ae=Kt("\r",n[0][_][1][1])+Ae;break;case 4:je=Kt(" ",n[0][_][1][1])+je;break;case 5:je=Kt("\r",n[0][_][1][1])+je;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][_][1][0])}_=-1}h.push(Ae+h.pop()+je);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:k[1][1],r:k[1][0]};var ke={c:t.c,r:t.r};if(a.sharedf[_t(p)]){var re=a.sharedf[_t(p)];h.push(go(re,c,ke,a,s))}else{var _e=!1;for(d=0;d!=a.arrayf.length;++d)if(g=a.arrayf[d],!(p.c<g[0].s.c||p.c>g[0].e.c)&&!(p.r<g[0].s.r||p.r>g[0].e.r)){h.push(go(g[1],c,ke,a,s)),_e=!0;break}_e||h.push(k[1])}break;case"PtgArray":h.push("{"+CP(k[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":_=B;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+k[1].idx+"[#"+k[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(k));default:throw new Error("Unrecognized Formula Token: "+String(k))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&_>=0&&fe.indexOf(n[0][B][0])==-1){k=n[0][_];var Te=!0;switch(k[1][0]){case 4:Te=!1;case 0:A=Kt(" ",k[1][1]);break;case 5:Te=!1;case 1:A=Kt("\r",k[1][1]);break;default:if(A="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+k[1][0])}h.push((Te?A:"")+h.pop()+(Te?"":A)),_=-1}}if(h.length>1&&s.WTF)throw new Error("bad formula stack");return h[0]}function wP(n){if(n==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return ss(n);return ss(0)}function bP(n,e,t,a,s){var l=os(e,t,s),c=wP(n.v),h=ge(6),d=33;h.write_shift(2,d),h.write_shift(4,0);for(var g=ge(n.bf.length),p=0;p<n.bf.length;++p)g[p]=n.bf[p];var v=wn([l,c,h,g]);return v}function Zh(n,e,t){var a=n.read_shift(4),s=SP(n,a,t),l=n.read_shift(4),c=l>0?_P(n,l,s,t):null;return[s,c]}var IP=Zh,ef=Zh,RP=Zh,NP=Zh,kP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},BC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},OP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function MP(n){var e="of:="+n.replace(Am,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function DP(n){return n.replace(/\./,"!")}var zl=typeof Map<"u";function Im(n,e,t){var a=0,s=n.length;if(t){if(zl?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var l=zl?t.get(e):t[e];a<l.length;++a)if(n[l[a]].t===e)return n.Count++,l[a]}}else for(;a<s;++a)if(n[a].t===e)return n.Count++,a;return n[s]={t:e},n.Count++,n.Unique++,t&&(zl?(t.has(e)||t.set(e,[]),t.get(e).push(s)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(s))),s}function tf(n,e){var t={min:n+1,max:n+1},a=-1;return e.MDW&&(Ua=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?a=Ah(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(t.width=Q0(a),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function HC(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ii(n,e,t){var a=t.revssf[e.z!=null?e.z:"General"],s=60,l=n.length;if(a==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){PS(e.z,s),t.ssf[s]=e.z,t.revssf[e.z]=a=s;break}}for(s=0;s!=l;++s)if(n[s].numFmtId===a)return s;return n[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function PP(n,e,t){if(n&&n["!ref"]){var a=Lt(n["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function FP(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+Zt(n[t])+'"/>';return e+"</mergeCells>"}function LP(n,e,t,a,s){var l=!1,c={},h=null;if(a.bookType!=="xlsx"&&e.vbaraw){var d=e.SheetNames[t];try{e.Workbook&&(d=e.Workbook.Sheets[t].CodeName||d)}catch{}l=!0,c.codeName=Jl(xt(d))}if(n&&n["!outline"]){var g={summaryBelow:1,summaryRight:1};n["!outline"].above&&(g.summaryBelow=0),n["!outline"].left&&(g.summaryRight=0),h=(h||"")+Ne("outlinePr",null,g)}!l&&!h||(s[s.length]=Ne("sheetPr",h,c))}var UP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],BP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function HP(n){var e={sheet:1};return UP.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),BP.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=CC(n.password).toString(16).toUpperCase()),Ne("sheetProtection",null,e)}function jP(n){return HC(n),Ne("pageMargins",null,n)}function zP(n,e){for(var t=["<cols>"],a,s=0;s!=e.length;++s)(a=e[s])&&(t[t.length]=Ne("col",null,tf(s,a)));return t[t.length]="</cols>",t.join("")}function GP(n,e,t,a){var s=typeof n.ref=="string"?n.ref:Zt(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=Sr(s);c.s.r==c.e.r&&(c.e.r=Sr(e["!ref"]).e.r,s=Zt(c));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+t.SheetNames[a]+"'!"+s;break}}return h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+s}),Ne("autoFilter",null,{ref:s})}function $P(n,e,t,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,s),{})}function KP(n,e,t,a){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var s="",l=n.t,c=n.v;if(n.t!=="z")switch(n.t){case"b":s=n.v?"1":"0";break;case"n":s=""+n.v;break;case"e":s=sc[n.v];break;case"d":a&&a.cellDates?s=Xn(n.v,-1).toISOString():(n=ir(n),n.t="n",s=""+(n.v=ar(Xn(n.v)))),typeof n.z>"u"&&(n.z=Vt[14]);break;default:s=n.v;break}var h=bn("v",xt(s)),d={r:e},g=Ii(a.cellXfs,n,a);switch(g!==0&&(d.s=g),n.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){h=bn("v",""+Im(a.Strings,n.v,a.revStrings)),d.t="s";break}d.t="str";break}if(n.t!=l&&(n.t=l,n.v=c),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;h=Ne("f",xt(n.f),p)+(n.v!=null?h:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(d.cm=1),Ne("c",h,d)}function VP(n,e,t,a){var s=[],l=[],c=Lt(n["!ref"]),h="",d,g="",p=[],v=0,T=0,x=n["!rows"],C=Array.isArray(n),_={r:g},A,B=-1;for(T=c.s.c;T<=c.e.c;++T)p[T]=Fn(T);for(v=c.s.r;v<=c.e.r;++v){for(l=[],g=In(v),T=c.s.c;T<=c.e.c;++T){d=p[T]+g;var I=C?(n[v]||[])[T]:n[d];I!==void 0&&(h=KP(I,d,n,e))!=null&&l.push(h)}(l.length>0||x&&x[v])&&(_={r:g},x&&x[v]&&(A=x[v],A.hidden&&(_.hidden=1),B=-1,A.hpx?B=wh(A.hpx):A.hpt&&(B=A.hpt),B>-1&&(_.ht=B,_.customHeight=1),A.level&&(_.outlineLevel=A.level)),s[s.length]=Ne("row",l.join(""),_))}if(x)for(;v<x.length;++v)x&&x[v]&&(_={r:v+1},A=x[v],A.hidden&&(_.hidden=1),B=-1,A.hpx?B=wh(A.hpx):A.hpt&&(B=A.hpt),B>-1&&(_.ht=B,_.customHeight=1),A.level&&(_.outlineLevel=A.level),s[s.length]=Ne("row","",_));return s.join("")}function jC(n,e,t,a){var s=[en,Ne("worksheet",null,{xmlns:_o[0],"xmlns:r":gn.r})],l=t.SheetNames[n],c=0,h="",d=t.Sheets[l];d==null&&(d={});var g=d["!ref"]||"A1",p=Lt(g);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+g+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),g=Zt(p)}a||(a={}),d["!comments"]=[];var v=[];LP(d,t,n,e,s),s[s.length]=Ne("dimension",null,{ref:g}),s[s.length]=$P(d,e,n,t),e.sheetFormat&&(s[s.length]=Ne("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=zP(d,d["!cols"])),s[c=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(h=VP(d,e),h.length>0&&(s[s.length]=h)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),d["!protect"]&&(s[s.length]=HP(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=GP(d["!autofilter"],d,t,n)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=FP(d["!merges"]));var T=-1,x,C=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(_){_[1].Target&&(x={ref:_[0]},_[1].Target.charAt(0)!="#"&&(C=yt(a,-1,xt(_[1].Target).replace(/#.*$/,""),ht.HLINK),x["r:id"]="rId"+C),(T=_[1].Target.indexOf("#"))>-1&&(x.location=xt(_[1].Target.slice(T+1))),_[1].Tooltip&&(x.tooltip=xt(_[1].Tooltip)),s[s.length]=Ne("hyperlink",null,x))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=jP(d["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=bn("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:g}))),v.length>0&&(C=yt(a,-1,"../drawings/drawing"+(n+1)+".xml",ht.DRAW),s[s.length]=Ne("drawing",null,{"r:id":"rId"+C}),d["!drawing"]=v),d["!comments"].length>0&&(C=yt(a,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ht.VML),s[s.length]=Ne("legacyDrawing",null,{"r:id":"rId"+C}),d["!legacy"]=C),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function qP(n,e){var t={},a=n.l+e;t.r=n.read_shift(4),n.l+=4;var s=n.read_shift(2);n.l+=1;var l=n.read_shift(1);return n.l=a,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=s/20),t}function YP(n,e,t){var a=ge(145),s=(t["!rows"]||[])[n]||{};a.write_shift(4,n),a.write_shift(4,0);var l=320;s.hpx?l=wh(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var h=0,d=a.l;a.l+=4;for(var g={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,T=-1,x=p<<10;x<p+1<<10;++x){g.c=x;var C=Array.isArray(t)?(t[g.r]||[])[g.c]:t[_t(g)];C&&(v<0&&(v=x),T=x)}v<0||(++h,a.write_shift(4,v),a.write_shift(4,T))}var _=a.l;return a.l=d,a.write_shift(4,h),a.l=_,a.length>a.l?a.slice(0,a.l):a}function XP(n,e,t,a){var s=YP(a,t,e);(s.length>17||(e["!rows"]||[])[a])&&Se(n,0,s)}var WP=ds,QP=Co;function JP(){}function ZP(n,e){var t={},a=n[n.l];return++n.l,t.above=!(a&64),t.left=!(a&128),n.l+=18,t.name=cM(n),t}function e6(n,e,t){t==null&&(t=ge(84+4*n.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),t.write_shift(1,a);for(var s=1;s<3;++s)t.write_shift(1,0);return Sh({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),nC(n,t),t.slice(0,t.l)}function t6(n){var e=Ur(n);return[e]}function n6(n,e,t){return t==null&&(t=ge(8)),us(e,t)}function r6(n){var e=hs(n);return[e]}function a6(n,e,t){return t==null&&(t=ge(4)),fs(e,t)}function i6(n){var e=Ur(n),t=n.read_shift(1);return[e,t,"b"]}function s6(n,e,t){return t==null&&(t=ge(9)),us(e,t),t.write_shift(1,n.v?1:0),t}function o6(n){var e=hs(n),t=n.read_shift(1);return[e,t,"b"]}function l6(n,e,t){return t==null&&(t=ge(5)),fs(e,t),t.write_shift(1,n.v?1:0),t}function c6(n){var e=Ur(n),t=n.read_shift(1);return[e,t,"e"]}function u6(n,e,t){return t==null&&(t=ge(9)),us(e,t),t.write_shift(1,n.v),t}function h6(n){var e=hs(n),t=n.read_shift(1);return[e,t,"e"]}function f6(n,e,t){return t==null&&(t=ge(8)),fs(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function d6(n){var e=Ur(n),t=n.read_shift(4);return[e,t,"s"]}function g6(n,e,t){return t==null&&(t=ge(12)),us(e,t),t.write_shift(4,e.v),t}function m6(n){var e=hs(n),t=n.read_shift(4);return[e,t,"s"]}function p6(n,e,t){return t==null&&(t=ge(8)),fs(e,t),t.write_shift(4,e.v),t}function v6(n){var e=Ur(n),t=Eo(n);return[e,t,"n"]}function y6(n,e,t){return t==null&&(t=ge(16)),us(e,t),ss(n.v,t),t}function T6(n){var e=hs(n),t=Eo(n);return[e,t,"n"]}function x6(n,e,t){return t==null&&(t=ge(12)),fs(e,t),ss(n.v,t),t}function _6(n){var e=Ur(n),t=rC(n);return[e,t,"n"]}function S6(n,e,t){return t==null&&(t=ge(12)),us(e,t),aC(n.v,t),t}function C6(n){var e=hs(n),t=rC(n);return[e,t,"n"]}function E6(n,e,t){return t==null&&(t=ge(8)),fs(e,t),aC(n.v,t),t}function A6(n){var e=Ur(n),t=xm(n);return[e,t,"is"]}function w6(n){var e=Ur(n),t=Ln(n);return[e,t,"str"]}function b6(n,e,t){return t==null&&(t=ge(12+4*n.v.length)),us(e,t),pn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function I6(n){var e=hs(n),t=Ln(n);return[e,t,"str"]}function R6(n,e,t){return t==null&&(t=ge(8+4*n.v.length)),fs(e,t),pn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function N6(n,e,t){var a=n.l+e,s=Ur(n);s.r=t["!row"];var l=n.read_shift(1),c=[s,l,"b"];if(t.cellFormula){n.l+=2;var h=ef(n,a-n.l,t);c[3]=go(h,null,s,t.supbooks,t)}else n.l=a;return c}function k6(n,e,t){var a=n.l+e,s=Ur(n);s.r=t["!row"];var l=n.read_shift(1),c=[s,l,"e"];if(t.cellFormula){n.l+=2;var h=ef(n,a-n.l,t);c[3]=go(h,null,s,t.supbooks,t)}else n.l=a;return c}function O6(n,e,t){var a=n.l+e,s=Ur(n);s.r=t["!row"];var l=Eo(n),c=[s,l,"n"];if(t.cellFormula){n.l+=2;var h=ef(n,a-n.l,t);c[3]=go(h,null,s,t.supbooks,t)}else n.l=a;return c}function M6(n,e,t){var a=n.l+e,s=Ur(n);s.r=t["!row"];var l=Ln(n),c=[s,l,"str"];if(t.cellFormula){n.l+=2;var h=ef(n,a-n.l,t);c[3]=go(h,null,s,t.supbooks,t)}else n.l=a;return c}var D6=ds,P6=Co;function F6(n,e){return e==null&&(e=ge(4)),e.write_shift(4,n),e}function L6(n,e){var t=n.l+e,a=ds(n),s=_m(n),l=Ln(n),c=Ln(n),h=Ln(n);n.l=t;var d={rfx:a,relId:s,loc:l,display:h};return c&&(d.Tooltip=c),d}function U6(n,e){var t=ge(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));Co({s:mn(n[0]),e:mn(n[0])},t),Sm("rId"+e,t);var a=n[1].Target.indexOf("#"),s=a==-1?"":n[1].Target.slice(a+1);return pn(s||"",t),pn(n[1].Tooltip||"",t),pn("",t),t.slice(0,t.l)}function B6(){}function H6(n,e,t){var a=n.l+e,s=iC(n),l=n.read_shift(1),c=[s];if(c[2]=l,t.cellFormula){var h=IP(n,a-n.l,t);c[1]=h}else n.l=a;return c}function j6(n,e,t){var a=n.l+e,s=ds(n),l=[s];if(t.cellFormula){var c=NP(n,a-n.l,t);l[1]=c,n.l=a}else n.l=a;return l}function z6(n,e,t){t==null&&(t=ge(18));var a=tf(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),t.write_shift(2,s),t}var zC=["left","right","top","bottom","header","footer"];function G6(n){var e={};return zC.forEach(function(t){e[t]=Eo(n)}),e}function $6(n,e){return e==null&&(e=ge(48)),HC(n),zC.forEach(function(t){ss(n[t],e)}),e}function K6(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function V6(n,e,t){t==null&&(t=ge(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function q6(n){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),Co(n,e),e}function Y6(n,e){return e==null&&(e=ge(66)),e.write_shift(2,n.password?CC(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function X6(){}function W6(){}function Q6(n,e,t,a,s,l,c){if(e.v===void 0)return!1;var h="";switch(e.t){case"b":h=e.v?"1":"0";break;case"d":e=ir(e),e.z=e.z||Vt[14],e.v=ar(Xn(e.v)),e.t="n";break;case"n":case"e":h=""+e.v;break;default:h=e.v;break}var d={r:t,c:a};switch(d.s=Ii(s.cellXfs,e,s),e.l&&l["!links"].push([_t(d),e.l]),e.c&&l["!comments"].push([_t(d),e.c]),e.t){case"s":case"str":return s.bookSST?(h=Im(s.Strings,e.v,s.revStrings),d.t="s",d.v=h,c?Se(n,18,p6(e,d)):Se(n,7,g6(e,d))):(d.t="str",c?Se(n,17,R6(e,d)):Se(n,6,b6(e,d))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?c?Se(n,13,E6(e,d)):Se(n,2,S6(e,d)):c?Se(n,16,x6(e,d)):Se(n,5,y6(e,d)),!0;case"b":return d.t="b",c?Se(n,15,l6(e,d)):Se(n,4,s6(e,d)),!0;case"e":return d.t="e",c?Se(n,14,f6(e,d)):Se(n,3,u6(e,d)),!0}return c?Se(n,12,a6(e,d)):Se(n,1,n6(e,d)),!0}function J6(n,e,t,a){var s=Lt(e["!ref"]||"A1"),l,c="",h=[];Se(n,145);var d=Array.isArray(e),g=s.e.r;e["!rows"]&&(g=Math.max(s.e.r,e["!rows"].length-1));for(var p=s.s.r;p<=g;++p){c=In(p),XP(n,e,s,p);var v=!1;if(p<=s.e.r)for(var T=s.s.c;T<=s.e.c;++T){p===s.s.r&&(h[T]=Fn(T)),l=h[T]+c;var x=d?(e[p]||[])[T]:e[l];if(!x){v=!1;continue}v=Q6(n,x,p,T,a,e,v)}}Se(n,146)}function Z6(n,e){!e||!e["!merges"]||(Se(n,177,F6(e["!merges"].length)),e["!merges"].forEach(function(t){Se(n,176,P6(t))}),Se(n,178))}function eF(n,e){!e||!e["!cols"]||(Se(n,390),e["!cols"].forEach(function(t,a){t&&Se(n,60,z6(a,t))}),Se(n,391))}function tF(n,e){!e||!e["!ref"]||(Se(n,648),Se(n,649,q6(Lt(e["!ref"]))),Se(n,650))}function nF(n,e,t){e["!links"].forEach(function(a){if(a[1].Target){var s=yt(t,-1,a[1].Target.replace(/#.*$/,""),ht.HLINK);Se(n,494,U6(a,s))}}),delete e["!links"]}function rF(n,e,t,a){if(e["!comments"].length>0){var s=yt(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ht.VML);Se(n,551,Sm("rId"+s)),e["!legacy"]=s}}function aF(n,e,t,a){if(e["!autofilter"]){var s=e["!autofilter"],l=typeof s.ref=="string"?s.ref:Zt(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,h=Sr(l);h.s.r==h.e.r&&(h.e.r=Sr(e["!ref"]).e.r,l=Zt(h));for(var d=0;d<c.length;++d){var g=c[d];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==a){g.Ref="'"+t.SheetNames[a]+"'!"+l;break}}d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+l}),Se(n,161,Co(Lt(l))),Se(n,162)}}function iF(n,e,t){Se(n,133),Se(n,137,V6(e,t)),Se(n,138),Se(n,134)}function sF(n,e){e["!protect"]&&Se(n,535,Y6(e["!protect"]))}function oF(n,e,t,a){var s=nr(),l=t.SheetNames[n],c=t.Sheets[l]||{},h=l;try{t&&t.Workbook&&(h=t.Workbook.Sheets[n].CodeName||h)}catch{}var d=Lt(c["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Se(s,129),(t.vbaraw||c["!outline"])&&Se(s,147,e6(h,c["!outline"])),Se(s,148,QP(d)),iF(s,c,t.Workbook),eF(s,c),J6(s,c,n,e),sF(s,c),aF(s,c,t,n),Z6(s,c),nF(s,c,a),c["!margins"]&&Se(s,476,$6(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&tF(s,c),rF(s,c,n,a),Se(s,130),s.end()}function lF(n,e){n.l+=10;var t=Ln(n);return{name:t}}var cF=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function uF(n){return!n.Workbook||!n.Workbook.WBProps?"false":j4(n.Workbook.WBProps.date1904)?"true":"false"}var hF="][*?/\\".split("");function GC(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return hF.forEach(function(a){if(n.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function fF(n,e,t){n.forEach(function(a,s){GC(a);for(var l=0;l<s;++l)if(a==n[l])throw new Error("Duplicate Sheet Name: "+a);if(t){var c=e&&e[s]&&e[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function dF(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];fF(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)PP(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function $C(n){var e=[en];e[e.length]=Ne("workbook",null,{xmlns:_o[0],"xmlns:r":gn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(cF.forEach(function(h){n.Workbook.WBProps[h[0]]!=null&&n.Workbook.WBProps[h[0]]!=h[1]&&(a[h[0]]=n.Workbook.WBProps[h[0]])}),n.Workbook.WBProps.CodeName&&(a.codeName=n.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Ne("workbookPr",null,a);var s=n.Workbook&&n.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",l=0;l!=n.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==n.SheetNames.length&&(l=0),e[e.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",l=0;l!=n.SheetNames.length;++l){var c={name:xt(n.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}e[e.length]=Ne("sheet",null,c)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(h){var d={name:h.Name};h.Comment&&(d.comment=h.Comment),h.Sheet!=null&&(d.localSheetId=""+h.Sheet),h.Hidden&&(d.hidden="1"),h.Ref&&(e[e.length]=Ne("definedName",xt(h.Ref),d))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function gF(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=W0(n),t.name=Ln(n),t}function mF(n,e){return e||(e=ge(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Sm(n.strRelID,e),pn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function pF(n,e){var t={},a=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var s=e>8?Ln(n):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function vF(n,e){e||(e=ge(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),nC(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function yF(n,e,t){var a=n.l+e;n.l+=4,n.l+=1;var s=n.read_shift(4),l=uM(n),c=RP(n,0,t),h=_m(n);n.l=a;var d={Name:l,Ptg:c};return s<268435455&&(d.Sheet=s),h&&(d.Comment=h),d}function TF(n,e){Se(n,143);for(var t=0;t!=e.SheetNames.length;++t){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,s={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Se(n,156,mF(s))}Se(n,144)}function xF(n,e){e||(e=ge(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return pn("SheetJS",e),pn(gh.version,e),pn(gh.version,e),pn("7262",e),e.length>e.l?e.slice(0,e.l):e}function _F(n,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function SF(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,a=0,s=-1,l=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&s==-1?s=a:t[a].Hidden==1&&l==-1&&(l=a);l>s||(Se(n,135),Se(n,158,_F(s)),Se(n,136))}}function CF(n,e){var t=nr();return Se(t,131),Se(t,128,xF()),Se(t,153,vF(n.Workbook&&n.Workbook.WBProps||null)),SF(t,n),TF(t,n),Se(t,132),t.end()}function EF(n,e,t){return(e.slice(-4)===".bin"?CF:$C)(n)}function AF(n,e,t,a,s){return(e.slice(-4)===".bin"?oF:jC)(n,t,a,s)}function wF(n,e,t){return(e.slice(-4)===".bin"?$3:wC)(n,t)}function bF(n,e,t){return(e.slice(-4)===".bin"?v3:SC)(n,t)}function IF(n,e,t){return(e.slice(-4)===".bin"?sD:kC)(n)}function RF(n){return(n.slice(-4)===".bin"?J3:RC)()}function NF(n,e){var t=[];return n.Props&&t.push(wM(n.Props,e)),n.Custprops&&t.push(bM(n.Props,n.Custprops)),t.join("")}function kF(){return""}function OF(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,s){var l=[];l.push(Ne("NumberFormat",null,{"ss:Format":xt(Vt[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};t.push(Ne("Style",l.join(""),c))}),Ne("Styles",t.join(""))}function KC(n){return Ne("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+wm(n.Ref,{r:0,c:0})})}function MF(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],a=0;a<e.length;++a){var s=e[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(KC(s)))}return Ne("Names",t.join(""))}function DF(n,e,t,a){if(!n||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var h=s[c];h.Sheet==t&&(h.Name.match(/^_xlfn\./)||l.push(KC(h)))}return l.join("")}function PF(n,e,t,a){if(!n)return"";var s=[];if(n["!margins"]&&(s.push("<PageSetup>"),n["!margins"].header&&s.push(Ne("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&s.push(Ne("Footer",null,{"x:Margin":n["!margins"].footer})),s.push(Ne("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)s.push(Ne("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<t&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==t&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),n["!protect"]&&(s.push(bn("ProtectContents","True")),n["!protect"].objects&&s.push(bn("ProtectObjects","True")),n["!protect"].scenarios&&s.push(bn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?s.push(bn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&s.push(bn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){n["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Ne("WorksheetOptions",s.join(""),{xmlns:yr.x})}function FF(n){return n.map(function(e){var t=H4(e.t||""),a=Ne("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",a,{"ss:Author":e.a})}).join("")}function LF(n,e,t,a,s,l,c){if(!n||n.v==null&&n.f==null)return"";var h={};if(n.f&&(h["ss:Formula"]="="+xt(wm(n.f,c))),n.F&&n.F.slice(0,e.length)==e){var d=mn(n.F.slice(e.length+1));h["ss:ArrayRange"]="RC:R"+(d.r==c.r?"":"["+(d.r-c.r)+"]")+"C"+(d.c==c.c?"":"["+(d.c-c.c)+"]")}if(n.l&&n.l.Target&&(h["ss:HRef"]=xt(n.l.Target),n.l.Tooltip&&(h["x:HRefScreenTip"]=xt(n.l.Tooltip))),t["!merges"])for(var g=t["!merges"],p=0;p!=g.length;++p)g[p].s.c!=c.c||g[p].s.r!=c.r||(g[p].e.c>g[p].s.c&&(h["ss:MergeAcross"]=g[p].e.c-g[p].s.c),g[p].e.r>g[p].s.r&&(h["ss:MergeDown"]=g[p].e.r-g[p].s.r));var v="",T="";switch(n.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",T=String(n.v);break;case"b":v="Boolean",T=n.v?"1":"0";break;case"e":v="Error",T=sc[n.v];break;case"d":v="DateTime",T=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||Vt[14]);break;case"s":v="String",T=B4(n.v||"");break}var x=Ii(a.cellXfs,n,a);h["ss:StyleID"]="s"+(21+x),h["ss:Index"]=c.c+1;var C=n.v!=null?T:"",_=n.t=="z"?"":'<Data ss:Type="'+v+'">'+C+"</Data>";return(n.c||[]).length>0&&(_+=FF(n.c)),Ne("Cell",_,h)}function UF(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=AC(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function BF(n,e,t,a){if(!n["!ref"])return"";var s=Lt(n["!ref"]),l=n["!merges"]||[],c=0,h=[];n["!cols"]&&n["!cols"].forEach(function(A,B){Em(A);var I=!!A.width,k=tf(B,A),z={"ss:Index":B+1};I&&(z["ss:Width"]=Eh(k.width)),A.hidden&&(z["ss:Hidden"]="1"),h.push(Ne("Column",null,z))});for(var d=Array.isArray(n),g=s.s.r;g<=s.e.r;++g){for(var p=[UF(g,(n["!rows"]||[])[g])],v=s.s.c;v<=s.e.c;++v){var T=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>v)&&!(l[c].s.r>g)&&!(l[c].e.c<v)&&!(l[c].e.r<g)){(l[c].s.c!=v||l[c].s.r!=g)&&(T=!0);break}if(!T){var x={r:g,c:v},C=_t(x),_=d?(n[g]||[])[v]:n[C];p.push(LF(_,C,n,e,t,a,x))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function HF(n,e,t){var a=[],s=t.SheetNames[n],l=t.Sheets[s],c=l?DF(l,e,n,t):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?BF(l,e,n,t):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(PF(l,e,n,t)),a.join("")}function jF(n,e){e||(e={}),n.SSF||(n.SSF=ir(Vt)),n.SSF&&(Wh(),Xh(n.SSF),e.revssf=Qh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ii(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(NF(n,e)),t.push(kF()),t.push(""),t.push("");for(var a=0;a<n.SheetNames.length;++a)t.push(Ne("Worksheet",HF(a,e,n),{"ss:Name":xt(n.SheetNames[a])}));return t[2]=OF(n,e),t[3]=MF(n),en+Ne("Workbook",t.join(""),{xmlns:yr.ss,"xmlns:o":yr.o,"xmlns:x":yr.x,"xmlns:ss":yr.ss,"xmlns:dt":yr.dt,"xmlns:html":yr.html})}var b0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function zF(n,e){var t=[],a=[],s=[],l=0,c,h=CT(FT,"n"),d=CT(LT,"n");if(n.Props)for(c=Rn(n.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(h,c[l])?t:Object.prototype.hasOwnProperty.call(d,c[l])?a:s).push([c[l],n.Props[c[l]]]);if(n.Custprops)for(c=Rn(n.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(n.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(h,c[l])?t:Object.prototype.hasOwnProperty.call(d,c[l])?a:s).push([c[l],n.Custprops[c[l]]]);var g=[];for(l=0;l<s.length;++l)mC.indexOf(s[l][0])>-1||fC.indexOf(s[l][0])>-1||s[l][1]!=null&&g.push(s[l]);a.length&&It.utils.cfb_add(e,"/SummaryInformation",zT(a,b0.SI,d,LT)),(t.length||g.length)&&It.utils.cfb_add(e,"/DocumentSummaryInformation",zT(t,b0.DSI,h,FT,g.length?g:null,b0.UDI))}function GF(n,e){var t=e||{},a=It.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return It.utils.cfb_add(a,s,VC(n,t)),t.biff==8&&(n.Props||n.Custprops)&&zF(n,a),t.biff==8&&n.vbaraw&&oD(a,It.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),a}var $F={0:{f:qP},1:{f:t6},2:{f:_6},3:{f:c6},4:{f:i6},5:{f:v6},6:{f:w6},7:{f:d6},8:{f:M6},9:{f:O6},10:{f:N6},11:{f:k6},12:{f:r6},13:{f:C6},14:{f:h6},15:{f:o6},16:{f:T6},17:{f:I6},18:{f:m6},19:{f:xm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:yF},40:{},42:{},43:{f:w3},44:{f:E3},45:{f:R3},46:{f:k3},47:{f:N3},48:{},49:{f:rM},50:{},51:{f:q3},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:a3},62:{f:A6},63:{f:Z3},64:{f:X6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:va,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:K6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:ZP},148:{f:WP,p:16},151:{f:B6},152:{},153:{f:pF},154:{},155:{},156:{f:gF},157:{},158:{},159:{T:1,f:g3},160:{T:-1},161:{T:1,f:ds},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:D6},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:K3},336:{T:-1},337:{f:W3,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:W0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JM},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:H6},427:{f:j6},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:G6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:JP},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:L6},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:W0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:aD},633:{T:1},634:{T:-1},635:{T:1,f:nD},636:{T:-1},637:{f:oM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:lF},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:W6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Oe(n,e,t,a){var s=e;if(!isNaN(s)){var l=a||(t||[]).length||0,c=n.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&vm(t)&&n.push(t)}}function KF(n,e,t,a){var s=(t||[]).length||0;if(s<=8224)return Oe(n,e,t,s);var l=e;if(!isNaN(l)){for(var c=t.parts||[],h=0,d=0,g=0;g+(c[h]||8224)<=8224;)g+=c[h]||8224,h++;var p=n.next(4);for(p.write_shift(2,l),p.write_shift(2,g),n.push(t.slice(d,d+g)),d+=g;d<s;){for(p=n.next(4),p.write_shift(2,60),g=0;g+(c[h]||8224)<=8224;)g+=c[h]||8224,h++;p.write_shift(2,g),n.push(t.slice(d,d+g)),d+=g}}}function lc(n,e,t){return n||(n=ge(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function VF(n,e,t,a){var s=ge(9);return lc(s,n,e),vC(t,a||"b",s),s}function qF(n,e,t){var a=ge(8+2*t.length);return lc(a,n,e),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function YF(n,e,t,a){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?ar(Xn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Oe(n,2,l3(t,a,s)):Oe(n,3,o3(t,a,s));return;case"b":case"e":Oe(n,5,VF(t,a,e.v,e.t));return;case"s":case"str":Oe(n,4,qF(t,a,(e.v||"").slice(0,255)));return}Oe(n,1,lc(null,t,a))}function XF(n,e,t,a){var s=Array.isArray(e),l=Lt(e["!ref"]||"A1"),c,h="",d=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=Zt(l)}for(var g=l.s.r;g<=l.e.r;++g){h=In(g);for(var p=l.s.c;p<=l.e.c;++p){g===l.s.r&&(d[p]=Fn(p)),c=d[p]+h;var v=s?(e[g]||[])[p]:e[c];v&&YF(n,v,g,p)}}}function WF(n,e){for(var t=e||{},a=nr(),s=0,l=0;l<n.SheetNames.length;++l)n.SheetNames[l]==t.sheet&&(s=l);if(s==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Oe(a,t.biff==4?1033:t.biff==3?521:9,Cm(n,16,t)),XF(a,n.Sheets[n.SheetNames[s]],s,t),Oe(a,10),a.end()}function QF(n,e,t){Oe(n,49,$M({sz:12,name:"Arial"},t))}function JF(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&Oe(n,1054,qM(s,e[s],t))})}function ZF(n,e){var t=ge(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Oe(n,2151,t),t=ge(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),xC(Lt(e["!ref"]||"A1"),t),t.write_shift(4,4),Oe(n,2152,t)}function e8(n,e){for(var t=0;t<16;++t)Oe(n,224,$T({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){Oe(n,224,$T(a,0,e))})}function t8(n,e){for(var t=0;t<e["!links"].length;++t){var a=e["!links"][t];Oe(n,440,t3(a)),a[1].Tooltip&&Oe(n,2048,n3(a))}delete e["!links"]}function n8(n,e){if(e){var t=0;e.forEach(function(a,s){++t<=256&&a&&Oe(n,125,i3(tf(s,a),s))})}}function r8(n,e,t,a,s){var l=16+Ii(s.cellXfs,e,s);if(e.v==null&&!e.bf){Oe(n,513,os(t,a,l));return}if(e.bf)Oe(n,6,bP(e,t,a,s,l));else switch(e.t){case"d":case"n":var c=e.t=="d"?ar(Xn(e.v)):e.v;Oe(n,515,QM(t,a,c,l));break;case"b":case"e":Oe(n,517,WM(t,a,e.v,l,s,e.t));break;case"s":case"str":if(s.bookSST){var h=Im(s.Strings,e.v,s.revStrings);Oe(n,253,KM(t,a,h,l))}else Oe(n,516,VM(t,a,(e.v||"").slice(0,255),l,s));break;default:Oe(n,513,os(t,a,l))}}function a8(n,e,t){var a=nr(),s=t.SheetNames[n],l=t.Sheets[s]||{},c=(t||{}).Workbook||{},h=(c.Sheets||[])[n]||{},d=Array.isArray(l),g=e.biff==8,p,v="",T=[],x=Lt(l["!ref"]||"A1"),C=g?65536:16384;if(x.e.c>255||x.e.r>=C){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");x.e.c=Math.min(x.e.c,255),x.e.r=Math.min(x.e.c,C-1)}Oe(a,2057,Cm(t,16,e)),Oe(a,13,Pr(1)),Oe(a,12,Pr(100)),Oe(a,15,qn(!0)),Oe(a,17,qn(!1)),Oe(a,16,ss(.001)),Oe(a,95,qn(!0)),Oe(a,42,qn(!1)),Oe(a,43,qn(!1)),Oe(a,130,Pr(1)),Oe(a,128,XM()),Oe(a,131,qn(!1)),Oe(a,132,qn(!1)),g&&n8(a,l["!cols"]),Oe(a,512,YM(x,e)),g&&(l["!links"]=[]);for(var _=x.s.r;_<=x.e.r;++_){v=In(_);for(var A=x.s.c;A<=x.e.c;++A){_===x.s.r&&(T[A]=Fn(A)),p=T[A]+v;var B=d?(l[_]||[])[A]:l[p];B&&(r8(a,B,_,A,e),g&&B.l&&l["!links"].push([p,B.l]))}}var I=h.CodeName||h.name||s;return g&&Oe(a,574,GM((c.Views||[])[0])),g&&(l["!merges"]||[]).length&&Oe(a,229,e3(l["!merges"])),g&&t8(a,l),Oe(a,442,TC(I)),g&&ZF(a,l),Oe(a,10),a.end()}function i8(n,e,t){var a=nr(),s=(n||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},h=t.biff==8,d=t.biff==5;if(Oe(a,2057,Cm(n,5,t)),t.bookType=="xla"&&Oe(a,135),Oe(a,225,h?Pr(1200):null),Oe(a,193,NM(2)),d&&Oe(a,191),d&&Oe(a,192),Oe(a,226),Oe(a,92,BM("SheetJS",t)),Oe(a,66,Pr(h?1200:1252)),h&&Oe(a,353,Pr(0)),h&&Oe(a,448),Oe(a,317,s3(n.SheetNames.length)),h&&n.vbaraw&&Oe(a,211),h&&n.vbaraw){var g=c.CodeName||"ThisWorkbook";Oe(a,442,TC(g))}Oe(a,156,Pr(17)),Oe(a,25,qn(!1)),Oe(a,18,qn(!1)),Oe(a,19,Pr(0)),h&&Oe(a,431,qn(!1)),h&&Oe(a,444,Pr(0)),Oe(a,61,zM()),Oe(a,64,qn(!1)),Oe(a,141,Pr(0)),Oe(a,34,qn(uF(n)=="true")),Oe(a,14,qn(!0)),h&&Oe(a,439,qn(!1)),Oe(a,218,Pr(0)),QF(a,n,t),JF(a,n.SSF,t),e8(a,t),h&&Oe(a,352,qn(!1));var p=a.end(),v=nr();h&&Oe(v,140,r3()),h&&t.Strings&&KF(v,252,jM(t.Strings)),Oe(v,10);var T=v.end(),x=nr(),C=0,_=0;for(_=0;_<n.SheetNames.length;++_)C+=(h?12:11)+(h?2:1)*n.SheetNames[_].length;var A=p.length+C+T.length;for(_=0;_<n.SheetNames.length;++_){var B=l[_]||{};Oe(x,133,HM({pos:A,hs:B.Hidden||0,dt:0,name:n.SheetNames[_]},t)),A+=e[_].length}var I=x.end();if(C!=I.length)throw new Error("BS8 "+C+" != "+I.length);var k=[];return p.length&&k.push(p),I.length&&k.push(I),T.length&&k.push(T),wn(k)}function s8(n,e){var t=e||{},a=[];n&&!n.SSF&&(n.SSF=ir(Vt)),n&&n.SSF&&(Wh(),Xh(n.SSF),t.revssf=Qh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Rm(t),t.cellXfs=[],Ii(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var s=0;s<n.SheetNames.length;++s)a[a.length]=a8(s,t,n);return a.unshift(i8(n,a,t)),wn(a)}function VC(n,e){for(var t=0;t<=n.SheetNames.length;++t){var a=n.Sheets[n.SheetNames[t]];if(!(!a||!a["!ref"])){var s=Sr(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var l=e||{};switch(l.biff||2){case 8:case 5:return s8(n,e);case 4:case 3:case 2:return WF(n,e)}throw new Error("invalid type "+l.bookType+" for BIFF")}function o8(n,e,t,a){for(var s=n["!merges"]||[],l=[],c=e.s.c;c<=e.e.c;++c){for(var h=0,d=0,g=0;g<s.length;++g)if(!(s[g].s.r>t||s[g].s.c>c)&&!(s[g].e.r<t||s[g].e.c<c)){if(s[g].s.r<t||s[g].s.c<c){h=-1;break}h=s[g].e.r-s[g].s.r+1,d=s[g].e.c-s[g].s.c+1;break}if(!(h<0)){var p=_t({r:t,c}),v=a.dense?(n[t]||[])[c]:n[p],T=v&&v.v!=null&&(v.h||U4(v.w||(ja(v),v.w)||""))||"",x={};h>1&&(x.rowspan=h),d>1&&(x.colspan=d),a.editable?T='<span contenteditable="true">'+T+"</span>":v&&(x["data-t"]=v&&v.t||"z",v.v!=null&&(x["data-v"]=v.v),v.z!=null&&(x["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(T='<a href="'+v.l.Target+'">'+T+"</a>")),x.id=(a.id||"sjs")+"-"+p,l.push(Ne("td",T,x))}}var C="<tr>";return C+l.join("")+"</tr>"}var l8='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',c8="</body></html>";function u8(n,e,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function qC(n,e){var t=e||{},a=t.header!=null?t.header:l8,s=t.footer!=null?t.footer:c8,l=[a],c=Sr(n["!ref"]);t.dense=Array.isArray(n),l.push(u8(n,c,t));for(var h=c.s.r;h<=c.e.r;++h)l.push(o8(n,c,h,t));return l.push("</table>"+s),l.join("")}function YC(n,e,t){var a=t||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?mn(a.origin):a.origin;s=c.r,l=c.c}var h=e.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,h.length),g={s:{r:0,c:0},e:{r:s,c:l}};if(n["!ref"]){var p=Sr(n["!ref"]);g.s.r=Math.min(g.s.r,p.s.r),g.s.c=Math.min(g.s.c,p.s.c),g.e.r=Math.max(g.e.r,p.e.r),g.e.c=Math.max(g.e.c,p.e.c),s==-1&&(g.e.r=s=p.e.r+1)}var v=[],T=0,x=n["!rows"]||(n["!rows"]=[]),C=0,_=0,A=0,B=0,I=0,k=0;for(n["!cols"]||(n["!cols"]=[]);C<h.length&&_<d;++C){var z=h[C];if(QT(z)){if(a.display)continue;x[_]={hidden:!0}}var X=z.children;for(A=B=0;A<X.length;++A){var W=X[A];if(!(a.display&&QT(W))){var N=W.hasAttribute("data-v")?W.getAttribute("data-v"):W.hasAttribute("v")?W.getAttribute("v"):z4(W.innerHTML),G=W.getAttribute("data-z")||W.getAttribute("z");for(T=0;T<v.length;++T){var V=v[T];V.s.c==B+l&&V.s.r<_+s&&_+s<=V.e.r&&(B=V.e.c+1-l,T=-1)}k=+W.getAttribute("colspan")||1,((I=+W.getAttribute("rowspan")||1)>1||k>1)&&v.push({s:{r:_+s,c:B+l},e:{r:_+s+(I||1)-1,c:B+l+(k||1)-1}});var ie={t:"s",v:N},J=W.getAttribute("data-t")||W.getAttribute("t")||"";N!=null&&(N.length==0?ie.t=J||"z":a.raw||N.trim().length==0||J=="s"||(N==="TRUE"?ie={t:"b",v:!0}:N==="FALSE"?ie={t:"b",v:!1}:isNaN(La(N))?isNaN(Ql(N).getDate())||(ie={t:"d",v:Xn(N)},a.cellDates||(ie={t:"n",v:ar(ie.v)}),ie.z=a.dateNF||Vt[14]):ie={t:"n",v:La(N)})),ie.z===void 0&&G!=null&&(ie.z=G);var he="",Ae=W.getElementsByTagName("A");if(Ae&&Ae.length)for(var je=0;je<Ae.length&&!(Ae[je].hasAttribute("href")&&(he=Ae[je].getAttribute("href"),he.charAt(0)!="#"));++je);he&&he.charAt(0)!="#"&&(ie.l={Target:he}),a.dense?(n[_+s]||(n[_+s]=[]),n[_+s][B+l]=ie):n[_t({c:B+l,r:_+s})]=ie,g.e.c<B+l&&(g.e.c=B+l),B+=k}}++_}return v.length&&(n["!merges"]=(n["!merges"]||[]).concat(v)),g.e.r=Math.max(g.e.r,_-1+s),n["!ref"]=Zt(g),_>=d&&(n["!fullref"]=Zt((g.e.r=h.length-C+_-1+s,g))),n}function XC(n,e){var t=e||{},a=t.dense?[]:{};return YC(a,n,e)}function h8(n,e){return cs(XC(n,e),e)}function QT(n){var e="",t=f8(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function f8(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var d8=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return en+e}})(),JT=(function(){var n=function(l){return xt(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(l,c,h){var d=[];d.push('      <table:table table:name="'+xt(c.SheetNames[h])+`" table:style-name="ta1">
`);var g=0,p=0,v=Sr(l["!ref"]||"A1"),T=l["!merges"]||[],x=0,C=Array.isArray(l);if(l["!cols"])for(p=0;p<=v.e.c;++p)d.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var _="",A=l["!rows"]||[];for(g=0;g<v.s.r;++g)_=A[g]?' table:style-name="ro'+A[g].ods+'"':"",d.push("        <table:table-row"+_+`></table:table-row>
`);for(;g<=v.e.r;++g){for(_=A[g]?' table:style-name="ro'+A[g].ods+'"':"",d.push("        <table:table-row"+_+`>
`),p=0;p<v.s.c;++p)d.push(e);for(;p<=v.e.c;++p){var B=!1,I={},k="";for(x=0;x!=T.length;++x)if(!(T[x].s.c>p)&&!(T[x].s.r>g)&&!(T[x].e.c<p)&&!(T[x].e.r<g)){(T[x].s.c!=p||T[x].s.r!=g)&&(B=!0),I["table:number-columns-spanned"]=T[x].e.c-T[x].s.c+1,I["table:number-rows-spanned"]=T[x].e.r-T[x].s.r+1;break}if(B){d.push(t);continue}var z=_t({r:g,c:p}),X=C?(l[g]||[])[p]:l[z];if(X&&X.f&&(I["table:formula"]=xt(MP(X.f)),X.F&&X.F.slice(0,z.length)==z)){var W=Sr(X.F);I["table:number-matrix-columns-spanned"]=W.e.c-W.s.c+1,I["table:number-matrix-rows-spanned"]=W.e.r-W.s.r+1}if(!X){d.push(e);continue}switch(X.t){case"b":k=X.v?"TRUE":"FALSE",I["office:value-type"]="boolean",I["office:boolean-value"]=X.v?"true":"false";break;case"n":k=X.w||String(X.v||0),I["office:value-type"]="float",I["office:value"]=X.v||0;break;case"s":case"str":k=X.v==null?"":X.v,I["office:value-type"]="string";break;case"d":k=X.w||Xn(X.v).toISOString(),I["office:value-type"]="date",I["office:date-value"]=Xn(X.v).toISOString(),I["table:style-name"]="ce1";break;default:d.push(e);continue}var N=n(k);if(X.l&&X.l.Target){var G=X.l.Target;G=G.charAt(0)=="#"?"#"+DP(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),N=Ne("text:a",N,{"xlink:href":G.replace(/&/g,"&amp;")})}d.push("          "+Ne("table:table-cell",Ne("text:p",N,{}),I)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var h=0;c.SheetNames.map(function(g){return c.Sheets[g]}).forEach(function(g){if(g&&g["!cols"]){for(var p=0;p<g["!cols"].length;++p)if(g["!cols"][p]){var v=g["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Em(v),v.ods=h;var T=g["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+T+`"/>
`),l.push(`  </style:style>
`),++h}}});var d=0;c.SheetNames.map(function(g){return c.Sheets[g]}).forEach(function(g){if(g&&g["!rows"]){for(var p=0;p<g["!rows"].length;++p)if(g["!rows"][p]){g["!rows"][p].ods=d;var v=g["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,h){var d=[en],g=Zl({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=Zl({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(d.push("<office:document"+g+p+`>
`),d.push(uC().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+g+`>
`),s(d,c),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var v=0;v!=c.SheetNames.length;++v)d.push(a(c.Sheets[c.SheetNames[v]],c,v));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),h.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function WC(n,e){if(e.bookType=="fods")return JT(n,e);var t=dm(),a="",s=[],l=[];return a="mimetype",nt(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",nt(t,a,JT(n,e)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",nt(t,a,d8(n,e)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",nt(t,a,en+uC()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",nt(t,a,AM(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",nt(t,a,CM(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function bh(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function g8(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):qr(Jl(n))}function m8(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var a=0;a<e.length;++a)if(n[t+a]!=e[a])continue e;return!0}return!1}function bi(n){var e=n.reduce(function(s,l){return s+l.length},0),t=new Uint8Array(e),a=0;return n.forEach(function(s){t.set(s,a),a+=s.length}),t}function p8(n,e,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,a-6176);n[e+15]|=a>>7,n[e+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)n[e+l]=s&255;n[e+15]|=t>=0?0:128}function ec(n,e){var t=e?e[0]:0,a=n[t]&127;e:if(n[t++]>=128&&(a|=(n[t]&127)<<7,n[t++]<128||(a|=(n[t]&127)<<14,n[t++]<128)||(a|=(n[t]&127)<<21,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),a}function vt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function co(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function rn(n){for(var e=[],t=[0];t[0]<n.length;){var a=t[0],s=ec(n,t),l=s&7;s=Math.floor(s/8);var c=0,h;if(s==0)break;switch(l){case 0:{for(var d=t[0];n[t[0]++]>=128;);h=n.slice(d,t[0])}break;case 5:c=4,h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=ec(n,t),h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var g={data:h,type:l};e[s]==null?e[s]=[g]:e[s].push(g)}return e}function Cn(n){var e=[];return n.forEach(function(t,a){t.forEach(function(s){s.data&&(e.push(vt(a*8+s.type)),s.type==2&&e.push(vt(s.data.length)),e.push(s.data))})}),bi(e)}function $r(n){for(var e,t=[],a=[0];a[0]<n.length;){var s=ec(n,a),l=rn(n.slice(a[0],a[0]+s));a[0]+=s;var c={id:co(l[1][0].data),messages:[]};l[2].forEach(function(h){var d=rn(h.data),g=co(d[3][0].data);c.messages.push({meta:d,data:n.slice(a[0],a[0]+g)}),a[0]+=g}),(e=l[3])!=null&&e[0]&&(c.merge=co(l[3][0].data)>>>0>0),t.push(c)}return t}function Qs(n){var e=[];return n.forEach(function(t){var a=[];a[1]=[{data:vt(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:vt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:vt(c.data.length)}],a[2].push({data:Cn(c.meta),type:2})});var l=Cn(a);e.push(vt(l.length)),e.push(l),s.forEach(function(c){return e.push(c)})}),bi(e)}function v8(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],a=ec(e,t),s=[];t[0]<e.length;){var l=e[t[0]]&3;if(l==0){var c=e[t[0]++]>>2;if(c<60)++c;else{var h=c-59;c=e[t[0]],h>1&&(c|=e[t[0]+1]<<8),h>2&&(c|=e[t[0]+2]<<16),h>3&&(c|=e[t[0]+3]<<24),c>>>=0,c++,t[0]+=h}s.push(e.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var d=0,g=0;if(l==1?(g=(e[t[0]]>>2&7)+4,d=(e[t[0]++]&224)<<3,d|=e[t[0]++]):(g=(e[t[0]++]>>2)+1,l==2?(d=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(d=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[bi(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(g>=d)for(s.push(s[0].slice(-d)),g-=d;g>=s[s.length-1].length;)s.push(s[s.length-1]),g-=s[s.length-1].length;s.push(s[0].slice(-d,-d+g))}}var p=bi(s);if(p.length!=a)throw new Error("Unexpected length: ".concat(p.length," != ").concat(a));return p}function Kr(n){for(var e=[],t=0;t<n.length;){var a=n[t++],s=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(v8(a,n.slice(t,t+s))),t+=s}if(t!==n.length)throw new Error("data is not a valid framed stream!");return bi(e)}function Js(n){for(var e=[],t=0;t<n.length;){var a=Math.min(n.length-t,268435455),s=new Uint8Array(4);e.push(s);var l=vt(a),c=l.length;e.push(l),a<=60?(c++,e.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(n.slice(t,t+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,t+=a}return bi(e)}function I0(n,e){var t=new Uint8Array(32),a=bh(t),s=12,l=0;switch(t[0]=5,n.t){case"n":t[1]=2,p8(t,s,n.v),l|=1,s+=16;break;case"b":t[1]=6,a.setFloat64(s,n.v?1:0,!0),l|=2,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,a.setUint32(s,e.indexOf(n.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+n.t}return a.setUint32(8,l,!0),t.slice(0,s)}function R0(n,e){var t=new Uint8Array(32),a=bh(t),s=12,l=0;switch(t[0]=3,n.t){case"n":t[2]=2,a.setFloat64(s,n.v,!0),l|=32,s+=8;break;case"b":t[2]=6,a.setFloat64(s,n.v?1:0,!0),l|=32,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,a.setUint32(s,e.indexOf(n.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+n.t}return a.setUint32(4,l,!0),t.slice(0,s)}function di(n){var e=rn(n);return ec(e[1][0].data)}function y8(n,e,t){var a,s,l,c;if(!((a=n[6])!=null&&a[0])||!((s=n[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var h=((c=(l=n[8])==null?void 0:l[0])==null?void 0:c.data)&&co(n[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var d=0,g=bh(n[7][0].data),p=0,v=[],T=bh(n[4][0].data),x=0,C=[],_=0;_<e.length;++_){if(e[_]==null){g.setUint16(_*2,65535,!0),T.setUint16(_*2,65535);continue}g.setUint16(_*2,p,!0),T.setUint16(_*2,x,!0);var A,B;switch(typeof e[_]){case"string":A=I0({t:"s",v:e[_]},t),B=R0({t:"s",v:e[_]},t);break;case"number":A=I0({t:"n",v:e[_]},t),B=R0({t:"n",v:e[_]},t);break;case"boolean":A=I0({t:"b",v:e[_]},t),B=R0({t:"b",v:e[_]},t);break;default:throw new Error("Unsupported value "+e[_])}v.push(A),p+=A.length,C.push(B),x+=B.length,++d}for(n[2][0].data=vt(d);_<n[7][0].data.length/2;++_)g.setUint16(_*2,65535,!0),T.setUint16(_*2,65535,!0);return n[6][0].data=bi(v),n[3][0].data=bi(C),d}function T8(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Sr(t["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(Zt(a)));var l=Ih(t,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(L){return L.forEach(function(P){typeof P=="string"&&c.push(P)})});var h={},d=[],g=It.read(e.numbers,{type:"base64"});g.FileIndex.map(function(L,P){return[L,g.FullPaths[P]]}).forEach(function(L){var P=L[0],j=L[1];if(P.type==2&&P.name.match(/\.iwa/)){var Z=P.content,be=Kr(Z),Ce=$r(be);Ce.forEach(function(Pe){d.push(Pe.id),h[Pe.id]={deps:[],location:j,type:co(Pe.messages[0].meta[1][0].data)}})}}),d.sort(function(L,P){return L-P});var p=d.filter(function(L){return L>1}).map(function(L){return[L,vt(L)]});g.FileIndex.map(function(L,P){return[L,g.FullPaths[P]]}).forEach(function(L){var P=L[0];if(L[1],!!P.name.match(/\.iwa/)){var j=$r(Kr(P.content));j.forEach(function(Z){Z.messages.forEach(function(be){p.forEach(function(Ce){Z.messages.some(function(Pe){return co(Pe.meta[1][0].data)!=11006&&m8(Pe.data,Ce[1])})&&h[Ce[0]].deps.push(Z.id)})})})}});for(var v=It.find(g,h[1].location),T=$r(Kr(v.content)),x,C=0;C<T.length;++C){var _=T[C];_.id==1&&(x=_)}var A=di(rn(x.messages[0].data)[1][0].data);for(v=It.find(g,h[A].location),T=$r(Kr(v.content)),C=0;C<T.length;++C)_=T[C],_.id==A&&(x=_);for(A=di(rn(x.messages[0].data)[2][0].data),v=It.find(g,h[A].location),T=$r(Kr(v.content)),C=0;C<T.length;++C)_=T[C],_.id==A&&(x=_);for(A=di(rn(x.messages[0].data)[2][0].data),v=It.find(g,h[A].location),T=$r(Kr(v.content)),C=0;C<T.length;++C)_=T[C],_.id==A&&(x=_);var B=rn(x.messages[0].data);{B[6][0].data=vt(a.e.r+1),B[7][0].data=vt(a.e.c+1);var I=di(B[46][0].data),k=It.find(g,h[I].location),z=$r(Kr(k.content));{for(var X=0;X<z.length&&z[X].id!=I;++X);if(z[X].id!=I)throw"Bad ColumnRowUIDMapArchive";var W=rn(z[X].messages[0].data);W[1]=[],W[2]=[],W[3]=[];for(var N=0;N<=a.e.c;++N){var G=[];G[1]=G[2]=[{type:0,data:vt(N+420690)}],W[1].push({type:2,data:Cn(G)}),W[2].push({type:0,data:vt(N)}),W[3].push({type:0,data:vt(N)})}W[4]=[],W[5]=[],W[6]=[];for(var V=0;V<=a.e.r;++V)G=[],G[1]=G[2]=[{type:0,data:vt(V+726270)}],W[4].push({type:2,data:Cn(G)}),W[5].push({type:0,data:vt(V)}),W[6].push({type:0,data:vt(V)});z[X].messages[0].data=Cn(W)}k.content=Js(Qs(z)),k.size=k.content.length,delete B[46];var ie=rn(B[4][0].data);{ie[7][0].data=vt(a.e.r+1);var J=rn(ie[1][0].data),he=di(J[2][0].data);k=It.find(g,h[he].location),z=$r(Kr(k.content));{if(z[0].id!=he)throw"Bad HeaderStorageBucket";var Ae=rn(z[0].messages[0].data);for(V=0;V<l.length;++V){var je=rn(Ae[2][0].data);je[1][0].data=vt(V),je[4][0].data=vt(l[V].length),Ae[2][V]={type:Ae[2][0].type,data:Cn(je)}}z[0].messages[0].data=Cn(Ae)}k.content=Js(Qs(z)),k.size=k.content.length;var ke=di(ie[2][0].data);k=It.find(g,h[ke].location),z=$r(Kr(k.content));{if(z[0].id!=ke)throw"Bad HeaderStorageBucket";for(Ae=rn(z[0].messages[0].data),N=0;N<=a.e.c;++N)je=rn(Ae[2][0].data),je[1][0].data=vt(N),je[4][0].data=vt(a.e.r+1),Ae[2][N]={type:Ae[2][0].type,data:Cn(je)};z[0].messages[0].data=Cn(Ae)}k.content=Js(Qs(z)),k.size=k.content.length;var re=di(ie[4][0].data);(function(){for(var L=It.find(g,h[re].location),P=$r(Kr(L.content)),j,Z=0;Z<P.length;++Z){var be=P[Z];be.id==re&&(j=be)}var Ce=rn(j.messages[0].data);{Ce[3]=[];var Pe=[];c.forEach(function(et,jt){Pe[1]=[{type:0,data:vt(jt)}],Pe[2]=[{type:0,data:vt(1)}],Pe[3]=[{type:2,data:g8(et)}],Ce[3].push({type:2,data:Cn(Pe)})})}j.messages[0].data=Cn(Ce);var De=Qs(P),ot=Js(De);L.content=ot,L.size=L.content.length})();var _e=rn(ie[3][0].data);{var fe=_e[1][0];delete _e[2];var Te=rn(fe.data);{var U=di(Te[2][0].data);(function(){for(var L=It.find(g,h[U].location),P=$r(Kr(L.content)),j,Z=0;Z<P.length;++Z){var be=P[Z];be.id==U&&(j=be)}var Ce=rn(j.messages[0].data);{delete Ce[6],delete _e[7];var Pe=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var De=0,ot=0;ot<=a.e.r;++ot){var et=rn(Pe);De+=y8(et,l[ot],c),et[1][0].data=vt(ot),Ce[5].push({data:Cn(et),type:2})}Ce[1]=[{type:0,data:vt(a.e.c+1)}],Ce[2]=[{type:0,data:vt(a.e.r+1)}],Ce[3]=[{type:0,data:vt(De)}],Ce[4]=[{type:0,data:vt(a.e.r+1)}]}j.messages[0].data=Cn(Ce);var jt=Qs(P),lt=Js(jt);L.content=lt,L.size=L.content.length})()}fe.data=Cn(Te)}ie[3][0].data=Cn(_e)}B[4][0].data=Cn(ie)}x.messages[0].data=Cn(B);var ue=Qs(T),b=Js(ue);return v.content=b,v.size=v.content.length,g}function x8(n){return function(t){for(var a=0;a!=n.length;++a){var s=n[a];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Rm(n){x8([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function _8(n,e){return e.bookType=="ods"?WC(n,e):e.bookType=="numbers"?T8(n,e):e.bookType=="xlsb"?S8(n,e):C8(n,e)}function S8(n,e){no=1024,n&&!n.SSF&&(n.SSF=ir(Vt)),n&&n.SSF&&(Wh(),Xh(n.SSF),e.revssf=Qh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",a=OC.indexOf(e.bookType)>-1,s=oC();Rm(e=e||{});var l=dm(),c="",h=0;if(e.cellXfs=[],Ii(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),c="docProps/core.xml",nt(l,c,hC(n.Props,e)),s.coreprops.push(c),yt(e.rels,2,c,ht.CORE_PROPS),c="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var d=[],g=0;g<n.SheetNames.length;++g)(n.Workbook.Sheets[g]||{}).Hidden!=2&&d.push(n.SheetNames[g]);n.Props.SheetNames=d}for(n.Props.Worksheets=n.Props.SheetNames.length,nt(l,c,dC(n.Props)),s.extprops.push(c),yt(e.rels,3,c,ht.EXT_PROPS),n.Custprops!==n.Props&&Rn(n.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,gC(n.Custprops)),s.custprops.push(c),yt(e.rels,4,c,ht.CUST_PROPS)),h=1;h<=n.SheetNames.length;++h){var p={"!id":{}},v=n.Sheets[n.SheetNames[h-1]],T=(v||{})["!type"]||"sheet";switch(T){case"chart":default:c="xl/worksheets/sheet"+h+"."+t,nt(l,c,AF(h-1,c,e,n,p)),s.sheets.push(c),yt(e.wbrels,-1,"worksheets/sheet"+h+"."+t,ht.WS[0])}if(v){var x=v["!comments"],C=!1,_="";x&&x.length>0&&(_="xl/comments"+h+"."+t,nt(l,_,IF(x,_)),s.comments.push(_),yt(p,-1,"../comments"+h+"."+t,ht.CMNT),C=!0),v["!legacy"]&&C&&nt(l,"xl/drawings/vmlDrawing"+h+".vml",NC(h,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&nt(l,cC(c),oo(p))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,nt(l,c,bF(e.Strings,c,e)),s.strs.push(c),yt(e.wbrels,-1,"sharedStrings."+t,ht.SST)),c="xl/workbook."+t,nt(l,c,EF(n,c)),s.workbooks.push(c),yt(e.rels,1,c,ht.WB),c="xl/theme/theme1.xml",nt(l,c,IC(n.Themes,e)),s.themes.push(c),yt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),c="xl/styles."+t,nt(l,c,wF(n,c,e)),s.styles.push(c),yt(e.wbrels,-1,"styles."+t,ht.STY),n.vbaraw&&a&&(c="xl/vbaProject.bin",nt(l,c,n.vbaraw),s.vba.push(c),yt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),c="xl/metadata."+t,nt(l,c,RF(c)),s.metadata.push(c),yt(e.wbrels,-1,"metadata."+t,ht.XLMETA),nt(l,"[Content_Types].xml",lC(s,e)),nt(l,"_rels/.rels",oo(e.rels)),nt(l,"xl/_rels/workbook."+t+".rels",oo(e.wbrels)),delete e.revssf,delete e.ssf,l}function C8(n,e){no=1024,n&&!n.SSF&&(n.SSF=ir(Vt)),n&&n.SSF&&(Wh(),Xh(n.SSF),e.revssf=Qh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,zl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",a=OC.indexOf(e.bookType)>-1,s=oC();Rm(e=e||{});var l=dm(),c="",h=0;if(e.cellXfs=[],Ii(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),c="docProps/core.xml",nt(l,c,hC(n.Props,e)),s.coreprops.push(c),yt(e.rels,2,c,ht.CORE_PROPS),c="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var d=[],g=0;g<n.SheetNames.length;++g)(n.Workbook.Sheets[g]||{}).Hidden!=2&&d.push(n.SheetNames[g]);n.Props.SheetNames=d}n.Props.Worksheets=n.Props.SheetNames.length,nt(l,c,dC(n.Props)),s.extprops.push(c),yt(e.rels,3,c,ht.EXT_PROPS),n.Custprops!==n.Props&&Rn(n.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,gC(n.Custprops)),s.custprops.push(c),yt(e.rels,4,c,ht.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,h=1;h<=n.SheetNames.length;++h){var v={"!id":{}},T=n.Sheets[n.SheetNames[h-1]],x=(T||{})["!type"]||"sheet";switch(x){case"chart":default:c="xl/worksheets/sheet"+h+"."+t,nt(l,c,jC(h-1,e,n,v)),s.sheets.push(c),yt(e.wbrels,-1,"worksheets/sheet"+h+"."+t,ht.WS[0])}if(T){var C=T["!comments"],_=!1,A="";if(C&&C.length>0){var B=!1;C.forEach(function(I){I[1].forEach(function(k){k.T==!0&&(B=!0)})}),B&&(A="xl/threadedComments/threadedComment"+h+"."+t,nt(l,A,eD(C,p,e)),s.threadedcomments.push(A),yt(v,-1,"../threadedComments/threadedComment"+h+"."+t,ht.TCMNT)),A="xl/comments"+h+"."+t,nt(l,A,kC(C)),s.comments.push(A),yt(v,-1,"../comments"+h+"."+t,ht.CMNT),_=!0}T["!legacy"]&&_&&nt(l,"xl/drawings/vmlDrawing"+h+".vml",NC(h,T["!comments"])),delete T["!comments"],delete T["!legacy"]}v["!id"].rId1&&nt(l,cC(c),oo(v))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,nt(l,c,SC(e.Strings,e)),s.strs.push(c),yt(e.wbrels,-1,"sharedStrings."+t,ht.SST)),c="xl/workbook."+t,nt(l,c,$C(n)),s.workbooks.push(c),yt(e.rels,1,c,ht.WB),c="xl/theme/theme1.xml",nt(l,c,IC(n.Themes,e)),s.themes.push(c),yt(e.wbrels,-1,"theme/theme1.xml",ht.THEME),c="xl/styles."+t,nt(l,c,wC(n,e)),s.styles.push(c),yt(e.wbrels,-1,"styles."+t,ht.STY),n.vbaraw&&a&&(c="xl/vbaProject.bin",nt(l,c,n.vbaraw),s.vba.push(c),yt(e.wbrels,-1,"vbaProject.bin",ht.VBA)),c="xl/metadata."+t,nt(l,c,RC()),s.metadata.push(c),yt(e.wbrels,-1,"metadata."+t,ht.XLMETA),p.length>1&&(c="xl/persons/person.xml",nt(l,c,tD(p)),s.people.push(c),yt(e.wbrels,-1,"persons/person.xml",ht.PEOPLE)),nt(l,"[Content_Types].xml",lC(s,e)),nt(l,"_rels/.rels",oo(e.rels)),nt(l,"xl/_rels/workbook."+t+".rels",oo(e.wbrels)),delete e.revssf,delete e.ssf,l}function E8(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=Ha(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function QC(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return ac(e.file,It.write(n,{type:gt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return It.write(n,e)}function A8(n,e){var t=ir(e||{}),a=_8(n,t);return w8(a,t)}function w8(n,e){var t={},a=gt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=a;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var s=n.FullPaths?It.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Yh(s))}return e.password&&typeof encrypt_agile<"u"?QC(encrypt_agile(s,e.password),e):e.type==="file"?ac(e.file,s):e.type=="string"?Ul(s):s}function b8(n,e){var t=e||{},a=GF(n,t);return QC(a,t)}function ha(n,e,t){t||(t="");var a=t+n;switch(e.type){case"base64":return Wl(Jl(a));case"binary":return Jl(a);case"string":return n;case"file":return ac(e.file,a,"utf8");case"buffer":return gt?za(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ha(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function I8(n,e){switch(e.type){case"base64":return Wl(n);case"binary":return n;case"string":return n;case"file":return ac(e.file,n,"binary");case"buffer":return gt?za(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function zu(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",a=0;a<n.length;++a)t+=String.fromCharCode(n[a]);return e.type=="base64"?Wl(t):e.type=="string"?Ul(t):t;case"file":return ac(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function JC(n,e){n4(),dF(n);var t=ir(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=JC(n,t);return t.type="array",Yh(a)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=n.SheetNames.indexOf(t.sheet),!n.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ha(jF(n,t),t);case"slk":case"sylk":return ha(u3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"htm":case"html":return ha(qC(n.Sheets[n.SheetNames[s]],t),t);case"txt":return I8(ZC(n.Sheets[n.SheetNames[s]],t),t);case"csv":return ha(Nm(n.Sheets[n.SheetNames[s]],t),t,"\uFEFF");case"dif":return ha(h3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"dbf":return zu(c3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"prn":return ha(f3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"rtf":return ha(T3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"eth":return ha(_C.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"fods":return ha(WC(n,t),t);case"wk1":return zu(KT.sheet_to_wk1(n.Sheets[n.SheetNames[s]],t),t);case"wk3":return zu(KT.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),zu(VC(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),b8(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return A8(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function R8(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function N8(n,e,t){var a={};return a.type="file",a.file=e,R8(a),JC(n,a)}function k8(n,e,t,a,s,l,c,h){var d=In(t),g=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),v=!0,T=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(T,"__rowNum__",{value:t,enumerable:!1})}catch{T.__rowNum__=t}else T.__rowNum__=t;if(!c||n[t])for(var x=e.s.c;x<=e.e.c;++x){var C=c?n[t][x]:n[a[x]+d];if(C===void 0||C.t===void 0){if(g===void 0)continue;l[x]!=null&&(T[l[x]]=g);continue}var _=C.v;switch(C.t){case"z":if(_==null)break;continue;case"e":_=_==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+C.t)}if(l[x]!=null){if(_==null)if(C.t=="e"&&_===null)T[l[x]]=null;else if(g!==void 0)T[l[x]]=g;else if(p&&_===null)T[l[x]]=null;else continue;else T[l[x]]=p&&(C.t!=="n"||C.t==="n"&&h.rawNumbers!==!1)?_:ja(C,_,h);_!=null&&(v=!1)}}return{row:T,isempty:v}}function Ih(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},a=0,s=1,l=[],c=0,h="",d={s:{r:0,c:0},e:{r:0,c:0}},g=e||{},p=g.range!=null?g.range:n["!ref"];switch(g.header===1?a=1:g.header==="A"?a=2:Array.isArray(g.header)?a=3:g.header==null&&(a=0),typeof p){case"string":d=Lt(p);break;case"number":d=Lt(n["!ref"]),d.s.r=p;break;default:d=p}a>0&&(s=0);var v=In(d.s.r),T=[],x=[],C=0,_=0,A=Array.isArray(n),B=d.s.r,I=0,k={};A&&!n[B]&&(n[B]=[]);var z=g.skipHidden&&n["!cols"]||[],X=g.skipHidden&&n["!rows"]||[];for(I=d.s.c;I<=d.e.c;++I)if(!(z[I]||{}).hidden)switch(T[I]=Fn(I),t=A?n[B][I]:n[T[I]+v],a){case 1:l[I]=I-d.s.c;break;case 2:l[I]=T[I];break;case 3:l[I]=g.header[I-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),h=c=ja(t,null,g),_=k[c]||0,!_)k[c]=1;else{do h=c+"_"+_++;while(k[h]);k[c]=_,k[h]=1}l[I]=h}for(B=d.s.r+s;B<=d.e.r;++B)if(!(X[B]||{}).hidden){var W=k8(n,d,B,T,a,l,A,g);(W.isempty===!1||(a===1?g.blankrows!==!1:g.blankrows))&&(x[C++]=W.row)}return x.length=C,x}var ZT=/"/g;function O8(n,e,t,a,s,l,c,h){for(var d=!0,g=[],p="",v=In(t),T=e.s.c;T<=e.e.c;++T)if(a[T]){var x=h.dense?(n[t]||[])[T]:n[a[T]+v];if(x==null)p="";else if(x.v!=null){d=!1,p=""+(h.rawNumbers&&x.t=="n"?x.v:ja(x,null,h));for(var C=0,_=0;C!==p.length;++C)if((_=p.charCodeAt(C))===s||_===l||_===34||h.forceQuotes){p='"'+p.replace(ZT,'""')+'"';break}p=="ID"&&(p='"ID"')}else x.f!=null&&!x.F?(d=!1,p="="+x.f,p.indexOf(",")>=0&&(p='"'+p.replace(ZT,'""')+'"')):p="";g.push(p)}return h.blankrows===!1&&d?null:g.join(c)}function Nm(n,e){var t=[],a=e??{};if(n==null||n["!ref"]==null)return"";var s=Lt(n["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),h=a.RS!==void 0?a.RS:`
`,d=h.charCodeAt(0),g=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];a.dense=Array.isArray(n);for(var T=a.skipHidden&&n["!cols"]||[],x=a.skipHidden&&n["!rows"]||[],C=s.s.c;C<=s.e.c;++C)(T[C]||{}).hidden||(v[C]=Fn(C));for(var _=0,A=s.s.r;A<=s.e.r;++A)(x[A]||{}).hidden||(p=O8(n,s,A,v,c,d,l,a),p!=null&&(a.strip&&(p=p.replace(g,"")),(p||a.blankrows!==!1)&&t.push((_++?h:"")+p)));return delete a.dense,t.join("")}function ZC(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=Nm(n,e);return t}function M8(n){var e="",t,a="";if(n==null||n["!ref"]==null)return[];var s=Lt(n["!ref"]),l="",c=[],h,d=[],g=Array.isArray(n);for(h=s.s.c;h<=s.e.c;++h)c[h]=Fn(h);for(var p=s.s.r;p<=s.e.r;++p)for(l=In(p),h=s.s.c;h<=s.e.c;++h)if(e=c[h]+l,t=g?(n[p]||[])[h]:n[e],a="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;a=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}d[d.length]=e+"="+a}return d}function eE(n,e,t){var a=t||{},s=+!a.skipHeader,l=n||{},c=0,h=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var d=typeof a.origin=="string"?mn(a.origin):a.origin;c=d.r,h=d.c}var g,p={s:{c:0,r:0},e:{c:h,r:c+e.length-1+s}};if(l["!ref"]){var v=Lt(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),c==-1&&(c=v.e.r+1,p.e.r=c+e.length-1+s)}else c==-1&&(c=0,p.e.r=e.length-1+s);var T=a.header||[],x=0;e.forEach(function(_,A){Rn(_).forEach(function(B){(x=T.indexOf(B))==-1&&(T[x=T.length]=B);var I=_[B],k="z",z="",X=_t({c:h+x,r:c+A+s});g=tc(l,X),I&&typeof I=="object"&&!(I instanceof Date)?l[X]=I:(typeof I=="number"?k="n":typeof I=="boolean"?k="b":typeof I=="string"?k="s":I instanceof Date?(k="d",a.cellDates||(k="n",I=ar(I)),z=a.dateNF||Vt[14]):I===null&&a.nullError&&(k="e",I=0),g?(g.t=k,g.v=I,delete g.w,delete g.R,z&&(g.z=z)):l[X]=g={t:k,v:I},z&&(g.z=z))})}),p.e.c=Math.max(p.e.c,h+T.length-1);var C=In(c);if(s)for(x=0;x<T.length;++x)l[Fn(x+h)+C]={t:"s",v:T[x]};return l["!ref"]=Zt(p),l}function D8(n,e){return eE(null,n,e)}function tc(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var a=mn(e);return n[a.r]||(n[a.r]=[]),n[a.r][a.c]||(n[a.r][a.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?tc(n,_t(e)):tc(n,_t({r:e,c:t||0}))}function P8(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function F8(){return{SheetNames:[],Sheets:{}}}function L8(n,e,t,a){var s=1;if(!t)for(;s<=65535&&n.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&n.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||t;for(++s;s<=65535&&n.SheetNames.indexOf(t=c+s)!=-1;++s);}if(GC(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function U8(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var a=P8(n,e);switch(n.Workbook.Sheets[a]||(n.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[a].Hidden=t}function B8(n,e){return n.z=e,n}function tE(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function H8(n,e,t){return tE(n,"#"+e,t)}function j8(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function z8(n,e,t,a){for(var s=typeof e!="string"?e:Lt(e),l=typeof e=="string"?e:Zt(e),c=s.s.r;c<=s.e.r;++c)for(var h=s.s.c;h<=s.e.c;++h){var d=tc(n,c,h);d.t="n",d.F=l,delete d.v,c==s.s.r&&h==s.s.c&&(d.f=t,a&&(d.D=!0))}return n}var N0={encode_col:Fn,encode_row:In,encode_cell:_t,encode_range:Zt,decode_col:Tm,decode_row:ym,split_cell:nM,decode_cell:mn,decode_range:Sr,format_cell:ja,sheet_add_aoa:tC,sheet_add_json:eE,sheet_add_dom:YC,aoa_to_sheet:So,json_to_sheet:D8,table_to_sheet:XC,table_to_book:h8,sheet_to_csv:Nm,sheet_to_txt:ZC,sheet_to_json:Ih,sheet_to_html:qC,sheet_to_formulae:M8,sheet_to_row_object_array:Ih,sheet_get_cell:tc,book_new:F8,book_append_sheet:L8,book_set_sheet_visibility:U8,cell_set_number_format:B8,cell_set_hyperlink:tE,cell_set_internal_link:H8,cell_add_comment:j8,sheet_set_array_formula:z8,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function G8(n,e="reporte.xlsx"){const t=n.map(c=>({...c})),a=N0.json_to_sheet(t),s=Object.keys(t[0]??{}).map(c=>{const h=t.reduce((d,g)=>{const p=g?.[c],v=p==null?0:String(p).length;return Math.max(d,v,c.length)},10);return{wch:Math.min(Math.max(h+2,10),60)}});a["!cols"]=s;const l=N0.book_new();N0.book_append_sheet(l,a,"Reporte"),N8(l,e)}const $8=1;function K8(n,e){const[t,a]=K.useState(!1),[s,l]=K.useState(null),[c,h]=K.useState([]),[d,g]=K.useState(0),[p,v]=K.useState(0),[T,x]=K.useState({desde:Sy(),hasta:Sy(),persona:"",tipoVehiculo:""}),C=B=>x(I=>({...I,...B})),_=K.useCallback(async()=>{const B=await e.getAll({filter:"fields/Activa eq 'Activa'",top:2e3,orderby:"fields/Title asc"});let I=0,k=0;for(const X of B){const W=String(X.TipoCelda??"").toLowerCase();W==="carro"?I+=1:W==="moto"&&(k+=1)}const z=I*1+k*$8;g(z)},[e]),A=K.useCallback(async()=>{const{desde:B,hasta:I,persona:k,tipoVehiculo:z}=T,X=["(fields/Status ne 'Cancelada')",`fields/Date ge '${B}'`,`fields/Date le '${I}'`];if(z&&X.push(`fields/VehicleType eq '${String(z).replace(/'/g,"''")}'`),k?.trim()){const G=k.trim().toLowerCase().replace(/'/g,"''");X.push(`(contains(tolower(fields/Title),'${G}') or contains(tolower(fields/NombreUsuario),'${G}'))`)}const N=(await n.getAll({filter:X.join(" and "),orderby:"fields/Date asc,fields/Turn asc",top:2e3})).map(G=>({Id:Number(G.ID??G.Id??0),Fecha:String(G.Date??"").slice(0,10),Turno:String(G.Turn??""),Celda:G.SpotId??String(G.SpotIdLookupId??G.SpotId??""),SpotId:Number(G.SpotIdLookupId??G.SpotId??0),TipoVehiculo:G.VehicleType??G.VehivleType??"",Usuario:String(G.NombreUsuario??G.Title??""),Estado:String(G.Status??"")}));h(N)},[T,n]);return K.useEffect(()=>{if(!d||d<=0){v(0);return}let B=0;for(const k of c){const z=String(k.TipoVehiculo).toLowerCase();B+=1}const I=Math.min(100,Math.round(B/d*100));v(Number.isFinite(I)?I:0)},[c,d]),K.useEffect(()=>{let B=!1;return(async()=>{try{a(!0),l(null),await _(),await A()}catch(I){B||l(I?.message??"Error cargando reportería")}finally{B||a(!1)}})(),()=>{B=!0}},[_,A]),K.useEffect(()=>{let B=!1;return(async()=>{try{a(!0),l(null),await A()}catch(I){B||l(I?.message??"Error cargando reservas")}finally{B||a(!1)}})(),()=>{B=!0}},[A]),{loading:t,error:s,rows:c,aforoPct:p,capacidadTotal:d,filters:T,setFilters:x,onChange:C,loadReservas:A,loadCapacidad:_}}function V8(){const{reservations:n,parkingSlots:e}=pa(),{loading:t,error:a,rows:s,aforoPct:l,capacidadTotal:c,filters:h,onChange:d,loadReservas:g}=K8(n,e);return y.jsxs("section",{className:fn.wrapper,children:[y.jsxs("header",{className:fn.header,children:[y.jsx("h2",{className:fn.title,children:"Reportería de Parqueadero"}),y.jsxs("div",{className:fn.aforo,children:["Aforo (periodo filtrado): ",y.jsxs("strong",{children:[l,"%"]}),!!c&&y.jsxs("span",{className:fn.aforoCap,children:["(Capacidad total: ",c," vehiculos)"]})]})]}),y.jsxs("div",{className:fn.filters,children:[y.jsxs("div",{className:fn.field,children:[y.jsx("label",{children:"Desde"}),y.jsx("input",{type:"date",value:h.desde,onChange:p=>d({desde:p.target.value})})]}),y.jsxs("div",{className:fn.field,children:[y.jsx("label",{children:"Hasta"}),y.jsx("input",{type:"date",value:h.hasta,onChange:p=>d({hasta:p.target.value})})]}),y.jsxs("div",{className:fn.field,children:[y.jsx("label",{children:"Persona (correo o nombre)"}),y.jsx("input",{type:"text",placeholder:"ej: juan@empresa.com",value:h.persona,onChange:p=>d({persona:p.target.value})})]}),y.jsxs("div",{className:fn.field,children:[y.jsx("label",{children:"Tipo de vehículo"}),y.jsxs("select",{value:h.tipoVehiculo,onChange:p=>d({tipoVehiculo:p.target.value}),children:[y.jsx("option",{value:"",children:"Todos"}),y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("div",{className:fn.actions,children:[y.jsx("button",{className:fn.btn,onClick:()=>g(),disabled:t,children:"Aplicar filtros"}),y.jsx("button",{className:fn.btnPrimary,onClick:()=>G8(s,"reporte-parqueadero.xlsx"),disabled:t||s.length===0,children:"Exportar a Excel"})]})]}),t&&y.jsx("div",{className:fn.info,children:"Cargando…"}),a&&y.jsx("div",{className:fn.error,children:a}),!t&&!a&&y.jsx("div",{className:fn.tableWrap,children:y.jsxs("table",{className:fn.table,children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"Fecha"}),y.jsx("th",{children:"Turno"}),y.jsx("th",{children:"Celda"}),y.jsx("th",{children:"Vehículo"}),y.jsx("th",{children:"Usuario"}),y.jsx("th",{children:"Estado"})]})}),y.jsx("tbody",{children:s.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:fn.empty,children:"Sin resultados"})}):s.map(p=>y.jsxs("tr",{children:[y.jsx("td",{children:p.Fecha}),y.jsx("td",{children:p.Turno}),y.jsx("td",{children:p.Celda}),y.jsx("td",{children:p.TipoVehiculo}),y.jsx("td",{children:p.Usuario}),y.jsx("td",{children:p.Estado})]},p.Id))})]})})]})}const Gu=n=>/^\s*\d(?:\s*,\s*\d)*\s*$/.test(String(n??"").trim()),ex=n=>{const e=String(n??"").trim(),t=["Lunes","Martes","Miércoles","Jueves","Viernes","Sábado","Domingo"],a=Number(e);if(Number.isFinite(a)&&a>=1&&a<=7)return t[a-1];const s=e.charAt(0).toUpperCase()+e.slice(1).toLowerCase();return t.includes(s)?s:e};function q8({checked:n,onChange:e}){return y.jsx("button",{onClick:()=>e(!n),role:"switch","aria-checked":n,style:{padding:6,borderRadius:999,width:56,background:n?"#22c55e":"#cbd5e1",border:"none",cursor:"pointer",position:"relative"},title:n?"Desactivar Pico y Placa":"Activar Pico y Placa",children:y.jsx("span",{style:{display:"inline-block",width:22,height:22,borderRadius:"999px",background:"#fff",transition:"transform 150ms",transform:`translateX(${n?28:0}px)`,boxShadow:"0 1px 4px rgba(0,0,0,.2)"}})})}async function Y8(){alert("Se enviará una notificación de cambio de Pico y Placa.")}const X8=()=>{const{picoYPlaca:n,settings:e}=pa(),[t,a]=K.useState([]),[s,l]=K.useState(!0),[c,h]=K.useState(null),[d,g]=K.useState(null),[p,v]=K.useState(null),[T,x]=K.useState(!1),C=!T;K.useEffect(()=>{let I=!1;return(async()=>{try{l(!0),g(null),v(null);const[k,z]=await Promise.all([n.getAll({orderby:"fields/Title asc",top:100}),e.get("1")]);if(I)return;const X=(Array.isArray(k)?k:[]).map(W=>({ID:String(W?.ID??W?.Id??W?.id),Title:String(W?.Title??""),Moto:String(W?.Moto??""),Carro:String(W?.Carro??"")}));a(X),x(!!(z?.PicoPlaca??!1))}catch(k){I||g(k?.message??"No se pudo cargar Pico y Placa.")}finally{I||l(!1)}})(),()=>{I=!0}},[n,e]);const _=K.useMemo(()=>{let I;return k=>{x(k),v(null),g(null),clearTimeout(I),I=setTimeout(async()=>{try{await e.update("1",{PicoPlaca:k}),v(`Pico y Placa ${k?"activado":"desactivado"}.`)}catch(z){g(z?.message??"No se pudo guardar el estado de Pico y Placa."),x(X=>!X)}},400)}},[e]),A=(I,k,z)=>{C||(a(X=>X.map(W=>W.ID===I?{...W,[k]:z}:W)),v(null),g(null))},B=async I=>{if(C)return;const{Moto:k,Carro:z}=I;if(!Gu(k)||!Gu(z)){g('Formato inválido. Usa dígitos separados por comas. Ej: "6,9" o "0,2,4,6,8".');return}h(I.ID),v(null),g(null);try{await n.update(I.ID,{Moto:k,Carro:z}),v(`Fila ${ex(I.Title)} guardada.`)}catch(X){g(X?.message??"No se pudo guardar la fila.")}finally{h(null)}};return s?y.jsx("div",{style:{padding:12},children:"Cargando Pico y Placa…"}):y.jsx("section",{style:{maxWidth:900,margin:"0 auto",display:"grid",gap:12},children:y.jsxs("div",{style:{background:"#fff",borderRadius:12,boxShadow:"0 2px 10px rgba(0,0,0,.08)",padding:16,display:"grid",gap:12},children:[y.jsxs("div",{style:{display:"flex",alignItems:"center",gap:12},children:[y.jsx("h2",{style:{margin:0,fontSize:20,fontWeight:700},children:"Pico y Placa Medellín"}),y.jsx(q8,{checked:T,onChange:_}),y.jsx("span",{style:{fontSize:12,color:"#64748b"},children:T?"Habilitado":"Deshabilitado"})]}),d&&y.jsx("div",{style:{color:"#b91c1c",background:"#fee2e2",padding:8,borderRadius:8},children:d}),p&&y.jsx("div",{style:{color:"#065f46",background:"#d1fae5",padding:8,borderRadius:8},children:p}),y.jsxs("div",{style:{position:"relative"},children:[y.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #e2e8f0",borderRadius:8,overflow:"hidden"},children:[y.jsx("thead",{style:{background:"#f8fafc"},children:y.jsxs("tr",{children:[y.jsx("th",{style:{textAlign:"left",padding:8,borderBottom:"1px solid #e2e8f0"},children:"Día"}),y.jsx("th",{style:{textAlign:"left",padding:8,borderBottom:"1px solid #e2e8f0"},children:"Moto"}),y.jsx("th",{style:{textAlign:"left",padding:8,borderBottom:"1px solid #e2e8f0"},children:"Carro"}),y.jsx("th",{style:{padding:8,borderBottom:"1px solid #e2e8f0"},children:"Acción"})]})}),y.jsx("tbody",{children:t.map(I=>{const k=!Gu(I.Moto),z=!Gu(I.Carro);return y.jsxs("tr",{children:[y.jsx("td",{style:{padding:8,borderBottom:"1px solid #f1f5f9"},children:ex(I.Title)}),y.jsx("td",{style:{padding:8,borderBottom:"1px solid #f1f5f9"},children:y.jsx("input",{value:I.Moto,onChange:X=>A(I.ID,"Moto",X.target.value),placeholder:"ej: 6,9",disabled:C,readOnly:C,style:{width:"100%",borderRadius:8,border:`1px solid ${k?"#ef4444":"#cbd5e1"}`,padding:"6px 8px",outline:"none"}})}),y.jsx("td",{style:{padding:8,borderBottom:"1px solid #f1f5f9"},children:y.jsx("input",{value:I.Carro,onChange:X=>A(I.ID,"Carro",X.target.value),placeholder:"ej: 0,2,4,6,8",disabled:C,readOnly:C,style:{width:"100%",borderRadius:8,border:`1px solid ${z?"#ef4444":"#cbd5e1"}`,padding:"6px 8px",outline:"none"}})}),y.jsx("td",{style:{padding:8,textAlign:"center"},children:y.jsx("button",{onClick:()=>B(I),disabled:C||c===I.ID||k||z,title:C?"Pico y Placa está deshabilitado":k||z?"Formato inválido":"Guardar cambios",style:{padding:"6px 10px",borderRadius:8,border:"none",background:C||k||z?"#cbd5e1":c===I.ID?"#38bdf8":"#0ea5e9",color:"#fff",cursor:C||k||z||c===I.ID?"default":"pointer"},children:c===I.ID?"Guardando…":"Guardar"})})]},I.ID)})})]}),C&&y.jsx("div",{style:{position:"absolute",inset:0,background:"rgba(248,250,252,.7)",display:"grid",placeItems:"center",fontSize:14,color:"#334155"},"aria-hidden":"true",children:"Pico y Placa está deshabilitado"})]}),y.jsx("div",{style:{display:"flex",gap:8,marginTop:8},children:y.jsx("button",{onClick:Y8,disabled:C,style:{padding:"8px 12px",borderRadius:8,border:"1px solid #0ea5e9",background:C?"#f1f5f9":"#fff",color:C?"#94a3b8":"#0ea5e9",cursor:C?"default":"pointer"},title:C?"Habilita Pico y Placa para notificar":"Enviar notificación",children:"Notificar cambio de pico y placa"})}),y.jsxs("p",{style:{fontSize:12,color:"#64748b",marginTop:6},children:["Formato: dígitos 0–9 separados por comas. Ejemplos: ",y.jsx("code",{children:"6,9"}),","," ",y.jsx("code",{children:"0,2,4,6,8"}),"."]})]})})};class W8{graph;constructor(e){this.graph=e}async getMeBasic(){const e=["id","displayName","givenName","surname","mail","userPrincipalName","jobTitle","department","officeLocation","businessPhones","mobilePhone"].join(","),t=await this.graph.get(`/me?$select=${encodeURIComponent(e)}`);return{id:String(t?.id??""),displayName:t?.displayName,givenName:t?.givenName,surname:t?.surname,mail:t?.mail??null,userPrincipalName:t?.userPrincipalName,jobTitle:t?.jobTitle??null,department:t?.department??null,officeLocation:t?.officeLocation??null,businessPhones:Array.isArray(t?.businessPhones)?t.businessPhones:[],mobilePhone:t?.mobilePhone??null}}async getMyPhotoDataUrl(){try{const e=await this.graph.getToken(),t=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return null;const s=await(await t.blob()).arrayBuffer();return`data:image/jpeg;base64,${this.arrayBufferToBase64(s)}`}catch{return null}}arrayBufferToBase64(e){let t="";const a=new Uint8Array(e),s=a.byteLength;for(let l=0;l<s;l++)t+=String.fromCharCode(a[l]);return btoa(t)}}const Q8=[{key:"misreservas",label:"Reservas"},{key:"celdas",label:"Celdas"},{key:"admin",label:"Administración"},{key:"pyp",label:"Pico y placa"},{key:"colaboradores",label:"Colaboradores"},{key:"reportes",label:"Reportes"}];function J8(){const{usuariosParking:n}=pa();return{changeUser:async a=>{const s=(a??"").trim();if(!s)throw new Error("userEmail requerido");const c={filter:`Title eq '${s.replace(/'/g,"''")}'`,top:1},h=await n.getAll(c),g=(Array.isArray(h)?h:[])[0];if(!g)throw new Error(`Usuario no encontrado: ${s}`);const p=g.ID??g.Id??g.id;if(p==null)throw new Error("El usuario no tiene ID");const v=String(g.Rol??g.rol??"").toLowerCase(),T=v==="admin"?"Usuario":"admin";return await n.update(String(p),{Rol:T}),{ok:!0,id:p,email:s,before:v,after:T}},isUserPermitted:async a=>{const s=(a??"").trim();if(!s)return!1;const c={filter:`Title eq '${s.replace(/'/g,"''")}'`,top:1},h=await n.getAll(c),g=(Array.isArray(h)?h:[])[0];if(!g)return!1;const p=g.Permitidos??g.permitidos??g.Permitido;return p===!0||p===1||String(p).toLowerCase()==="true"}}}function Z8(){const[n,e]=K.useState("misreservas"),[t,a]=K.useState(null),[s,l]=K.useState(!0),[c,h]=K.useState(null),[d,g]=K.useState(!1),[p,v]=K.useState(!1),{graph:T,shared:x}=pa(),C=K.useMemo(()=>new W8(T),[T]),{signOut:_}=xo(),{changeUser:A,isUserPermitted:B}=J8(),{settings:I}=pa(),k=async()=>{if(!(!t?.mail||d))try{g(!0);const{after:W}=await A(t.mail);h(W.toLowerCase())}catch(W){console.error(W)}finally{g(!1)}};K.useEffect(()=>{let W=!1;return l(!0),(async()=>{try{const N=await C.getMeBasic();if(W)return;a({displayName:N.displayName??void 0,mail:N.mail??N.userPrincipalName??void 0,jobTitle:N.jobTitle??void 0})}catch(N){W||a(null),console.error(N)}finally{W||l(!1)}})(),()=>{W=!0}},[C]),K.useEffect(()=>{h(null)},[t?.mail]),K.useEffect(()=>{const W=t?.mail;if(!W)return;let N=!1;return(async()=>{try{const G=await x.getRole(W);N||(h(G),G==="admin"&&e(V=>V??"misreservas"))}catch(G){console.error(G),N||h("usuario")}})(),()=>{N=!0}},[t?.mail,x]),K.useEffect(()=>{let W=!1;return(async()=>{if(!t?.mail){v(!1);return}try{const N=await B(t.mail);W||v(N)}catch{W||v(!1)}})(),()=>{W=!0}},[t?.mail,B]);const z=c==="admin",X=W=>e(W);return s||c===null?y.jsx("div",{className:"center muted",style:{padding:24},children:"Cargando permisos…"}):y.jsx($R,{children:y.jsxs("div",{className:"page",children:[y.jsx("div",{className:"section userCard",children:y.jsxs("div",{className:"userRow",children:[y.jsx("div",{className:"brand",children:y.jsx("h1",{children:"PARKING EDM"})}),y.jsxs("div",{className:"userCluster",children:[y.jsx("div",{className:"avatar",children:t?.displayName?t.displayName[0]:y.jsx("span",{children:"?"})}),y.jsx("div",{className:"userInfo",children:t?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"userName",children:t.displayName}),y.jsx("div",{className:"userMail",children:t.mail}),y.jsx("div",{className:"userMail",children:z?"admin":"usuario"}),t.jobTitle&&y.jsx("div",{className:"userTitle",children:t.jobTitle})]}):y.jsx("div",{className:"errorText",children:"No se pudo cargar el usuario"})}),y.jsx("div",{style:{marginLeft:"auto"},children:y.jsx("button",{className:"btn-change-role",onClick:_,children:"Cerrar sesión"})})]})]})}),z&&y.jsx("nav",{className:"nav",children:Q8.map(W=>y.jsx("button",{onClick:()=>X(W.key),className:"navBtn",style:{background:n===W.key?"#38bdf8":"#fff",color:n===W.key?"#fff":"#2563eb",boxShadow:n===W.key?"0 2px 8px #38bdf855":"none"},children:W.label},W.key))}),y.jsxs("main",{className:"main",children:[!z&&t?.mail&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Reservar Parqueadero"}),y.jsx(qR,{userEmail:t.mail,userName:t.displayName})]}),y.jsx(lT,{userMail:t.mail,isAdmin:!1})]}),z&&n==="misreservas"&&t?.mail&&y.jsx(lT,{userMail:t.mail,isAdmin:!0}),z&&n==="celdas"&&y.jsx(Ck,{}),z&&n==="admin"&&y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Administración"}),y.jsx(Nk,{settingsSvc:I})]}),z&&n==="colaboradores"&&y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Colaboradores"}),y.jsx(UO,{})]}),z&&n==="reportes"&&y.jsx(V8,{}),z&&n==="pyp"&&y.jsx("div",{className:"center",children:y.jsx(X8,{})}),y.jsx("br",{}),p&&y.jsx("button",{onClick:k,disabled:!t?.mail||d,className:"btn-change-role","aria-busy":d||void 0,children:d?"Actualizando…":"Cambiar rol"})]})]})})}function eL(){const{ready:n,account:e,signIn:t}=xo();return n?e?y.jsx(DR,{children:y.jsx(Z8,{})}):y.jsxs("div",{className:"page",children:[y.jsx("div",{className:"section userCard",children:y.jsx("div",{className:"userRow",children:y.jsx("div",{className:"brand",children:y.jsx("h1",{children:"PARKING EDM"})})})}),y.jsx("main",{className:"main",children:y.jsxs("div",{className:"center",style:{display:"grid",gap:12},children:[y.jsx("h2",{children:"Inicia sesión para continuar"}),y.jsx("button",{className:"btn-change-role",onClick:t,children:"Iniciar sesión"}),y.jsx("small",{className:"muted",children:"Si tu navegador bloquea la ventana emergente, habilítala para este sitio."})]})})]}):y.jsx("div",{className:"center muted",style:{padding:24},children:"Conectando…"})}mw.createRoot(document.getElementById("root")).render(y.jsx(K.StrictMode,{children:y.jsx(IR,{children:y.jsx(eL,{})})}));
