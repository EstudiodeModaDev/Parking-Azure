(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))a(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function t(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function a(s){if(s.ep)return;s.ep=!0;const l=t(s);fetch(s.href,l)}})();var u0={exports:{}},wl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uy;function cw(){if(uy)return wl;uy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(a,s,l){var c=null;if(l!==void 0&&(c=""+l),s.key!==void 0&&(c=""+s.key),"key"in s){l={};for(var h in s)h!=="key"&&(l[h]=s[h])}else l=s;return s=l.ref,{$$typeof:n,type:a,key:c,ref:s!==void 0?s:null,props:l}}return wl.Fragment=e,wl.jsx=t,wl.jsxs=t,wl}var hy;function uw(){return hy||(hy=1,u0.exports=cw()),u0.exports}var y=uw(),h0={exports:{}},Ze={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fy;function hw(){if(fy)return Ze;fy=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),a=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),v=Symbol.iterator;function _(U){return U===null||typeof U!="object"?null:(U=v&&U[v]||U["@@iterator"],typeof U=="function"?U:null)}var T={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,x={};function A(U,ue,b){this.props=U,this.context=ue,this.refs=x,this.updater=b||T}A.prototype.isReactComponent={},A.prototype.setState=function(U,ue){if(typeof U!="object"&&typeof U!="function"&&U!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,U,ue,"setState")},A.prototype.forceUpdate=function(U){this.updater.enqueueForceUpdate(this,U,"forceUpdate")};function B(){}B.prototype=A.prototype;function k(U,ue,b){this.props=U,this.context=ue,this.refs=x,this.updater=b||T}var O=k.prototype=new B;O.constructor=k,C(O,A.prototype),O.isPureReactComponent=!0;var j=Array.isArray,H={H:null,A:null,T:null,S:null,V:null},Y=Object.prototype.hasOwnProperty;function I(U,ue,b,L,P,K){return b=K.ref,{$$typeof:n,type:U,key:ue,ref:b!==void 0?b:null,props:K}}function G(U,ue){return I(U.type,ue,void 0,void 0,void 0,U.props)}function q(U){return typeof U=="object"&&U!==null&&U.$$typeof===n}function ie(U){var ue={"=":"=0",":":"=2"};return"$"+U.replace(/[=:]/g,function(b){return ue[b]})}var J=/\/+/g;function he(U,ue){return typeof U=="object"&&U!==null&&U.key!=null?ie(""+U.key):ue.toString(36)}function Ae(){}function je(U){switch(U.status){case"fulfilled":return U.value;case"rejected":throw U.reason;default:switch(typeof U.status=="string"?U.then(Ae,Ae):(U.status="pending",U.then(function(ue){U.status==="pending"&&(U.status="fulfilled",U.value=ue)},function(ue){U.status==="pending"&&(U.status="rejected",U.reason=ue)})),U.status){case"fulfilled":return U.value;case"rejected":throw U.reason}}throw U}function ke(U,ue,b,L,P){var K=typeof U;(K==="undefined"||K==="boolean")&&(U=null);var Z=!1;if(U===null)Z=!0;else switch(K){case"bigint":case"string":case"number":Z=!0;break;case"object":switch(U.$$typeof){case n:case e:Z=!0;break;case p:return Z=U._init,ke(Z(U._payload),ue,b,L,P)}}if(Z)return P=P(U),Z=L===""?"."+he(U,0):L,j(P)?(b="",Z!=null&&(b=Z.replace(J,"$&/")+"/"),ke(P,ue,b,"",function(Pe){return Pe})):P!=null&&(q(P)&&(P=G(P,b+(P.key==null||U&&U.key===P.key?"":(""+P.key).replace(J,"$&/")+"/")+Z)),ue.push(P)),1;Z=0;var be=L===""?".":L+":";if(j(U))for(var Ce=0;Ce<U.length;Ce++)L=U[Ce],K=be+he(L,Ce),Z+=ke(L,ue,b,K,P);else if(Ce=_(U),typeof Ce=="function")for(U=Ce.call(U),Ce=0;!(L=U.next()).done;)L=L.value,K=be+he(L,Ce++),Z+=ke(L,ue,b,K,P);else if(K==="object"){if(typeof U.then=="function")return ke(je(U),ue,b,L,P);throw ue=String(U),Error("Objects are not valid as a React child (found: "+(ue==="[object Object]"?"object with keys {"+Object.keys(U).join(", ")+"}":ue)+"). If you meant to render a collection of children, use an array instead.")}return Z}function re(U,ue,b){if(U==null)return U;var L=[],P=0;return ke(U,L,"","",function(K){return ue.call(b,K,P++)}),L}function xe(U){if(U._status===-1){var ue=U._result;ue=ue(),ue.then(function(b){(U._status===0||U._status===-1)&&(U._status=1,U._result=b)},function(b){(U._status===0||U._status===-1)&&(U._status=2,U._result=b)}),U._status===-1&&(U._status=0,U._result=ue)}if(U._status===1)return U._result.default;throw U._result}var fe=typeof reportError=="function"?reportError:function(U){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ue=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof U=="object"&&U!==null&&typeof U.message=="string"?String(U.message):String(U),error:U});if(!window.dispatchEvent(ue))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",U);return}console.error(U)};function Te(){}return Ze.Children={map:re,forEach:function(U,ue,b){re(U,function(){ue.apply(this,arguments)},b)},count:function(U){var ue=0;return re(U,function(){ue++}),ue},toArray:function(U){return re(U,function(ue){return ue})||[]},only:function(U){if(!q(U))throw Error("React.Children.only expected to receive a single React element child.");return U}},Ze.Component=A,Ze.Fragment=t,Ze.Profiler=s,Ze.PureComponent=k,Ze.StrictMode=a,Ze.Suspense=d,Ze.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=H,Ze.__COMPILER_RUNTIME={__proto__:null,c:function(U){return H.H.useMemoCache(U)}},Ze.cache=function(U){return function(){return U.apply(null,arguments)}},Ze.cloneElement=function(U,ue,b){if(U==null)throw Error("The argument must be a React element, but you passed "+U+".");var L=C({},U.props),P=U.key,K=void 0;if(ue!=null)for(Z in ue.ref!==void 0&&(K=void 0),ue.key!==void 0&&(P=""+ue.key),ue)!Y.call(ue,Z)||Z==="key"||Z==="__self"||Z==="__source"||Z==="ref"&&ue.ref===void 0||(L[Z]=ue[Z]);var Z=arguments.length-2;if(Z===1)L.children=b;else if(1<Z){for(var be=Array(Z),Ce=0;Ce<Z;Ce++)be[Ce]=arguments[Ce+2];L.children=be}return I(U.type,P,void 0,void 0,K,L)},Ze.createContext=function(U){return U={$$typeof:c,_currentValue:U,_currentValue2:U,_threadCount:0,Provider:null,Consumer:null},U.Provider=U,U.Consumer={$$typeof:l,_context:U},U},Ze.createElement=function(U,ue,b){var L,P={},K=null;if(ue!=null)for(L in ue.key!==void 0&&(K=""+ue.key),ue)Y.call(ue,L)&&L!=="key"&&L!=="__self"&&L!=="__source"&&(P[L]=ue[L]);var Z=arguments.length-2;if(Z===1)P.children=b;else if(1<Z){for(var be=Array(Z),Ce=0;Ce<Z;Ce++)be[Ce]=arguments[Ce+2];P.children=be}if(U&&U.defaultProps)for(L in Z=U.defaultProps,Z)P[L]===void 0&&(P[L]=Z[L]);return I(U,K,void 0,void 0,null,P)},Ze.createRef=function(){return{current:null}},Ze.forwardRef=function(U){return{$$typeof:h,render:U}},Ze.isValidElement=q,Ze.lazy=function(U){return{$$typeof:p,_payload:{_status:-1,_result:U},_init:xe}},Ze.memo=function(U,ue){return{$$typeof:g,type:U,compare:ue===void 0?null:ue}},Ze.startTransition=function(U){var ue=H.T,b={};H.T=b;try{var L=U(),P=H.S;P!==null&&P(b,L),typeof L=="object"&&L!==null&&typeof L.then=="function"&&L.then(Te,fe)}catch(K){fe(K)}finally{H.T=ue}},Ze.unstable_useCacheRefresh=function(){return H.H.useCacheRefresh()},Ze.use=function(U){return H.H.use(U)},Ze.useActionState=function(U,ue,b){return H.H.useActionState(U,ue,b)},Ze.useCallback=function(U,ue){return H.H.useCallback(U,ue)},Ze.useContext=function(U){return H.H.useContext(U)},Ze.useDebugValue=function(){},Ze.useDeferredValue=function(U,ue){return H.H.useDeferredValue(U,ue)},Ze.useEffect=function(U,ue,b){var L=H.H;if(typeof b=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return L.useEffect(U,ue)},Ze.useId=function(){return H.H.useId()},Ze.useImperativeHandle=function(U,ue,b){return H.H.useImperativeHandle(U,ue,b)},Ze.useInsertionEffect=function(U,ue){return H.H.useInsertionEffect(U,ue)},Ze.useLayoutEffect=function(U,ue){return H.H.useLayoutEffect(U,ue)},Ze.useMemo=function(U,ue){return H.H.useMemo(U,ue)},Ze.useOptimistic=function(U,ue){return H.H.useOptimistic(U,ue)},Ze.useReducer=function(U,ue,b){return H.H.useReducer(U,ue,b)},Ze.useRef=function(U){return H.H.useRef(U)},Ze.useState=function(U){return H.H.useState(U)},Ze.useSyncExternalStore=function(U,ue,b){return H.H.useSyncExternalStore(U,ue,b)},Ze.useTransition=function(){return H.H.useTransition()},Ze.version="19.1.1",Ze}var dy;function eg(){return dy||(dy=1,h0.exports=hw()),h0.exports}var V=eg(),f0={exports:{}},bl={},d0={exports:{}},g0={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gy;function fw(){return gy||(gy=1,(function(n){function e(re,xe){var fe=re.length;re.push(xe);e:for(;0<fe;){var Te=fe-1>>>1,U=re[Te];if(0<s(U,xe))re[Te]=xe,re[fe]=U,fe=Te;else break e}}function t(re){return re.length===0?null:re[0]}function a(re){if(re.length===0)return null;var xe=re[0],fe=re.pop();if(fe!==xe){re[0]=fe;e:for(var Te=0,U=re.length,ue=U>>>1;Te<ue;){var b=2*(Te+1)-1,L=re[b],P=b+1,K=re[P];if(0>s(L,fe))P<U&&0>s(K,L)?(re[Te]=K,re[P]=fe,Te=P):(re[Te]=L,re[b]=fe,Te=b);else if(P<U&&0>s(K,fe))re[Te]=K,re[P]=fe,Te=P;else break e}}return xe}function s(re,xe){var fe=re.sortIndex-xe.sortIndex;return fe!==0?fe:re.id-xe.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;n.unstable_now=function(){return l.now()}}else{var c=Date,h=c.now();n.unstable_now=function(){return c.now()-h}}var d=[],g=[],p=1,v=null,_=3,T=!1,C=!1,x=!1,A=!1,B=typeof setTimeout=="function"?setTimeout:null,k=typeof clearTimeout=="function"?clearTimeout:null,O=typeof setImmediate<"u"?setImmediate:null;function j(re){for(var xe=t(g);xe!==null;){if(xe.callback===null)a(g);else if(xe.startTime<=re)a(g),xe.sortIndex=xe.expirationTime,e(d,xe);else break;xe=t(g)}}function H(re){if(x=!1,j(re),!C)if(t(d)!==null)C=!0,Y||(Y=!0,he());else{var xe=t(g);xe!==null&&ke(H,xe.startTime-re)}}var Y=!1,I=-1,G=5,q=-1;function ie(){return A?!0:!(n.unstable_now()-q<G)}function J(){if(A=!1,Y){var re=n.unstable_now();q=re;var xe=!0;try{e:{C=!1,x&&(x=!1,k(I),I=-1),T=!0;var fe=_;try{t:{for(j(re),v=t(d);v!==null&&!(v.expirationTime>re&&ie());){var Te=v.callback;if(typeof Te=="function"){v.callback=null,_=v.priorityLevel;var U=Te(v.expirationTime<=re);if(re=n.unstable_now(),typeof U=="function"){v.callback=U,j(re),xe=!0;break t}v===t(d)&&a(d),j(re)}else a(d);v=t(d)}if(v!==null)xe=!0;else{var ue=t(g);ue!==null&&ke(H,ue.startTime-re),xe=!1}}break e}finally{v=null,_=fe,T=!1}xe=void 0}}finally{xe?he():Y=!1}}}var he;if(typeof O=="function")he=function(){O(J)};else if(typeof MessageChannel<"u"){var Ae=new MessageChannel,je=Ae.port2;Ae.port1.onmessage=J,he=function(){je.postMessage(null)}}else he=function(){B(J,0)};function ke(re,xe){I=B(function(){re(n.unstable_now())},xe)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(re){re.callback=null},n.unstable_forceFrameRate=function(re){0>re||125<re?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<re?Math.floor(1e3/re):5},n.unstable_getCurrentPriorityLevel=function(){return _},n.unstable_next=function(re){switch(_){case 1:case 2:case 3:var xe=3;break;default:xe=_}var fe=_;_=xe;try{return re()}finally{_=fe}},n.unstable_requestPaint=function(){A=!0},n.unstable_runWithPriority=function(re,xe){switch(re){case 1:case 2:case 3:case 4:case 5:break;default:re=3}var fe=_;_=re;try{return xe()}finally{_=fe}},n.unstable_scheduleCallback=function(re,xe,fe){var Te=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Te+fe:Te):fe=Te,re){case 1:var U=-1;break;case 2:U=250;break;case 5:U=1073741823;break;case 4:U=1e4;break;default:U=5e3}return U=fe+U,re={id:p++,callback:xe,priorityLevel:re,startTime:fe,expirationTime:U,sortIndex:-1},fe>Te?(re.sortIndex=fe,e(g,re),t(d)===null&&re===t(g)&&(x?(k(I),I=-1):x=!0,ke(H,fe-Te))):(re.sortIndex=U,e(d,re),C||T||(C=!0,Y||(Y=!0,he()))),re},n.unstable_shouldYield=ie,n.unstable_wrapCallback=function(re){var xe=_;return function(){var fe=_;_=xe;try{return re.apply(this,arguments)}finally{_=fe}}}})(g0)),g0}var my;function dw(){return my||(my=1,d0.exports=fw()),d0.exports}var m0={exports:{}},Pn={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var py;function gw(){if(py)return Pn;py=1;var n=eg();function e(d){var g="https://react.dev/errors/"+d;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)g+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var a={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},s=Symbol.for("react.portal");function l(d,g,p){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:v==null?null:""+v,children:d,containerInfo:g,implementation:p}}var c=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function h(d,g){if(d==="font")return"";if(typeof g=="string")return g==="use-credentials"?g:""}return Pn.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=a,Pn.createPortal=function(d,g){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!g||g.nodeType!==1&&g.nodeType!==9&&g.nodeType!==11)throw Error(e(299));return l(d,g,null,p)},Pn.flushSync=function(d){var g=c.T,p=a.p;try{if(c.T=null,a.p=2,d)return d()}finally{c.T=g,a.p=p,a.d.f()}},Pn.preconnect=function(d,g){typeof d=="string"&&(g?(g=g.crossOrigin,g=typeof g=="string"?g==="use-credentials"?g:"":void 0):g=null,a.d.C(d,g))},Pn.prefetchDNS=function(d){typeof d=="string"&&a.d.D(d)},Pn.preinit=function(d,g){if(typeof d=="string"&&g&&typeof g.as=="string"){var p=g.as,v=h(p,g.crossOrigin),_=typeof g.integrity=="string"?g.integrity:void 0,T=typeof g.fetchPriority=="string"?g.fetchPriority:void 0;p==="style"?a.d.S(d,typeof g.precedence=="string"?g.precedence:void 0,{crossOrigin:v,integrity:_,fetchPriority:T}):p==="script"&&a.d.X(d,{crossOrigin:v,integrity:_,fetchPriority:T,nonce:typeof g.nonce=="string"?g.nonce:void 0})}},Pn.preinitModule=function(d,g){if(typeof d=="string")if(typeof g=="object"&&g!==null){if(g.as==null||g.as==="script"){var p=h(g.as,g.crossOrigin);a.d.M(d,{crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0})}}else g==null&&a.d.M(d)},Pn.preload=function(d,g){if(typeof d=="string"&&typeof g=="object"&&g!==null&&typeof g.as=="string"){var p=g.as,v=h(p,g.crossOrigin);a.d.L(d,p,{crossOrigin:v,integrity:typeof g.integrity=="string"?g.integrity:void 0,nonce:typeof g.nonce=="string"?g.nonce:void 0,type:typeof g.type=="string"?g.type:void 0,fetchPriority:typeof g.fetchPriority=="string"?g.fetchPriority:void 0,referrerPolicy:typeof g.referrerPolicy=="string"?g.referrerPolicy:void 0,imageSrcSet:typeof g.imageSrcSet=="string"?g.imageSrcSet:void 0,imageSizes:typeof g.imageSizes=="string"?g.imageSizes:void 0,media:typeof g.media=="string"?g.media:void 0})}},Pn.preloadModule=function(d,g){if(typeof d=="string")if(g){var p=h(g.as,g.crossOrigin);a.d.m(d,{as:typeof g.as=="string"&&g.as!=="script"?g.as:void 0,crossOrigin:p,integrity:typeof g.integrity=="string"?g.integrity:void 0})}else a.d.m(d)},Pn.requestFormReset=function(d){a.d.r(d)},Pn.unstable_batchedUpdates=function(d,g){return d(g)},Pn.useFormState=function(d,g,p){return c.H.useFormState(d,g,p)},Pn.useFormStatus=function(){return c.H.useHostTransitionStatus()},Pn.version="19.1.1",Pn}var vy;function n_(){if(vy)return m0.exports;vy=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),m0.exports=gw(),m0.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yy;function mw(){if(yy)return bl;yy=1;var n=dw(),e=eg(),t=n_();function a(r){var i="https://react.dev/errors/"+r;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var o=2;o<arguments.length;o++)i+="&args[]="+encodeURIComponent(arguments[o])}return"Minified React error #"+r+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(r){return!(!r||r.nodeType!==1&&r.nodeType!==9&&r.nodeType!==11)}function l(r){var i=r,o=r;if(r.alternate)for(;i.return;)i=i.return;else{r=i;do i=r,(i.flags&4098)!==0&&(o=i.return),r=i.return;while(r)}return i.tag===3?o:null}function c(r){if(r.tag===13){var i=r.memoizedState;if(i===null&&(r=r.alternate,r!==null&&(i=r.memoizedState)),i!==null)return i.dehydrated}return null}function h(r){if(l(r)!==r)throw Error(a(188))}function d(r){var i=r.alternate;if(!i){if(i=l(r),i===null)throw Error(a(188));return i!==r?null:r}for(var o=r,u=i;;){var f=o.return;if(f===null)break;var m=f.alternate;if(m===null){if(u=f.return,u!==null){o=u;continue}break}if(f.child===m.child){for(m=f.child;m;){if(m===o)return h(f),r;if(m===u)return h(f),i;m=m.sibling}throw Error(a(188))}if(o.return!==u.return)o=f,u=m;else{for(var S=!1,w=f.child;w;){if(w===o){S=!0,o=f,u=m;break}if(w===u){S=!0,u=f,o=m;break}w=w.sibling}if(!S){for(w=m.child;w;){if(w===o){S=!0,o=m,u=f;break}if(w===u){S=!0,u=m,o=f;break}w=w.sibling}if(!S)throw Error(a(189))}}if(o.alternate!==u)throw Error(a(190))}if(o.tag!==3)throw Error(a(188));return o.stateNode.current===o?r:i}function g(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r;for(r=r.child;r!==null;){if(i=g(r),i!==null)return i;r=r.sibling}return null}var p=Object.assign,v=Symbol.for("react.element"),_=Symbol.for("react.transitional.element"),T=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),x=Symbol.for("react.strict_mode"),A=Symbol.for("react.profiler"),B=Symbol.for("react.provider"),k=Symbol.for("react.consumer"),O=Symbol.for("react.context"),j=Symbol.for("react.forward_ref"),H=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),I=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),q=Symbol.for("react.activity"),ie=Symbol.for("react.memo_cache_sentinel"),J=Symbol.iterator;function he(r){return r===null||typeof r!="object"?null:(r=J&&r[J]||r["@@iterator"],typeof r=="function"?r:null)}var Ae=Symbol.for("react.client.reference");function je(r){if(r==null)return null;if(typeof r=="function")return r.$$typeof===Ae?null:r.displayName||r.name||null;if(typeof r=="string")return r;switch(r){case C:return"Fragment";case A:return"Profiler";case x:return"StrictMode";case H:return"Suspense";case Y:return"SuspenseList";case q:return"Activity"}if(typeof r=="object")switch(r.$$typeof){case T:return"Portal";case O:return(r.displayName||"Context")+".Provider";case k:return(r._context.displayName||"Context")+".Consumer";case j:var i=r.render;return r=r.displayName,r||(r=i.displayName||i.name||"",r=r!==""?"ForwardRef("+r+")":"ForwardRef"),r;case I:return i=r.displayName||null,i!==null?i:je(r.type)||"Memo";case G:i=r._payload,r=r._init;try{return je(r(i))}catch{}}return null}var ke=Array.isArray,re=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,xe=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Te=[],U=-1;function ue(r){return{current:r}}function b(r){0>U||(r.current=Te[U],Te[U]=null,U--)}function L(r,i){U++,Te[U]=r.current,r.current=i}var P=ue(null),K=ue(null),Z=ue(null),be=ue(null);function Ce(r,i){switch(L(Z,i),L(K,r),L(P,null),i.nodeType){case 9:case 11:r=(r=i.documentElement)&&(r=r.namespaceURI)?Uv(r):0;break;default:if(r=i.tagName,i=i.namespaceURI)i=Uv(i),r=Bv(i,r);else switch(r){case"svg":r=1;break;case"math":r=2;break;default:r=0}}b(P),L(P,r)}function Pe(){b(P),b(K),b(Z)}function De(r){r.memoizedState!==null&&L(be,r);var i=P.current,o=Bv(i,r.type);i!==o&&(L(K,r),L(P,o))}function lt(r){K.current===r&&(b(P),b(K)),be.current===r&&(b(be),xl._currentValue=fe)}var et=Object.prototype.hasOwnProperty,zt=n.unstable_scheduleCallback,ct=n.unstable_cancelCallback,Hn=n.unstable_shouldYield,Ot=n.unstable_requestPaint,Fe=n.unstable_now,On=n.unstable_getCurrentPriorityLevel,jn=n.unstable_ImmediatePriority,wr=n.unstable_UserBlockingPriority,lr=n.unstable_NormalPriority,Me=n.unstable_LowPriority,Mt=n.unstable_IdlePriority,yn=n.log,zn=n.unstable_setDisableYieldValue,Gn=null,Tn=null;function Mn(r){if(typeof yn=="function"&&zn(r),Tn&&typeof Tn.setStrictMode=="function")try{Tn.setStrictMode(Gn,r)}catch{}}var $n=Math.clz32?Math.clz32:mc,dc=Math.log,gc=Math.LN2;function mc(r){return r>>>=0,r===0?32:31-(dc(r)/gc|0)|0}var ki=256,Oi=4194304;function ra(r){var i=r&42;if(i!==0)return i;switch(r&-r){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return r&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return r&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return r}}function vs(r,i,o){var u=r.pendingLanes;if(u===0)return 0;var f=0,m=r.suspendedLanes,S=r.pingedLanes;r=r.warmLanes;var w=u&134217727;return w!==0?(u=w&~m,u!==0?f=ra(u):(S&=w,S!==0?f=ra(S):o||(o=w&~r,o!==0&&(f=ra(o))))):(w=u&~m,w!==0?f=ra(w):S!==0?f=ra(S):o||(o=u&~r,o!==0&&(f=ra(o)))),f===0?0:i!==0&&i!==f&&(i&m)===0&&(m=f&-f,o=i&-i,m>=o||m===32&&(o&4194048)!==0)?i:f}function Mi(r,i){return(r.pendingLanes&~(r.suspendedLanes&~r.pingedLanes)&i)===0}function pc(r,i){switch(r){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Io(){var r=ki;return ki<<=1,(ki&4194048)===0&&(ki=256),r}function Ro(){var r=Oi;return Oi<<=1,(Oi&62914560)===0&&(Oi=4194304),r}function No(r){for(var i=[],o=0;31>o;o++)i.push(r);return i}function Di(r,i){r.pendingLanes|=i,i!==268435456&&(r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0)}function ys(r,i,o,u,f,m){var S=r.pendingLanes;r.pendingLanes=o,r.suspendedLanes=0,r.pingedLanes=0,r.warmLanes=0,r.expiredLanes&=o,r.entangledLanes&=o,r.errorRecoveryDisabledLanes&=o,r.shellSuspendCounter=0;var w=r.entanglements,z=r.expirationTimes,ne=r.hiddenUpdates;for(o=S&~o;0<o;){var me=31-$n(o),_e=1<<me;w[me]=0,z[me]=-1;var oe=ne[me];if(oe!==null)for(ne[me]=null,me=0;me<oe.length;me++){var ce=oe[me];ce!==null&&(ce.lane&=-536870913)}o&=~_e}u!==0&&vc(r,u,0),m!==0&&f===0&&r.tag!==0&&(r.suspendedLanes|=m&~(S&~i))}function vc(r,i,o){r.pendingLanes|=i,r.suspendedLanes&=~i;var u=31-$n(i);r.entangledLanes|=i,r.entanglements[u]=r.entanglements[u]|1073741824|o&4194090}function yc(r,i){var o=r.entangledLanes|=i;for(r=r.entanglements;o;){var u=31-$n(o),f=1<<u;f&i|r[u]&i&&(r[u]|=i),o&=~f}}function ko(r){switch(r){case 2:r=1;break;case 8:r=4;break;case 32:r=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:r=128;break;case 268435456:r=134217728;break;default:r=0}return r}function Oo(r){return r&=-r,2<r?8<r?(r&134217727)!==0?32:268435456:8:2}function Tc(){var r=xe.p;return r!==0?r:(r=window.event,r===void 0?32:ay(r.type))}function af(r,i){var o=xe.p;try{return xe.p=r,i()}finally{xe.p=o}}var aa=Math.random().toString(36).slice(2),ln="__reactFiber$"+aa,cn="__reactProps$"+aa,$a="__reactContainer$"+aa,Mo="__reactEvents$"+aa,sf="__reactListeners$"+aa,E="__reactHandles$"+aa,D="__reactResources$"+aa,R="__reactMarker$"+aa;function N(r){delete r[ln],delete r[cn],delete r[Mo],delete r[sf],delete r[E]}function M(r){var i=r[ln];if(i)return i;for(var o=r.parentNode;o;){if(i=o[$a]||o[ln]){if(o=i.alternate,i.child!==null||o!==null&&o.child!==null)for(r=Gv(r);r!==null;){if(o=r[ln])return o;r=Gv(r)}return i}r=o,o=r.parentNode}return null}function F(r){if(r=r[ln]||r[$a]){var i=r.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return r}return null}function ae(r){var i=r.tag;if(i===5||i===26||i===27||i===6)return r.stateNode;throw Error(a(33))}function de(r){var i=r[D];return i||(i=r[D]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function ee(r){r[R]=!0}var se=new Set,le={};function Ee(r,i){Re(r,i),Re(r+"Capture",i)}function Re(r,i){for(le[r]=i,r=0;r<i.length;r++)se.add(i[r])}var Be=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Ie={},Le={};function We(r){return et.call(Le,r)?!0:et.call(Ie,r)?!1:Be.test(r)?Le[r]=!0:(Ie[r]=!0,!1)}function Ct(r,i,o){if(We(i))if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":r.removeAttribute(i);return;case"boolean":var u=i.toLowerCase().slice(0,5);if(u!=="data-"&&u!=="aria-"){r.removeAttribute(i);return}}r.setAttribute(i,""+o)}}function Et(r,i,o){if(o===null)r.removeAttribute(i);else{switch(typeof o){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(i);return}r.setAttribute(i,""+o)}}function Ft(r,i,o,u){if(u===null)r.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":r.removeAttribute(o);return}r.setAttributeNS(i,o,""+u)}}var Ta,Ka;function br(r){if(Ta===void 0)try{throw Error()}catch(o){var i=o.stack.trim().match(/\n( *(at )?)/);Ta=i&&i[1]||"",Ka=-1<o.stack.indexOf(`
    at`)?" (<anonymous>)":-1<o.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Ta+r+Ka}var zr=!1;function Pi(r,i){if(!r||zr)return"";zr=!0;var o=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var u={DetermineComponentFrameRoot:function(){try{if(i){var _e=function(){throw Error()};if(Object.defineProperty(_e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(_e,[])}catch(ce){var oe=ce}Reflect.construct(r,[],_e)}else{try{_e.call()}catch(ce){oe=ce}r.call(_e.prototype)}}else{try{throw Error()}catch(ce){oe=ce}(_e=r())&&typeof _e.catch=="function"&&_e.catch(function(){})}}catch(ce){if(ce&&oe&&typeof ce.stack=="string")return[ce.stack,oe.stack]}return[null,null]}};u.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var f=Object.getOwnPropertyDescriptor(u.DetermineComponentFrameRoot,"name");f&&f.configurable&&Object.defineProperty(u.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=u.DetermineComponentFrameRoot(),S=m[0],w=m[1];if(S&&w){var z=S.split(`
`),ne=w.split(`
`);for(f=u=0;u<z.length&&!z[u].includes("DetermineComponentFrameRoot");)u++;for(;f<ne.length&&!ne[f].includes("DetermineComponentFrameRoot");)f++;if(u===z.length||f===ne.length)for(u=z.length-1,f=ne.length-1;1<=u&&0<=f&&z[u]!==ne[f];)f--;for(;1<=u&&0<=f;u--,f--)if(z[u]!==ne[f]){if(u!==1||f!==1)do if(u--,f--,0>f||z[u]!==ne[f]){var me=`
`+z[u].replace(" at new "," at ");return r.displayName&&me.includes("<anonymous>")&&(me=me.replace("<anonymous>",r.displayName)),me}while(1<=u&&0<=f);break}}}finally{zr=!1,Error.prepareStackTrace=o}return(o=r?r.displayName||r.name:"")?br(o):""}function Gr(r){switch(r.tag){case 26:case 27:case 5:return br(r.type);case 16:return br("Lazy");case 13:return br("Suspense");case 19:return br("SuspenseList");case 0:case 15:return Pi(r.type,!1);case 11:return Pi(r.type.render,!1);case 1:return Pi(r.type,!0);case 31:return br("Activity");default:return""}}function Om(r){try{var i="";do i+=Gr(r),r=r.return;while(r);return i}catch(o){return`
Error generating stack: `+o.message+`
`+o.stack}}function Ir(r){switch(typeof r){case"bigint":case"boolean":case"number":case"string":case"undefined":return r;case"object":return r;default:return""}}function Mm(r){var i=r.type;return(r=r.nodeName)&&r.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function aE(r){var i=Mm(r)?"checked":"value",o=Object.getOwnPropertyDescriptor(r.constructor.prototype,i),u=""+r[i];if(!r.hasOwnProperty(i)&&typeof o<"u"&&typeof o.get=="function"&&typeof o.set=="function"){var f=o.get,m=o.set;return Object.defineProperty(r,i,{configurable:!0,get:function(){return f.call(this)},set:function(S){u=""+S,m.call(this,S)}}),Object.defineProperty(r,i,{enumerable:o.enumerable}),{getValue:function(){return u},setValue:function(S){u=""+S},stopTracking:function(){r._valueTracker=null,delete r[i]}}}}function _c(r){r._valueTracker||(r._valueTracker=aE(r))}function Dm(r){if(!r)return!1;var i=r._valueTracker;if(!i)return!0;var o=i.getValue(),u="";return r&&(u=Mm(r)?r.checked?"true":"false":r.value),r=u,r!==o?(i.setValue(r),!0):!1}function xc(r){if(r=r||(typeof document<"u"?document:void 0),typeof r>"u")return null;try{return r.activeElement||r.body}catch{return r.body}}var iE=/[\n"\\]/g;function Rr(r){return r.replace(iE,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function of(r,i,o,u,f,m,S,w){r.name="",S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"?r.type=S:r.removeAttribute("type"),i!=null?S==="number"?(i===0&&r.value===""||r.value!=i)&&(r.value=""+Ir(i)):r.value!==""+Ir(i)&&(r.value=""+Ir(i)):S!=="submit"&&S!=="reset"||r.removeAttribute("value"),i!=null?lf(r,S,Ir(i)):o!=null?lf(r,S,Ir(o)):u!=null&&r.removeAttribute("value"),f==null&&m!=null&&(r.defaultChecked=!!m),f!=null&&(r.checked=f&&typeof f!="function"&&typeof f!="symbol"),w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"?r.name=""+Ir(w):r.removeAttribute("name")}function Pm(r,i,o,u,f,m,S,w){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(r.type=m),i!=null||o!=null){if(!(m!=="submit"&&m!=="reset"||i!=null))return;o=o!=null?""+Ir(o):"",i=i!=null?""+Ir(i):o,w||i===r.value||(r.value=i),r.defaultValue=i}u=u??f,u=typeof u!="function"&&typeof u!="symbol"&&!!u,r.checked=w?r.checked:!!u,r.defaultChecked=!!u,S!=null&&typeof S!="function"&&typeof S!="symbol"&&typeof S!="boolean"&&(r.name=S)}function lf(r,i,o){i==="number"&&xc(r.ownerDocument)===r||r.defaultValue===""+o||(r.defaultValue=""+o)}function Ts(r,i,o,u){if(r=r.options,i){i={};for(var f=0;f<o.length;f++)i["$"+o[f]]=!0;for(o=0;o<r.length;o++)f=i.hasOwnProperty("$"+r[o].value),r[o].selected!==f&&(r[o].selected=f),f&&u&&(r[o].defaultSelected=!0)}else{for(o=""+Ir(o),i=null,f=0;f<r.length;f++){if(r[f].value===o){r[f].selected=!0,u&&(r[f].defaultSelected=!0);return}i!==null||r[f].disabled||(i=r[f])}i!==null&&(i.selected=!0)}}function Fm(r,i,o){if(i!=null&&(i=""+Ir(i),i!==r.value&&(r.value=i),o==null)){r.defaultValue!==i&&(r.defaultValue=i);return}r.defaultValue=o!=null?""+Ir(o):""}function Lm(r,i,o,u){if(i==null){if(u!=null){if(o!=null)throw Error(a(92));if(ke(u)){if(1<u.length)throw Error(a(93));u=u[0]}o=u}o==null&&(o=""),i=o}o=Ir(i),r.defaultValue=o,u=r.textContent,u===o&&u!==""&&u!==null&&(r.value=u)}function _s(r,i){if(i){var o=r.firstChild;if(o&&o===r.lastChild&&o.nodeType===3){o.nodeValue=i;return}}r.textContent=i}var sE=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function Um(r,i,o){var u=i.indexOf("--")===0;o==null||typeof o=="boolean"||o===""?u?r.setProperty(i,""):i==="float"?r.cssFloat="":r[i]="":u?r.setProperty(i,o):typeof o!="number"||o===0||sE.has(i)?i==="float"?r.cssFloat=o:r[i]=(""+o).trim():r[i]=o+"px"}function Bm(r,i,o){if(i!=null&&typeof i!="object")throw Error(a(62));if(r=r.style,o!=null){for(var u in o)!o.hasOwnProperty(u)||i!=null&&i.hasOwnProperty(u)||(u.indexOf("--")===0?r.setProperty(u,""):u==="float"?r.cssFloat="":r[u]="");for(var f in i)u=i[f],i.hasOwnProperty(f)&&o[f]!==u&&Um(r,f,u)}else for(var m in i)i.hasOwnProperty(m)&&Um(r,m,i[m])}function cf(r){if(r.indexOf("-")===-1)return!1;switch(r){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var oE=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),lE=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Sc(r){return lE.test(""+r)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":r}var uf=null;function hf(r){return r=r.target||r.srcElement||window,r.correspondingUseElement&&(r=r.correspondingUseElement),r.nodeType===3?r.parentNode:r}var xs=null,Ss=null;function Hm(r){var i=F(r);if(i&&(r=i.stateNode)){var o=r[cn]||null;e:switch(r=i.stateNode,i.type){case"input":if(of(r,o.value,o.defaultValue,o.defaultValue,o.checked,o.defaultChecked,o.type,o.name),i=o.name,o.type==="radio"&&i!=null){for(o=r;o.parentNode;)o=o.parentNode;for(o=o.querySelectorAll('input[name="'+Rr(""+i)+'"][type="radio"]'),i=0;i<o.length;i++){var u=o[i];if(u!==r&&u.form===r.form){var f=u[cn]||null;if(!f)throw Error(a(90));of(u,f.value,f.defaultValue,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name)}}for(i=0;i<o.length;i++)u=o[i],u.form===r.form&&Dm(u)}break e;case"textarea":Fm(r,o.value,o.defaultValue);break e;case"select":i=o.value,i!=null&&Ts(r,!!o.multiple,i,!1)}}}var ff=!1;function jm(r,i,o){if(ff)return r(i,o);ff=!0;try{var u=r(i);return u}finally{if(ff=!1,(xs!==null||Ss!==null)&&(ou(),xs&&(i=xs,r=Ss,Ss=xs=null,Hm(i),r)))for(i=0;i<r.length;i++)Hm(r[i])}}function Do(r,i){var o=r.stateNode;if(o===null)return null;var u=o[cn]||null;if(u===null)return null;o=u[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(u=!u.disabled)||(r=r.type,u=!(r==="button"||r==="input"||r==="select"||r==="textarea")),r=!u;break e;default:r=!1}if(r)return null;if(o&&typeof o!="function")throw Error(a(231,i,typeof o));return o}var _a=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),df=!1;if(_a)try{var Po={};Object.defineProperty(Po,"passive",{get:function(){df=!0}}),window.addEventListener("test",Po,Po),window.removeEventListener("test",Po,Po)}catch{df=!1}var Va=null,gf=null,Cc=null;function zm(){if(Cc)return Cc;var r,i=gf,o=i.length,u,f="value"in Va?Va.value:Va.textContent,m=f.length;for(r=0;r<o&&i[r]===f[r];r++);var S=o-r;for(u=1;u<=S&&i[o-u]===f[m-u];u++);return Cc=f.slice(r,1<u?1-u:void 0)}function Ec(r){var i=r.keyCode;return"charCode"in r?(r=r.charCode,r===0&&i===13&&(r=13)):r=i,r===10&&(r=13),32<=r||r===13?r:0}function Ac(){return!0}function Gm(){return!1}function Jn(r){function i(o,u,f,m,S){this._reactName=o,this._targetInst=f,this.type=u,this.nativeEvent=m,this.target=S,this.currentTarget=null;for(var w in r)r.hasOwnProperty(w)&&(o=r[w],this[w]=o?o(m):m[w]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Ac:Gm,this.isPropagationStopped=Gm,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var o=this.nativeEvent;o&&(o.preventDefault?o.preventDefault():typeof o.returnValue!="unknown"&&(o.returnValue=!1),this.isDefaultPrevented=Ac)},stopPropagation:function(){var o=this.nativeEvent;o&&(o.stopPropagation?o.stopPropagation():typeof o.cancelBubble!="unknown"&&(o.cancelBubble=!0),this.isPropagationStopped=Ac)},persist:function(){},isPersistent:Ac}),i}var Fi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(r){return r.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},wc=Jn(Fi),Fo=p({},Fi,{view:0,detail:0}),cE=Jn(Fo),mf,pf,Lo,bc=p({},Fo,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:yf,button:0,buttons:0,relatedTarget:function(r){return r.relatedTarget===void 0?r.fromElement===r.srcElement?r.toElement:r.fromElement:r.relatedTarget},movementX:function(r){return"movementX"in r?r.movementX:(r!==Lo&&(Lo&&r.type==="mousemove"?(mf=r.screenX-Lo.screenX,pf=r.screenY-Lo.screenY):pf=mf=0,Lo=r),mf)},movementY:function(r){return"movementY"in r?r.movementY:pf}}),$m=Jn(bc),uE=p({},bc,{dataTransfer:0}),hE=Jn(uE),fE=p({},Fo,{relatedTarget:0}),vf=Jn(fE),dE=p({},Fi,{animationName:0,elapsedTime:0,pseudoElement:0}),gE=Jn(dE),mE=p({},Fi,{clipboardData:function(r){return"clipboardData"in r?r.clipboardData:window.clipboardData}}),pE=Jn(mE),vE=p({},Fi,{data:0}),Km=Jn(vE),yE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},_E={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function xE(r){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(r):(r=_E[r])?!!i[r]:!1}function yf(){return xE}var SE=p({},Fo,{key:function(r){if(r.key){var i=yE[r.key]||r.key;if(i!=="Unidentified")return i}return r.type==="keypress"?(r=Ec(r),r===13?"Enter":String.fromCharCode(r)):r.type==="keydown"||r.type==="keyup"?TE[r.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:yf,charCode:function(r){return r.type==="keypress"?Ec(r):0},keyCode:function(r){return r.type==="keydown"||r.type==="keyup"?r.keyCode:0},which:function(r){return r.type==="keypress"?Ec(r):r.type==="keydown"||r.type==="keyup"?r.keyCode:0}}),CE=Jn(SE),EE=p({},bc,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vm=Jn(EE),AE=p({},Fo,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:yf}),wE=Jn(AE),bE=p({},Fi,{propertyName:0,elapsedTime:0,pseudoElement:0}),IE=Jn(bE),RE=p({},bc,{deltaX:function(r){return"deltaX"in r?r.deltaX:"wheelDeltaX"in r?-r.wheelDeltaX:0},deltaY:function(r){return"deltaY"in r?r.deltaY:"wheelDeltaY"in r?-r.wheelDeltaY:"wheelDelta"in r?-r.wheelDelta:0},deltaZ:0,deltaMode:0}),NE=Jn(RE),kE=p({},Fi,{newState:0,oldState:0}),OE=Jn(kE),ME=[9,13,27,32],Tf=_a&&"CompositionEvent"in window,Uo=null;_a&&"documentMode"in document&&(Uo=document.documentMode);var DE=_a&&"TextEvent"in window&&!Uo,qm=_a&&(!Tf||Uo&&8<Uo&&11>=Uo),Ym=" ",Xm=!1;function Wm(r,i){switch(r){case"keyup":return ME.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Qm(r){return r=r.detail,typeof r=="object"&&"data"in r?r.data:null}var Cs=!1;function PE(r,i){switch(r){case"compositionend":return Qm(i);case"keypress":return i.which!==32?null:(Xm=!0,Ym);case"textInput":return r=i.data,r===Ym&&Xm?null:r;default:return null}}function FE(r,i){if(Cs)return r==="compositionend"||!Tf&&Wm(r,i)?(r=zm(),Cc=gf=Va=null,Cs=!1,r):null;switch(r){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return qm&&i.locale!=="ko"?null:i.data;default:return null}}var LE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Jm(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i==="input"?!!LE[r.type]:i==="textarea"}function Zm(r,i,o,u){xs?Ss?Ss.push(u):Ss=[u]:xs=u,i=du(i,"onChange"),0<i.length&&(o=new wc("onChange","change",null,o,u),r.push({event:o,listeners:i}))}var Bo=null,Ho=null;function UE(r){Mv(r,0)}function Ic(r){var i=ae(r);if(Dm(i))return r}function ep(r,i){if(r==="change")return i}var tp=!1;if(_a){var _f;if(_a){var xf="oninput"in document;if(!xf){var np=document.createElement("div");np.setAttribute("oninput","return;"),xf=typeof np.oninput=="function"}_f=xf}else _f=!1;tp=_f&&(!document.documentMode||9<document.documentMode)}function rp(){Bo&&(Bo.detachEvent("onpropertychange",ap),Ho=Bo=null)}function ap(r){if(r.propertyName==="value"&&Ic(Ho)){var i=[];Zm(i,Ho,r,hf(r)),jm(UE,i)}}function BE(r,i,o){r==="focusin"?(rp(),Bo=i,Ho=o,Bo.attachEvent("onpropertychange",ap)):r==="focusout"&&rp()}function HE(r){if(r==="selectionchange"||r==="keyup"||r==="keydown")return Ic(Ho)}function jE(r,i){if(r==="click")return Ic(i)}function zE(r,i){if(r==="input"||r==="change")return Ic(i)}function GE(r,i){return r===i&&(r!==0||1/r===1/i)||r!==r&&i!==i}var cr=typeof Object.is=="function"?Object.is:GE;function jo(r,i){if(cr(r,i))return!0;if(typeof r!="object"||r===null||typeof i!="object"||i===null)return!1;var o=Object.keys(r),u=Object.keys(i);if(o.length!==u.length)return!1;for(u=0;u<o.length;u++){var f=o[u];if(!et.call(i,f)||!cr(r[f],i[f]))return!1}return!0}function ip(r){for(;r&&r.firstChild;)r=r.firstChild;return r}function sp(r,i){var o=ip(r);r=0;for(var u;o;){if(o.nodeType===3){if(u=r+o.textContent.length,r<=i&&u>=i)return{node:o,offset:i-r};r=u}e:{for(;o;){if(o.nextSibling){o=o.nextSibling;break e}o=o.parentNode}o=void 0}o=ip(o)}}function op(r,i){return r&&i?r===i?!0:r&&r.nodeType===3?!1:i&&i.nodeType===3?op(r,i.parentNode):"contains"in r?r.contains(i):r.compareDocumentPosition?!!(r.compareDocumentPosition(i)&16):!1:!1}function lp(r){r=r!=null&&r.ownerDocument!=null&&r.ownerDocument.defaultView!=null?r.ownerDocument.defaultView:window;for(var i=xc(r.document);i instanceof r.HTMLIFrameElement;){try{var o=typeof i.contentWindow.location.href=="string"}catch{o=!1}if(o)r=i.contentWindow;else break;i=xc(r.document)}return i}function Sf(r){var i=r&&r.nodeName&&r.nodeName.toLowerCase();return i&&(i==="input"&&(r.type==="text"||r.type==="search"||r.type==="tel"||r.type==="url"||r.type==="password")||i==="textarea"||r.contentEditable==="true")}var $E=_a&&"documentMode"in document&&11>=document.documentMode,Es=null,Cf=null,zo=null,Ef=!1;function cp(r,i,o){var u=o.window===o?o.document:o.nodeType===9?o:o.ownerDocument;Ef||Es==null||Es!==xc(u)||(u=Es,"selectionStart"in u&&Sf(u)?u={start:u.selectionStart,end:u.selectionEnd}:(u=(u.ownerDocument&&u.ownerDocument.defaultView||window).getSelection(),u={anchorNode:u.anchorNode,anchorOffset:u.anchorOffset,focusNode:u.focusNode,focusOffset:u.focusOffset}),zo&&jo(zo,u)||(zo=u,u=du(Cf,"onSelect"),0<u.length&&(i=new wc("onSelect","select",null,i,o),r.push({event:i,listeners:u}),i.target=Es)))}function Li(r,i){var o={};return o[r.toLowerCase()]=i.toLowerCase(),o["Webkit"+r]="webkit"+i,o["Moz"+r]="moz"+i,o}var As={animationend:Li("Animation","AnimationEnd"),animationiteration:Li("Animation","AnimationIteration"),animationstart:Li("Animation","AnimationStart"),transitionrun:Li("Transition","TransitionRun"),transitionstart:Li("Transition","TransitionStart"),transitioncancel:Li("Transition","TransitionCancel"),transitionend:Li("Transition","TransitionEnd")},Af={},up={};_a&&(up=document.createElement("div").style,"AnimationEvent"in window||(delete As.animationend.animation,delete As.animationiteration.animation,delete As.animationstart.animation),"TransitionEvent"in window||delete As.transitionend.transition);function Ui(r){if(Af[r])return Af[r];if(!As[r])return r;var i=As[r],o;for(o in i)if(i.hasOwnProperty(o)&&o in up)return Af[r]=i[o];return r}var hp=Ui("animationend"),fp=Ui("animationiteration"),dp=Ui("animationstart"),KE=Ui("transitionrun"),VE=Ui("transitionstart"),qE=Ui("transitioncancel"),gp=Ui("transitionend"),mp=new Map,wf="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wf.push("scrollEnd");function $r(r,i){mp.set(r,i),Ee(i,[r])}var pp=new WeakMap;function Nr(r,i){if(typeof r=="object"&&r!==null){var o=pp.get(r);return o!==void 0?o:(i={value:r,source:i,stack:Om(i)},pp.set(r,i),i)}return{value:r,source:i,stack:Om(i)}}var kr=[],ws=0,bf=0;function Rc(){for(var r=ws,i=bf=ws=0;i<r;){var o=kr[i];kr[i++]=null;var u=kr[i];kr[i++]=null;var f=kr[i];kr[i++]=null;var m=kr[i];if(kr[i++]=null,u!==null&&f!==null){var S=u.pending;S===null?f.next=f:(f.next=S.next,S.next=f),u.pending=f}m!==0&&vp(o,f,m)}}function Nc(r,i,o,u){kr[ws++]=r,kr[ws++]=i,kr[ws++]=o,kr[ws++]=u,bf|=u,r.lanes|=u,r=r.alternate,r!==null&&(r.lanes|=u)}function If(r,i,o,u){return Nc(r,i,o,u),kc(r)}function bs(r,i){return Nc(r,null,null,i),kc(r)}function vp(r,i,o){r.lanes|=o;var u=r.alternate;u!==null&&(u.lanes|=o);for(var f=!1,m=r.return;m!==null;)m.childLanes|=o,u=m.alternate,u!==null&&(u.childLanes|=o),m.tag===22&&(r=m.stateNode,r===null||r._visibility&1||(f=!0)),r=m,m=m.return;return r.tag===3?(m=r.stateNode,f&&i!==null&&(f=31-$n(o),r=m.hiddenUpdates,u=r[f],u===null?r[f]=[i]:u.push(i),i.lane=o|536870912),m):null}function kc(r){if(50<dl)throw dl=0,Dd=null,Error(a(185));for(var i=r.return;i!==null;)r=i,i=r.return;return r.tag===3?r.stateNode:null}var Is={};function YE(r,i,o,u){this.tag=r,this.key=o,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=u,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function ur(r,i,o,u){return new YE(r,i,o,u)}function Rf(r){return r=r.prototype,!(!r||!r.isReactComponent)}function xa(r,i){var o=r.alternate;return o===null?(o=ur(r.tag,i,r.key,r.mode),o.elementType=r.elementType,o.type=r.type,o.stateNode=r.stateNode,o.alternate=r,r.alternate=o):(o.pendingProps=i,o.type=r.type,o.flags=0,o.subtreeFlags=0,o.deletions=null),o.flags=r.flags&65011712,o.childLanes=r.childLanes,o.lanes=r.lanes,o.child=r.child,o.memoizedProps=r.memoizedProps,o.memoizedState=r.memoizedState,o.updateQueue=r.updateQueue,i=r.dependencies,o.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},o.sibling=r.sibling,o.index=r.index,o.ref=r.ref,o.refCleanup=r.refCleanup,o}function yp(r,i){r.flags&=65011714;var o=r.alternate;return o===null?(r.childLanes=0,r.lanes=i,r.child=null,r.subtreeFlags=0,r.memoizedProps=null,r.memoizedState=null,r.updateQueue=null,r.dependencies=null,r.stateNode=null):(r.childLanes=o.childLanes,r.lanes=o.lanes,r.child=o.child,r.subtreeFlags=0,r.deletions=null,r.memoizedProps=o.memoizedProps,r.memoizedState=o.memoizedState,r.updateQueue=o.updateQueue,r.type=o.type,i=o.dependencies,r.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),r}function Oc(r,i,o,u,f,m){var S=0;if(u=r,typeof r=="function")Rf(r)&&(S=1);else if(typeof r=="string")S=WA(r,o,P.current)?26:r==="html"||r==="head"||r==="body"?27:5;else e:switch(r){case q:return r=ur(31,o,i,f),r.elementType=q,r.lanes=m,r;case C:return Bi(o.children,f,m,i);case x:S=8,f|=24;break;case A:return r=ur(12,o,i,f|2),r.elementType=A,r.lanes=m,r;case H:return r=ur(13,o,i,f),r.elementType=H,r.lanes=m,r;case Y:return r=ur(19,o,i,f),r.elementType=Y,r.lanes=m,r;default:if(typeof r=="object"&&r!==null)switch(r.$$typeof){case B:case O:S=10;break e;case k:S=9;break e;case j:S=11;break e;case I:S=14;break e;case G:S=16,u=null;break e}S=29,o=Error(a(130,r===null?"null":typeof r,"")),u=null}return i=ur(S,o,i,f),i.elementType=r,i.type=u,i.lanes=m,i}function Bi(r,i,o,u){return r=ur(7,r,u,i),r.lanes=o,r}function Nf(r,i,o){return r=ur(6,r,null,i),r.lanes=o,r}function kf(r,i,o){return i=ur(4,r.children!==null?r.children:[],r.key,i),i.lanes=o,i.stateNode={containerInfo:r.containerInfo,pendingChildren:null,implementation:r.implementation},i}var Rs=[],Ns=0,Mc=null,Dc=0,Or=[],Mr=0,Hi=null,Sa=1,Ca="";function ji(r,i){Rs[Ns++]=Dc,Rs[Ns++]=Mc,Mc=r,Dc=i}function Tp(r,i,o){Or[Mr++]=Sa,Or[Mr++]=Ca,Or[Mr++]=Hi,Hi=r;var u=Sa;r=Ca;var f=32-$n(u)-1;u&=~(1<<f),o+=1;var m=32-$n(i)+f;if(30<m){var S=f-f%5;m=(u&(1<<S)-1).toString(32),u>>=S,f-=S,Sa=1<<32-$n(i)+f|o<<f|u,Ca=m+r}else Sa=1<<m|o<<f|u,Ca=r}function Of(r){r.return!==null&&(ji(r,1),Tp(r,1,0))}function Mf(r){for(;r===Mc;)Mc=Rs[--Ns],Rs[Ns]=null,Dc=Rs[--Ns],Rs[Ns]=null;for(;r===Hi;)Hi=Or[--Mr],Or[Mr]=null,Ca=Or[--Mr],Or[Mr]=null,Sa=Or[--Mr],Or[Mr]=null}var Kn=null,Gt=null,gt=!1,zi=null,ia=!1,Df=Error(a(519));function Gi(r){var i=Error(a(418,""));throw Ko(Nr(i,r)),Df}function _p(r){var i=r.stateNode,o=r.type,u=r.memoizedProps;switch(i[ln]=r,i[cn]=u,o){case"dialog":ot("cancel",i),ot("close",i);break;case"iframe":case"object":case"embed":ot("load",i);break;case"video":case"audio":for(o=0;o<ml.length;o++)ot(ml[o],i);break;case"source":ot("error",i);break;case"img":case"image":case"link":ot("error",i),ot("load",i);break;case"details":ot("toggle",i);break;case"input":ot("invalid",i),Pm(i,u.value,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name,!0),_c(i);break;case"select":ot("invalid",i);break;case"textarea":ot("invalid",i),Lm(i,u.value,u.defaultValue,u.children),_c(i)}o=u.children,typeof o!="string"&&typeof o!="number"&&typeof o!="bigint"||i.textContent===""+o||u.suppressHydrationWarning===!0||Lv(i.textContent,o)?(u.popover!=null&&(ot("beforetoggle",i),ot("toggle",i)),u.onScroll!=null&&ot("scroll",i),u.onScrollEnd!=null&&ot("scrollend",i),u.onClick!=null&&(i.onclick=gu),i=!0):i=!1,i||Gi(r)}function xp(r){for(Kn=r.return;Kn;)switch(Kn.tag){case 5:case 13:ia=!1;return;case 27:case 3:ia=!0;return;default:Kn=Kn.return}}function Go(r){if(r!==Kn)return!1;if(!gt)return xp(r),gt=!0,!1;var i=r.tag,o;if((o=i!==3&&i!==27)&&((o=i===5)&&(o=r.type,o=!(o!=="form"&&o!=="button")||Wd(r.type,r.memoizedProps)),o=!o),o&&Gt&&Gi(r),xp(r),i===13){if(r=r.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(a(317));e:{for(r=r.nextSibling,i=0;r;){if(r.nodeType===8)if(o=r.data,o==="/$"){if(i===0){Gt=Vr(r.nextSibling);break e}i--}else o!=="$"&&o!=="$!"&&o!=="$?"||i++;r=r.nextSibling}Gt=null}}else i===27?(i=Gt,li(r.type)?(r=e0,e0=null,Gt=r):Gt=i):Gt=Kn?Vr(r.stateNode.nextSibling):null;return!0}function $o(){Gt=Kn=null,gt=!1}function Sp(){var r=zi;return r!==null&&(tr===null?tr=r:tr.push.apply(tr,r),zi=null),r}function Ko(r){zi===null?zi=[r]:zi.push(r)}var Pf=ue(null),$i=null,Ea=null;function qa(r,i,o){L(Pf,i._currentValue),i._currentValue=o}function Aa(r){r._currentValue=Pf.current,b(Pf)}function Ff(r,i,o){for(;r!==null;){var u=r.alternate;if((r.childLanes&i)!==i?(r.childLanes|=i,u!==null&&(u.childLanes|=i)):u!==null&&(u.childLanes&i)!==i&&(u.childLanes|=i),r===o)break;r=r.return}}function Lf(r,i,o,u){var f=r.child;for(f!==null&&(f.return=r);f!==null;){var m=f.dependencies;if(m!==null){var S=f.child;m=m.firstContext;e:for(;m!==null;){var w=m;m=f;for(var z=0;z<i.length;z++)if(w.context===i[z]){m.lanes|=o,w=m.alternate,w!==null&&(w.lanes|=o),Ff(m.return,o,r),u||(S=null);break e}m=w.next}}else if(f.tag===18){if(S=f.return,S===null)throw Error(a(341));S.lanes|=o,m=S.alternate,m!==null&&(m.lanes|=o),Ff(S,o,r),S=null}else S=f.child;if(S!==null)S.return=f;else for(S=f;S!==null;){if(S===r){S=null;break}if(f=S.sibling,f!==null){f.return=S.return,S=f;break}S=S.return}f=S}}function Vo(r,i,o,u){r=null;for(var f=i,m=!1;f!==null;){if(!m){if((f.flags&524288)!==0)m=!0;else if((f.flags&262144)!==0)break}if(f.tag===10){var S=f.alternate;if(S===null)throw Error(a(387));if(S=S.memoizedProps,S!==null){var w=f.type;cr(f.pendingProps.value,S.value)||(r!==null?r.push(w):r=[w])}}else if(f===be.current){if(S=f.alternate,S===null)throw Error(a(387));S.memoizedState.memoizedState!==f.memoizedState.memoizedState&&(r!==null?r.push(xl):r=[xl])}f=f.return}r!==null&&Lf(i,r,o,u),i.flags|=262144}function Pc(r){for(r=r.firstContext;r!==null;){if(!cr(r.context._currentValue,r.memoizedValue))return!0;r=r.next}return!1}function Ki(r){$i=r,Ea=null,r=r.dependencies,r!==null&&(r.firstContext=null)}function Dn(r){return Cp($i,r)}function Fc(r,i){return $i===null&&Ki(r),Cp(r,i)}function Cp(r,i){var o=i._currentValue;if(i={context:i,memoizedValue:o,next:null},Ea===null){if(r===null)throw Error(a(308));Ea=i,r.dependencies={lanes:0,firstContext:i},r.flags|=524288}else Ea=Ea.next=i;return o}var XE=typeof AbortController<"u"?AbortController:function(){var r=[],i=this.signal={aborted:!1,addEventListener:function(o,u){r.push(u)}};this.abort=function(){i.aborted=!0,r.forEach(function(o){return o()})}},WE=n.unstable_scheduleCallback,QE=n.unstable_NormalPriority,nn={$$typeof:O,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function Uf(){return{controller:new XE,data:new Map,refCount:0}}function qo(r){r.refCount--,r.refCount===0&&WE(QE,function(){r.controller.abort()})}var Yo=null,Bf=0,ks=0,Os=null;function JE(r,i){if(Yo===null){var o=Yo=[];Bf=0,ks=jd(),Os={status:"pending",value:void 0,then:function(u){o.push(u)}}}return Bf++,i.then(Ep,Ep),i}function Ep(){if(--Bf===0&&Yo!==null){Os!==null&&(Os.status="fulfilled");var r=Yo;Yo=null,ks=0,Os=null;for(var i=0;i<r.length;i++)(0,r[i])()}}function ZE(r,i){var o=[],u={status:"pending",value:null,reason:null,then:function(f){o.push(f)}};return r.then(function(){u.status="fulfilled",u.value=i;for(var f=0;f<o.length;f++)(0,o[f])(i)},function(f){for(u.status="rejected",u.reason=f,f=0;f<o.length;f++)(0,o[f])(void 0)}),u}var Ap=re.S;re.S=function(r,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&JE(r,i),Ap!==null&&Ap(r,i)};var Vi=ue(null);function Hf(){var r=Vi.current;return r!==null?r:Lt.pooledCache}function Lc(r,i){i===null?L(Vi,Vi.current):L(Vi,i.pool)}function wp(){var r=Hf();return r===null?null:{parent:nn._currentValue,pool:r}}var Xo=Error(a(460)),bp=Error(a(474)),Uc=Error(a(542)),jf={then:function(){}};function Ip(r){return r=r.status,r==="fulfilled"||r==="rejected"}function Bc(){}function Rp(r,i,o){switch(o=r[o],o===void 0?r.push(i):o!==i&&(i.then(Bc,Bc),i=o),i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,kp(r),r;default:if(typeof i.status=="string")i.then(Bc,Bc);else{if(r=Lt,r!==null&&100<r.shellSuspendCounter)throw Error(a(482));r=i,r.status="pending",r.then(function(u){if(i.status==="pending"){var f=i;f.status="fulfilled",f.value=u}},function(u){if(i.status==="pending"){var f=i;f.status="rejected",f.reason=u}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw r=i.reason,kp(r),r}throw Wo=i,Xo}}var Wo=null;function Np(){if(Wo===null)throw Error(a(459));var r=Wo;return Wo=null,r}function kp(r){if(r===Xo||r===Uc)throw Error(a(483))}var Ya=!1;function zf(r){r.updateQueue={baseState:r.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Gf(r,i){r=r.updateQueue,i.updateQueue===r&&(i.updateQueue={baseState:r.baseState,firstBaseUpdate:r.firstBaseUpdate,lastBaseUpdate:r.lastBaseUpdate,shared:r.shared,callbacks:null})}function Xa(r){return{lane:r,tag:0,payload:null,callback:null,next:null}}function Wa(r,i,o){var u=r.updateQueue;if(u===null)return null;if(u=u.shared,(pt&2)!==0){var f=u.pending;return f===null?i.next=i:(i.next=f.next,f.next=i),u.pending=i,i=kc(r),vp(r,null,o),i}return Nc(r,u,i,o),kc(r)}function Qo(r,i,o){if(i=i.updateQueue,i!==null&&(i=i.shared,(o&4194048)!==0)){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,yc(r,o)}}function $f(r,i){var o=r.updateQueue,u=r.alternate;if(u!==null&&(u=u.updateQueue,o===u)){var f=null,m=null;if(o=o.firstBaseUpdate,o!==null){do{var S={lane:o.lane,tag:o.tag,payload:o.payload,callback:null,next:null};m===null?f=m=S:m=m.next=S,o=o.next}while(o!==null);m===null?f=m=i:m=m.next=i}else f=m=i;o={baseState:u.baseState,firstBaseUpdate:f,lastBaseUpdate:m,shared:u.shared,callbacks:u.callbacks},r.updateQueue=o;return}r=o.lastBaseUpdate,r===null?o.firstBaseUpdate=i:r.next=i,o.lastBaseUpdate=i}var Kf=!1;function Jo(){if(Kf){var r=Os;if(r!==null)throw r}}function Zo(r,i,o,u){Kf=!1;var f=r.updateQueue;Ya=!1;var m=f.firstBaseUpdate,S=f.lastBaseUpdate,w=f.shared.pending;if(w!==null){f.shared.pending=null;var z=w,ne=z.next;z.next=null,S===null?m=ne:S.next=ne,S=z;var me=r.alternate;me!==null&&(me=me.updateQueue,w=me.lastBaseUpdate,w!==S&&(w===null?me.firstBaseUpdate=ne:w.next=ne,me.lastBaseUpdate=z))}if(m!==null){var _e=f.baseState;S=0,me=ne=z=null,w=m;do{var oe=w.lane&-536870913,ce=oe!==w.lane;if(ce?(ut&oe)===oe:(u&oe)===oe){oe!==0&&oe===ks&&(Kf=!0),me!==null&&(me=me.next={lane:0,tag:w.tag,payload:w.payload,callback:null,next:null});e:{var Ye=r,Ke=w;oe=i;var bt=o;switch(Ke.tag){case 1:if(Ye=Ke.payload,typeof Ye=="function"){_e=Ye.call(bt,_e,oe);break e}_e=Ye;break e;case 3:Ye.flags=Ye.flags&-65537|128;case 0:if(Ye=Ke.payload,oe=typeof Ye=="function"?Ye.call(bt,_e,oe):Ye,oe==null)break e;_e=p({},_e,oe);break e;case 2:Ya=!0}}oe=w.callback,oe!==null&&(r.flags|=64,ce&&(r.flags|=8192),ce=f.callbacks,ce===null?f.callbacks=[oe]:ce.push(oe))}else ce={lane:oe,tag:w.tag,payload:w.payload,callback:w.callback,next:null},me===null?(ne=me=ce,z=_e):me=me.next=ce,S|=oe;if(w=w.next,w===null){if(w=f.shared.pending,w===null)break;ce=w,w=ce.next,ce.next=null,f.lastBaseUpdate=ce,f.shared.pending=null}}while(!0);me===null&&(z=_e),f.baseState=z,f.firstBaseUpdate=ne,f.lastBaseUpdate=me,m===null&&(f.shared.lanes=0),ai|=S,r.lanes=S,r.memoizedState=_e}}function Op(r,i){if(typeof r!="function")throw Error(a(191,r));r.call(i)}function Mp(r,i){var o=r.callbacks;if(o!==null)for(r.callbacks=null,r=0;r<o.length;r++)Op(o[r],i)}var Ms=ue(null),Hc=ue(0);function Dp(r,i){r=Oa,L(Hc,r),L(Ms,i),Oa=r|i.baseLanes}function Vf(){L(Hc,Oa),L(Ms,Ms.current)}function qf(){Oa=Hc.current,b(Ms),b(Hc)}var Qa=0,rt=null,At=null,Wt=null,jc=!1,Ds=!1,qi=!1,zc=0,el=0,Ps=null,eA=0;function Yt(){throw Error(a(321))}function Yf(r,i){if(i===null)return!1;for(var o=0;o<i.length&&o<r.length;o++)if(!cr(r[o],i[o]))return!1;return!0}function Xf(r,i,o,u,f,m){return Qa=m,rt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,re.H=r===null||r.memoizedState===null?v1:y1,qi=!1,m=o(u,f),qi=!1,Ds&&(m=Fp(i,o,u,f)),Pp(r),m}function Pp(r){re.H=Yc;var i=At!==null&&At.next!==null;if(Qa=0,Wt=At=rt=null,jc=!1,el=0,Ps=null,i)throw Error(a(300));r===null||un||(r=r.dependencies,r!==null&&Pc(r)&&(un=!0))}function Fp(r,i,o,u){rt=r;var f=0;do{if(Ds&&(Ps=null),el=0,Ds=!1,25<=f)throw Error(a(301));if(f+=1,Wt=At=null,r.updateQueue!=null){var m=r.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}re.H=oA,m=i(o,u)}while(Ds);return m}function tA(){var r=re.H,i=r.useState()[0];return i=typeof i.then=="function"?tl(i):i,r=r.useState()[0],(At!==null?At.memoizedState:null)!==r&&(rt.flags|=1024),i}function Wf(){var r=zc!==0;return zc=0,r}function Qf(r,i,o){i.updateQueue=r.updateQueue,i.flags&=-2053,r.lanes&=~o}function Jf(r){if(jc){for(r=r.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}jc=!1}Qa=0,Wt=At=rt=null,Ds=!1,el=zc=0,Ps=null}function Zn(){var r={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Wt===null?rt.memoizedState=Wt=r:Wt=Wt.next=r,Wt}function Qt(){if(At===null){var r=rt.alternate;r=r!==null?r.memoizedState:null}else r=At.next;var i=Wt===null?rt.memoizedState:Wt.next;if(i!==null)Wt=i,At=r;else{if(r===null)throw rt.alternate===null?Error(a(467)):Error(a(310));At=r,r={memoizedState:At.memoizedState,baseState:At.baseState,baseQueue:At.baseQueue,queue:At.queue,next:null},Wt===null?rt.memoizedState=Wt=r:Wt=Wt.next=r}return Wt}function Zf(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function tl(r){var i=el;return el+=1,Ps===null&&(Ps=[]),r=Rp(Ps,r,i),i=rt,(Wt===null?i.memoizedState:Wt.next)===null&&(i=i.alternate,re.H=i===null||i.memoizedState===null?v1:y1),r}function Gc(r){if(r!==null&&typeof r=="object"){if(typeof r.then=="function")return tl(r);if(r.$$typeof===O)return Dn(r)}throw Error(a(438,String(r)))}function ed(r){var i=null,o=rt.updateQueue;if(o!==null&&(i=o.memoCache),i==null){var u=rt.alternate;u!==null&&(u=u.updateQueue,u!==null&&(u=u.memoCache,u!=null&&(i={data:u.data.map(function(f){return f.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),o===null&&(o=Zf(),rt.updateQueue=o),o.memoCache=i,o=i.data[i.index],o===void 0)for(o=i.data[i.index]=Array(r),u=0;u<r;u++)o[u]=ie;return i.index++,o}function wa(r,i){return typeof i=="function"?i(r):i}function $c(r){var i=Qt();return td(i,At,r)}function td(r,i,o){var u=r.queue;if(u===null)throw Error(a(311));u.lastRenderedReducer=o;var f=r.baseQueue,m=u.pending;if(m!==null){if(f!==null){var S=f.next;f.next=m.next,m.next=S}i.baseQueue=f=m,u.pending=null}if(m=r.baseState,f===null)r.memoizedState=m;else{i=f.next;var w=S=null,z=null,ne=i,me=!1;do{var _e=ne.lane&-536870913;if(_e!==ne.lane?(ut&_e)===_e:(Qa&_e)===_e){var oe=ne.revertLane;if(oe===0)z!==null&&(z=z.next={lane:0,revertLane:0,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null}),_e===ks&&(me=!0);else if((Qa&oe)===oe){ne=ne.next,oe===ks&&(me=!0);continue}else _e={lane:0,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},z===null?(w=z=_e,S=m):z=z.next=_e,rt.lanes|=oe,ai|=oe;_e=ne.action,qi&&o(m,_e),m=ne.hasEagerState?ne.eagerState:o(m,_e)}else oe={lane:_e,revertLane:ne.revertLane,action:ne.action,hasEagerState:ne.hasEagerState,eagerState:ne.eagerState,next:null},z===null?(w=z=oe,S=m):z=z.next=oe,rt.lanes|=_e,ai|=_e;ne=ne.next}while(ne!==null&&ne!==i);if(z===null?S=m:z.next=w,!cr(m,r.memoizedState)&&(un=!0,me&&(o=Os,o!==null)))throw o;r.memoizedState=m,r.baseState=S,r.baseQueue=z,u.lastRenderedState=m}return f===null&&(u.lanes=0),[r.memoizedState,u.dispatch]}function nd(r){var i=Qt(),o=i.queue;if(o===null)throw Error(a(311));o.lastRenderedReducer=r;var u=o.dispatch,f=o.pending,m=i.memoizedState;if(f!==null){o.pending=null;var S=f=f.next;do m=r(m,S.action),S=S.next;while(S!==f);cr(m,i.memoizedState)||(un=!0),i.memoizedState=m,i.baseQueue===null&&(i.baseState=m),o.lastRenderedState=m}return[m,u]}function Lp(r,i,o){var u=rt,f=Qt(),m=gt;if(m){if(o===void 0)throw Error(a(407));o=o()}else o=i();var S=!cr((At||f).memoizedState,o);S&&(f.memoizedState=o,un=!0),f=f.queue;var w=Hp.bind(null,u,f,r);if(nl(2048,8,w,[r]),f.getSnapshot!==i||S||Wt!==null&&Wt.memoizedState.tag&1){if(u.flags|=2048,Fs(9,Kc(),Bp.bind(null,u,f,o,i),null),Lt===null)throw Error(a(349));m||(Qa&124)!==0||Up(u,i,o)}return o}function Up(r,i,o){r.flags|=16384,r={getSnapshot:i,value:o},i=rt.updateQueue,i===null?(i=Zf(),rt.updateQueue=i,i.stores=[r]):(o=i.stores,o===null?i.stores=[r]:o.push(r))}function Bp(r,i,o,u){i.value=o,i.getSnapshot=u,jp(i)&&zp(r)}function Hp(r,i,o){return o(function(){jp(i)&&zp(r)})}function jp(r){var i=r.getSnapshot;r=r.value;try{var o=i();return!cr(r,o)}catch{return!0}}function zp(r){var i=bs(r,2);i!==null&&mr(i,r,2)}function rd(r){var i=Zn();if(typeof r=="function"){var o=r;if(r=o(),qi){Mn(!0);try{o()}finally{Mn(!1)}}}return i.memoizedState=i.baseState=r,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:r},i}function Gp(r,i,o,u){return r.baseState=o,td(r,At,typeof u=="function"?u:wa)}function nA(r,i,o,u,f){if(qc(r))throw Error(a(485));if(r=i.action,r!==null){var m={payload:f,action:r,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(S){m.listeners.push(S)}};re.T!==null?o(!0):m.isTransition=!1,u(m),o=i.pending,o===null?(m.next=i.pending=m,$p(i,m)):(m.next=o.next,i.pending=o.next=m)}}function $p(r,i){var o=i.action,u=i.payload,f=r.state;if(i.isTransition){var m=re.T,S={};re.T=S;try{var w=o(f,u),z=re.S;z!==null&&z(S,w),Kp(r,i,w)}catch(ne){ad(r,i,ne)}finally{re.T=m}}else try{m=o(f,u),Kp(r,i,m)}catch(ne){ad(r,i,ne)}}function Kp(r,i,o){o!==null&&typeof o=="object"&&typeof o.then=="function"?o.then(function(u){Vp(r,i,u)},function(u){return ad(r,i,u)}):Vp(r,i,o)}function Vp(r,i,o){i.status="fulfilled",i.value=o,qp(i),r.state=o,i=r.pending,i!==null&&(o=i.next,o===i?r.pending=null:(o=o.next,i.next=o,$p(r,o)))}function ad(r,i,o){var u=r.pending;if(r.pending=null,u!==null){u=u.next;do i.status="rejected",i.reason=o,qp(i),i=i.next;while(i!==u)}r.action=null}function qp(r){r=r.listeners;for(var i=0;i<r.length;i++)(0,r[i])()}function Yp(r,i){return i}function Xp(r,i){if(gt){var o=Lt.formState;if(o!==null){e:{var u=rt;if(gt){if(Gt){t:{for(var f=Gt,m=ia;f.nodeType!==8;){if(!m){f=null;break t}if(f=Vr(f.nextSibling),f===null){f=null;break t}}m=f.data,f=m==="F!"||m==="F"?f:null}if(f){Gt=Vr(f.nextSibling),u=f.data==="F!";break e}}Gi(u)}u=!1}u&&(i=o[0])}}return o=Zn(),o.memoizedState=o.baseState=i,u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Yp,lastRenderedState:i},o.queue=u,o=g1.bind(null,rt,u),u.dispatch=o,u=rd(!1),m=cd.bind(null,rt,!1,u.queue),u=Zn(),f={state:i,dispatch:null,action:r,pending:null},u.queue=f,o=nA.bind(null,rt,f,m,o),f.dispatch=o,u.memoizedState=r,[i,o,!1]}function Wp(r){var i=Qt();return Qp(i,At,r)}function Qp(r,i,o){if(i=td(r,i,Yp)[0],r=$c(wa)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var u=tl(i)}catch(S){throw S===Xo?Uc:S}else u=i;i=Qt();var f=i.queue,m=f.dispatch;return o!==i.memoizedState&&(rt.flags|=2048,Fs(9,Kc(),rA.bind(null,f,o),null)),[u,m,r]}function rA(r,i){r.action=i}function Jp(r){var i=Qt(),o=At;if(o!==null)return Qp(i,o,r);Qt(),i=i.memoizedState,o=Qt();var u=o.queue.dispatch;return o.memoizedState=r,[i,u,!1]}function Fs(r,i,o,u){return r={tag:r,create:o,deps:u,inst:i,next:null},i=rt.updateQueue,i===null&&(i=Zf(),rt.updateQueue=i),o=i.lastEffect,o===null?i.lastEffect=r.next=r:(u=o.next,o.next=r,r.next=u,i.lastEffect=r),r}function Kc(){return{destroy:void 0,resource:void 0}}function Zp(){return Qt().memoizedState}function Vc(r,i,o,u){var f=Zn();u=u===void 0?null:u,rt.flags|=r,f.memoizedState=Fs(1|i,Kc(),o,u)}function nl(r,i,o,u){var f=Qt();u=u===void 0?null:u;var m=f.memoizedState.inst;At!==null&&u!==null&&Yf(u,At.memoizedState.deps)?f.memoizedState=Fs(i,m,o,u):(rt.flags|=r,f.memoizedState=Fs(1|i,m,o,u))}function e1(r,i){Vc(8390656,8,r,i)}function t1(r,i){nl(2048,8,r,i)}function n1(r,i){return nl(4,2,r,i)}function r1(r,i){return nl(4,4,r,i)}function a1(r,i){if(typeof i=="function"){r=r();var o=i(r);return function(){typeof o=="function"?o():i(null)}}if(i!=null)return r=r(),i.current=r,function(){i.current=null}}function i1(r,i,o){o=o!=null?o.concat([r]):null,nl(4,4,a1.bind(null,i,r),o)}function id(){}function s1(r,i){var o=Qt();i=i===void 0?null:i;var u=o.memoizedState;return i!==null&&Yf(i,u[1])?u[0]:(o.memoizedState=[r,i],r)}function o1(r,i){var o=Qt();i=i===void 0?null:i;var u=o.memoizedState;if(i!==null&&Yf(i,u[1]))return u[0];if(u=r(),qi){Mn(!0);try{r()}finally{Mn(!1)}}return o.memoizedState=[u,i],u}function sd(r,i,o){return o===void 0||(Qa&1073741824)!==0?r.memoizedState=i:(r.memoizedState=o,r=uv(),rt.lanes|=r,ai|=r,o)}function l1(r,i,o,u){return cr(o,i)?o:Ms.current!==null?(r=sd(r,o,u),cr(r,i)||(un=!0),r):(Qa&42)===0?(un=!0,r.memoizedState=o):(r=uv(),rt.lanes|=r,ai|=r,i)}function c1(r,i,o,u,f){var m=xe.p;xe.p=m!==0&&8>m?m:8;var S=re.T,w={};re.T=w,cd(r,!1,i,o);try{var z=f(),ne=re.S;if(ne!==null&&ne(w,z),z!==null&&typeof z=="object"&&typeof z.then=="function"){var me=ZE(z,u);rl(r,i,me,gr(r))}else rl(r,i,u,gr(r))}catch(_e){rl(r,i,{then:function(){},status:"rejected",reason:_e},gr())}finally{xe.p=m,re.T=S}}function aA(){}function od(r,i,o,u){if(r.tag!==5)throw Error(a(476));var f=u1(r).queue;c1(r,f,i,fe,o===null?aA:function(){return h1(r),o(u)})}function u1(r){var i=r.memoizedState;if(i!==null)return i;i={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:fe},next:null};var o={};return i.next={memoizedState:o,baseState:o,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:wa,lastRenderedState:o},next:null},r.memoizedState=i,r=r.alternate,r!==null&&(r.memoizedState=i),i}function h1(r){var i=u1(r).next.queue;rl(r,i,{},gr())}function ld(){return Dn(xl)}function f1(){return Qt().memoizedState}function d1(){return Qt().memoizedState}function iA(r){for(var i=r.return;i!==null;){switch(i.tag){case 24:case 3:var o=gr();r=Xa(o);var u=Wa(i,r,o);u!==null&&(mr(u,i,o),Qo(u,i,o)),i={cache:Uf()},r.payload=i;return}i=i.return}}function sA(r,i,o){var u=gr();o={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null},qc(r)?m1(i,o):(o=If(r,i,o,u),o!==null&&(mr(o,r,u),p1(o,i,u)))}function g1(r,i,o){var u=gr();rl(r,i,o,u)}function rl(r,i,o,u){var f={lane:u,revertLane:0,action:o,hasEagerState:!1,eagerState:null,next:null};if(qc(r))m1(i,f);else{var m=r.alternate;if(r.lanes===0&&(m===null||m.lanes===0)&&(m=i.lastRenderedReducer,m!==null))try{var S=i.lastRenderedState,w=m(S,o);if(f.hasEagerState=!0,f.eagerState=w,cr(w,S))return Nc(r,i,f,0),Lt===null&&Rc(),!1}catch{}finally{}if(o=If(r,i,f,u),o!==null)return mr(o,r,u),p1(o,i,u),!0}return!1}function cd(r,i,o,u){if(u={lane:2,revertLane:jd(),action:u,hasEagerState:!1,eagerState:null,next:null},qc(r)){if(i)throw Error(a(479))}else i=If(r,o,u,2),i!==null&&mr(i,r,2)}function qc(r){var i=r.alternate;return r===rt||i!==null&&i===rt}function m1(r,i){Ds=jc=!0;var o=r.pending;o===null?i.next=i:(i.next=o.next,o.next=i),r.pending=i}function p1(r,i,o){if((o&4194048)!==0){var u=i.lanes;u&=r.pendingLanes,o|=u,i.lanes=o,yc(r,o)}}var Yc={readContext:Dn,use:Gc,useCallback:Yt,useContext:Yt,useEffect:Yt,useImperativeHandle:Yt,useLayoutEffect:Yt,useInsertionEffect:Yt,useMemo:Yt,useReducer:Yt,useRef:Yt,useState:Yt,useDebugValue:Yt,useDeferredValue:Yt,useTransition:Yt,useSyncExternalStore:Yt,useId:Yt,useHostTransitionStatus:Yt,useFormState:Yt,useActionState:Yt,useOptimistic:Yt,useMemoCache:Yt,useCacheRefresh:Yt},v1={readContext:Dn,use:Gc,useCallback:function(r,i){return Zn().memoizedState=[r,i===void 0?null:i],r},useContext:Dn,useEffect:e1,useImperativeHandle:function(r,i,o){o=o!=null?o.concat([r]):null,Vc(4194308,4,a1.bind(null,i,r),o)},useLayoutEffect:function(r,i){return Vc(4194308,4,r,i)},useInsertionEffect:function(r,i){Vc(4,2,r,i)},useMemo:function(r,i){var o=Zn();i=i===void 0?null:i;var u=r();if(qi){Mn(!0);try{r()}finally{Mn(!1)}}return o.memoizedState=[u,i],u},useReducer:function(r,i,o){var u=Zn();if(o!==void 0){var f=o(i);if(qi){Mn(!0);try{o(i)}finally{Mn(!1)}}}else f=i;return u.memoizedState=u.baseState=f,r={pending:null,lanes:0,dispatch:null,lastRenderedReducer:r,lastRenderedState:f},u.queue=r,r=r.dispatch=sA.bind(null,rt,r),[u.memoizedState,r]},useRef:function(r){var i=Zn();return r={current:r},i.memoizedState=r},useState:function(r){r=rd(r);var i=r.queue,o=g1.bind(null,rt,i);return i.dispatch=o,[r.memoizedState,o]},useDebugValue:id,useDeferredValue:function(r,i){var o=Zn();return sd(o,r,i)},useTransition:function(){var r=rd(!1);return r=c1.bind(null,rt,r.queue,!0,!1),Zn().memoizedState=r,[!1,r]},useSyncExternalStore:function(r,i,o){var u=rt,f=Zn();if(gt){if(o===void 0)throw Error(a(407));o=o()}else{if(o=i(),Lt===null)throw Error(a(349));(ut&124)!==0||Up(u,i,o)}f.memoizedState=o;var m={value:o,getSnapshot:i};return f.queue=m,e1(Hp.bind(null,u,m,r),[r]),u.flags|=2048,Fs(9,Kc(),Bp.bind(null,u,m,o,i),null),o},useId:function(){var r=Zn(),i=Lt.identifierPrefix;if(gt){var o=Ca,u=Sa;o=(u&~(1<<32-$n(u)-1)).toString(32)+o,i="«"+i+"R"+o,o=zc++,0<o&&(i+="H"+o.toString(32)),i+="»"}else o=eA++,i="«"+i+"r"+o.toString(32)+"»";return r.memoizedState=i},useHostTransitionStatus:ld,useFormState:Xp,useActionState:Xp,useOptimistic:function(r){var i=Zn();i.memoizedState=i.baseState=r;var o={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=o,i=cd.bind(null,rt,!0,o),o.dispatch=i,[r,i]},useMemoCache:ed,useCacheRefresh:function(){return Zn().memoizedState=iA.bind(null,rt)}},y1={readContext:Dn,use:Gc,useCallback:s1,useContext:Dn,useEffect:t1,useImperativeHandle:i1,useInsertionEffect:n1,useLayoutEffect:r1,useMemo:o1,useReducer:$c,useRef:Zp,useState:function(){return $c(wa)},useDebugValue:id,useDeferredValue:function(r,i){var o=Qt();return l1(o,At.memoizedState,r,i)},useTransition:function(){var r=$c(wa)[0],i=Qt().memoizedState;return[typeof r=="boolean"?r:tl(r),i]},useSyncExternalStore:Lp,useId:f1,useHostTransitionStatus:ld,useFormState:Wp,useActionState:Wp,useOptimistic:function(r,i){var o=Qt();return Gp(o,At,r,i)},useMemoCache:ed,useCacheRefresh:d1},oA={readContext:Dn,use:Gc,useCallback:s1,useContext:Dn,useEffect:t1,useImperativeHandle:i1,useInsertionEffect:n1,useLayoutEffect:r1,useMemo:o1,useReducer:nd,useRef:Zp,useState:function(){return nd(wa)},useDebugValue:id,useDeferredValue:function(r,i){var o=Qt();return At===null?sd(o,r,i):l1(o,At.memoizedState,r,i)},useTransition:function(){var r=nd(wa)[0],i=Qt().memoizedState;return[typeof r=="boolean"?r:tl(r),i]},useSyncExternalStore:Lp,useId:f1,useHostTransitionStatus:ld,useFormState:Jp,useActionState:Jp,useOptimistic:function(r,i){var o=Qt();return At!==null?Gp(o,At,r,i):(o.baseState=r,[r,o.queue.dispatch])},useMemoCache:ed,useCacheRefresh:d1},Ls=null,al=0;function Xc(r){var i=al;return al+=1,Ls===null&&(Ls=[]),Rp(Ls,r,i)}function il(r,i){i=i.props.ref,r.ref=i!==void 0?i:null}function Wc(r,i){throw i.$$typeof===v?Error(a(525)):(r=Object.prototype.toString.call(i),Error(a(31,r==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":r)))}function T1(r){var i=r._init;return i(r._payload)}function _1(r){function i(Q,X){if(r){var te=Q.deletions;te===null?(Q.deletions=[X],Q.flags|=16):te.push(X)}}function o(Q,X){if(!r)return null;for(;X!==null;)i(Q,X),X=X.sibling;return null}function u(Q){for(var X=new Map;Q!==null;)Q.key!==null?X.set(Q.key,Q):X.set(Q.index,Q),Q=Q.sibling;return X}function f(Q,X){return Q=xa(Q,X),Q.index=0,Q.sibling=null,Q}function m(Q,X,te){return Q.index=te,r?(te=Q.alternate,te!==null?(te=te.index,te<X?(Q.flags|=67108866,X):te):(Q.flags|=67108866,X)):(Q.flags|=1048576,X)}function S(Q){return r&&Q.alternate===null&&(Q.flags|=67108866),Q}function w(Q,X,te,pe){return X===null||X.tag!==6?(X=Nf(te,Q.mode,pe),X.return=Q,X):(X=f(X,te),X.return=Q,X)}function z(Q,X,te,pe){var ze=te.type;return ze===C?me(Q,X,te.props.children,pe,te.key):X!==null&&(X.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&T1(ze)===X.type)?(X=f(X,te.props),il(X,te),X.return=Q,X):(X=Oc(te.type,te.key,te.props,null,Q.mode,pe),il(X,te),X.return=Q,X)}function ne(Q,X,te,pe){return X===null||X.tag!==4||X.stateNode.containerInfo!==te.containerInfo||X.stateNode.implementation!==te.implementation?(X=kf(te,Q.mode,pe),X.return=Q,X):(X=f(X,te.children||[]),X.return=Q,X)}function me(Q,X,te,pe,ze){return X===null||X.tag!==7?(X=Bi(te,Q.mode,pe,ze),X.return=Q,X):(X=f(X,te),X.return=Q,X)}function _e(Q,X,te){if(typeof X=="string"&&X!==""||typeof X=="number"||typeof X=="bigint")return X=Nf(""+X,Q.mode,te),X.return=Q,X;if(typeof X=="object"&&X!==null){switch(X.$$typeof){case _:return te=Oc(X.type,X.key,X.props,null,Q.mode,te),il(te,X),te.return=Q,te;case T:return X=kf(X,Q.mode,te),X.return=Q,X;case G:var pe=X._init;return X=pe(X._payload),_e(Q,X,te)}if(ke(X)||he(X))return X=Bi(X,Q.mode,te,null),X.return=Q,X;if(typeof X.then=="function")return _e(Q,Xc(X),te);if(X.$$typeof===O)return _e(Q,Fc(Q,X),te);Wc(Q,X)}return null}function oe(Q,X,te,pe){var ze=X!==null?X.key:null;if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return ze!==null?null:w(Q,X,""+te,pe);if(typeof te=="object"&&te!==null){switch(te.$$typeof){case _:return te.key===ze?z(Q,X,te,pe):null;case T:return te.key===ze?ne(Q,X,te,pe):null;case G:return ze=te._init,te=ze(te._payload),oe(Q,X,te,pe)}if(ke(te)||he(te))return ze!==null?null:me(Q,X,te,pe,null);if(typeof te.then=="function")return oe(Q,X,Xc(te),pe);if(te.$$typeof===O)return oe(Q,X,Fc(Q,te),pe);Wc(Q,te)}return null}function ce(Q,X,te,pe,ze){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return Q=Q.get(te)||null,w(X,Q,""+pe,ze);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case _:return Q=Q.get(pe.key===null?te:pe.key)||null,z(X,Q,pe,ze);case T:return Q=Q.get(pe.key===null?te:pe.key)||null,ne(X,Q,pe,ze);case G:var at=pe._init;return pe=at(pe._payload),ce(Q,X,te,pe,ze)}if(ke(pe)||he(pe))return Q=Q.get(te)||null,me(X,Q,pe,ze,null);if(typeof pe.then=="function")return ce(Q,X,te,Xc(pe),ze);if(pe.$$typeof===O)return ce(Q,X,te,Fc(X,pe),ze);Wc(X,pe)}return null}function Ye(Q,X,te,pe){for(var ze=null,at=null,Ge=X,Ve=X=0,fn=null;Ge!==null&&Ve<te.length;Ve++){Ge.index>Ve?(fn=Ge,Ge=null):fn=Ge.sibling;var ht=oe(Q,Ge,te[Ve],pe);if(ht===null){Ge===null&&(Ge=fn);break}r&&Ge&&ht.alternate===null&&i(Q,Ge),X=m(ht,X,Ve),at===null?ze=ht:at.sibling=ht,at=ht,Ge=fn}if(Ve===te.length)return o(Q,Ge),gt&&ji(Q,Ve),ze;if(Ge===null){for(;Ve<te.length;Ve++)Ge=_e(Q,te[Ve],pe),Ge!==null&&(X=m(Ge,X,Ve),at===null?ze=Ge:at.sibling=Ge,at=Ge);return gt&&ji(Q,Ve),ze}for(Ge=u(Ge);Ve<te.length;Ve++)fn=ce(Ge,Q,Ve,te[Ve],pe),fn!==null&&(r&&fn.alternate!==null&&Ge.delete(fn.key===null?Ve:fn.key),X=m(fn,X,Ve),at===null?ze=fn:at.sibling=fn,at=fn);return r&&Ge.forEach(function(di){return i(Q,di)}),gt&&ji(Q,Ve),ze}function Ke(Q,X,te,pe){if(te==null)throw Error(a(151));for(var ze=null,at=null,Ge=X,Ve=X=0,fn=null,ht=te.next();Ge!==null&&!ht.done;Ve++,ht=te.next()){Ge.index>Ve?(fn=Ge,Ge=null):fn=Ge.sibling;var di=oe(Q,Ge,ht.value,pe);if(di===null){Ge===null&&(Ge=fn);break}r&&Ge&&di.alternate===null&&i(Q,Ge),X=m(di,X,Ve),at===null?ze=di:at.sibling=di,at=di,Ge=fn}if(ht.done)return o(Q,Ge),gt&&ji(Q,Ve),ze;if(Ge===null){for(;!ht.done;Ve++,ht=te.next())ht=_e(Q,ht.value,pe),ht!==null&&(X=m(ht,X,Ve),at===null?ze=ht:at.sibling=ht,at=ht);return gt&&ji(Q,Ve),ze}for(Ge=u(Ge);!ht.done;Ve++,ht=te.next())ht=ce(Ge,Q,Ve,ht.value,pe),ht!==null&&(r&&ht.alternate!==null&&Ge.delete(ht.key===null?Ve:ht.key),X=m(ht,X,Ve),at===null?ze=ht:at.sibling=ht,at=ht);return r&&Ge.forEach(function(lw){return i(Q,lw)}),gt&&ji(Q,Ve),ze}function bt(Q,X,te,pe){if(typeof te=="object"&&te!==null&&te.type===C&&te.key===null&&(te=te.props.children),typeof te=="object"&&te!==null){switch(te.$$typeof){case _:e:{for(var ze=te.key;X!==null;){if(X.key===ze){if(ze=te.type,ze===C){if(X.tag===7){o(Q,X.sibling),pe=f(X,te.props.children),pe.return=Q,Q=pe;break e}}else if(X.elementType===ze||typeof ze=="object"&&ze!==null&&ze.$$typeof===G&&T1(ze)===X.type){o(Q,X.sibling),pe=f(X,te.props),il(pe,te),pe.return=Q,Q=pe;break e}o(Q,X);break}else i(Q,X);X=X.sibling}te.type===C?(pe=Bi(te.props.children,Q.mode,pe,te.key),pe.return=Q,Q=pe):(pe=Oc(te.type,te.key,te.props,null,Q.mode,pe),il(pe,te),pe.return=Q,Q=pe)}return S(Q);case T:e:{for(ze=te.key;X!==null;){if(X.key===ze)if(X.tag===4&&X.stateNode.containerInfo===te.containerInfo&&X.stateNode.implementation===te.implementation){o(Q,X.sibling),pe=f(X,te.children||[]),pe.return=Q,Q=pe;break e}else{o(Q,X);break}else i(Q,X);X=X.sibling}pe=kf(te,Q.mode,pe),pe.return=Q,Q=pe}return S(Q);case G:return ze=te._init,te=ze(te._payload),bt(Q,X,te,pe)}if(ke(te))return Ye(Q,X,te,pe);if(he(te)){if(ze=he(te),typeof ze!="function")throw Error(a(150));return te=ze.call(te),Ke(Q,X,te,pe)}if(typeof te.then=="function")return bt(Q,X,Xc(te),pe);if(te.$$typeof===O)return bt(Q,X,Fc(Q,te),pe);Wc(Q,te)}return typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint"?(te=""+te,X!==null&&X.tag===6?(o(Q,X.sibling),pe=f(X,te),pe.return=Q,Q=pe):(o(Q,X),pe=Nf(te,Q.mode,pe),pe.return=Q,Q=pe),S(Q)):o(Q,X)}return function(Q,X,te,pe){try{al=0;var ze=bt(Q,X,te,pe);return Ls=null,ze}catch(Ge){if(Ge===Xo||Ge===Uc)throw Ge;var at=ur(29,Ge,null,Q.mode);return at.lanes=pe,at.return=Q,at}finally{}}}var Us=_1(!0),x1=_1(!1),Dr=ue(null),sa=null;function Ja(r){var i=r.alternate;L(rn,rn.current&1),L(Dr,r),sa===null&&(i===null||Ms.current!==null||i.memoizedState!==null)&&(sa=r)}function S1(r){if(r.tag===22){if(L(rn,rn.current),L(Dr,r),sa===null){var i=r.alternate;i!==null&&i.memoizedState!==null&&(sa=r)}}else Za()}function Za(){L(rn,rn.current),L(Dr,Dr.current)}function ba(r){b(Dr),sa===r&&(sa=null),b(rn)}var rn=ue(0);function Qc(r){for(var i=r;i!==null;){if(i.tag===13){var o=i.memoizedState;if(o!==null&&(o=o.dehydrated,o===null||o.data==="$?"||Zd(o)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function ud(r,i,o,u){i=r.memoizedState,o=o(u,i),o=o==null?i:p({},i,o),r.memoizedState=o,r.lanes===0&&(r.updateQueue.baseState=o)}var hd={enqueueSetState:function(r,i,o){r=r._reactInternals;var u=gr(),f=Xa(u);f.payload=i,o!=null&&(f.callback=o),i=Wa(r,f,u),i!==null&&(mr(i,r,u),Qo(i,r,u))},enqueueReplaceState:function(r,i,o){r=r._reactInternals;var u=gr(),f=Xa(u);f.tag=1,f.payload=i,o!=null&&(f.callback=o),i=Wa(r,f,u),i!==null&&(mr(i,r,u),Qo(i,r,u))},enqueueForceUpdate:function(r,i){r=r._reactInternals;var o=gr(),u=Xa(o);u.tag=2,i!=null&&(u.callback=i),i=Wa(r,u,o),i!==null&&(mr(i,r,o),Qo(i,r,o))}};function C1(r,i,o,u,f,m,S){return r=r.stateNode,typeof r.shouldComponentUpdate=="function"?r.shouldComponentUpdate(u,m,S):i.prototype&&i.prototype.isPureReactComponent?!jo(o,u)||!jo(f,m):!0}function E1(r,i,o,u){r=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(o,u),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(o,u),i.state!==r&&hd.enqueueReplaceState(i,i.state,null)}function Yi(r,i){var o=i;if("ref"in i){o={};for(var u in i)u!=="ref"&&(o[u]=i[u])}if(r=r.defaultProps){o===i&&(o=p({},o));for(var f in r)o[f]===void 0&&(o[f]=r[f])}return o}var Jc=typeof reportError=="function"?reportError:function(r){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof r=="object"&&r!==null&&typeof r.message=="string"?String(r.message):String(r),error:r});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",r);return}console.error(r)};function A1(r){Jc(r)}function w1(r){console.error(r)}function b1(r){Jc(r)}function Zc(r,i){try{var o=r.onUncaughtError;o(i.value,{componentStack:i.stack})}catch(u){setTimeout(function(){throw u})}}function I1(r,i,o){try{var u=r.onCaughtError;u(o.value,{componentStack:o.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(f){setTimeout(function(){throw f})}}function fd(r,i,o){return o=Xa(o),o.tag=3,o.payload={element:null},o.callback=function(){Zc(r,i)},o}function R1(r){return r=Xa(r),r.tag=3,r}function N1(r,i,o,u){var f=o.type.getDerivedStateFromError;if(typeof f=="function"){var m=u.value;r.payload=function(){return f(m)},r.callback=function(){I1(i,o,u)}}var S=o.stateNode;S!==null&&typeof S.componentDidCatch=="function"&&(r.callback=function(){I1(i,o,u),typeof f!="function"&&(ii===null?ii=new Set([this]):ii.add(this));var w=u.stack;this.componentDidCatch(u.value,{componentStack:w!==null?w:""})})}function lA(r,i,o,u,f){if(o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){if(i=o.alternate,i!==null&&Vo(i,o,f,!0),o=Dr.current,o!==null){switch(o.tag){case 13:return sa===null?Fd():o.alternate===null&&$t===0&&($t=3),o.flags&=-257,o.flags|=65536,o.lanes=f,u===jf?o.flags|=16384:(i=o.updateQueue,i===null?o.updateQueue=new Set([u]):i.add(u),Ud(r,u,f)),!1;case 22:return o.flags|=65536,u===jf?o.flags|=16384:(i=o.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([u])},o.updateQueue=i):(o=i.retryQueue,o===null?i.retryQueue=new Set([u]):o.add(u)),Ud(r,u,f)),!1}throw Error(a(435,o.tag))}return Ud(r,u,f),Fd(),!1}if(gt)return i=Dr.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=f,u!==Df&&(r=Error(a(422),{cause:u}),Ko(Nr(r,o)))):(u!==Df&&(i=Error(a(423),{cause:u}),Ko(Nr(i,o))),r=r.current.alternate,r.flags|=65536,f&=-f,r.lanes|=f,u=Nr(u,o),f=fd(r.stateNode,u,f),$f(r,f),$t!==4&&($t=2)),!1;var m=Error(a(520),{cause:u});if(m=Nr(m,o),fl===null?fl=[m]:fl.push(m),$t!==4&&($t=2),i===null)return!0;u=Nr(u,o),o=i;do{switch(o.tag){case 3:return o.flags|=65536,r=f&-f,o.lanes|=r,r=fd(o.stateNode,u,r),$f(o,r),!1;case 1:if(i=o.type,m=o.stateNode,(o.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(ii===null||!ii.has(m))))return o.flags|=65536,f&=-f,o.lanes|=f,f=R1(f),N1(f,r,o,u),$f(o,f),!1}o=o.return}while(o!==null);return!1}var k1=Error(a(461)),un=!1;function _n(r,i,o,u){i.child=r===null?x1(i,null,o,u):Us(i,r.child,o,u)}function O1(r,i,o,u,f){o=o.render;var m=i.ref;if("ref"in u){var S={};for(var w in u)w!=="ref"&&(S[w]=u[w])}else S=u;return Ki(i),u=Xf(r,i,o,S,m,f),w=Wf(),r!==null&&!un?(Qf(r,i,f),Ia(r,i,f)):(gt&&w&&Of(i),i.flags|=1,_n(r,i,u,f),i.child)}function M1(r,i,o,u,f){if(r===null){var m=o.type;return typeof m=="function"&&!Rf(m)&&m.defaultProps===void 0&&o.compare===null?(i.tag=15,i.type=m,D1(r,i,m,u,f)):(r=Oc(o.type,null,u,i,i.mode,f),r.ref=i.ref,r.return=i,i.child=r)}if(m=r.child,!_d(r,f)){var S=m.memoizedProps;if(o=o.compare,o=o!==null?o:jo,o(S,u)&&r.ref===i.ref)return Ia(r,i,f)}return i.flags|=1,r=xa(m,u),r.ref=i.ref,r.return=i,i.child=r}function D1(r,i,o,u,f){if(r!==null){var m=r.memoizedProps;if(jo(m,u)&&r.ref===i.ref)if(un=!1,i.pendingProps=u=m,_d(r,f))(r.flags&131072)!==0&&(un=!0);else return i.lanes=r.lanes,Ia(r,i,f)}return dd(r,i,o,u,f)}function P1(r,i,o){var u=i.pendingProps,f=u.children,m=r!==null?r.memoizedState:null;if(u.mode==="hidden"){if((i.flags&128)!==0){if(u=m!==null?m.baseLanes|o:o,r!==null){for(f=i.child=r.child,m=0;f!==null;)m=m|f.lanes|f.childLanes,f=f.sibling;i.childLanes=m&~u}else i.childLanes=0,i.child=null;return F1(r,i,u,o)}if((o&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},r!==null&&Lc(i,m!==null?m.cachePool:null),m!==null?Dp(i,m):Vf(),S1(i);else return i.lanes=i.childLanes=536870912,F1(r,i,m!==null?m.baseLanes|o:o,o)}else m!==null?(Lc(i,m.cachePool),Dp(i,m),Za(),i.memoizedState=null):(r!==null&&Lc(i,null),Vf(),Za());return _n(r,i,f,o),i.child}function F1(r,i,o,u){var f=Hf();return f=f===null?null:{parent:nn._currentValue,pool:f},i.memoizedState={baseLanes:o,cachePool:f},r!==null&&Lc(i,null),Vf(),S1(i),r!==null&&Vo(r,i,u,!0),null}function eu(r,i){var o=i.ref;if(o===null)r!==null&&r.ref!==null&&(i.flags|=4194816);else{if(typeof o!="function"&&typeof o!="object")throw Error(a(284));(r===null||r.ref!==o)&&(i.flags|=4194816)}}function dd(r,i,o,u,f){return Ki(i),o=Xf(r,i,o,u,void 0,f),u=Wf(),r!==null&&!un?(Qf(r,i,f),Ia(r,i,f)):(gt&&u&&Of(i),i.flags|=1,_n(r,i,o,f),i.child)}function L1(r,i,o,u,f,m){return Ki(i),i.updateQueue=null,o=Fp(i,u,o,f),Pp(r),u=Wf(),r!==null&&!un?(Qf(r,i,m),Ia(r,i,m)):(gt&&u&&Of(i),i.flags|=1,_n(r,i,o,m),i.child)}function U1(r,i,o,u,f){if(Ki(i),i.stateNode===null){var m=Is,S=o.contextType;typeof S=="object"&&S!==null&&(m=Dn(S)),m=new o(u,m),i.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=hd,i.stateNode=m,m._reactInternals=i,m=i.stateNode,m.props=u,m.state=i.memoizedState,m.refs={},zf(i),S=o.contextType,m.context=typeof S=="object"&&S!==null?Dn(S):Is,m.state=i.memoizedState,S=o.getDerivedStateFromProps,typeof S=="function"&&(ud(i,o,S,u),m.state=i.memoizedState),typeof o.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(S=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),S!==m.state&&hd.enqueueReplaceState(m,m.state,null),Zo(i,u,m,f),Jo(),m.state=i.memoizedState),typeof m.componentDidMount=="function"&&(i.flags|=4194308),u=!0}else if(r===null){m=i.stateNode;var w=i.memoizedProps,z=Yi(o,w);m.props=z;var ne=m.context,me=o.contextType;S=Is,typeof me=="object"&&me!==null&&(S=Dn(me));var _e=o.getDerivedStateFromProps;me=typeof _e=="function"||typeof m.getSnapshotBeforeUpdate=="function",w=i.pendingProps!==w,me||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(w||ne!==S)&&E1(i,m,u,S),Ya=!1;var oe=i.memoizedState;m.state=oe,Zo(i,u,m,f),Jo(),ne=i.memoizedState,w||oe!==ne||Ya?(typeof _e=="function"&&(ud(i,o,_e,u),ne=i.memoizedState),(z=Ya||C1(i,o,z,u,oe,ne,S))?(me||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(i.flags|=4194308)):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=u,i.memoizedState=ne),m.props=u,m.state=ne,m.context=S,u=z):(typeof m.componentDidMount=="function"&&(i.flags|=4194308),u=!1)}else{m=i.stateNode,Gf(r,i),S=i.memoizedProps,me=Yi(o,S),m.props=me,_e=i.pendingProps,oe=m.context,ne=o.contextType,z=Is,typeof ne=="object"&&ne!==null&&(z=Dn(ne)),w=o.getDerivedStateFromProps,(ne=typeof w=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(S!==_e||oe!==z)&&E1(i,m,u,z),Ya=!1,oe=i.memoizedState,m.state=oe,Zo(i,u,m,f),Jo();var ce=i.memoizedState;S!==_e||oe!==ce||Ya||r!==null&&r.dependencies!==null&&Pc(r.dependencies)?(typeof w=="function"&&(ud(i,o,w,u),ce=i.memoizedState),(me=Ya||C1(i,o,me,u,oe,ce,z)||r!==null&&r.dependencies!==null&&Pc(r.dependencies))?(ne||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(u,ce,z),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(u,ce,z)),typeof m.componentDidUpdate=="function"&&(i.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof m.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=1024),i.memoizedProps=u,i.memoizedState=ce),m.props=u,m.state=ce,m.context=z,u=me):(typeof m.componentDidUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||S===r.memoizedProps&&oe===r.memoizedState||(i.flags|=1024),u=!1)}return m=u,eu(r,i),u=(i.flags&128)!==0,m||u?(m=i.stateNode,o=u&&typeof o.getDerivedStateFromError!="function"?null:m.render(),i.flags|=1,r!==null&&u?(i.child=Us(i,r.child,null,f),i.child=Us(i,null,o,f)):_n(r,i,o,f),i.memoizedState=m.state,r=i.child):r=Ia(r,i,f),r}function B1(r,i,o,u){return $o(),i.flags|=256,_n(r,i,o,u),i.child}var gd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function md(r){return{baseLanes:r,cachePool:wp()}}function pd(r,i,o){return r=r!==null?r.childLanes&~o:0,i&&(r|=Pr),r}function H1(r,i,o){var u=i.pendingProps,f=!1,m=(i.flags&128)!==0,S;if((S=m)||(S=r!==null&&r.memoizedState===null?!1:(rn.current&2)!==0),S&&(f=!0,i.flags&=-129),S=(i.flags&32)!==0,i.flags&=-33,r===null){if(gt){if(f?Ja(i):Za(),gt){var w=Gt,z;if(z=w){e:{for(z=w,w=ia;z.nodeType!==8;){if(!w){w=null;break e}if(z=Vr(z.nextSibling),z===null){w=null;break e}}w=z}w!==null?(i.memoizedState={dehydrated:w,treeContext:Hi!==null?{id:Sa,overflow:Ca}:null,retryLane:536870912,hydrationErrors:null},z=ur(18,null,null,0),z.stateNode=w,z.return=i,i.child=z,Kn=i,Gt=null,z=!0):z=!1}z||Gi(i)}if(w=i.memoizedState,w!==null&&(w=w.dehydrated,w!==null))return Zd(w)?i.lanes=32:i.lanes=536870912,null;ba(i)}return w=u.children,u=u.fallback,f?(Za(),f=i.mode,w=tu({mode:"hidden",children:w},f),u=Bi(u,f,o,null),w.return=i,u.return=i,w.sibling=u,i.child=w,f=i.child,f.memoizedState=md(o),f.childLanes=pd(r,S,o),i.memoizedState=gd,u):(Ja(i),vd(i,w))}if(z=r.memoizedState,z!==null&&(w=z.dehydrated,w!==null)){if(m)i.flags&256?(Ja(i),i.flags&=-257,i=yd(r,i,o)):i.memoizedState!==null?(Za(),i.child=r.child,i.flags|=128,i=null):(Za(),f=u.fallback,w=i.mode,u=tu({mode:"visible",children:u.children},w),f=Bi(f,w,o,null),f.flags|=2,u.return=i,f.return=i,u.sibling=f,i.child=u,Us(i,r.child,null,o),u=i.child,u.memoizedState=md(o),u.childLanes=pd(r,S,o),i.memoizedState=gd,i=f);else if(Ja(i),Zd(w)){if(S=w.nextSibling&&w.nextSibling.dataset,S)var ne=S.dgst;S=ne,u=Error(a(419)),u.stack="",u.digest=S,Ko({value:u,source:null,stack:null}),i=yd(r,i,o)}else if(un||Vo(r,i,o,!1),S=(o&r.childLanes)!==0,un||S){if(S=Lt,S!==null&&(u=o&-o,u=(u&42)!==0?1:ko(u),u=(u&(S.suspendedLanes|o))!==0?0:u,u!==0&&u!==z.retryLane))throw z.retryLane=u,bs(r,u),mr(S,r,u),k1;w.data==="$?"||Fd(),i=yd(r,i,o)}else w.data==="$?"?(i.flags|=192,i.child=r.child,i=null):(r=z.treeContext,Gt=Vr(w.nextSibling),Kn=i,gt=!0,zi=null,ia=!1,r!==null&&(Or[Mr++]=Sa,Or[Mr++]=Ca,Or[Mr++]=Hi,Sa=r.id,Ca=r.overflow,Hi=i),i=vd(i,u.children),i.flags|=4096);return i}return f?(Za(),f=u.fallback,w=i.mode,z=r.child,ne=z.sibling,u=xa(z,{mode:"hidden",children:u.children}),u.subtreeFlags=z.subtreeFlags&65011712,ne!==null?f=xa(ne,f):(f=Bi(f,w,o,null),f.flags|=2),f.return=i,u.return=i,u.sibling=f,i.child=u,u=f,f=i.child,w=r.child.memoizedState,w===null?w=md(o):(z=w.cachePool,z!==null?(ne=nn._currentValue,z=z.parent!==ne?{parent:ne,pool:ne}:z):z=wp(),w={baseLanes:w.baseLanes|o,cachePool:z}),f.memoizedState=w,f.childLanes=pd(r,S,o),i.memoizedState=gd,u):(Ja(i),o=r.child,r=o.sibling,o=xa(o,{mode:"visible",children:u.children}),o.return=i,o.sibling=null,r!==null&&(S=i.deletions,S===null?(i.deletions=[r],i.flags|=16):S.push(r)),i.child=o,i.memoizedState=null,o)}function vd(r,i){return i=tu({mode:"visible",children:i},r.mode),i.return=r,r.child=i}function tu(r,i){return r=ur(22,r,null,i),r.lanes=0,r.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},r}function yd(r,i,o){return Us(i,r.child,null,o),r=vd(i,i.pendingProps.children),r.flags|=2,i.memoizedState=null,r}function j1(r,i,o){r.lanes|=i;var u=r.alternate;u!==null&&(u.lanes|=i),Ff(r.return,i,o)}function Td(r,i,o,u,f){var m=r.memoizedState;m===null?r.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:u,tail:o,tailMode:f}:(m.isBackwards=i,m.rendering=null,m.renderingStartTime=0,m.last=u,m.tail=o,m.tailMode=f)}function z1(r,i,o){var u=i.pendingProps,f=u.revealOrder,m=u.tail;if(_n(r,i,u.children,o),u=rn.current,(u&2)!==0)u=u&1|2,i.flags|=128;else{if(r!==null&&(r.flags&128)!==0)e:for(r=i.child;r!==null;){if(r.tag===13)r.memoizedState!==null&&j1(r,o,i);else if(r.tag===19)j1(r,o,i);else if(r.child!==null){r.child.return=r,r=r.child;continue}if(r===i)break e;for(;r.sibling===null;){if(r.return===null||r.return===i)break e;r=r.return}r.sibling.return=r.return,r=r.sibling}u&=1}switch(L(rn,u),f){case"forwards":for(o=i.child,f=null;o!==null;)r=o.alternate,r!==null&&Qc(r)===null&&(f=o),o=o.sibling;o=f,o===null?(f=i.child,i.child=null):(f=o.sibling,o.sibling=null),Td(i,!1,f,o,m);break;case"backwards":for(o=null,f=i.child,i.child=null;f!==null;){if(r=f.alternate,r!==null&&Qc(r)===null){i.child=f;break}r=f.sibling,f.sibling=o,o=f,f=r}Td(i,!0,o,null,m);break;case"together":Td(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function Ia(r,i,o){if(r!==null&&(i.dependencies=r.dependencies),ai|=i.lanes,(o&i.childLanes)===0)if(r!==null){if(Vo(r,i,o,!1),(o&i.childLanes)===0)return null}else return null;if(r!==null&&i.child!==r.child)throw Error(a(153));if(i.child!==null){for(r=i.child,o=xa(r,r.pendingProps),i.child=o,o.return=i;r.sibling!==null;)r=r.sibling,o=o.sibling=xa(r,r.pendingProps),o.return=i;o.sibling=null}return i.child}function _d(r,i){return(r.lanes&i)!==0?!0:(r=r.dependencies,!!(r!==null&&Pc(r)))}function cA(r,i,o){switch(i.tag){case 3:Ce(i,i.stateNode.containerInfo),qa(i,nn,r.memoizedState.cache),$o();break;case 27:case 5:De(i);break;case 4:Ce(i,i.stateNode.containerInfo);break;case 10:qa(i,i.type,i.memoizedProps.value);break;case 13:var u=i.memoizedState;if(u!==null)return u.dehydrated!==null?(Ja(i),i.flags|=128,null):(o&i.child.childLanes)!==0?H1(r,i,o):(Ja(i),r=Ia(r,i,o),r!==null?r.sibling:null);Ja(i);break;case 19:var f=(r.flags&128)!==0;if(u=(o&i.childLanes)!==0,u||(Vo(r,i,o,!1),u=(o&i.childLanes)!==0),f){if(u)return z1(r,i,o);i.flags|=128}if(f=i.memoizedState,f!==null&&(f.rendering=null,f.tail=null,f.lastEffect=null),L(rn,rn.current),u)break;return null;case 22:case 23:return i.lanes=0,P1(r,i,o);case 24:qa(i,nn,r.memoizedState.cache)}return Ia(r,i,o)}function G1(r,i,o){if(r!==null)if(r.memoizedProps!==i.pendingProps)un=!0;else{if(!_d(r,o)&&(i.flags&128)===0)return un=!1,cA(r,i,o);un=(r.flags&131072)!==0}else un=!1,gt&&(i.flags&1048576)!==0&&Tp(i,Dc,i.index);switch(i.lanes=0,i.tag){case 16:e:{r=i.pendingProps;var u=i.elementType,f=u._init;if(u=f(u._payload),i.type=u,typeof u=="function")Rf(u)?(r=Yi(u,r),i.tag=1,i=U1(null,i,u,r,o)):(i.tag=0,i=dd(null,i,u,r,o));else{if(u!=null){if(f=u.$$typeof,f===j){i.tag=11,i=O1(null,i,u,r,o);break e}else if(f===I){i.tag=14,i=M1(null,i,u,r,o);break e}}throw i=je(u)||u,Error(a(306,i,""))}}return i;case 0:return dd(r,i,i.type,i.pendingProps,o);case 1:return u=i.type,f=Yi(u,i.pendingProps),U1(r,i,u,f,o);case 3:e:{if(Ce(i,i.stateNode.containerInfo),r===null)throw Error(a(387));u=i.pendingProps;var m=i.memoizedState;f=m.element,Gf(r,i),Zo(i,u,null,o);var S=i.memoizedState;if(u=S.cache,qa(i,nn,u),u!==m.cache&&Lf(i,[nn],o,!0),Jo(),u=S.element,m.isDehydrated)if(m={element:u,isDehydrated:!1,cache:S.cache},i.updateQueue.baseState=m,i.memoizedState=m,i.flags&256){i=B1(r,i,u,o);break e}else if(u!==f){f=Nr(Error(a(424)),i),Ko(f),i=B1(r,i,u,o);break e}else{switch(r=i.stateNode.containerInfo,r.nodeType){case 9:r=r.body;break;default:r=r.nodeName==="HTML"?r.ownerDocument.body:r}for(Gt=Vr(r.firstChild),Kn=i,gt=!0,zi=null,ia=!0,o=x1(i,null,u,o),i.child=o;o;)o.flags=o.flags&-3|4096,o=o.sibling}else{if($o(),u===f){i=Ia(r,i,o);break e}_n(r,i,u,o)}i=i.child}return i;case 26:return eu(r,i),r===null?(o=qv(i.type,null,i.pendingProps,null))?i.memoizedState=o:gt||(o=i.type,r=i.pendingProps,u=mu(Z.current).createElement(o),u[ln]=i,u[cn]=r,Sn(u,o,r),ee(u),i.stateNode=u):i.memoizedState=qv(i.type,r.memoizedProps,i.pendingProps,r.memoizedState),null;case 27:return De(i),r===null&&gt&&(u=i.stateNode=$v(i.type,i.pendingProps,Z.current),Kn=i,ia=!0,f=Gt,li(i.type)?(e0=f,Gt=Vr(u.firstChild)):Gt=f),_n(r,i,i.pendingProps.children,o),eu(r,i),r===null&&(i.flags|=4194304),i.child;case 5:return r===null&&gt&&((f=u=Gt)&&(u=LA(u,i.type,i.pendingProps,ia),u!==null?(i.stateNode=u,Kn=i,Gt=Vr(u.firstChild),ia=!1,f=!0):f=!1),f||Gi(i)),De(i),f=i.type,m=i.pendingProps,S=r!==null?r.memoizedProps:null,u=m.children,Wd(f,m)?u=null:S!==null&&Wd(f,S)&&(i.flags|=32),i.memoizedState!==null&&(f=Xf(r,i,tA,null,null,o),xl._currentValue=f),eu(r,i),_n(r,i,u,o),i.child;case 6:return r===null&&gt&&((r=o=Gt)&&(o=UA(o,i.pendingProps,ia),o!==null?(i.stateNode=o,Kn=i,Gt=null,r=!0):r=!1),r||Gi(i)),null;case 13:return H1(r,i,o);case 4:return Ce(i,i.stateNode.containerInfo),u=i.pendingProps,r===null?i.child=Us(i,null,u,o):_n(r,i,u,o),i.child;case 11:return O1(r,i,i.type,i.pendingProps,o);case 7:return _n(r,i,i.pendingProps,o),i.child;case 8:return _n(r,i,i.pendingProps.children,o),i.child;case 12:return _n(r,i,i.pendingProps.children,o),i.child;case 10:return u=i.pendingProps,qa(i,i.type,u.value),_n(r,i,u.children,o),i.child;case 9:return f=i.type._context,u=i.pendingProps.children,Ki(i),f=Dn(f),u=u(f),i.flags|=1,_n(r,i,u,o),i.child;case 14:return M1(r,i,i.type,i.pendingProps,o);case 15:return D1(r,i,i.type,i.pendingProps,o);case 19:return z1(r,i,o);case 31:return u=i.pendingProps,o=i.mode,u={mode:u.mode,children:u.children},r===null?(o=tu(u,o),o.ref=i.ref,i.child=o,o.return=i,i=o):(o=xa(r.child,u),o.ref=i.ref,i.child=o,o.return=i,i=o),i;case 22:return P1(r,i,o);case 24:return Ki(i),u=Dn(nn),r===null?(f=Hf(),f===null&&(f=Lt,m=Uf(),f.pooledCache=m,m.refCount++,m!==null&&(f.pooledCacheLanes|=o),f=m),i.memoizedState={parent:u,cache:f},zf(i),qa(i,nn,f)):((r.lanes&o)!==0&&(Gf(r,i),Zo(i,null,null,o),Jo()),f=r.memoizedState,m=i.memoizedState,f.parent!==u?(f={parent:u,cache:u},i.memoizedState=f,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=f),qa(i,nn,u)):(u=m.cache,qa(i,nn,u),u!==f.cache&&Lf(i,[nn],o,!0))),_n(r,i,i.pendingProps.children,o),i.child;case 29:throw i.pendingProps}throw Error(a(156,i.tag))}function Ra(r){r.flags|=4}function $1(r,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)r.flags&=-16777217;else if(r.flags|=16777216,!Jv(i)){if(i=Dr.current,i!==null&&((ut&4194048)===ut?sa!==null:(ut&62914560)!==ut&&(ut&536870912)===0||i!==sa))throw Wo=jf,bp;r.flags|=8192}}function nu(r,i){i!==null&&(r.flags|=4),r.flags&16384&&(i=r.tag!==22?Ro():536870912,r.lanes|=i,zs|=i)}function sl(r,i){if(!gt)switch(r.tailMode){case"hidden":i=r.tail;for(var o=null;i!==null;)i.alternate!==null&&(o=i),i=i.sibling;o===null?r.tail=null:o.sibling=null;break;case"collapsed":o=r.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?i||r.tail===null?r.tail=null:r.tail.sibling=null:u.sibling=null}}function jt(r){var i=r.alternate!==null&&r.alternate.child===r.child,o=0,u=0;if(i)for(var f=r.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags&65011712,u|=f.flags&65011712,f.return=r,f=f.sibling;else for(f=r.child;f!==null;)o|=f.lanes|f.childLanes,u|=f.subtreeFlags,u|=f.flags,f.return=r,f=f.sibling;return r.subtreeFlags|=u,r.childLanes=o,i}function uA(r,i,o){var u=i.pendingProps;switch(Mf(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return jt(i),null;case 1:return jt(i),null;case 3:return o=i.stateNode,u=null,r!==null&&(u=r.memoizedState.cache),i.memoizedState.cache!==u&&(i.flags|=2048),Aa(nn),Pe(),o.pendingContext&&(o.context=o.pendingContext,o.pendingContext=null),(r===null||r.child===null)&&(Go(i)?Ra(i):r===null||r.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Sp())),jt(i),null;case 26:return o=i.memoizedState,r===null?(Ra(i),o!==null?(jt(i),$1(i,o)):(jt(i),i.flags&=-16777217)):o?o!==r.memoizedState?(Ra(i),jt(i),$1(i,o)):(jt(i),i.flags&=-16777217):(r.memoizedProps!==u&&Ra(i),jt(i),i.flags&=-16777217),null;case 27:lt(i),o=Z.current;var f=i.type;if(r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ra(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return jt(i),null}r=P.current,Go(i)?_p(i):(r=$v(f,u,o),i.stateNode=r,Ra(i))}return jt(i),null;case 5:if(lt(i),o=i.type,r!==null&&i.stateNode!=null)r.memoizedProps!==u&&Ra(i);else{if(!u){if(i.stateNode===null)throw Error(a(166));return jt(i),null}if(r=P.current,Go(i))_p(i);else{switch(f=mu(Z.current),r){case 1:r=f.createElementNS("http://www.w3.org/2000/svg",o);break;case 2:r=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;default:switch(o){case"svg":r=f.createElementNS("http://www.w3.org/2000/svg",o);break;case"math":r=f.createElementNS("http://www.w3.org/1998/Math/MathML",o);break;case"script":r=f.createElement("div"),r.innerHTML="<script><\/script>",r=r.removeChild(r.firstChild);break;case"select":r=typeof u.is=="string"?f.createElement("select",{is:u.is}):f.createElement("select"),u.multiple?r.multiple=!0:u.size&&(r.size=u.size);break;default:r=typeof u.is=="string"?f.createElement(o,{is:u.is}):f.createElement(o)}}r[ln]=i,r[cn]=u;e:for(f=i.child;f!==null;){if(f.tag===5||f.tag===6)r.appendChild(f.stateNode);else if(f.tag!==4&&f.tag!==27&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===i)break e;for(;f.sibling===null;){if(f.return===null||f.return===i)break e;f=f.return}f.sibling.return=f.return,f=f.sibling}i.stateNode=r;e:switch(Sn(r,o,u),o){case"button":case"input":case"select":case"textarea":r=!!u.autoFocus;break e;case"img":r=!0;break e;default:r=!1}r&&Ra(i)}}return jt(i),i.flags&=-16777217,null;case 6:if(r&&i.stateNode!=null)r.memoizedProps!==u&&Ra(i);else{if(typeof u!="string"&&i.stateNode===null)throw Error(a(166));if(r=Z.current,Go(i)){if(r=i.stateNode,o=i.memoizedProps,u=null,f=Kn,f!==null)switch(f.tag){case 27:case 5:u=f.memoizedProps}r[ln]=i,r=!!(r.nodeValue===o||u!==null&&u.suppressHydrationWarning===!0||Lv(r.nodeValue,o)),r||Gi(i)}else r=mu(r).createTextNode(u),r[ln]=i,i.stateNode=r}return jt(i),null;case 13:if(u=i.memoizedState,r===null||r.memoizedState!==null&&r.memoizedState.dehydrated!==null){if(f=Go(i),u!==null&&u.dehydrated!==null){if(r===null){if(!f)throw Error(a(318));if(f=i.memoizedState,f=f!==null?f.dehydrated:null,!f)throw Error(a(317));f[ln]=i}else $o(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;jt(i),f=!1}else f=Sp(),r!==null&&r.memoizedState!==null&&(r.memoizedState.hydrationErrors=f),f=!0;if(!f)return i.flags&256?(ba(i),i):(ba(i),null)}if(ba(i),(i.flags&128)!==0)return i.lanes=o,i;if(o=u!==null,r=r!==null&&r.memoizedState!==null,o){u=i.child,f=null,u.alternate!==null&&u.alternate.memoizedState!==null&&u.alternate.memoizedState.cachePool!==null&&(f=u.alternate.memoizedState.cachePool.pool);var m=null;u.memoizedState!==null&&u.memoizedState.cachePool!==null&&(m=u.memoizedState.cachePool.pool),m!==f&&(u.flags|=2048)}return o!==r&&o&&(i.child.flags|=8192),nu(i,i.updateQueue),jt(i),null;case 4:return Pe(),r===null&&Kd(i.stateNode.containerInfo),jt(i),null;case 10:return Aa(i.type),jt(i),null;case 19:if(b(rn),f=i.memoizedState,f===null)return jt(i),null;if(u=(i.flags&128)!==0,m=f.rendering,m===null)if(u)sl(f,!1);else{if($t!==0||r!==null&&(r.flags&128)!==0)for(r=i.child;r!==null;){if(m=Qc(r),m!==null){for(i.flags|=128,sl(f,!1),r=m.updateQueue,i.updateQueue=r,nu(i,r),i.subtreeFlags=0,r=o,o=i.child;o!==null;)yp(o,r),o=o.sibling;return L(rn,rn.current&1|2),i.child}r=r.sibling}f.tail!==null&&Fe()>iu&&(i.flags|=128,u=!0,sl(f,!1),i.lanes=4194304)}else{if(!u)if(r=Qc(m),r!==null){if(i.flags|=128,u=!0,r=r.updateQueue,i.updateQueue=r,nu(i,r),sl(f,!0),f.tail===null&&f.tailMode==="hidden"&&!m.alternate&&!gt)return jt(i),null}else 2*Fe()-f.renderingStartTime>iu&&o!==536870912&&(i.flags|=128,u=!0,sl(f,!1),i.lanes=4194304);f.isBackwards?(m.sibling=i.child,i.child=m):(r=f.last,r!==null?r.sibling=m:i.child=m,f.last=m)}return f.tail!==null?(i=f.tail,f.rendering=i,f.tail=i.sibling,f.renderingStartTime=Fe(),i.sibling=null,r=rn.current,L(rn,u?r&1|2:r&1),i):(jt(i),null);case 22:case 23:return ba(i),qf(),u=i.memoizedState!==null,r!==null?r.memoizedState!==null!==u&&(i.flags|=8192):u&&(i.flags|=8192),u?(o&536870912)!==0&&(i.flags&128)===0&&(jt(i),i.subtreeFlags&6&&(i.flags|=8192)):jt(i),o=i.updateQueue,o!==null&&nu(i,o.retryQueue),o=null,r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),u=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(u=i.memoizedState.cachePool.pool),u!==o&&(i.flags|=2048),r!==null&&b(Vi),null;case 24:return o=null,r!==null&&(o=r.memoizedState.cache),i.memoizedState.cache!==o&&(i.flags|=2048),Aa(nn),jt(i),null;case 25:return null;case 30:return null}throw Error(a(156,i.tag))}function hA(r,i){switch(Mf(i),i.tag){case 1:return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 3:return Aa(nn),Pe(),r=i.flags,(r&65536)!==0&&(r&128)===0?(i.flags=r&-65537|128,i):null;case 26:case 27:case 5:return lt(i),null;case 13:if(ba(i),r=i.memoizedState,r!==null&&r.dehydrated!==null){if(i.alternate===null)throw Error(a(340));$o()}return r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 19:return b(rn),null;case 4:return Pe(),null;case 10:return Aa(i.type),null;case 22:case 23:return ba(i),qf(),r!==null&&b(Vi),r=i.flags,r&65536?(i.flags=r&-65537|128,i):null;case 24:return Aa(nn),null;case 25:return null;default:return null}}function K1(r,i){switch(Mf(i),i.tag){case 3:Aa(nn),Pe();break;case 26:case 27:case 5:lt(i);break;case 4:Pe();break;case 13:ba(i);break;case 19:b(rn);break;case 10:Aa(i.type);break;case 22:case 23:ba(i),qf(),r!==null&&b(Vi);break;case 24:Aa(nn)}}function ol(r,i){try{var o=i.updateQueue,u=o!==null?o.lastEffect:null;if(u!==null){var f=u.next;o=f;do{if((o.tag&r)===r){u=void 0;var m=o.create,S=o.inst;u=m(),S.destroy=u}o=o.next}while(o!==f)}}catch(w){Dt(i,i.return,w)}}function ei(r,i,o){try{var u=i.updateQueue,f=u!==null?u.lastEffect:null;if(f!==null){var m=f.next;u=m;do{if((u.tag&r)===r){var S=u.inst,w=S.destroy;if(w!==void 0){S.destroy=void 0,f=i;var z=o,ne=w;try{ne()}catch(me){Dt(f,z,me)}}}u=u.next}while(u!==m)}}catch(me){Dt(i,i.return,me)}}function V1(r){var i=r.updateQueue;if(i!==null){var o=r.stateNode;try{Mp(i,o)}catch(u){Dt(r,r.return,u)}}}function q1(r,i,o){o.props=Yi(r.type,r.memoizedProps),o.state=r.memoizedState;try{o.componentWillUnmount()}catch(u){Dt(r,i,u)}}function ll(r,i){try{var o=r.ref;if(o!==null){switch(r.tag){case 26:case 27:case 5:var u=r.stateNode;break;case 30:u=r.stateNode;break;default:u=r.stateNode}typeof o=="function"?r.refCleanup=o(u):o.current=u}}catch(f){Dt(r,i,f)}}function oa(r,i){var o=r.ref,u=r.refCleanup;if(o!==null)if(typeof u=="function")try{u()}catch(f){Dt(r,i,f)}finally{r.refCleanup=null,r=r.alternate,r!=null&&(r.refCleanup=null)}else if(typeof o=="function")try{o(null)}catch(f){Dt(r,i,f)}else o.current=null}function Y1(r){var i=r.type,o=r.memoizedProps,u=r.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":o.autoFocus&&u.focus();break e;case"img":o.src?u.src=o.src:o.srcSet&&(u.srcset=o.srcSet)}}catch(f){Dt(r,r.return,f)}}function xd(r,i,o){try{var u=r.stateNode;OA(u,r.type,o,i),u[cn]=i}catch(f){Dt(r,r.return,f)}}function X1(r){return r.tag===5||r.tag===3||r.tag===26||r.tag===27&&li(r.type)||r.tag===4}function Sd(r){e:for(;;){for(;r.sibling===null;){if(r.return===null||X1(r.return))return null;r=r.return}for(r.sibling.return=r.return,r=r.sibling;r.tag!==5&&r.tag!==6&&r.tag!==18;){if(r.tag===27&&li(r.type)||r.flags&2||r.child===null||r.tag===4)continue e;r.child.return=r,r=r.child}if(!(r.flags&2))return r.stateNode}}function Cd(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?(o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o).insertBefore(r,i):(i=o.nodeType===9?o.body:o.nodeName==="HTML"?o.ownerDocument.body:o,i.appendChild(r),o=o._reactRootContainer,o!=null||i.onclick!==null||(i.onclick=gu));else if(u!==4&&(u===27&&li(r.type)&&(o=r.stateNode,i=null),r=r.child,r!==null))for(Cd(r,i,o),r=r.sibling;r!==null;)Cd(r,i,o),r=r.sibling}function ru(r,i,o){var u=r.tag;if(u===5||u===6)r=r.stateNode,i?o.insertBefore(r,i):o.appendChild(r);else if(u!==4&&(u===27&&li(r.type)&&(o=r.stateNode),r=r.child,r!==null))for(ru(r,i,o),r=r.sibling;r!==null;)ru(r,i,o),r=r.sibling}function W1(r){var i=r.stateNode,o=r.memoizedProps;try{for(var u=r.type,f=i.attributes;f.length;)i.removeAttributeNode(f[0]);Sn(i,u,o),i[ln]=r,i[cn]=o}catch(m){Dt(r,r.return,m)}}var Na=!1,Xt=!1,Ed=!1,Q1=typeof WeakSet=="function"?WeakSet:Set,hn=null;function fA(r,i){if(r=r.containerInfo,Yd=xu,r=lp(r),Sf(r)){if("selectionStart"in r)var o={start:r.selectionStart,end:r.selectionEnd};else e:{o=(o=r.ownerDocument)&&o.defaultView||window;var u=o.getSelection&&o.getSelection();if(u&&u.rangeCount!==0){o=u.anchorNode;var f=u.anchorOffset,m=u.focusNode;u=u.focusOffset;try{o.nodeType,m.nodeType}catch{o=null;break e}var S=0,w=-1,z=-1,ne=0,me=0,_e=r,oe=null;t:for(;;){for(var ce;_e!==o||f!==0&&_e.nodeType!==3||(w=S+f),_e!==m||u!==0&&_e.nodeType!==3||(z=S+u),_e.nodeType===3&&(S+=_e.nodeValue.length),(ce=_e.firstChild)!==null;)oe=_e,_e=ce;for(;;){if(_e===r)break t;if(oe===o&&++ne===f&&(w=S),oe===m&&++me===u&&(z=S),(ce=_e.nextSibling)!==null)break;_e=oe,oe=_e.parentNode}_e=ce}o=w===-1||z===-1?null:{start:w,end:z}}else o=null}o=o||{start:0,end:0}}else o=null;for(Xd={focusedElem:r,selectionRange:o},xu=!1,hn=i;hn!==null;)if(i=hn,r=i.child,(i.subtreeFlags&1024)!==0&&r!==null)r.return=i,hn=r;else for(;hn!==null;){switch(i=hn,m=i.alternate,r=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((r&1024)!==0&&m!==null){r=void 0,o=i,f=m.memoizedProps,m=m.memoizedState,u=o.stateNode;try{var Ye=Yi(o.type,f,o.elementType===o.type);r=u.getSnapshotBeforeUpdate(Ye,m),u.__reactInternalSnapshotBeforeUpdate=r}catch(Ke){Dt(o,o.return,Ke)}}break;case 3:if((r&1024)!==0){if(r=i.stateNode.containerInfo,o=r.nodeType,o===9)Jd(r);else if(o===1)switch(r.nodeName){case"HEAD":case"HTML":case"BODY":Jd(r);break;default:r.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((r&1024)!==0)throw Error(a(163))}if(r=i.sibling,r!==null){r.return=i.return,hn=r;break}hn=i.return}}function J1(r,i,o){var u=o.flags;switch(o.tag){case 0:case 11:case 15:ti(r,o),u&4&&ol(5,o);break;case 1:if(ti(r,o),u&4)if(r=o.stateNode,i===null)try{r.componentDidMount()}catch(S){Dt(o,o.return,S)}else{var f=Yi(o.type,i.memoizedProps);i=i.memoizedState;try{r.componentDidUpdate(f,i,r.__reactInternalSnapshotBeforeUpdate)}catch(S){Dt(o,o.return,S)}}u&64&&V1(o),u&512&&ll(o,o.return);break;case 3:if(ti(r,o),u&64&&(r=o.updateQueue,r!==null)){if(i=null,o.child!==null)switch(o.child.tag){case 27:case 5:i=o.child.stateNode;break;case 1:i=o.child.stateNode}try{Mp(r,i)}catch(S){Dt(o,o.return,S)}}break;case 27:i===null&&u&4&&W1(o);case 26:case 5:ti(r,o),i===null&&u&4&&Y1(o),u&512&&ll(o,o.return);break;case 12:ti(r,o);break;case 13:ti(r,o),u&4&&tv(r,o),u&64&&(r=o.memoizedState,r!==null&&(r=r.dehydrated,r!==null&&(o=xA.bind(null,o),BA(r,o))));break;case 22:if(u=o.memoizedState!==null||Na,!u){i=i!==null&&i.memoizedState!==null||Xt,f=Na;var m=Xt;Na=u,(Xt=i)&&!m?ni(r,o,(o.subtreeFlags&8772)!==0):ti(r,o),Na=f,Xt=m}break;case 30:break;default:ti(r,o)}}function Z1(r){var i=r.alternate;i!==null&&(r.alternate=null,Z1(i)),r.child=null,r.deletions=null,r.sibling=null,r.tag===5&&(i=r.stateNode,i!==null&&N(i)),r.stateNode=null,r.return=null,r.dependencies=null,r.memoizedProps=null,r.memoizedState=null,r.pendingProps=null,r.stateNode=null,r.updateQueue=null}var Bt=null,er=!1;function ka(r,i,o){for(o=o.child;o!==null;)ev(r,i,o),o=o.sibling}function ev(r,i,o){if(Tn&&typeof Tn.onCommitFiberUnmount=="function")try{Tn.onCommitFiberUnmount(Gn,o)}catch{}switch(o.tag){case 26:Xt||oa(o,i),ka(r,i,o),o.memoizedState?o.memoizedState.count--:o.stateNode&&(o=o.stateNode,o.parentNode.removeChild(o));break;case 27:Xt||oa(o,i);var u=Bt,f=er;li(o.type)&&(Bt=o.stateNode,er=!1),ka(r,i,o),vl(o.stateNode),Bt=u,er=f;break;case 5:Xt||oa(o,i);case 6:if(u=Bt,f=er,Bt=null,ka(r,i,o),Bt=u,er=f,Bt!==null)if(er)try{(Bt.nodeType===9?Bt.body:Bt.nodeName==="HTML"?Bt.ownerDocument.body:Bt).removeChild(o.stateNode)}catch(m){Dt(o,i,m)}else try{Bt.removeChild(o.stateNode)}catch(m){Dt(o,i,m)}break;case 18:Bt!==null&&(er?(r=Bt,zv(r.nodeType===9?r.body:r.nodeName==="HTML"?r.ownerDocument.body:r,o.stateNode),Al(r)):zv(Bt,o.stateNode));break;case 4:u=Bt,f=er,Bt=o.stateNode.containerInfo,er=!0,ka(r,i,o),Bt=u,er=f;break;case 0:case 11:case 14:case 15:Xt||ei(2,o,i),Xt||ei(4,o,i),ka(r,i,o);break;case 1:Xt||(oa(o,i),u=o.stateNode,typeof u.componentWillUnmount=="function"&&q1(o,i,u)),ka(r,i,o);break;case 21:ka(r,i,o);break;case 22:Xt=(u=Xt)||o.memoizedState!==null,ka(r,i,o),Xt=u;break;default:ka(r,i,o)}}function tv(r,i){if(i.memoizedState===null&&(r=i.alternate,r!==null&&(r=r.memoizedState,r!==null&&(r=r.dehydrated,r!==null))))try{Al(r)}catch(o){Dt(i,i.return,o)}}function dA(r){switch(r.tag){case 13:case 19:var i=r.stateNode;return i===null&&(i=r.stateNode=new Q1),i;case 22:return r=r.stateNode,i=r._retryCache,i===null&&(i=r._retryCache=new Q1),i;default:throw Error(a(435,r.tag))}}function Ad(r,i){var o=dA(r);i.forEach(function(u){var f=SA.bind(null,r,u);o.has(u)||(o.add(u),u.then(f,f))})}function hr(r,i){var o=i.deletions;if(o!==null)for(var u=0;u<o.length;u++){var f=o[u],m=r,S=i,w=S;e:for(;w!==null;){switch(w.tag){case 27:if(li(w.type)){Bt=w.stateNode,er=!1;break e}break;case 5:Bt=w.stateNode,er=!1;break e;case 3:case 4:Bt=w.stateNode.containerInfo,er=!0;break e}w=w.return}if(Bt===null)throw Error(a(160));ev(m,S,f),Bt=null,er=!1,m=f.alternate,m!==null&&(m.return=null),f.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)nv(i,r),i=i.sibling}var Kr=null;function nv(r,i){var o=r.alternate,u=r.flags;switch(r.tag){case 0:case 11:case 14:case 15:hr(i,r),fr(r),u&4&&(ei(3,r,r.return),ol(3,r),ei(5,r,r.return));break;case 1:hr(i,r),fr(r),u&512&&(Xt||o===null||oa(o,o.return)),u&64&&Na&&(r=r.updateQueue,r!==null&&(u=r.callbacks,u!==null&&(o=r.shared.hiddenCallbacks,r.shared.hiddenCallbacks=o===null?u:o.concat(u))));break;case 26:var f=Kr;if(hr(i,r),fr(r),u&512&&(Xt||o===null||oa(o,o.return)),u&4){var m=o!==null?o.memoizedState:null;if(u=r.memoizedState,o===null)if(u===null)if(r.stateNode===null){e:{u=r.type,o=r.memoizedProps,f=f.ownerDocument||f;t:switch(u){case"title":m=f.getElementsByTagName("title")[0],(!m||m[R]||m[ln]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=f.createElement(u),f.head.insertBefore(m,f.querySelector("head > title"))),Sn(m,u,o),m[ln]=r,ee(m),u=m;break e;case"link":var S=Wv("link","href",f).get(u+(o.href||""));if(S){for(var w=0;w<S.length;w++)if(m=S[w],m.getAttribute("href")===(o.href==null||o.href===""?null:o.href)&&m.getAttribute("rel")===(o.rel==null?null:o.rel)&&m.getAttribute("title")===(o.title==null?null:o.title)&&m.getAttribute("crossorigin")===(o.crossOrigin==null?null:o.crossOrigin)){S.splice(w,1);break t}}m=f.createElement(u),Sn(m,u,o),f.head.appendChild(m);break;case"meta":if(S=Wv("meta","content",f).get(u+(o.content||""))){for(w=0;w<S.length;w++)if(m=S[w],m.getAttribute("content")===(o.content==null?null:""+o.content)&&m.getAttribute("name")===(o.name==null?null:o.name)&&m.getAttribute("property")===(o.property==null?null:o.property)&&m.getAttribute("http-equiv")===(o.httpEquiv==null?null:o.httpEquiv)&&m.getAttribute("charset")===(o.charSet==null?null:o.charSet)){S.splice(w,1);break t}}m=f.createElement(u),Sn(m,u,o),f.head.appendChild(m);break;default:throw Error(a(468,u))}m[ln]=r,ee(m),u=m}r.stateNode=u}else Qv(f,r.type,r.stateNode);else r.stateNode=Xv(f,u,r.memoizedProps);else m!==u?(m===null?o.stateNode!==null&&(o=o.stateNode,o.parentNode.removeChild(o)):m.count--,u===null?Qv(f,r.type,r.stateNode):Xv(f,u,r.memoizedProps)):u===null&&r.stateNode!==null&&xd(r,r.memoizedProps,o.memoizedProps)}break;case 27:hr(i,r),fr(r),u&512&&(Xt||o===null||oa(o,o.return)),o!==null&&u&4&&xd(r,r.memoizedProps,o.memoizedProps);break;case 5:if(hr(i,r),fr(r),u&512&&(Xt||o===null||oa(o,o.return)),r.flags&32){f=r.stateNode;try{_s(f,"")}catch(ce){Dt(r,r.return,ce)}}u&4&&r.stateNode!=null&&(f=r.memoizedProps,xd(r,f,o!==null?o.memoizedProps:f)),u&1024&&(Ed=!0);break;case 6:if(hr(i,r),fr(r),u&4){if(r.stateNode===null)throw Error(a(162));u=r.memoizedProps,o=r.stateNode;try{o.nodeValue=u}catch(ce){Dt(r,r.return,ce)}}break;case 3:if(yu=null,f=Kr,Kr=pu(i.containerInfo),hr(i,r),Kr=f,fr(r),u&4&&o!==null&&o.memoizedState.isDehydrated)try{Al(i.containerInfo)}catch(ce){Dt(r,r.return,ce)}Ed&&(Ed=!1,rv(r));break;case 4:u=Kr,Kr=pu(r.stateNode.containerInfo),hr(i,r),fr(r),Kr=u;break;case 12:hr(i,r),fr(r);break;case 13:hr(i,r),fr(r),r.child.flags&8192&&r.memoizedState!==null!=(o!==null&&o.memoizedState!==null)&&(kd=Fe()),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Ad(r,u)));break;case 22:f=r.memoizedState!==null;var z=o!==null&&o.memoizedState!==null,ne=Na,me=Xt;if(Na=ne||f,Xt=me||z,hr(i,r),Xt=me,Na=ne,fr(r),u&8192)e:for(i=r.stateNode,i._visibility=f?i._visibility&-2:i._visibility|1,f&&(o===null||z||Na||Xt||Xi(r)),o=null,i=r;;){if(i.tag===5||i.tag===26){if(o===null){z=o=i;try{if(m=z.stateNode,f)S=m.style,typeof S.setProperty=="function"?S.setProperty("display","none","important"):S.display="none";else{w=z.stateNode;var _e=z.memoizedProps.style,oe=_e!=null&&_e.hasOwnProperty("display")?_e.display:null;w.style.display=oe==null||typeof oe=="boolean"?"":(""+oe).trim()}}catch(ce){Dt(z,z.return,ce)}}}else if(i.tag===6){if(o===null){z=i;try{z.stateNode.nodeValue=f?"":z.memoizedProps}catch(ce){Dt(z,z.return,ce)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===r)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===r)break e;for(;i.sibling===null;){if(i.return===null||i.return===r)break e;o===i&&(o=null),i=i.return}o===i&&(o=null),i.sibling.return=i.return,i=i.sibling}u&4&&(u=r.updateQueue,u!==null&&(o=u.retryQueue,o!==null&&(u.retryQueue=null,Ad(r,o))));break;case 19:hr(i,r),fr(r),u&4&&(u=r.updateQueue,u!==null&&(r.updateQueue=null,Ad(r,u)));break;case 30:break;case 21:break;default:hr(i,r),fr(r)}}function fr(r){var i=r.flags;if(i&2){try{for(var o,u=r.return;u!==null;){if(X1(u)){o=u;break}u=u.return}if(o==null)throw Error(a(160));switch(o.tag){case 27:var f=o.stateNode,m=Sd(r);ru(r,m,f);break;case 5:var S=o.stateNode;o.flags&32&&(_s(S,""),o.flags&=-33);var w=Sd(r);ru(r,w,S);break;case 3:case 4:var z=o.stateNode.containerInfo,ne=Sd(r);Cd(r,ne,z);break;default:throw Error(a(161))}}catch(me){Dt(r,r.return,me)}r.flags&=-3}i&4096&&(r.flags&=-4097)}function rv(r){if(r.subtreeFlags&1024)for(r=r.child;r!==null;){var i=r;rv(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),r=r.sibling}}function ti(r,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)J1(r,i.alternate,i),i=i.sibling}function Xi(r){for(r=r.child;r!==null;){var i=r;switch(i.tag){case 0:case 11:case 14:case 15:ei(4,i,i.return),Xi(i);break;case 1:oa(i,i.return);var o=i.stateNode;typeof o.componentWillUnmount=="function"&&q1(i,i.return,o),Xi(i);break;case 27:vl(i.stateNode);case 26:case 5:oa(i,i.return),Xi(i);break;case 22:i.memoizedState===null&&Xi(i);break;case 30:Xi(i);break;default:Xi(i)}r=r.sibling}}function ni(r,i,o){for(o=o&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var u=i.alternate,f=r,m=i,S=m.flags;switch(m.tag){case 0:case 11:case 15:ni(f,m,o),ol(4,m);break;case 1:if(ni(f,m,o),u=m,f=u.stateNode,typeof f.componentDidMount=="function")try{f.componentDidMount()}catch(ne){Dt(u,u.return,ne)}if(u=m,f=u.updateQueue,f!==null){var w=u.stateNode;try{var z=f.shared.hiddenCallbacks;if(z!==null)for(f.shared.hiddenCallbacks=null,f=0;f<z.length;f++)Op(z[f],w)}catch(ne){Dt(u,u.return,ne)}}o&&S&64&&V1(m),ll(m,m.return);break;case 27:W1(m);case 26:case 5:ni(f,m,o),o&&u===null&&S&4&&Y1(m),ll(m,m.return);break;case 12:ni(f,m,o);break;case 13:ni(f,m,o),o&&S&4&&tv(f,m);break;case 22:m.memoizedState===null&&ni(f,m,o),ll(m,m.return);break;case 30:break;default:ni(f,m,o)}i=i.sibling}}function wd(r,i){var o=null;r!==null&&r.memoizedState!==null&&r.memoizedState.cachePool!==null&&(o=r.memoizedState.cachePool.pool),r=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(r=i.memoizedState.cachePool.pool),r!==o&&(r!=null&&r.refCount++,o!=null&&qo(o))}function bd(r,i){r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&qo(r))}function la(r,i,o,u){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)av(r,i,o,u),i=i.sibling}function av(r,i,o,u){var f=i.flags;switch(i.tag){case 0:case 11:case 15:la(r,i,o,u),f&2048&&ol(9,i);break;case 1:la(r,i,o,u);break;case 3:la(r,i,o,u),f&2048&&(r=null,i.alternate!==null&&(r=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==r&&(i.refCount++,r!=null&&qo(r)));break;case 12:if(f&2048){la(r,i,o,u),r=i.stateNode;try{var m=i.memoizedProps,S=m.id,w=m.onPostCommit;typeof w=="function"&&w(S,i.alternate===null?"mount":"update",r.passiveEffectDuration,-0)}catch(z){Dt(i,i.return,z)}}else la(r,i,o,u);break;case 13:la(r,i,o,u);break;case 23:break;case 22:m=i.stateNode,S=i.alternate,i.memoizedState!==null?m._visibility&2?la(r,i,o,u):cl(r,i):m._visibility&2?la(r,i,o,u):(m._visibility|=2,Bs(r,i,o,u,(i.subtreeFlags&10256)!==0)),f&2048&&wd(S,i);break;case 24:la(r,i,o,u),f&2048&&bd(i.alternate,i);break;default:la(r,i,o,u)}}function Bs(r,i,o,u,f){for(f=f&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var m=r,S=i,w=o,z=u,ne=S.flags;switch(S.tag){case 0:case 11:case 15:Bs(m,S,w,z,f),ol(8,S);break;case 23:break;case 22:var me=S.stateNode;S.memoizedState!==null?me._visibility&2?Bs(m,S,w,z,f):cl(m,S):(me._visibility|=2,Bs(m,S,w,z,f)),f&&ne&2048&&wd(S.alternate,S);break;case 24:Bs(m,S,w,z,f),f&&ne&2048&&bd(S.alternate,S);break;default:Bs(m,S,w,z,f)}i=i.sibling}}function cl(r,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var o=r,u=i,f=u.flags;switch(u.tag){case 22:cl(o,u),f&2048&&wd(u.alternate,u);break;case 24:cl(o,u),f&2048&&bd(u.alternate,u);break;default:cl(o,u)}i=i.sibling}}var ul=8192;function Hs(r){if(r.subtreeFlags&ul)for(r=r.child;r!==null;)iv(r),r=r.sibling}function iv(r){switch(r.tag){case 26:Hs(r),r.flags&ul&&r.memoizedState!==null&&JA(Kr,r.memoizedState,r.memoizedProps);break;case 5:Hs(r);break;case 3:case 4:var i=Kr;Kr=pu(r.stateNode.containerInfo),Hs(r),Kr=i;break;case 22:r.memoizedState===null&&(i=r.alternate,i!==null&&i.memoizedState!==null?(i=ul,ul=16777216,Hs(r),ul=i):Hs(r));break;default:Hs(r)}}function sv(r){var i=r.alternate;if(i!==null&&(r=i.child,r!==null)){i.child=null;do i=r.sibling,r.sibling=null,r=i;while(r!==null)}}function hl(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];hn=u,lv(u,r)}sv(r)}if(r.subtreeFlags&10256)for(r=r.child;r!==null;)ov(r),r=r.sibling}function ov(r){switch(r.tag){case 0:case 11:case 15:hl(r),r.flags&2048&&ei(9,r,r.return);break;case 3:hl(r);break;case 12:hl(r);break;case 22:var i=r.stateNode;r.memoizedState!==null&&i._visibility&2&&(r.return===null||r.return.tag!==13)?(i._visibility&=-3,au(r)):hl(r);break;default:hl(r)}}function au(r){var i=r.deletions;if((r.flags&16)!==0){if(i!==null)for(var o=0;o<i.length;o++){var u=i[o];hn=u,lv(u,r)}sv(r)}for(r=r.child;r!==null;){switch(i=r,i.tag){case 0:case 11:case 15:ei(8,i,i.return),au(i);break;case 22:o=i.stateNode,o._visibility&2&&(o._visibility&=-3,au(i));break;default:au(i)}r=r.sibling}}function lv(r,i){for(;hn!==null;){var o=hn;switch(o.tag){case 0:case 11:case 15:ei(8,o,i);break;case 23:case 22:if(o.memoizedState!==null&&o.memoizedState.cachePool!==null){var u=o.memoizedState.cachePool.pool;u!=null&&u.refCount++}break;case 24:qo(o.memoizedState.cache)}if(u=o.child,u!==null)u.return=o,hn=u;else e:for(o=r;hn!==null;){u=hn;var f=u.sibling,m=u.return;if(Z1(u),u===o){hn=null;break e}if(f!==null){f.return=m,hn=f;break e}hn=m}}}var gA={getCacheForType:function(r){var i=Dn(nn),o=i.data.get(r);return o===void 0&&(o=r(),i.data.set(r,o)),o}},mA=typeof WeakMap=="function"?WeakMap:Map,pt=0,Lt=null,st=null,ut=0,vt=0,dr=null,ri=!1,js=!1,Id=!1,Oa=0,$t=0,ai=0,Wi=0,Rd=0,Pr=0,zs=0,fl=null,tr=null,Nd=!1,kd=0,iu=1/0,su=null,ii=null,xn=0,si=null,Gs=null,$s=0,Od=0,Md=null,cv=null,dl=0,Dd=null;function gr(){if((pt&2)!==0&&ut!==0)return ut&-ut;if(re.T!==null){var r=ks;return r!==0?r:jd()}return Tc()}function uv(){Pr===0&&(Pr=(ut&536870912)===0||gt?Io():536870912);var r=Dr.current;return r!==null&&(r.flags|=32),Pr}function mr(r,i,o){(r===Lt&&(vt===2||vt===9)||r.cancelPendingCommit!==null)&&(Ks(r,0),oi(r,ut,Pr,!1)),Di(r,o),((pt&2)===0||r!==Lt)&&(r===Lt&&((pt&2)===0&&(Wi|=o),$t===4&&oi(r,ut,Pr,!1)),ca(r))}function hv(r,i,o){if((pt&6)!==0)throw Error(a(327));var u=!o&&(i&124)===0&&(i&r.expiredLanes)===0||Mi(r,i),f=u?yA(r,i):Ld(r,i,!0),m=u;do{if(f===0){js&&!u&&oi(r,i,0,!1);break}else{if(o=r.current.alternate,m&&!pA(o)){f=Ld(r,i,!1),m=!1;continue}if(f===2){if(m=i,r.errorRecoveryDisabledLanes&m)var S=0;else S=r.pendingLanes&-536870913,S=S!==0?S:S&536870912?536870912:0;if(S!==0){i=S;e:{var w=r;f=fl;var z=w.current.memoizedState.isDehydrated;if(z&&(Ks(w,S).flags|=256),S=Ld(w,S,!1),S!==2){if(Id&&!z){w.errorRecoveryDisabledLanes|=m,Wi|=m,f=4;break e}m=tr,tr=f,m!==null&&(tr===null?tr=m:tr.push.apply(tr,m))}f=S}if(m=!1,f!==2)continue}}if(f===1){Ks(r,0),oi(r,i,0,!0);break}e:{switch(u=r,m=f,m){case 0:case 1:throw Error(a(345));case 4:if((i&4194048)!==i)break;case 6:oi(u,i,Pr,!ri);break e;case 2:tr=null;break;case 3:case 5:break;default:throw Error(a(329))}if((i&62914560)===i&&(f=kd+300-Fe(),10<f)){if(oi(u,i,Pr,!ri),vs(u,0,!0)!==0)break e;u.timeoutHandle=Hv(fv.bind(null,u,o,tr,su,Nd,i,Pr,Wi,zs,ri,m,2,-0,0),f);break e}fv(u,o,tr,su,Nd,i,Pr,Wi,zs,ri,m,0,-0,0)}}break}while(!0);ca(r)}function fv(r,i,o,u,f,m,S,w,z,ne,me,_e,oe,ce){if(r.timeoutHandle=-1,_e=i.subtreeFlags,(_e&8192||(_e&16785408)===16785408)&&(_l={stylesheets:null,count:0,unsuspend:QA},iv(i),_e=ZA(),_e!==null)){r.cancelPendingCommit=_e(Tv.bind(null,r,i,m,o,u,f,S,w,z,me,1,oe,ce)),oi(r,m,S,!ne);return}Tv(r,i,m,o,u,f,S,w,z)}function pA(r){for(var i=r;;){var o=i.tag;if((o===0||o===11||o===15)&&i.flags&16384&&(o=i.updateQueue,o!==null&&(o=o.stores,o!==null)))for(var u=0;u<o.length;u++){var f=o[u],m=f.getSnapshot;f=f.value;try{if(!cr(m(),f))return!1}catch{return!1}}if(o=i.child,i.subtreeFlags&16384&&o!==null)o.return=i,i=o;else{if(i===r)break;for(;i.sibling===null;){if(i.return===null||i.return===r)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function oi(r,i,o,u){i&=~Rd,i&=~Wi,r.suspendedLanes|=i,r.pingedLanes&=~i,u&&(r.warmLanes|=i),u=r.expirationTimes;for(var f=i;0<f;){var m=31-$n(f),S=1<<m;u[m]=-1,f&=~S}o!==0&&vc(r,o,i)}function ou(){return(pt&6)===0?(gl(0),!1):!0}function Pd(){if(st!==null){if(vt===0)var r=st.return;else r=st,Ea=$i=null,Jf(r),Ls=null,al=0,r=st;for(;r!==null;)K1(r.alternate,r),r=r.return;st=null}}function Ks(r,i){var o=r.timeoutHandle;o!==-1&&(r.timeoutHandle=-1,DA(o)),o=r.cancelPendingCommit,o!==null&&(r.cancelPendingCommit=null,o()),Pd(),Lt=r,st=o=xa(r.current,null),ut=i,vt=0,dr=null,ri=!1,js=Mi(r,i),Id=!1,zs=Pr=Rd=Wi=ai=$t=0,tr=fl=null,Nd=!1,(i&8)!==0&&(i|=i&32);var u=r.entangledLanes;if(u!==0)for(r=r.entanglements,u&=i;0<u;){var f=31-$n(u),m=1<<f;i|=r[f],u&=~m}return Oa=i,Rc(),o}function dv(r,i){rt=null,re.H=Yc,i===Xo||i===Uc?(i=Np(),vt=3):i===bp?(i=Np(),vt=4):vt=i===k1?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,dr=i,st===null&&($t=1,Zc(r,Nr(i,r.current)))}function gv(){var r=re.H;return re.H=Yc,r===null?Yc:r}function mv(){var r=re.A;return re.A=gA,r}function Fd(){$t=4,ri||(ut&4194048)!==ut&&Dr.current!==null||(js=!0),(ai&134217727)===0&&(Wi&134217727)===0||Lt===null||oi(Lt,ut,Pr,!1)}function Ld(r,i,o){var u=pt;pt|=2;var f=gv(),m=mv();(Lt!==r||ut!==i)&&(su=null,Ks(r,i)),i=!1;var S=$t;e:do try{if(vt!==0&&st!==null){var w=st,z=dr;switch(vt){case 8:Pd(),S=6;break e;case 3:case 2:case 9:case 6:Dr.current===null&&(i=!0);var ne=vt;if(vt=0,dr=null,Vs(r,w,z,ne),o&&js){S=0;break e}break;default:ne=vt,vt=0,dr=null,Vs(r,w,z,ne)}}vA(),S=$t;break}catch(me){dv(r,me)}while(!0);return i&&r.shellSuspendCounter++,Ea=$i=null,pt=u,re.H=f,re.A=m,st===null&&(Lt=null,ut=0,Rc()),S}function vA(){for(;st!==null;)pv(st)}function yA(r,i){var o=pt;pt|=2;var u=gv(),f=mv();Lt!==r||ut!==i?(su=null,iu=Fe()+500,Ks(r,i)):js=Mi(r,i);e:do try{if(vt!==0&&st!==null){i=st;var m=dr;t:switch(vt){case 1:vt=0,dr=null,Vs(r,i,m,1);break;case 2:case 9:if(Ip(m)){vt=0,dr=null,vv(i);break}i=function(){vt!==2&&vt!==9||Lt!==r||(vt=7),ca(r)},m.then(i,i);break e;case 3:vt=7;break e;case 4:vt=5;break e;case 7:Ip(m)?(vt=0,dr=null,vv(i)):(vt=0,dr=null,Vs(r,i,m,7));break;case 5:var S=null;switch(st.tag){case 26:S=st.memoizedState;case 5:case 27:var w=st;if(!S||Jv(S)){vt=0,dr=null;var z=w.sibling;if(z!==null)st=z;else{var ne=w.return;ne!==null?(st=ne,lu(ne)):st=null}break t}}vt=0,dr=null,Vs(r,i,m,5);break;case 6:vt=0,dr=null,Vs(r,i,m,6);break;case 8:Pd(),$t=6;break e;default:throw Error(a(462))}}TA();break}catch(me){dv(r,me)}while(!0);return Ea=$i=null,re.H=u,re.A=f,pt=o,st!==null?0:(Lt=null,ut=0,Rc(),$t)}function TA(){for(;st!==null&&!Hn();)pv(st)}function pv(r){var i=G1(r.alternate,r,Oa);r.memoizedProps=r.pendingProps,i===null?lu(r):st=i}function vv(r){var i=r,o=i.alternate;switch(i.tag){case 15:case 0:i=L1(o,i,i.pendingProps,i.type,void 0,ut);break;case 11:i=L1(o,i,i.pendingProps,i.type.render,i.ref,ut);break;case 5:Jf(i);default:K1(o,i),i=st=yp(i,Oa),i=G1(o,i,Oa)}r.memoizedProps=r.pendingProps,i===null?lu(r):st=i}function Vs(r,i,o,u){Ea=$i=null,Jf(i),Ls=null,al=0;var f=i.return;try{if(lA(r,f,i,o,ut)){$t=1,Zc(r,Nr(o,r.current)),st=null;return}}catch(m){if(f!==null)throw st=f,m;$t=1,Zc(r,Nr(o,r.current)),st=null;return}i.flags&32768?(gt||u===1?r=!0:js||(ut&536870912)!==0?r=!1:(ri=r=!0,(u===2||u===9||u===3||u===6)&&(u=Dr.current,u!==null&&u.tag===13&&(u.flags|=16384))),yv(i,r)):lu(i)}function lu(r){var i=r;do{if((i.flags&32768)!==0){yv(i,ri);return}r=i.return;var o=uA(i.alternate,i,Oa);if(o!==null){st=o;return}if(i=i.sibling,i!==null){st=i;return}st=i=r}while(i!==null);$t===0&&($t=5)}function yv(r,i){do{var o=hA(r.alternate,r);if(o!==null){o.flags&=32767,st=o;return}if(o=r.return,o!==null&&(o.flags|=32768,o.subtreeFlags=0,o.deletions=null),!i&&(r=r.sibling,r!==null)){st=r;return}st=r=o}while(r!==null);$t=6,st=null}function Tv(r,i,o,u,f,m,S,w,z){r.cancelPendingCommit=null;do cu();while(xn!==0);if((pt&6)!==0)throw Error(a(327));if(i!==null){if(i===r.current)throw Error(a(177));if(m=i.lanes|i.childLanes,m|=bf,ys(r,o,m,S,w,z),r===Lt&&(st=Lt=null,ut=0),Gs=i,si=r,$s=o,Od=m,Md=f,cv=u,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(r.callbackNode=null,r.callbackPriority=0,CA(lr,function(){return Ev(),null})):(r.callbackNode=null,r.callbackPriority=0),u=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||u){u=re.T,re.T=null,f=xe.p,xe.p=2,S=pt,pt|=4;try{fA(r,i,o)}finally{pt=S,xe.p=f,re.T=u}}xn=1,_v(),xv(),Sv()}}function _v(){if(xn===1){xn=0;var r=si,i=Gs,o=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||o){o=re.T,re.T=null;var u=xe.p;xe.p=2;var f=pt;pt|=4;try{nv(i,r);var m=Xd,S=lp(r.containerInfo),w=m.focusedElem,z=m.selectionRange;if(S!==w&&w&&w.ownerDocument&&op(w.ownerDocument.documentElement,w)){if(z!==null&&Sf(w)){var ne=z.start,me=z.end;if(me===void 0&&(me=ne),"selectionStart"in w)w.selectionStart=ne,w.selectionEnd=Math.min(me,w.value.length);else{var _e=w.ownerDocument||document,oe=_e&&_e.defaultView||window;if(oe.getSelection){var ce=oe.getSelection(),Ye=w.textContent.length,Ke=Math.min(z.start,Ye),bt=z.end===void 0?Ke:Math.min(z.end,Ye);!ce.extend&&Ke>bt&&(S=bt,bt=Ke,Ke=S);var Q=sp(w,Ke),X=sp(w,bt);if(Q&&X&&(ce.rangeCount!==1||ce.anchorNode!==Q.node||ce.anchorOffset!==Q.offset||ce.focusNode!==X.node||ce.focusOffset!==X.offset)){var te=_e.createRange();te.setStart(Q.node,Q.offset),ce.removeAllRanges(),Ke>bt?(ce.addRange(te),ce.extend(X.node,X.offset)):(te.setEnd(X.node,X.offset),ce.addRange(te))}}}}for(_e=[],ce=w;ce=ce.parentNode;)ce.nodeType===1&&_e.push({element:ce,left:ce.scrollLeft,top:ce.scrollTop});for(typeof w.focus=="function"&&w.focus(),w=0;w<_e.length;w++){var pe=_e[w];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}xu=!!Yd,Xd=Yd=null}finally{pt=f,xe.p=u,re.T=o}}r.current=i,xn=2}}function xv(){if(xn===2){xn=0;var r=si,i=Gs,o=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||o){o=re.T,re.T=null;var u=xe.p;xe.p=2;var f=pt;pt|=4;try{J1(r,i.alternate,i)}finally{pt=f,xe.p=u,re.T=o}}xn=3}}function Sv(){if(xn===4||xn===3){xn=0,Ot();var r=si,i=Gs,o=$s,u=cv;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?xn=5:(xn=0,Gs=si=null,Cv(r,r.pendingLanes));var f=r.pendingLanes;if(f===0&&(ii=null),Oo(o),i=i.stateNode,Tn&&typeof Tn.onCommitFiberRoot=="function")try{Tn.onCommitFiberRoot(Gn,i,void 0,(i.current.flags&128)===128)}catch{}if(u!==null){i=re.T,f=xe.p,xe.p=2,re.T=null;try{for(var m=r.onRecoverableError,S=0;S<u.length;S++){var w=u[S];m(w.value,{componentStack:w.stack})}}finally{re.T=i,xe.p=f}}($s&3)!==0&&cu(),ca(r),f=r.pendingLanes,(o&4194090)!==0&&(f&42)!==0?r===Dd?dl++:(dl=0,Dd=r):dl=0,gl(0)}}function Cv(r,i){(r.pooledCacheLanes&=i)===0&&(i=r.pooledCache,i!=null&&(r.pooledCache=null,qo(i)))}function cu(r){return _v(),xv(),Sv(),Ev()}function Ev(){if(xn!==5)return!1;var r=si,i=Od;Od=0;var o=Oo($s),u=re.T,f=xe.p;try{xe.p=32>o?32:o,re.T=null,o=Md,Md=null;var m=si,S=$s;if(xn=0,Gs=si=null,$s=0,(pt&6)!==0)throw Error(a(331));var w=pt;if(pt|=4,ov(m.current),av(m,m.current,S,o),pt=w,gl(0,!1),Tn&&typeof Tn.onPostCommitFiberRoot=="function")try{Tn.onPostCommitFiberRoot(Gn,m)}catch{}return!0}finally{xe.p=f,re.T=u,Cv(r,i)}}function Av(r,i,o){i=Nr(o,i),i=fd(r.stateNode,i,2),r=Wa(r,i,2),r!==null&&(Di(r,2),ca(r))}function Dt(r,i,o){if(r.tag===3)Av(r,r,o);else for(;i!==null;){if(i.tag===3){Av(i,r,o);break}else if(i.tag===1){var u=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof u.componentDidCatch=="function"&&(ii===null||!ii.has(u))){r=Nr(o,r),o=R1(2),u=Wa(i,o,2),u!==null&&(N1(o,u,i,r),Di(u,2),ca(u));break}}i=i.return}}function Ud(r,i,o){var u=r.pingCache;if(u===null){u=r.pingCache=new mA;var f=new Set;u.set(i,f)}else f=u.get(i),f===void 0&&(f=new Set,u.set(i,f));f.has(o)||(Id=!0,f.add(o),r=_A.bind(null,r,i,o),i.then(r,r))}function _A(r,i,o){var u=r.pingCache;u!==null&&u.delete(i),r.pingedLanes|=r.suspendedLanes&o,r.warmLanes&=~o,Lt===r&&(ut&o)===o&&($t===4||$t===3&&(ut&62914560)===ut&&300>Fe()-kd?(pt&2)===0&&Ks(r,0):Rd|=o,zs===ut&&(zs=0)),ca(r)}function wv(r,i){i===0&&(i=Ro()),r=bs(r,i),r!==null&&(Di(r,i),ca(r))}function xA(r){var i=r.memoizedState,o=0;i!==null&&(o=i.retryLane),wv(r,o)}function SA(r,i){var o=0;switch(r.tag){case 13:var u=r.stateNode,f=r.memoizedState;f!==null&&(o=f.retryLane);break;case 19:u=r.stateNode;break;case 22:u=r.stateNode._retryCache;break;default:throw Error(a(314))}u!==null&&u.delete(i),wv(r,o)}function CA(r,i){return zt(r,i)}var uu=null,qs=null,Bd=!1,hu=!1,Hd=!1,Qi=0;function ca(r){r!==qs&&r.next===null&&(qs===null?uu=qs=r:qs=qs.next=r),hu=!0,Bd||(Bd=!0,AA())}function gl(r,i){if(!Hd&&hu){Hd=!0;do for(var o=!1,u=uu;u!==null;){if(r!==0){var f=u.pendingLanes;if(f===0)var m=0;else{var S=u.suspendedLanes,w=u.pingedLanes;m=(1<<31-$n(42|r)+1)-1,m&=f&~(S&~w),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(o=!0,Nv(u,m))}else m=ut,m=vs(u,u===Lt?m:0,u.cancelPendingCommit!==null||u.timeoutHandle!==-1),(m&3)===0||Mi(u,m)||(o=!0,Nv(u,m));u=u.next}while(o);Hd=!1}}function EA(){bv()}function bv(){hu=Bd=!1;var r=0;Qi!==0&&(MA()&&(r=Qi),Qi=0);for(var i=Fe(),o=null,u=uu;u!==null;){var f=u.next,m=Iv(u,i);m===0?(u.next=null,o===null?uu=f:o.next=f,f===null&&(qs=o)):(o=u,(r!==0||(m&3)!==0)&&(hu=!0)),u=f}gl(r)}function Iv(r,i){for(var o=r.suspendedLanes,u=r.pingedLanes,f=r.expirationTimes,m=r.pendingLanes&-62914561;0<m;){var S=31-$n(m),w=1<<S,z=f[S];z===-1?((w&o)===0||(w&u)!==0)&&(f[S]=pc(w,i)):z<=i&&(r.expiredLanes|=w),m&=~w}if(i=Lt,o=ut,o=vs(r,r===i?o:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u=r.callbackNode,o===0||r===i&&(vt===2||vt===9)||r.cancelPendingCommit!==null)return u!==null&&u!==null&&ct(u),r.callbackNode=null,r.callbackPriority=0;if((o&3)===0||Mi(r,o)){if(i=o&-o,i===r.callbackPriority)return i;switch(u!==null&&ct(u),Oo(o)){case 2:case 8:o=wr;break;case 32:o=lr;break;case 268435456:o=Mt;break;default:o=lr}return u=Rv.bind(null,r),o=zt(o,u),r.callbackPriority=i,r.callbackNode=o,i}return u!==null&&u!==null&&ct(u),r.callbackPriority=2,r.callbackNode=null,2}function Rv(r,i){if(xn!==0&&xn!==5)return r.callbackNode=null,r.callbackPriority=0,null;var o=r.callbackNode;if(cu()&&r.callbackNode!==o)return null;var u=ut;return u=vs(r,r===Lt?u:0,r.cancelPendingCommit!==null||r.timeoutHandle!==-1),u===0?null:(hv(r,u,i),Iv(r,Fe()),r.callbackNode!=null&&r.callbackNode===o?Rv.bind(null,r):null)}function Nv(r,i){if(cu())return null;hv(r,i,!0)}function AA(){PA(function(){(pt&6)!==0?zt(jn,EA):bv()})}function jd(){return Qi===0&&(Qi=Io()),Qi}function kv(r){return r==null||typeof r=="symbol"||typeof r=="boolean"?null:typeof r=="function"?r:Sc(""+r)}function Ov(r,i){var o=i.ownerDocument.createElement("input");return o.name=i.name,o.value=i.value,r.id&&o.setAttribute("form",r.id),i.parentNode.insertBefore(o,i),r=new FormData(r),o.parentNode.removeChild(o),r}function wA(r,i,o,u,f){if(i==="submit"&&o&&o.stateNode===f){var m=kv((f[cn]||null).action),S=u.submitter;S&&(i=(i=S[cn]||null)?kv(i.formAction):S.getAttribute("formAction"),i!==null&&(m=i,S=null));var w=new wc("action","action",null,u,f);r.push({event:w,listeners:[{instance:null,listener:function(){if(u.defaultPrevented){if(Qi!==0){var z=S?Ov(f,S):new FormData(f);od(o,{pending:!0,data:z,method:f.method,action:m},null,z)}}else typeof m=="function"&&(w.preventDefault(),z=S?Ov(f,S):new FormData(f),od(o,{pending:!0,data:z,method:f.method,action:m},m,z))},currentTarget:f}]})}}for(var zd=0;zd<wf.length;zd++){var Gd=wf[zd],bA=Gd.toLowerCase(),IA=Gd[0].toUpperCase()+Gd.slice(1);$r(bA,"on"+IA)}$r(hp,"onAnimationEnd"),$r(fp,"onAnimationIteration"),$r(dp,"onAnimationStart"),$r("dblclick","onDoubleClick"),$r("focusin","onFocus"),$r("focusout","onBlur"),$r(KE,"onTransitionRun"),$r(VE,"onTransitionStart"),$r(qE,"onTransitionCancel"),$r(gp,"onTransitionEnd"),Re("onMouseEnter",["mouseout","mouseover"]),Re("onMouseLeave",["mouseout","mouseover"]),Re("onPointerEnter",["pointerout","pointerover"]),Re("onPointerLeave",["pointerout","pointerover"]),Ee("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Ee("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Ee("onBeforeInput",["compositionend","keypress","textInput","paste"]),Ee("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Ee("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Ee("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ml="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),RA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(ml));function Mv(r,i){i=(i&4)!==0;for(var o=0;o<r.length;o++){var u=r[o],f=u.event;u=u.listeners;e:{var m=void 0;if(i)for(var S=u.length-1;0<=S;S--){var w=u[S],z=w.instance,ne=w.currentTarget;if(w=w.listener,z!==m&&f.isPropagationStopped())break e;m=w,f.currentTarget=ne;try{m(f)}catch(me){Jc(me)}f.currentTarget=null,m=z}else for(S=0;S<u.length;S++){if(w=u[S],z=w.instance,ne=w.currentTarget,w=w.listener,z!==m&&f.isPropagationStopped())break e;m=w,f.currentTarget=ne;try{m(f)}catch(me){Jc(me)}f.currentTarget=null,m=z}}}}function ot(r,i){var o=i[Mo];o===void 0&&(o=i[Mo]=new Set);var u=r+"__bubble";o.has(u)||(Dv(i,r,2,!1),o.add(u))}function $d(r,i,o){var u=0;i&&(u|=4),Dv(o,r,u,i)}var fu="_reactListening"+Math.random().toString(36).slice(2);function Kd(r){if(!r[fu]){r[fu]=!0,se.forEach(function(o){o!=="selectionchange"&&(RA.has(o)||$d(o,!1,r),$d(o,!0,r))});var i=r.nodeType===9?r:r.ownerDocument;i===null||i[fu]||(i[fu]=!0,$d("selectionchange",!1,i))}}function Dv(r,i,o,u){switch(ay(i)){case 2:var f=nw;break;case 8:f=rw;break;default:f=i0}o=f.bind(null,i,o,r),f=void 0,!df||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(f=!0),u?f!==void 0?r.addEventListener(i,o,{capture:!0,passive:f}):r.addEventListener(i,o,!0):f!==void 0?r.addEventListener(i,o,{passive:f}):r.addEventListener(i,o,!1)}function Vd(r,i,o,u,f){var m=u;if((i&1)===0&&(i&2)===0&&u!==null)e:for(;;){if(u===null)return;var S=u.tag;if(S===3||S===4){var w=u.stateNode.containerInfo;if(w===f)break;if(S===4)for(S=u.return;S!==null;){var z=S.tag;if((z===3||z===4)&&S.stateNode.containerInfo===f)return;S=S.return}for(;w!==null;){if(S=M(w),S===null)return;if(z=S.tag,z===5||z===6||z===26||z===27){u=m=S;continue e}w=w.parentNode}}u=u.return}jm(function(){var ne=m,me=hf(o),_e=[];e:{var oe=mp.get(r);if(oe!==void 0){var ce=wc,Ye=r;switch(r){case"keypress":if(Ec(o)===0)break e;case"keydown":case"keyup":ce=CE;break;case"focusin":Ye="focus",ce=vf;break;case"focusout":Ye="blur",ce=vf;break;case"beforeblur":case"afterblur":ce=vf;break;case"click":if(o.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ce=$m;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ce=hE;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ce=wE;break;case hp:case fp:case dp:ce=gE;break;case gp:ce=IE;break;case"scroll":case"scrollend":ce=cE;break;case"wheel":ce=NE;break;case"copy":case"cut":case"paste":ce=pE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ce=Vm;break;case"toggle":case"beforetoggle":ce=OE}var Ke=(i&4)!==0,bt=!Ke&&(r==="scroll"||r==="scrollend"),Q=Ke?oe!==null?oe+"Capture":null:oe;Ke=[];for(var X=ne,te;X!==null;){var pe=X;if(te=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||te===null||Q===null||(pe=Do(X,Q),pe!=null&&Ke.push(pl(X,pe,te))),bt)break;X=X.return}0<Ke.length&&(oe=new ce(oe,Ye,null,o,me),_e.push({event:oe,listeners:Ke}))}}if((i&7)===0){e:{if(oe=r==="mouseover"||r==="pointerover",ce=r==="mouseout"||r==="pointerout",oe&&o!==uf&&(Ye=o.relatedTarget||o.fromElement)&&(M(Ye)||Ye[$a]))break e;if((ce||oe)&&(oe=me.window===me?me:(oe=me.ownerDocument)?oe.defaultView||oe.parentWindow:window,ce?(Ye=o.relatedTarget||o.toElement,ce=ne,Ye=Ye?M(Ye):null,Ye!==null&&(bt=l(Ye),Ke=Ye.tag,Ye!==bt||Ke!==5&&Ke!==27&&Ke!==6)&&(Ye=null)):(ce=null,Ye=ne),ce!==Ye)){if(Ke=$m,pe="onMouseLeave",Q="onMouseEnter",X="mouse",(r==="pointerout"||r==="pointerover")&&(Ke=Vm,pe="onPointerLeave",Q="onPointerEnter",X="pointer"),bt=ce==null?oe:ae(ce),te=Ye==null?oe:ae(Ye),oe=new Ke(pe,X+"leave",ce,o,me),oe.target=bt,oe.relatedTarget=te,pe=null,M(me)===ne&&(Ke=new Ke(Q,X+"enter",Ye,o,me),Ke.target=te,Ke.relatedTarget=bt,pe=Ke),bt=pe,ce&&Ye)t:{for(Ke=ce,Q=Ye,X=0,te=Ke;te;te=Ys(te))X++;for(te=0,pe=Q;pe;pe=Ys(pe))te++;for(;0<X-te;)Ke=Ys(Ke),X--;for(;0<te-X;)Q=Ys(Q),te--;for(;X--;){if(Ke===Q||Q!==null&&Ke===Q.alternate)break t;Ke=Ys(Ke),Q=Ys(Q)}Ke=null}else Ke=null;ce!==null&&Pv(_e,oe,ce,Ke,!1),Ye!==null&&bt!==null&&Pv(_e,bt,Ye,Ke,!0)}}e:{if(oe=ne?ae(ne):window,ce=oe.nodeName&&oe.nodeName.toLowerCase(),ce==="select"||ce==="input"&&oe.type==="file")var ze=ep;else if(Jm(oe))if(tp)ze=zE;else{ze=HE;var at=BE}else ce=oe.nodeName,!ce||ce.toLowerCase()!=="input"||oe.type!=="checkbox"&&oe.type!=="radio"?ne&&cf(ne.elementType)&&(ze=ep):ze=jE;if(ze&&(ze=ze(r,ne))){Zm(_e,ze,o,me);break e}at&&at(r,oe,ne),r==="focusout"&&ne&&oe.type==="number"&&ne.memoizedProps.value!=null&&lf(oe,"number",oe.value)}switch(at=ne?ae(ne):window,r){case"focusin":(Jm(at)||at.contentEditable==="true")&&(Es=at,Cf=ne,zo=null);break;case"focusout":zo=Cf=Es=null;break;case"mousedown":Ef=!0;break;case"contextmenu":case"mouseup":case"dragend":Ef=!1,cp(_e,o,me);break;case"selectionchange":if($E)break;case"keydown":case"keyup":cp(_e,o,me)}var Ge;if(Tf)e:{switch(r){case"compositionstart":var Ve="onCompositionStart";break e;case"compositionend":Ve="onCompositionEnd";break e;case"compositionupdate":Ve="onCompositionUpdate";break e}Ve=void 0}else Cs?Wm(r,o)&&(Ve="onCompositionEnd"):r==="keydown"&&o.keyCode===229&&(Ve="onCompositionStart");Ve&&(qm&&o.locale!=="ko"&&(Cs||Ve!=="onCompositionStart"?Ve==="onCompositionEnd"&&Cs&&(Ge=zm()):(Va=me,gf="value"in Va?Va.value:Va.textContent,Cs=!0)),at=du(ne,Ve),0<at.length&&(Ve=new Km(Ve,r,null,o,me),_e.push({event:Ve,listeners:at}),Ge?Ve.data=Ge:(Ge=Qm(o),Ge!==null&&(Ve.data=Ge)))),(Ge=DE?PE(r,o):FE(r,o))&&(Ve=du(ne,"onBeforeInput"),0<Ve.length&&(at=new Km("onBeforeInput","beforeinput",null,o,me),_e.push({event:at,listeners:Ve}),at.data=Ge)),wA(_e,r,ne,o,me)}Mv(_e,i)})}function pl(r,i,o){return{instance:r,listener:i,currentTarget:o}}function du(r,i){for(var o=i+"Capture",u=[];r!==null;){var f=r,m=f.stateNode;if(f=f.tag,f!==5&&f!==26&&f!==27||m===null||(f=Do(r,o),f!=null&&u.unshift(pl(r,f,m)),f=Do(r,i),f!=null&&u.push(pl(r,f,m))),r.tag===3)return u;r=r.return}return[]}function Ys(r){if(r===null)return null;do r=r.return;while(r&&r.tag!==5&&r.tag!==27);return r||null}function Pv(r,i,o,u,f){for(var m=i._reactName,S=[];o!==null&&o!==u;){var w=o,z=w.alternate,ne=w.stateNode;if(w=w.tag,z!==null&&z===u)break;w!==5&&w!==26&&w!==27||ne===null||(z=ne,f?(ne=Do(o,m),ne!=null&&S.unshift(pl(o,ne,z))):f||(ne=Do(o,m),ne!=null&&S.push(pl(o,ne,z)))),o=o.return}S.length!==0&&r.push({event:i,listeners:S})}var NA=/\r\n?/g,kA=/\u0000|\uFFFD/g;function Fv(r){return(typeof r=="string"?r:""+r).replace(NA,`
`).replace(kA,"")}function Lv(r,i){return i=Fv(i),Fv(r)===i}function gu(){}function wt(r,i,o,u,f,m){switch(o){case"children":typeof u=="string"?i==="body"||i==="textarea"&&u===""||_s(r,u):(typeof u=="number"||typeof u=="bigint")&&i!=="body"&&_s(r,""+u);break;case"className":Et(r,"class",u);break;case"tabIndex":Et(r,"tabindex",u);break;case"dir":case"role":case"viewBox":case"width":case"height":Et(r,o,u);break;case"style":Bm(r,u,m);break;case"data":if(i!=="object"){Et(r,"data",u);break}case"src":case"href":if(u===""&&(i!=="a"||o!=="href")){r.removeAttribute(o);break}if(u==null||typeof u=="function"||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Sc(""+u),r.setAttribute(o,u);break;case"action":case"formAction":if(typeof u=="function"){r.setAttribute(o,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(o==="formAction"?(i!=="input"&&wt(r,i,"name",f.name,f,null),wt(r,i,"formEncType",f.formEncType,f,null),wt(r,i,"formMethod",f.formMethod,f,null),wt(r,i,"formTarget",f.formTarget,f,null)):(wt(r,i,"encType",f.encType,f,null),wt(r,i,"method",f.method,f,null),wt(r,i,"target",f.target,f,null)));if(u==null||typeof u=="symbol"||typeof u=="boolean"){r.removeAttribute(o);break}u=Sc(""+u),r.setAttribute(o,u);break;case"onClick":u!=null&&(r.onclick=gu);break;case"onScroll":u!=null&&ot("scroll",r);break;case"onScrollEnd":u!=null&&ot("scrollend",r);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));r.innerHTML=o}}break;case"multiple":r.multiple=u&&typeof u!="function"&&typeof u!="symbol";break;case"muted":r.muted=u&&typeof u!="function"&&typeof u!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(u==null||typeof u=="function"||typeof u=="boolean"||typeof u=="symbol"){r.removeAttribute("xlink:href");break}o=Sc(""+u),r.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",o);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""+u):r.removeAttribute(o);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":u&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,""):r.removeAttribute(o);break;case"capture":case"download":u===!0?r.setAttribute(o,""):u!==!1&&u!=null&&typeof u!="function"&&typeof u!="symbol"?r.setAttribute(o,u):r.removeAttribute(o);break;case"cols":case"rows":case"size":case"span":u!=null&&typeof u!="function"&&typeof u!="symbol"&&!isNaN(u)&&1<=u?r.setAttribute(o,u):r.removeAttribute(o);break;case"rowSpan":case"start":u==null||typeof u=="function"||typeof u=="symbol"||isNaN(u)?r.removeAttribute(o):r.setAttribute(o,u);break;case"popover":ot("beforetoggle",r),ot("toggle",r),Ct(r,"popover",u);break;case"xlinkActuate":Ft(r,"http://www.w3.org/1999/xlink","xlink:actuate",u);break;case"xlinkArcrole":Ft(r,"http://www.w3.org/1999/xlink","xlink:arcrole",u);break;case"xlinkRole":Ft(r,"http://www.w3.org/1999/xlink","xlink:role",u);break;case"xlinkShow":Ft(r,"http://www.w3.org/1999/xlink","xlink:show",u);break;case"xlinkTitle":Ft(r,"http://www.w3.org/1999/xlink","xlink:title",u);break;case"xlinkType":Ft(r,"http://www.w3.org/1999/xlink","xlink:type",u);break;case"xmlBase":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:base",u);break;case"xmlLang":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:lang",u);break;case"xmlSpace":Ft(r,"http://www.w3.org/XML/1998/namespace","xml:space",u);break;case"is":Ct(r,"is",u);break;case"innerText":case"textContent":break;default:(!(2<o.length)||o[0]!=="o"&&o[0]!=="O"||o[1]!=="n"&&o[1]!=="N")&&(o=oE.get(o)||o,Ct(r,o,u))}}function qd(r,i,o,u,f,m){switch(o){case"style":Bm(r,u,m);break;case"dangerouslySetInnerHTML":if(u!=null){if(typeof u!="object"||!("__html"in u))throw Error(a(61));if(o=u.__html,o!=null){if(f.children!=null)throw Error(a(60));r.innerHTML=o}}break;case"children":typeof u=="string"?_s(r,u):(typeof u=="number"||typeof u=="bigint")&&_s(r,""+u);break;case"onScroll":u!=null&&ot("scroll",r);break;case"onScrollEnd":u!=null&&ot("scrollend",r);break;case"onClick":u!=null&&(r.onclick=gu);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!le.hasOwnProperty(o))e:{if(o[0]==="o"&&o[1]==="n"&&(f=o.endsWith("Capture"),i=o.slice(2,f?o.length-7:void 0),m=r[cn]||null,m=m!=null?m[o]:null,typeof m=="function"&&r.removeEventListener(i,m,f),typeof u=="function")){typeof m!="function"&&m!==null&&(o in r?r[o]=null:r.hasAttribute(o)&&r.removeAttribute(o)),r.addEventListener(i,u,f);break e}o in r?r[o]=u:u===!0?r.setAttribute(o,""):Ct(r,o,u)}}}function Sn(r,i,o){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ot("error",r),ot("load",r);var u=!1,f=!1,m;for(m in o)if(o.hasOwnProperty(m)){var S=o[m];if(S!=null)switch(m){case"src":u=!0;break;case"srcSet":f=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:wt(r,i,m,S,o,null)}}f&&wt(r,i,"srcSet",o.srcSet,o,null),u&&wt(r,i,"src",o.src,o,null);return;case"input":ot("invalid",r);var w=m=S=f=null,z=null,ne=null;for(u in o)if(o.hasOwnProperty(u)){var me=o[u];if(me!=null)switch(u){case"name":f=me;break;case"type":S=me;break;case"checked":z=me;break;case"defaultChecked":ne=me;break;case"value":m=me;break;case"defaultValue":w=me;break;case"children":case"dangerouslySetInnerHTML":if(me!=null)throw Error(a(137,i));break;default:wt(r,i,u,me,o,null)}}Pm(r,m,w,z,ne,S,f,!1),_c(r);return;case"select":ot("invalid",r),u=S=m=null;for(f in o)if(o.hasOwnProperty(f)&&(w=o[f],w!=null))switch(f){case"value":m=w;break;case"defaultValue":S=w;break;case"multiple":u=w;default:wt(r,i,f,w,o,null)}i=m,o=S,r.multiple=!!u,i!=null?Ts(r,!!u,i,!1):o!=null&&Ts(r,!!u,o,!0);return;case"textarea":ot("invalid",r),m=f=u=null;for(S in o)if(o.hasOwnProperty(S)&&(w=o[S],w!=null))switch(S){case"value":u=w;break;case"defaultValue":f=w;break;case"children":m=w;break;case"dangerouslySetInnerHTML":if(w!=null)throw Error(a(91));break;default:wt(r,i,S,w,o,null)}Lm(r,u,f,m),_c(r);return;case"option":for(z in o)if(o.hasOwnProperty(z)&&(u=o[z],u!=null))switch(z){case"selected":r.selected=u&&typeof u!="function"&&typeof u!="symbol";break;default:wt(r,i,z,u,o,null)}return;case"dialog":ot("beforetoggle",r),ot("toggle",r),ot("cancel",r),ot("close",r);break;case"iframe":case"object":ot("load",r);break;case"video":case"audio":for(u=0;u<ml.length;u++)ot(ml[u],r);break;case"image":ot("error",r),ot("load",r);break;case"details":ot("toggle",r);break;case"embed":case"source":case"link":ot("error",r),ot("load",r);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ne in o)if(o.hasOwnProperty(ne)&&(u=o[ne],u!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":throw Error(a(137,i));default:wt(r,i,ne,u,o,null)}return;default:if(cf(i)){for(me in o)o.hasOwnProperty(me)&&(u=o[me],u!==void 0&&qd(r,i,me,u,o,void 0));return}}for(w in o)o.hasOwnProperty(w)&&(u=o[w],u!=null&&wt(r,i,w,u,o,null))}function OA(r,i,o,u){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var f=null,m=null,S=null,w=null,z=null,ne=null,me=null;for(ce in o){var _e=o[ce];if(o.hasOwnProperty(ce)&&_e!=null)switch(ce){case"checked":break;case"value":break;case"defaultValue":z=_e;default:u.hasOwnProperty(ce)||wt(r,i,ce,null,u,_e)}}for(var oe in u){var ce=u[oe];if(_e=o[oe],u.hasOwnProperty(oe)&&(ce!=null||_e!=null))switch(oe){case"type":m=ce;break;case"name":f=ce;break;case"checked":ne=ce;break;case"defaultChecked":me=ce;break;case"value":S=ce;break;case"defaultValue":w=ce;break;case"children":case"dangerouslySetInnerHTML":if(ce!=null)throw Error(a(137,i));break;default:ce!==_e&&wt(r,i,oe,ce,u,_e)}}of(r,S,w,z,ne,me,m,f);return;case"select":ce=S=w=oe=null;for(m in o)if(z=o[m],o.hasOwnProperty(m)&&z!=null)switch(m){case"value":break;case"multiple":ce=z;default:u.hasOwnProperty(m)||wt(r,i,m,null,u,z)}for(f in u)if(m=u[f],z=o[f],u.hasOwnProperty(f)&&(m!=null||z!=null))switch(f){case"value":oe=m;break;case"defaultValue":w=m;break;case"multiple":S=m;default:m!==z&&wt(r,i,f,m,u,z)}i=w,o=S,u=ce,oe!=null?Ts(r,!!o,oe,!1):!!u!=!!o&&(i!=null?Ts(r,!!o,i,!0):Ts(r,!!o,o?[]:"",!1));return;case"textarea":ce=oe=null;for(w in o)if(f=o[w],o.hasOwnProperty(w)&&f!=null&&!u.hasOwnProperty(w))switch(w){case"value":break;case"children":break;default:wt(r,i,w,null,u,f)}for(S in u)if(f=u[S],m=o[S],u.hasOwnProperty(S)&&(f!=null||m!=null))switch(S){case"value":oe=f;break;case"defaultValue":ce=f;break;case"children":break;case"dangerouslySetInnerHTML":if(f!=null)throw Error(a(91));break;default:f!==m&&wt(r,i,S,f,u,m)}Fm(r,oe,ce);return;case"option":for(var Ye in o)if(oe=o[Ye],o.hasOwnProperty(Ye)&&oe!=null&&!u.hasOwnProperty(Ye))switch(Ye){case"selected":r.selected=!1;break;default:wt(r,i,Ye,null,u,oe)}for(z in u)if(oe=u[z],ce=o[z],u.hasOwnProperty(z)&&oe!==ce&&(oe!=null||ce!=null))switch(z){case"selected":r.selected=oe&&typeof oe!="function"&&typeof oe!="symbol";break;default:wt(r,i,z,oe,u,ce)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Ke in o)oe=o[Ke],o.hasOwnProperty(Ke)&&oe!=null&&!u.hasOwnProperty(Ke)&&wt(r,i,Ke,null,u,oe);for(ne in u)if(oe=u[ne],ce=o[ne],u.hasOwnProperty(ne)&&oe!==ce&&(oe!=null||ce!=null))switch(ne){case"children":case"dangerouslySetInnerHTML":if(oe!=null)throw Error(a(137,i));break;default:wt(r,i,ne,oe,u,ce)}return;default:if(cf(i)){for(var bt in o)oe=o[bt],o.hasOwnProperty(bt)&&oe!==void 0&&!u.hasOwnProperty(bt)&&qd(r,i,bt,void 0,u,oe);for(me in u)oe=u[me],ce=o[me],!u.hasOwnProperty(me)||oe===ce||oe===void 0&&ce===void 0||qd(r,i,me,oe,u,ce);return}}for(var Q in o)oe=o[Q],o.hasOwnProperty(Q)&&oe!=null&&!u.hasOwnProperty(Q)&&wt(r,i,Q,null,u,oe);for(_e in u)oe=u[_e],ce=o[_e],!u.hasOwnProperty(_e)||oe===ce||oe==null&&ce==null||wt(r,i,_e,oe,u,ce)}var Yd=null,Xd=null;function mu(r){return r.nodeType===9?r:r.ownerDocument}function Uv(r){switch(r){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Bv(r,i){if(r===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return r===1&&i==="foreignObject"?0:r}function Wd(r,i){return r==="textarea"||r==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Qd=null;function MA(){var r=window.event;return r&&r.type==="popstate"?r===Qd?!1:(Qd=r,!0):(Qd=null,!1)}var Hv=typeof setTimeout=="function"?setTimeout:void 0,DA=typeof clearTimeout=="function"?clearTimeout:void 0,jv=typeof Promise=="function"?Promise:void 0,PA=typeof queueMicrotask=="function"?queueMicrotask:typeof jv<"u"?function(r){return jv.resolve(null).then(r).catch(FA)}:Hv;function FA(r){setTimeout(function(){throw r})}function li(r){return r==="head"}function zv(r,i){var o=i,u=0,f=0;do{var m=o.nextSibling;if(r.removeChild(o),m&&m.nodeType===8)if(o=m.data,o==="/$"){if(0<u&&8>u){o=u;var S=r.ownerDocument;if(o&1&&vl(S.documentElement),o&2&&vl(S.body),o&4)for(o=S.head,vl(o),S=o.firstChild;S;){var w=S.nextSibling,z=S.nodeName;S[R]||z==="SCRIPT"||z==="STYLE"||z==="LINK"&&S.rel.toLowerCase()==="stylesheet"||o.removeChild(S),S=w}}if(f===0){r.removeChild(m),Al(i);return}f--}else o==="$"||o==="$?"||o==="$!"?f++:u=o.charCodeAt(0)-48;else u=0;o=m}while(o);Al(i)}function Jd(r){var i=r.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var o=i;switch(i=i.nextSibling,o.nodeName){case"HTML":case"HEAD":case"BODY":Jd(o),N(o);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(o.rel.toLowerCase()==="stylesheet")continue}r.removeChild(o)}}function LA(r,i,o,u){for(;r.nodeType===1;){var f=o;if(r.nodeName.toLowerCase()!==i.toLowerCase()){if(!u&&(r.nodeName!=="INPUT"||r.type!=="hidden"))break}else if(u){if(!r[R])switch(i){case"meta":if(!r.hasAttribute("itemprop"))break;return r;case"link":if(m=r.getAttribute("rel"),m==="stylesheet"&&r.hasAttribute("data-precedence"))break;if(m!==f.rel||r.getAttribute("href")!==(f.href==null||f.href===""?null:f.href)||r.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin)||r.getAttribute("title")!==(f.title==null?null:f.title))break;return r;case"style":if(r.hasAttribute("data-precedence"))break;return r;case"script":if(m=r.getAttribute("src"),(m!==(f.src==null?null:f.src)||r.getAttribute("type")!==(f.type==null?null:f.type)||r.getAttribute("crossorigin")!==(f.crossOrigin==null?null:f.crossOrigin))&&m&&r.hasAttribute("async")&&!r.hasAttribute("itemprop"))break;return r;default:return r}}else if(i==="input"&&r.type==="hidden"){var m=f.name==null?null:""+f.name;if(f.type==="hidden"&&r.getAttribute("name")===m)return r}else return r;if(r=Vr(r.nextSibling),r===null)break}return null}function UA(r,i,o){if(i==="")return null;for(;r.nodeType!==3;)if((r.nodeType!==1||r.nodeName!=="INPUT"||r.type!=="hidden")&&!o||(r=Vr(r.nextSibling),r===null))return null;return r}function Zd(r){return r.data==="$!"||r.data==="$?"&&r.ownerDocument.readyState==="complete"}function BA(r,i){var o=r.ownerDocument;if(r.data!=="$?"||o.readyState==="complete")i();else{var u=function(){i(),o.removeEventListener("DOMContentLoaded",u)};o.addEventListener("DOMContentLoaded",u),r._reactRetry=u}}function Vr(r){for(;r!=null;r=r.nextSibling){var i=r.nodeType;if(i===1||i===3)break;if(i===8){if(i=r.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return r}var e0=null;function Gv(r){r=r.previousSibling;for(var i=0;r;){if(r.nodeType===8){var o=r.data;if(o==="$"||o==="$!"||o==="$?"){if(i===0)return r;i--}else o==="/$"&&i++}r=r.previousSibling}return null}function $v(r,i,o){switch(i=mu(o),r){case"html":if(r=i.documentElement,!r)throw Error(a(452));return r;case"head":if(r=i.head,!r)throw Error(a(453));return r;case"body":if(r=i.body,!r)throw Error(a(454));return r;default:throw Error(a(451))}}function vl(r){for(var i=r.attributes;i.length;)r.removeAttributeNode(i[0]);N(r)}var Fr=new Map,Kv=new Set;function pu(r){return typeof r.getRootNode=="function"?r.getRootNode():r.nodeType===9?r:r.ownerDocument}var Ma=xe.d;xe.d={f:HA,r:jA,D:zA,C:GA,L:$A,m:KA,X:qA,S:VA,M:YA};function HA(){var r=Ma.f(),i=ou();return r||i}function jA(r){var i=F(r);i!==null&&i.tag===5&&i.type==="form"?h1(i):Ma.r(r)}var Xs=typeof document>"u"?null:document;function Vv(r,i,o){var u=Xs;if(u&&typeof i=="string"&&i){var f=Rr(i);f='link[rel="'+r+'"][href="'+f+'"]',typeof o=="string"&&(f+='[crossorigin="'+o+'"]'),Kv.has(f)||(Kv.add(f),r={rel:r,crossOrigin:o,href:i},u.querySelector(f)===null&&(i=u.createElement("link"),Sn(i,"link",r),ee(i),u.head.appendChild(i)))}}function zA(r){Ma.D(r),Vv("dns-prefetch",r,null)}function GA(r,i){Ma.C(r,i),Vv("preconnect",r,i)}function $A(r,i,o){Ma.L(r,i,o);var u=Xs;if(u&&r&&i){var f='link[rel="preload"][as="'+Rr(i)+'"]';i==="image"&&o&&o.imageSrcSet?(f+='[imagesrcset="'+Rr(o.imageSrcSet)+'"]',typeof o.imageSizes=="string"&&(f+='[imagesizes="'+Rr(o.imageSizes)+'"]')):f+='[href="'+Rr(r)+'"]';var m=f;switch(i){case"style":m=Ws(r);break;case"script":m=Qs(r)}Fr.has(m)||(r=p({rel:"preload",href:i==="image"&&o&&o.imageSrcSet?void 0:r,as:i},o),Fr.set(m,r),u.querySelector(f)!==null||i==="style"&&u.querySelector(yl(m))||i==="script"&&u.querySelector(Tl(m))||(i=u.createElement("link"),Sn(i,"link",r),ee(i),u.head.appendChild(i)))}}function KA(r,i){Ma.m(r,i);var o=Xs;if(o&&r){var u=i&&typeof i.as=="string"?i.as:"script",f='link[rel="modulepreload"][as="'+Rr(u)+'"][href="'+Rr(r)+'"]',m=f;switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=Qs(r)}if(!Fr.has(m)&&(r=p({rel:"modulepreload",href:r},i),Fr.set(m,r),o.querySelector(f)===null)){switch(u){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(o.querySelector(Tl(m)))return}u=o.createElement("link"),Sn(u,"link",r),ee(u),o.head.appendChild(u)}}}function VA(r,i,o){Ma.S(r,i,o);var u=Xs;if(u&&r){var f=de(u).hoistableStyles,m=Ws(r);i=i||"default";var S=f.get(m);if(!S){var w={loading:0,preload:null};if(S=u.querySelector(yl(m)))w.loading=5;else{r=p({rel:"stylesheet",href:r,"data-precedence":i},o),(o=Fr.get(m))&&t0(r,o);var z=S=u.createElement("link");ee(z),Sn(z,"link",r),z._p=new Promise(function(ne,me){z.onload=ne,z.onerror=me}),z.addEventListener("load",function(){w.loading|=1}),z.addEventListener("error",function(){w.loading|=2}),w.loading|=4,vu(S,i,u)}S={type:"stylesheet",instance:S,count:1,state:w},f.set(m,S)}}}function qA(r,i){Ma.X(r,i);var o=Xs;if(o&&r){var u=de(o).hoistableScripts,f=Qs(r),m=u.get(f);m||(m=o.querySelector(Tl(f)),m||(r=p({src:r,async:!0},i),(i=Fr.get(f))&&n0(r,i),m=o.createElement("script"),ee(m),Sn(m,"link",r),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function YA(r,i){Ma.M(r,i);var o=Xs;if(o&&r){var u=de(o).hoistableScripts,f=Qs(r),m=u.get(f);m||(m=o.querySelector(Tl(f)),m||(r=p({src:r,async:!0,type:"module"},i),(i=Fr.get(f))&&n0(r,i),m=o.createElement("script"),ee(m),Sn(m,"link",r),o.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},u.set(f,m))}}function qv(r,i,o,u){var f=(f=Z.current)?pu(f):null;if(!f)throw Error(a(446));switch(r){case"meta":case"title":return null;case"style":return typeof o.precedence=="string"&&typeof o.href=="string"?(i=Ws(o.href),o=de(f).hoistableStyles,u=o.get(i),u||(u={type:"style",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};case"link":if(o.rel==="stylesheet"&&typeof o.href=="string"&&typeof o.precedence=="string"){r=Ws(o.href);var m=de(f).hoistableStyles,S=m.get(r);if(S||(f=f.ownerDocument||f,S={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(r,S),(m=f.querySelector(yl(r)))&&!m._p&&(S.instance=m,S.state.loading=5),Fr.has(r)||(o={rel:"preload",as:"style",href:o.href,crossOrigin:o.crossOrigin,integrity:o.integrity,media:o.media,hrefLang:o.hrefLang,referrerPolicy:o.referrerPolicy},Fr.set(r,o),m||XA(f,r,o,S.state))),i&&u===null)throw Error(a(528,""));return S}if(i&&u!==null)throw Error(a(529,""));return null;case"script":return i=o.async,o=o.src,typeof o=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=Qs(o),o=de(f).hoistableScripts,u=o.get(i),u||(u={type:"script",instance:null,count:0,state:null},o.set(i,u)),u):{type:"void",instance:null,count:0,state:null};default:throw Error(a(444,r))}}function Ws(r){return'href="'+Rr(r)+'"'}function yl(r){return'link[rel="stylesheet"]['+r+"]"}function Yv(r){return p({},r,{"data-precedence":r.precedence,precedence:null})}function XA(r,i,o,u){r.querySelector('link[rel="preload"][as="style"]['+i+"]")?u.loading=1:(i=r.createElement("link"),u.preload=i,i.addEventListener("load",function(){return u.loading|=1}),i.addEventListener("error",function(){return u.loading|=2}),Sn(i,"link",o),ee(i),r.head.appendChild(i))}function Qs(r){return'[src="'+Rr(r)+'"]'}function Tl(r){return"script[async]"+r}function Xv(r,i,o){if(i.count++,i.instance===null)switch(i.type){case"style":var u=r.querySelector('style[data-href~="'+Rr(o.href)+'"]');if(u)return i.instance=u,ee(u),u;var f=p({},o,{"data-href":o.href,"data-precedence":o.precedence,href:null,precedence:null});return u=(r.ownerDocument||r).createElement("style"),ee(u),Sn(u,"style",f),vu(u,o.precedence,r),i.instance=u;case"stylesheet":f=Ws(o.href);var m=r.querySelector(yl(f));if(m)return i.state.loading|=4,i.instance=m,ee(m),m;u=Yv(o),(f=Fr.get(f))&&t0(u,f),m=(r.ownerDocument||r).createElement("link"),ee(m);var S=m;return S._p=new Promise(function(w,z){S.onload=w,S.onerror=z}),Sn(m,"link",u),i.state.loading|=4,vu(m,o.precedence,r),i.instance=m;case"script":return m=Qs(o.src),(f=r.querySelector(Tl(m)))?(i.instance=f,ee(f),f):(u=o,(f=Fr.get(m))&&(u=p({},o),n0(u,f)),r=r.ownerDocument||r,f=r.createElement("script"),ee(f),Sn(f,"link",u),r.head.appendChild(f),i.instance=f);case"void":return null;default:throw Error(a(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(u=i.instance,i.state.loading|=4,vu(u,o.precedence,r));return i.instance}function vu(r,i,o){for(var u=o.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),f=u.length?u[u.length-1]:null,m=f,S=0;S<u.length;S++){var w=u[S];if(w.dataset.precedence===i)m=w;else if(m!==f)break}m?m.parentNode.insertBefore(r,m.nextSibling):(i=o.nodeType===9?o.head:o,i.insertBefore(r,i.firstChild))}function t0(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.title==null&&(r.title=i.title)}function n0(r,i){r.crossOrigin==null&&(r.crossOrigin=i.crossOrigin),r.referrerPolicy==null&&(r.referrerPolicy=i.referrerPolicy),r.integrity==null&&(r.integrity=i.integrity)}var yu=null;function Wv(r,i,o){if(yu===null){var u=new Map,f=yu=new Map;f.set(o,u)}else f=yu,u=f.get(o),u||(u=new Map,f.set(o,u));if(u.has(r))return u;for(u.set(r,null),o=o.getElementsByTagName(r),f=0;f<o.length;f++){var m=o[f];if(!(m[R]||m[ln]||r==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var S=m.getAttribute(i)||"";S=r+S;var w=u.get(S);w?w.push(m):u.set(S,[m])}}return u}function Qv(r,i,o){r=r.ownerDocument||r,r.head.insertBefore(o,i==="title"?r.querySelector("head > title"):null)}function WA(r,i,o){if(o===1||i.itemProp!=null)return!1;switch(r){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return r=i.disabled,typeof i.precedence=="string"&&r==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function Jv(r){return!(r.type==="stylesheet"&&(r.state.loading&3)===0)}var _l=null;function QA(){}function JA(r,i,o){if(_l===null)throw Error(a(475));var u=_l;if(i.type==="stylesheet"&&(typeof o.media!="string"||matchMedia(o.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var f=Ws(o.href),m=r.querySelector(yl(f));if(m){r=m._p,r!==null&&typeof r=="object"&&typeof r.then=="function"&&(u.count++,u=Tu.bind(u),r.then(u,u)),i.state.loading|=4,i.instance=m,ee(m);return}m=r.ownerDocument||r,o=Yv(o),(f=Fr.get(f))&&t0(o,f),m=m.createElement("link"),ee(m);var S=m;S._p=new Promise(function(w,z){S.onload=w,S.onerror=z}),Sn(m,"link",o),i.instance=m}u.stylesheets===null&&(u.stylesheets=new Map),u.stylesheets.set(i,r),(r=i.state.preload)&&(i.state.loading&3)===0&&(u.count++,i=Tu.bind(u),r.addEventListener("load",i),r.addEventListener("error",i))}}function ZA(){if(_l===null)throw Error(a(475));var r=_l;return r.stylesheets&&r.count===0&&r0(r,r.stylesheets),0<r.count?function(i){var o=setTimeout(function(){if(r.stylesheets&&r0(r,r.stylesheets),r.unsuspend){var u=r.unsuspend;r.unsuspend=null,u()}},6e4);return r.unsuspend=i,function(){r.unsuspend=null,clearTimeout(o)}}:null}function Tu(){if(this.count--,this.count===0){if(this.stylesheets)r0(this,this.stylesheets);else if(this.unsuspend){var r=this.unsuspend;this.unsuspend=null,r()}}}var _u=null;function r0(r,i){r.stylesheets=null,r.unsuspend!==null&&(r.count++,_u=new Map,i.forEach(ew,r),_u=null,Tu.call(r))}function ew(r,i){if(!(i.state.loading&4)){var o=_u.get(r);if(o)var u=o.get(null);else{o=new Map,_u.set(r,o);for(var f=r.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<f.length;m++){var S=f[m];(S.nodeName==="LINK"||S.getAttribute("media")!=="not all")&&(o.set(S.dataset.precedence,S),u=S)}u&&o.set(null,u)}f=i.instance,S=f.getAttribute("data-precedence"),m=o.get(S)||u,m===u&&o.set(null,f),o.set(S,f),this.count++,u=Tu.bind(this),f.addEventListener("load",u),f.addEventListener("error",u),m?m.parentNode.insertBefore(f,m.nextSibling):(r=r.nodeType===9?r.head:r,r.insertBefore(f,r.firstChild)),i.state.loading|=4}}var xl={$$typeof:O,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function tw(r,i,o,u,f,m,S,w){this.tag=1,this.containerInfo=r,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=No(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=No(0),this.hiddenUpdates=No(null),this.identifierPrefix=u,this.onUncaughtError=f,this.onCaughtError=m,this.onRecoverableError=S,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=w,this.incompleteTransitions=new Map}function Zv(r,i,o,u,f,m,S,w,z,ne,me,_e){return r=new tw(r,i,o,S,w,z,ne,_e),i=1,m===!0&&(i|=24),m=ur(3,null,null,i),r.current=m,m.stateNode=r,i=Uf(),i.refCount++,r.pooledCache=i,i.refCount++,m.memoizedState={element:u,isDehydrated:o,cache:i},zf(m),r}function ey(r){return r?(r=Is,r):Is}function ty(r,i,o,u,f,m){f=ey(f),u.context===null?u.context=f:u.pendingContext=f,u=Xa(i),u.payload={element:o},m=m===void 0?null:m,m!==null&&(u.callback=m),o=Wa(r,u,i),o!==null&&(mr(o,r,i),Qo(o,r,i))}function ny(r,i){if(r=r.memoizedState,r!==null&&r.dehydrated!==null){var o=r.retryLane;r.retryLane=o!==0&&o<i?o:i}}function a0(r,i){ny(r,i),(r=r.alternate)&&ny(r,i)}function ry(r){if(r.tag===13){var i=bs(r,67108864);i!==null&&mr(i,r,67108864),a0(r,67108864)}}var xu=!0;function nw(r,i,o,u){var f=re.T;re.T=null;var m=xe.p;try{xe.p=2,i0(r,i,o,u)}finally{xe.p=m,re.T=f}}function rw(r,i,o,u){var f=re.T;re.T=null;var m=xe.p;try{xe.p=8,i0(r,i,o,u)}finally{xe.p=m,re.T=f}}function i0(r,i,o,u){if(xu){var f=s0(u);if(f===null)Vd(r,i,u,Su,o),iy(r,u);else if(iw(f,r,i,o,u))u.stopPropagation();else if(iy(r,u),i&4&&-1<aw.indexOf(r)){for(;f!==null;){var m=F(f);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var S=ra(m.pendingLanes);if(S!==0){var w=m;for(w.pendingLanes|=2,w.entangledLanes|=2;S;){var z=1<<31-$n(S);w.entanglements[1]|=z,S&=~z}ca(m),(pt&6)===0&&(iu=Fe()+500,gl(0))}}break;case 13:w=bs(m,2),w!==null&&mr(w,m,2),ou(),a0(m,2)}if(m=s0(u),m===null&&Vd(r,i,u,Su,o),m===f)break;f=m}f!==null&&u.stopPropagation()}else Vd(r,i,u,null,o)}}function s0(r){return r=hf(r),o0(r)}var Su=null;function o0(r){if(Su=null,r=M(r),r!==null){var i=l(r);if(i===null)r=null;else{var o=i.tag;if(o===13){if(r=c(i),r!==null)return r;r=null}else if(o===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;r=null}else i!==r&&(r=null)}}return Su=r,null}function ay(r){switch(r){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(On()){case jn:return 2;case wr:return 8;case lr:case Me:return 32;case Mt:return 268435456;default:return 32}default:return 32}}var l0=!1,ci=null,ui=null,hi=null,Sl=new Map,Cl=new Map,fi=[],aw="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iy(r,i){switch(r){case"focusin":case"focusout":ci=null;break;case"dragenter":case"dragleave":ui=null;break;case"mouseover":case"mouseout":hi=null;break;case"pointerover":case"pointerout":Sl.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Cl.delete(i.pointerId)}}function El(r,i,o,u,f,m){return r===null||r.nativeEvent!==m?(r={blockedOn:i,domEventName:o,eventSystemFlags:u,nativeEvent:m,targetContainers:[f]},i!==null&&(i=F(i),i!==null&&ry(i)),r):(r.eventSystemFlags|=u,i=r.targetContainers,f!==null&&i.indexOf(f)===-1&&i.push(f),r)}function iw(r,i,o,u,f){switch(i){case"focusin":return ci=El(ci,r,i,o,u,f),!0;case"dragenter":return ui=El(ui,r,i,o,u,f),!0;case"mouseover":return hi=El(hi,r,i,o,u,f),!0;case"pointerover":var m=f.pointerId;return Sl.set(m,El(Sl.get(m)||null,r,i,o,u,f)),!0;case"gotpointercapture":return m=f.pointerId,Cl.set(m,El(Cl.get(m)||null,r,i,o,u,f)),!0}return!1}function sy(r){var i=M(r.target);if(i!==null){var o=l(i);if(o!==null){if(i=o.tag,i===13){if(i=c(o),i!==null){r.blockedOn=i,af(r.priority,function(){if(o.tag===13){var u=gr();u=ko(u);var f=bs(o,u);f!==null&&mr(f,o,u),a0(o,u)}});return}}else if(i===3&&o.stateNode.current.memoizedState.isDehydrated){r.blockedOn=o.tag===3?o.stateNode.containerInfo:null;return}}}r.blockedOn=null}function Cu(r){if(r.blockedOn!==null)return!1;for(var i=r.targetContainers;0<i.length;){var o=s0(r.nativeEvent);if(o===null){o=r.nativeEvent;var u=new o.constructor(o.type,o);uf=u,o.target.dispatchEvent(u),uf=null}else return i=F(o),i!==null&&ry(i),r.blockedOn=o,!1;i.shift()}return!0}function oy(r,i,o){Cu(r)&&o.delete(i)}function sw(){l0=!1,ci!==null&&Cu(ci)&&(ci=null),ui!==null&&Cu(ui)&&(ui=null),hi!==null&&Cu(hi)&&(hi=null),Sl.forEach(oy),Cl.forEach(oy)}function Eu(r,i){r.blockedOn===i&&(r.blockedOn=null,l0||(l0=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,sw)))}var Au=null;function ly(r){Au!==r&&(Au=r,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Au===r&&(Au=null);for(var i=0;i<r.length;i+=3){var o=r[i],u=r[i+1],f=r[i+2];if(typeof u!="function"){if(o0(u||o)===null)continue;break}var m=F(o);m!==null&&(r.splice(i,3),i-=3,od(m,{pending:!0,data:f,method:o.method,action:u},u,f))}}))}function Al(r){function i(z){return Eu(z,r)}ci!==null&&Eu(ci,r),ui!==null&&Eu(ui,r),hi!==null&&Eu(hi,r),Sl.forEach(i),Cl.forEach(i);for(var o=0;o<fi.length;o++){var u=fi[o];u.blockedOn===r&&(u.blockedOn=null)}for(;0<fi.length&&(o=fi[0],o.blockedOn===null);)sy(o),o.blockedOn===null&&fi.shift();if(o=(r.ownerDocument||r).$$reactFormReplay,o!=null)for(u=0;u<o.length;u+=3){var f=o[u],m=o[u+1],S=f[cn]||null;if(typeof m=="function")S||ly(o);else if(S){var w=null;if(m&&m.hasAttribute("formAction")){if(f=m,S=m[cn]||null)w=S.formAction;else if(o0(f)!==null)continue}else w=S.action;typeof w=="function"?o[u+1]=w:(o.splice(u,3),u-=3),ly(o)}}}function c0(r){this._internalRoot=r}wu.prototype.render=c0.prototype.render=function(r){var i=this._internalRoot;if(i===null)throw Error(a(409));var o=i.current,u=gr();ty(o,u,r,i,null,null)},wu.prototype.unmount=c0.prototype.unmount=function(){var r=this._internalRoot;if(r!==null){this._internalRoot=null;var i=r.containerInfo;ty(r.current,2,null,r,null,null),ou(),i[$a]=null}};function wu(r){this._internalRoot=r}wu.prototype.unstable_scheduleHydration=function(r){if(r){var i=Tc();r={blockedOn:null,target:r,priority:i};for(var o=0;o<fi.length&&i!==0&&i<fi[o].priority;o++);fi.splice(o,0,r),o===0&&sy(r)}};var cy=e.version;if(cy!=="19.1.1")throw Error(a(527,cy,"19.1.1"));xe.findDOMNode=function(r){var i=r._reactInternals;if(i===void 0)throw typeof r.render=="function"?Error(a(188)):(r=Object.keys(r).join(","),Error(a(268,r)));return r=d(i),r=r!==null?g(r):null,r=r===null?null:r.stateNode,r};var ow={bundleType:0,version:"19.1.1",rendererPackageName:"react-dom",currentDispatcherRef:re,reconcilerVersion:"19.1.1"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var bu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!bu.isDisabled&&bu.supportsFiber)try{Gn=bu.inject(ow),Tn=bu}catch{}}return bl.createRoot=function(r,i){if(!s(r))throw Error(a(299));var o=!1,u="",f=A1,m=w1,S=b1,w=null;return i!=null&&(i.unstable_strictMode===!0&&(o=!0),i.identifierPrefix!==void 0&&(u=i.identifierPrefix),i.onUncaughtError!==void 0&&(f=i.onUncaughtError),i.onCaughtError!==void 0&&(m=i.onCaughtError),i.onRecoverableError!==void 0&&(S=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(w=i.unstable_transitionCallbacks)),i=Zv(r,1,!1,null,null,o,u,f,m,S,w,null),r[$a]=i.current,Kd(r),new c0(i)},bl.hydrateRoot=function(r,i,o){if(!s(r))throw Error(a(299));var u=!1,f="",m=A1,S=w1,w=b1,z=null,ne=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(f=o.identifierPrefix),o.onUncaughtError!==void 0&&(m=o.onUncaughtError),o.onCaughtError!==void 0&&(S=o.onCaughtError),o.onRecoverableError!==void 0&&(w=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(z=o.unstable_transitionCallbacks),o.formState!==void 0&&(ne=o.formState)),i=Zv(r,1,!0,i,o??null,u,f,m,S,w,z,ne),i.context=ey(null),o=i.current,u=gr(),u=ko(u),f=Xa(u),f.callback=null,Wa(o,f,u),o=u,i.current.lanes=o,Di(i,o),ca(i),r[$a]=i.current,Kd(r),new wu(i)},bl.version="19.1.1",bl}var Ty;function pw(){if(Ty)return f0.exports;Ty=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),f0.exports=mw(),f0.exports}var vw=pw();class mo{getToken;baseUrl;constructor(e,t="https://graph.microsoft.com/v1.0"){this.getToken=e,this.baseUrl=t}async call(e,t,a){const s=await this.getToken(),l=`${this.baseUrl}${t}`,c=await fetch(l,{method:e,headers:{Authorization:`Bearer ${s}`,...a?{"Content-Type":"application/json"}:{}},body:a?JSON.stringify(a):void 0});if(!c.ok){const d=await c.text().catch(()=>"");throw new Error(`${e} ${t} -> ${c.status} ${c.statusText} ${d?":: "+d:""}`)}if(c.status===204)return;const h=c.headers.get("content-type")||"";if(!h||!h.toLowerCase().includes("application/json")){const d=await c.text().catch(()=>"");return d?JSON.parse(d):void 0}return await c.json()}get(e){return this.call("GET",e)}post(e,t){return this.call("POST",e,t)}patch(e,t){return this.call("PATCH",e,t)}delete(e){return this.call("DELETE",e)}async getAllPages(e){let t=`${this.baseUrl}${e}`;const a=await this.getToken(),s=[];for(;t;){const l=await fetch(t,{headers:{Authorization:`Bearer ${a}`}});if(!l.ok)throw new Error(`GET ${t} -> ${l.status} ${await l.text()}`);const c=await l.json();Array.isArray(c?.value)&&s.push(...c.value),t=c["@odata.nextLink"]||""}return s}async getBlob(e){const t=await this.getToken(),a=await fetch(`${this.baseUrl}${e}`,{headers:{Authorization:`Bearer ${t}`}});if(!a.ok)throw new Error(`GET ${e} -> ${a.status} ${await a.text()}`);return await a.blob()}}class yw{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Settings"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),VisibleDays:t.VisibleDays!=null?Number(t.VisibleDays):void 0,InicioManana:t.InicioManana!=null?String(t.InicioManana):"07:00",FinalManana:t.FinalManana!=null?String(t.FinalManana):"12:00",InicioTarde:t.InicioTarde!=null?String(t.InicioTarde):"12:00",FinalTarde:t.FinalTarde!=null?String(t.FinalTarde):"18:00",TerminosyCondiciones:t.TerminosyCondiciones!=null?String(t.TerminosyCondiciones):"",PicoPlaca:!!t.PicoPlaca}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e}),a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${t?.id}?$expand=fields`);return this.toModel(a)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getById(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async getByTitle(e){return(await this.getAll({filter:`fields/Title eq '${this.esc(e)}'`,top:1}))[0]??null}async getVisibleDaysFromId1(){const e=await this.get("1");return Number(e.VisibleDays??0)}}function r_(n){throw new Error("SettingsService no inicializado")}const Tw="_wrapper_12agz_35",_w="_toolbar_12agz_55",xw="_label_12agz_93",Sw="_input_12agz_109",Cw="_select_12agz_111",Ew="_button_12agz_141",Aw="_error_12agz_175",pr={wrapper:Tw,toolbar:_w,label:xw,input:Sw,select:Cw,button:Ew,error:Aw},_y=n=>("0"+n).slice(-2),xy=n=>`${n.getFullYear()}-${_y(n.getMonth()+1)}-${_y(n.getDate())}`,ww=()=>{const n=new Date,e=new Date;return e.setDate(e.getDate()-29),{from:xy(e),to:xy(n)}},bw=(n,e)=>{const t=new Date(n);return t.setDate(t.getDate()+e),t},Sy=n=>n?n.toISOString().slice(0,10):"",Cy=()=>new Date().toISOString().slice(0,10),Iw="_backdrop_lu36a_1",Rw="_termsBox_lu36a_19",Nw="_modal_lu36a_57",kw="_header_lu36a_85",Ow="_title_lu36a_93",Mw="_close_lu36a_95",Dw="_body_lu36a_99",Pw="_footer_lu36a_103",Fw="_btnPrimary_lu36a_113",Lw="_btnGhost_lu36a_125",ua={backdrop:Iw,termsBox:Rw,modal:Nw,header:kw,title:Ow,close:Mw,body:Dw,footer:Pw,btnPrimary:Fw,btnGhost:Lw};/*! @azure/msal-common v15.12.0 2025-08-19 */const ye={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},vi={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,GONE:410,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},ts={GET:"GET",POST:"POST"},To=[ye.OPENID_SCOPE,ye.PROFILE_SCOPE,ye.OFFLINE_ACCESS_SCOPE],Ey=[...To,ye.EMAIL_SCOPE],qn={CONTENT_TYPE:"Content-Type",CONTENT_LENGTH:"Content-Length",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},Ay={ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},_i={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Iu={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Wn={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",NO_SESSION:"no_session"},tg={CODE:"code",IDTOKEN_TOKEN_REFRESHTOKEN:"id_token token refresh_token"},kh={QUERY:"query",FRAGMENT:"fragment"},Uw={QUERY:"query"},a_={AUTHORIZATION_CODE_GRANT:"authorization_code",REFRESH_TOKEN_GRANT:"refresh_token"},Ru={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",GENERIC_ACCOUNT_TYPE:"Generic"},ql={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},bn={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"},ng="appmetadata",Bw="client_info",Wu="1",Qu={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},vr={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},En={SCHEMA_VERSION:5,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},_t={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Pl={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},wy={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Js={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},p0={CONFIGURED_NO_AUTO_DETECTION:"2",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},Zi={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Hw={Pop:"pop"},i_=300;/*! @azure/msal-common v15.12.0 2025-08-19 */const Ju="unexpected_error",jw="post_request_failed";/*! @azure/msal-common v15.12.0 2025-08-19 */const by={[Ju]:"Unexpected error in authentication.",[jw]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."};class kt extends Error{constructor(e,t,a){const s=t?`${e}: ${t}`:e;super(s),Object.setPrototypeOf(this,kt.prototype),this.errorCode=e||ye.EMPTY_STRING,this.errorMessage=t||ye.EMPTY_STRING,this.subError=a||ye.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}}function M0(n,e){return new kt(n,e?`${by[n]} ${e}`:by[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */const rg="client_info_decoding_error",s_="client_info_empty_error",ag="token_parsing_error",o_="null_or_empty_token",Pa="endpoints_resolution_error",l_="network_error",c_="openid_config_error",u_="hash_not_deserialized",po="invalid_state",h_="state_mismatch",D0="state_not_found",f_="nonce_mismatch",ig="auth_time_not_found",d_="max_age_transpired",zw="multiple_matching_tokens",Gw="multiple_matching_accounts",g_="multiple_matching_appMetadata",m_="request_cannot_be_made",p_="cannot_remove_empty_scope",v_="cannot_append_scopeset",P0="empty_input_scopeset",$w="device_code_polling_cancelled",Kw="device_code_expired",Vw="device_code_unknown_error",sg="no_account_in_silent_request",y_="invalid_cache_record",og="invalid_cache_environment",F0="no_account_found",L0="no_crypto_object",qw="unexpected_credential_type",Yw="invalid_assertion",Xw="invalid_client_credential",xi="token_refresh_required",Ww="user_timeout_reached",T_="token_claims_cnf_required_for_signedjwt",__="authorization_code_missing_from_server_response",x_="binding_key_not_removed",S_="end_session_endpoint_not_supported",lg="key_id_missing",Qw="no_network_connectivity",Jw="user_canceled",Zw="missing_tenant_id_error",tt="method_not_implemented",e2="nested_app_auth_bridge_disabled";/*! @azure/msal-common v15.12.0 2025-08-19 */const Iy={[rg]:"The client info could not be parsed/decoded correctly",[s_]:"The client info was empty",[ag]:"Token cannot be parsed",[o_]:"The token is null or empty",[Pa]:"Endpoints cannot be resolved",[l_]:"Network request failed",[c_]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[u_]:"The hash parameters could not be deserialized",[po]:"State was not the expected format",[h_]:"State mismatch error",[D0]:"State not found",[f_]:"Nonce mismatch error",[ig]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[d_]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[zw]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Gw]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[g_]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[m_]:"Token request cannot be made without authorization code or refresh token.",[p_]:"Cannot remove null or empty scope from ScopeSet",[v_]:"Cannot append ScopeSet",[P0]:"Empty input ScopeSet cannot be processed",[$w]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Kw]:"Device code is expired.",[Vw]:"Device code stopped polling for unknown reasons.",[sg]:"Please pass an account object, silent flow is not supported without account information",[y_]:"Cache record object was null or undefined.",[og]:"Invalid environment when attempting to create cache entry",[F0]:"No account found in cache for given key.",[L0]:"No crypto object detected.",[qw]:"Unexpected credential type.",[Yw]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Xw]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[xi]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Ww]:"User defined timeout for device code polling reached",[T_]:"Cannot generate a POP jwt if the token_claims are not populated",[__]:"Server response does not contain an authorization code to proceed",[x_]:"Could not remove the credential's binding key from storage.",[S_]:"The provided authority does not support logout",[lg]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Qw]:"No network connectivity. Check your internet connection.",[Jw]:"User cancelled the flow.",[Zw]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[tt]:"This method has not been implemented",[e2]:"The nested app auth bridge is disabled"};class cg extends kt{constructor(e,t){super(e,t?`${Iy[e]}: ${t}`:Iy[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,cg.prototype)}}function we(n,e){return new cg(n,e)}/*! @azure/msal-common v15.12.0 2025-08-19 */const Zu={createNewGuid:()=>{throw we(tt)},base64Decode:()=>{throw we(tt)},base64Encode:()=>{throw we(tt)},base64UrlEncode:()=>{throw we(tt)},encodeKid:()=>{throw we(tt)},async getPublicKeyThumbprint(){throw we(tt)},async removeTokenBindingKey(){throw we(tt)},async clearKeystore(){throw we(tt)},async signJwt(){throw we(tt)},async hashString(){throw we(tt)}};/*! @azure/msal-common v15.12.0 2025-08-19 */var Ht;(function(n){n[n.Error=0]="Error",n[n.Warning=1]="Warning",n[n.Info=2]="Info",n[n.Verbose=3]="Verbose",n[n.Trace=4]="Trace"})(Ht||(Ht={}));class Ei{constructor(e,t,a){this.level=Ht.Info;const s=()=>{},l=e||Ei.createDefaultLoggerOptions();this.localCallback=l.loggerCallback||s,this.piiLoggingEnabled=l.piiLoggingEnabled||!1,this.level=typeof l.logLevel=="number"?l.logLevel:Ht.Info,this.correlationId=l.correlationId||ye.EMPTY_STRING,this.packageName=t||ye.EMPTY_STRING,this.packageVersion=a||ye.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ht.Info}}clone(e,t,a){return new Ei({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:a||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;const l=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Ht[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,l,t.containsPii||!1)}executeCallback(e,t,a){this.localCallback&&this.localCallback(e,t,a)}error(e,t){this.logMessage(e,{logLevel:Ht.Error,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Ht.Error,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Ht.Warning,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Ht.Warning,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Ht.Info,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Ht.Info,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Ht.Verbose,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Ht.Verbose,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Ht.Trace,containsPii:!1,correlationId:t||ye.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Ht.Trace,containsPii:!0,correlationId:t||ye.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}}/*! @azure/msal-common v15.12.0 2025-08-19 */const C_="@azure/msal-common",ug="15.12.0";/*! @azure/msal-common v15.12.0 2025-08-19 */const hg={None:"none"};/*! @azure/msal-common v15.12.0 2025-08-19 */const E_="redirect_uri_empty",t2="claims_request_parsing_error",A_="authority_uri_insecure",kl="url_parse_error",w_="empty_url_error",b_="empty_input_scopes_error",fg="invalid_claims",I_="token_request_empty",R_="logout_request_empty",n2="invalid_code_challenge_method",dg="pkce_params_missing",gg="invalid_cloud_discovery_metadata",N_="invalid_authority_metadata",k_="untrusted_authority",Oh="missing_ssh_jwk",O_="missing_ssh_kid",r2="missing_nonce_authentication_header",a2="invalid_authentication_header",M_="cannot_set_OIDCOptions",D_="cannot_allow_platform_broker",P_="authority_mismatch",F_="invalid_request_method_for_EAR",L_="invalid_authorize_post_body_parameters";/*! @azure/msal-common v15.12.0 2025-08-19 */const i2={[E_]:"A redirect URI is required for all calls, and none has been set.",[t2]:"Could not parse the given claims request object.",[A_]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[kl]:"URL could not be parsed into appropriate segments.",[w_]:"URL was empty or null.",[b_]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[fg]:"Given claims parameter must be a stringified JSON object.",[I_]:"Token request was empty and not found in cache.",[R_]:"The logout request was null or undefined.",[n2]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[dg]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[gg]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[N_]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[k_]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[Oh]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[O_]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[r2]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[a2]:"Invalid authentication header provided",[M_]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[D_]:"Cannot set allowPlatformBroker parameter to true when not in AAD protocol mode.",[P_]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority.",[L_]:"Invalid authorize post body parameters provided. If you are using authorizePostBodyParameters, the request method must be POST. Please check the request method and parameters.",[F_]:"Invalid request method for EAR protocol mode. The request method cannot be GET when using EAR protocol mode. Please change the request method to POST."};class mg extends kt{constructor(e){super(e,i2[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,mg.prototype)}}function Pt(n){return new mg(n)}/*! @azure/msal-common v15.12.0 2025-08-19 */class Cr{static isEmptyObj(e){if(e)try{const t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){const t={},a=e.split("&"),s=l=>decodeURIComponent(l.replace(/\+/g," "));return a.forEach(l=>{if(l.trim()){const[c,h]=l.split(/=(.+)/g,2);c&&h&&(t[s(c)]=s(h))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class sn{constructor(e){const t=e?Cr.trimArrayEntries([...e]):[],a=t?Cr.removeEmptyStringsFromArray(t):[];if(!a||!a.length)throw Pt(b_);this.scopes=new Set,a.forEach(s=>this.scopes.add(s))}static fromString(e){const a=(e||ye.EMPTY_STRING).split(" ");return new sn(a)}static createSearchScopes(e){const t=e&&e.length>0?e:[...To],a=new sn(t);return a.containsOnlyOIDCScopes()?a.removeScope(ye.OFFLINE_ACCESS_SCOPE):a.removeOIDCScopes(),a}containsScope(e){const t=this.printScopesLowerCase().split(" "),a=new sn(t);return e?a.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return Ey.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw we(v_)}}removeScope(e){if(!e)throw we(p_);this.scopes.delete(e.trim())}removeOIDCScopes(){Ey.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw we(P0);const t=new Set;return e.scopes.forEach(a=>t.add(a.toLowerCase())),this.scopes.forEach(a=>t.add(a.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw we(P0);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();const t=this.unionScopeSets(e),a=e.getScopeCount(),s=this.getScopeCount();return t.size<s+a}getScopeCount(){return this.scopes.size}asArray(){const e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):ye.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}}/*! @azure/msal-common v15.12.0 2025-08-19 */function Ry(n,e){return!!n&&!!e&&n===e.split(".")[1]}function pg(n,e,t,a){if(a){const{oid:s,sub:l,tid:c,name:h,tfp:d,acr:g,preferred_username:p,upn:v,login_hint:_}=a,T=c||d||g||"";return{tenantId:T,localAccountId:s||l||"",name:h,username:p||v||"",loginHint:_,isHomeTenant:Ry(T,n)}}else return{tenantId:t,localAccountId:e,username:"",isHomeTenant:Ry(t,n)}}function vg(n,e,t,a){let s=n;if(e){const{isHomeTenant:l,...c}=e;s={...n,...c}}if(t){const{isHomeTenant:l,...c}=pg(n.homeAccountId,n.localAccountId,n.tenantId,t);return s={...s,...c,idTokenClaims:t,idToken:a},s}return s}/*! @azure/msal-common v15.12.0 2025-08-19 */function _o(n,e){const t=s2(n);try{const a=e(t);return JSON.parse(a)}catch{throw we(ag)}}function s2(n){if(!n)throw we(o_);const t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(n);if(!t||t.length<4)throw we(ag);return t[2]}function U_(n,e){if(e===0||Date.now()-3e5>n+e)throw we(d_)}/*! @azure/msal-common v15.12.0 2025-08-19 */function Ny(n){if(!n)return n;let e=n.toLowerCase();return Cr.endsWith(e,"?")?e=e.slice(0,-1):Cr.endsWith(e,"?/")&&(e=e.slice(0,-2)),Cr.endsWith(e,"/")||(e+="/"),e}function B_(n){return n.startsWith("#/")?n.substring(2):n.startsWith("#")||n.startsWith("?")?n.substring(1):n}function eh(n){if(!n||n.indexOf("=")<0)return null;try{const e=B_(n),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.ear_jwe||t.error||t.error_description||t.state)return t}catch{throw we(u_)}return null}function Yl(n,e=!0,t){const a=new Array;return n.forEach((s,l)=>{!e&&t&&l in t?a.push(`${l}=${s}`):a.push(`${l}=${encodeURIComponent(s)}`)}),a.join("&")}function ky(n){if(!n)return n;const e=n.split("#")[0];try{const t=new URL(e),a=t.origin+t.pathname+t.search;return Ny(a)}catch{return Ny(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class dt{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw Pt(w_);e.includes("#")||(this._urlString=dt.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return Cr.endsWith(t,"?")?t=t.slice(0,-1):Cr.endsWith(t,"?/")&&(t=t.slice(0,-2)),Cr.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw Pt(kl)}if(!e.HostNameAndPort||!e.PathSegments)throw Pt(kl);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw Pt(A_)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return dt.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){const t=this.getUrlComponents(),a=t.PathSegments;return e&&a.length!==0&&(a[0]===_i.COMMON||a[0]===_i.ORGANIZATIONS)&&(a[0]=e),dt.constructAuthorityUriFromObject(t)}getUrlComponents(){const e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw Pt(kl);const a={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]};let s=a.AbsolutePath.split("/");return s=s.filter(l=>l&&l.length>0),a.PathSegments=s,a.QueryString&&a.QueryString.endsWith("/")&&(a.QueryString=a.QueryString.substring(0,a.QueryString.length-1)),a}static getDomainFromUrl(e){const t=RegExp("^([^:/?#]+://)?([^/?#]*)"),a=e.match(t);if(!a)throw Pt(kl);return a[2]}static getAbsoluteUrl(e,t){if(e[0]===ye.FORWARD_SLASH){const s=new dt(t).getUrlComponents();return s.Protocol+"//"+s.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new dt(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!eh(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const H_={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Oy=H_.endpointMetadata,yg=H_.instanceDiscoveryMetadata,j_=new Set;yg.metadata.forEach(n=>{n.aliases.forEach(e=>{j_.add(e)})});function o2(n,e){let t;const a=n.canonicalAuthority;if(a){const s=new dt(a).getUrlComponents().HostNameAndPort;t=My(s,n.cloudDiscoveryMetadata?.metadata,vr.CONFIG,e)||My(s,yg.metadata,vr.HARDCODED_VALUES,e)||n.knownAuthorities}return t||[]}function My(n,e,t,a){if(a?.trace(`getAliasesFromMetadata called with source: ${t}`),n&&e){const s=th(e,n);if(s)return a?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),s.aliases;a?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function l2(n){return th(yg.metadata,n)}function th(n,e){for(let t=0;t<n.length;t++){const a=n[t];if(a.aliases.includes(e))return a}return null}/*! @azure/msal-common v15.12.0 2025-08-19 */const nh="cache_quota_exceeded",Tg="cache_error_unknown";/*! @azure/msal-common v15.12.0 2025-08-19 */const v0={[nh]:"Exceeded cache storage capacity.",[Tg]:"Unexpected error occurred when using cache storage."};class oo extends kt{constructor(e,t){const a=t||(v0[e]?v0[e]:v0[Tg]);super(`${e}: ${a}`),Object.setPrototypeOf(this,oo.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=a}}function U0(n){return n instanceof Error?n.name==="QuotaExceededError"||n.name==="NS_ERROR_DOM_QUOTA_REACHED"||n.message.includes("exceeded the quota")?new oo(nh):new oo(n.name,n.message):new oo(Tg)}/*! @azure/msal-common v15.12.0 2025-08-19 */class B0{constructor(e,t,a,s,l){this.clientId=e,this.cryptoImpl=t,this.commonLogger=a.clone(C_,ug),this.staticAuthorityOptions=l,this.performanceClient=s}getAllAccounts(e,t){return this.buildTenantProfiles(this.getAccountsFilteredBy(e,t),t,e)}getAccountInfoFilteredBy(e,t){if(Object.keys(e).length===0||Object.values(e).every(s=>!s))return this.commonLogger.warning("getAccountInfoFilteredBy: Account filter is empty or invalid, returning null"),null;const a=this.getAllAccounts(e,t);return a.length>1?a.sort(l=>l.idTokenClaims?-1:1)[0]:a.length===1?a[0]:null}getBaseAccountInfo(e,t){const a=this.getAccountsFilteredBy(e,t);return a.length>0?a[0].getAccountInfo():null}buildTenantProfiles(e,t,a){return e.flatMap(s=>this.getTenantProfilesFromAccountEntity(s,t,a?.tenantId,a))}getTenantedAccountInfoByFilter(e,t,a,s,l){let c=null,h;if(l&&!this.tenantProfileMatchesFilter(a,l))return null;const d=this.getIdToken(e,s,t,a.tenantId);return d&&(h=_o(d.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(h,l))?null:(c=vg(e,a,h,d?.secret),c)}getTenantProfilesFromAccountEntity(e,t,a,s){const l=e.getAccountInfo();let c=l.tenantProfiles||new Map;const h=this.getTokenKeys();if(a){const g=c.get(a);if(g)c=new Map([[a,g]]);else return[]}const d=[];return c.forEach(g=>{const p=this.getTenantedAccountInfoByFilter(l,h,g,t,s);p&&d.push(p)}),d}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}async saveCacheRecord(e,t,a){if(!e)throw we(y_);try{e.account&&await this.setAccount(e.account,t),e.idToken&&a?.idToken!==!1&&await this.setIdTokenCredential(e.idToken,t),e.accessToken&&a?.accessToken!==!1&&await this.saveAccessToken(e.accessToken,t),e.refreshToken&&a?.refreshToken!==!1&&await this.setRefreshTokenCredential(e.refreshToken,t),e.appMetadata&&this.setAppMetadata(e.appMetadata,t)}catch(s){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),s instanceof kt?s:U0(s)}}async saveAccessToken(e,t){const a={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},s=this.getTokenKeys(),l=sn.fromString(e.target);s.accessToken.forEach(c=>{if(!this.accessTokenKeyMatchesFilter(c,a,!1))return;const h=this.getAccessTokenCredential(c,t);h&&this.credentialMatchesFilter(h,a)&&sn.fromString(h.target).intersectingScopeSets(l)&&this.removeAccessToken(c,t)}),await this.setAccessTokenCredential(e,t)}getAccountsFilteredBy(e,t){const a=this.getAccountKeys(),s=[];return a.forEach(l=>{const c=this.getAccount(l,t);if(!c||e.homeAccountId&&!this.matchHomeAccountId(c,e.homeAccountId)||e.username&&!this.matchUsername(c.username,e.username)||e.environment&&!this.matchEnvironment(c,e.environment)||e.realm&&!this.matchRealm(c,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(c,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(c,e.authorityType))return;const h={localAccountId:e?.localAccountId,name:e?.name},d=c.tenantProfiles?.filter(g=>this.tenantProfileMatchesFilter(g,h));d&&d.length===0||s.push(c)}),s}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===bn.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===_t.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){const t=this.getKeys(),a={};return t.forEach(s=>{if(!this.isAppMetadata(s))return;const l=this.getAppMetadata(s);l&&(e.environment&&!this.matchEnvironment(l,e.environment)||e.clientId&&!this.matchClientId(l,e.clientId)||(a[s]=l))}),a}getAuthorityMetadataByAlias(e){const t=this.getAuthorityMetadataKeys();let a=null;return t.forEach(s=>{if(!this.isAuthorityMetadata(s)||s.indexOf(this.clientId)===-1)return;const l=this.getAuthorityMetadata(s);l&&l.aliases.indexOf(e)!==-1&&(a=l)}),a}removeAllAccounts(e){this.getAllAccounts({},e).forEach(a=>{this.removeAccount(a,e)})}removeAccount(e,t){this.removeAccountContext(e,t);const a=this.getAccountKeys(),s=l=>l.includes(e.homeAccountId)&&l.includes(e.environment);a.filter(s).forEach(l=>{this.removeItem(l,t),this.performanceClient.incrementFields({accountsRemoved:1},t)})}removeAccountContext(e,t){const a=this.getTokenKeys(),s=l=>l.includes(e.homeAccountId)&&l.includes(e.environment);a.idToken.filter(s).forEach(l=>{this.removeIdToken(l,t)}),a.accessToken.filter(s).forEach(l=>{this.removeAccessToken(l,t)}),a.refreshToken.filter(s).forEach(l=>{this.removeRefreshToken(l,t)})}removeAccessToken(e,t){const a=this.getAccessTokenCredential(e,t);if(this.removeItem(e,t),this.performanceClient.incrementFields({accessTokensRemoved:1},t),!a||a.credentialType.toLowerCase()!==bn.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()||a.tokenType!==_t.POP)return;const s=a.keyId;s&&this.cryptoImpl.removeTokenBindingKey(s).catch(()=>{this.commonLogger.error(`Failed to remove token binding key ${s}`,t),this.performanceClient?.incrementFields({removeTokenBindingKeyFailure:1},t)})}removeAppMetadata(e){return this.getKeys().forEach(a=>{this.isAppMetadata(a)&&this.removeItem(a,e)}),!0}getIdToken(e,t,a,s,l){this.commonLogger.trace("CacheManager - getIdToken called");const c={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:bn.ID_TOKEN,clientId:this.clientId,realm:s},h=this.getIdTokensByFilter(c,t,a),d=h.size;if(d<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(d>1){let g=h;if(!s){const p=new Map;h.forEach((_,T)=>{_.realm===e.tenantId&&p.set(T,_)});const v=p.size;if(v<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),h.values().next().value;if(v===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),p.values().next().value;g=p}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),g.forEach((p,v)=>{this.removeIdToken(v,t)}),l&&t&&l.addFields({multiMatchedID:h.size},t),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),h.values().next().value}getIdTokensByFilter(e,t,a){const s=a&&a.idToken||this.getTokenKeys().idToken,l=new Map;return s.forEach(c=>{if(!this.idTokenKeyMatchesFilter(c,{clientId:this.clientId,...e}))return;const h=this.getIdTokenCredential(c,t);h&&this.credentialMatchesFilter(h,e)&&l.set(c,h)}),l}idTokenKeyMatchesFilter(e,t){const a=e.toLowerCase();return!(t.clientId&&a.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&a.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e,t){this.removeItem(e,t)}removeRefreshToken(e,t){this.removeItem(e,t)}getAccessToken(e,t,a,s){const l=t.correlationId;this.commonLogger.trace("CacheManager - getAccessToken called",l);const c=sn.createSearchScopes(t.scopes),h=t.authenticationScheme||_t.BEARER,d=h.toLowerCase()!==_t.BEARER.toLowerCase()?bn.ACCESS_TOKEN_WITH_AUTH_SCHEME:bn.ACCESS_TOKEN,g={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:d,clientId:this.clientId,realm:s||e.tenantId,target:c,tokenType:h,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},p=a&&a.accessToken||this.getTokenKeys().accessToken,v=[];p.forEach(T=>{if(this.accessTokenKeyMatchesFilter(T,g,!0)){const C=this.getAccessTokenCredential(T,l);C&&this.credentialMatchesFilter(C,g)&&v.push(C)}});const _=v.length;return _<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found",l),null):_>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them",l),v.forEach(T=>{this.removeAccessToken(this.generateCredentialKey(T),l)}),this.performanceClient.addFields({multiMatchedAT:v.length},l),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token",l),v[0])}accessTokenKeyMatchesFilter(e,t,a){const s=e.toLowerCase();if(t.clientId&&s.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&s.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&s.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&s.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){const l=t.target.asArray();for(let c=0;c<l.length;c++){if(a&&!s.includes(l[c].toLowerCase()))return!1;if(!a&&s.includes(l[c].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e,t){const a=this.getTokenKeys(),s=[];return a.accessToken.forEach(l=>{if(!this.accessTokenKeyMatchesFilter(l,e,!0))return;const c=this.getAccessTokenCredential(l,t);c&&this.credentialMatchesFilter(c,e)&&s.push(c)}),s}getRefreshToken(e,t,a,s,l){this.commonLogger.trace("CacheManager - getRefreshToken called");const c=t?Wu:void 0,h={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:bn.REFRESH_TOKEN,clientId:this.clientId,familyId:c},d=s&&s.refreshToken||this.getTokenKeys().refreshToken,g=[];d.forEach(v=>{if(this.refreshTokenKeyMatchesFilter(v,h)){const _=this.getRefreshTokenCredential(v,a);_&&this.credentialMatchesFilter(_,h)&&g.push(_)}});const p=g.length;return p<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(p>1&&l&&a&&l.addFields({multiMatchedRT:p},a),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),g[0])}refreshTokenKeyMatchesFilter(e,t){const a=e.toLowerCase();return!(t.familyId&&a.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&a.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&a.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){const t={environment:e,clientId:this.clientId},a=this.getAppMetadataFilteredBy(t),s=Object.keys(a).map(c=>a[c]),l=s.length;if(l<1)return null;if(l>1)throw we(g_);return s[0]}isAppMetadataFOCI(e){const t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Wu)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){const a=e.oid||e.sub;return t===a}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){const s=o2(this.staticAuthorityOptions,this.commonLogger);if(s.includes(t)&&s.includes(e.environment))return!0}const a=this.getAuthorityMetadataByAlias(t);return!!(a&&a.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==bn.ACCESS_TOKEN&&e.credentialType!==bn.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:sn.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(ng)!==-1}isAuthorityMetadata(e){return e.indexOf(Qu.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Qu.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(const a in t)e[a]=t[a];return e}}class c2 extends B0{async setAccount(){throw we(tt)}getAccount(){throw we(tt)}async setIdTokenCredential(){throw we(tt)}getIdTokenCredential(){throw we(tt)}async setAccessTokenCredential(){throw we(tt)}getAccessTokenCredential(){throw we(tt)}async setRefreshTokenCredential(){throw we(tt)}getRefreshTokenCredential(){throw we(tt)}setAppMetadata(){throw we(tt)}getAppMetadata(){throw we(tt)}setServerTelemetry(){throw we(tt)}getServerTelemetry(){throw we(tt)}setAuthorityMetadata(){throw we(tt)}getAuthorityMetadata(){throw we(tt)}getAuthorityMetadataKeys(){throw we(tt)}setThrottlingCache(){throw we(tt)}getThrottlingCache(){throw we(tt)}removeItem(){throw we(tt)}getKeys(){throw we(tt)}getAccountKeys(){throw we(tt)}getTokenKeys(){throw we(tt)}generateCredentialKey(){throw we(tt)}generateAccountKey(){throw we(tt)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const rr={AAD:"AAD",OIDC:"OIDC",EAR:"EAR"};/*! @azure/msal-common v15.12.0 2025-08-19 */const W={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",NetworkClientSendPostRequestAsync:"networkClientSendPostRequestAsync",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",InitializeCache:"initializeCache",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",GetAuthCodeUrl:"getAuthCodeUrl",GetStandardParams:"getStandardParams",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",HandleResponseEar:"handleResponseEar",HandleResponsePlatformBroker:"handleResponsePlatformBroker",HandleResponseCode:"handleResponseCode",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",ImportExistingCache:"importExistingCache",SetUserData:"setUserData",LocalStorageUpdated:"localStorageUpdated",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues",GenerateHKDF:"generateHKDF",GenerateBaseKey:"generateBaseKey",Base64Decode:"base64Decode",UrlEncodeArr:"urlEncodeArr",Encrypt:"encrypt",Decrypt:"decrypt",GenerateEarKey:"generateEarKey",DecryptEarResponse:"decryptEarResponse"},u2={InProgress:1};/*! @azure/msal-common v15.12.0 2025-08-19 */class Dy{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}}class z_{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:u2.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Dy}}startPerformanceMeasurement(){return new Dy}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}}/*! @azure/msal-common v15.12.0 2025-08-19 */const G_={tokenRenewalOffsetSeconds:i_,preventCorsPreflight:!1},h2={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Ht.Info,correlationId:ye.EMPTY_STRING},f2={claimsBasedCachingEnabled:!1},d2={async sendGetRequestAsync(){throw we(tt)},async sendPostRequestAsync(){throw we(tt)}},g2={sku:ye.SKU,version:ug,cpu:ye.EMPTY_STRING,os:ye.EMPTY_STRING},m2={clientSecret:ye.EMPTY_STRING,clientAssertion:void 0},p2={azureCloudInstance:hg.None,tenant:`${ye.DEFAULT_COMMON_TENANT}`},v2={application:{appName:"",appVersion:""}};function y2({authOptions:n,systemOptions:e,loggerOptions:t,cacheOptions:a,storageInterface:s,networkInterface:l,cryptoInterface:c,clientCredentials:h,libraryInfo:d,telemetry:g,serverTelemetryManager:p,persistencePlugin:v,serializableCache:_}){const T={...h2,...t};return{authOptions:T2(n),systemOptions:{...G_,...e},loggerOptions:T,cacheOptions:{...f2,...a},storageInterface:s||new c2(n.clientId,Zu,new Ei(T),new z_),networkInterface:l||d2,cryptoInterface:c||Zu,clientCredentials:h||m2,libraryInfo:{...g2,...d},telemetry:{...v2,...g},serverTelemetryManager:p||null,persistencePlugin:v||null,serializableCache:_||null}}function T2(n){return{clientCapabilities:[],azureCloudOptions:p2,skipAuthorityMetadataCache:!1,instanceAware:!1,encodeExtraQueryParams:!1,...n}}function $_(n){return n.authOptions.authority.options.protocolMode===rr.OIDC}/*! @azure/msal-common v15.12.0 2025-08-19 */const Qr={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};/*! @azure/msal-common v15.12.0 2025-08-19 */function rh(n,e){if(!n)throw we(s_);try{const t=e(n);return JSON.parse(t)}catch{throw we(rg)}}function lo(n){if(!n)throw we(rg);const e=n.split(ql.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?ye.EMPTY_STRING:e[1]}}/*! @azure/msal-common v15.12.0 2025-08-19 */const as="client_id",K_="redirect_uri",_2="response_type",x2="response_mode",S2="grant_type",C2="claims",E2="scope",A2="refresh_token",w2="state",b2="nonce",I2="prompt",R2="code",N2="code_challenge",k2="code_challenge_method",O2="code_verifier",M2="client-request-id",D2="x-client-SKU",P2="x-client-VER",F2="x-client-OS",L2="x-client-CPU",U2="x-client-current-telemetry",B2="x-client-last-telemetry",H2="x-ms-lib-capability",j2="x-app-name",z2="x-app-ver",G2="post_logout_redirect_uri",$2="id_token_hint",K2="client_secret",V2="client_assertion",q2="client_assertion_type",V_="token_type",q_="req_cnf",Py="return_spa_code",Y2="nativebroker",X2="logout_hint",W2="sid",Q2="login_hint",J2="domain_hint",Z2="x-client-xtra-sku",ah="brk_client_id",ih="brk_redirect_uri",H0="instance_aware",eb="ear_jwk",tb="ear_jwe_crypto";/*! @azure/msal-common v15.12.0 2025-08-19 */function Mh(n,e,t){if(!e)return;const a=n.get(as);a&&n.has(ah)&&t?.addFields({embeddedClientId:a,embeddedRedirectUri:n.get(K_)},e)}function _g(n,e){n.set(_2,e)}function nb(n,e){n.set(x2,e||Uw.QUERY)}function rb(n){n.set(Y2,"1")}function xg(n,e,t=!0,a=To){t&&!a.includes("openid")&&!e.includes("openid")&&a.push("openid");const s=t?[...e||[],...a]:e||[],l=new sn(s);n.set(E2,l.printScopes())}function Sg(n,e){n.set(as,e)}function Cg(n,e){n.set(K_,e)}function ab(n,e){n.set(G2,e)}function ib(n,e){n.set($2,e)}function sb(n,e){n.set(J2,e)}function Nu(n,e){n.set(Q2,e)}function sh(n,e){n.set(qn.CCS_HEADER,`UPN:${e}`)}function Fl(n,e){n.set(qn.CCS_HEADER,`Oid:${e.uid}@${e.utid}`)}function Fy(n,e){n.set(W2,e)}function Eg(n,e,t){const a=fb(e,t);try{JSON.parse(a)}catch{throw Pt(fg)}n.set(C2,a)}function Ag(n,e){n.set(M2,e)}function wg(n,e){n.set(D2,e.sku),n.set(P2,e.version),e.os&&n.set(F2,e.os),e.cpu&&n.set(L2,e.cpu)}function bg(n,e){e?.appName&&n.set(j2,e.appName),e?.appVersion&&n.set(z2,e.appVersion)}function ob(n,e){n.set(I2,e)}function Y_(n,e){e&&n.set(w2,e)}function lb(n,e){n.set(b2,e)}function X_(n,e,t){if(e&&t)n.set(N2,e),n.set(k2,t);else throw Pt(dg)}function cb(n,e){n.set(R2,e)}function ub(n,e){n.set(A2,e)}function hb(n,e){n.set(O2,e)}function W_(n,e){n.set(K2,e)}function Q_(n,e){e&&n.set(V2,e)}function J_(n,e){e&&n.set(q2,e)}function Z_(n,e){n.set(S2,e)}function Ig(n){n.set(Bw,"1")}function ex(n){n.has(H0)||n.set(H0,"true")}function Si(n,e){Object.entries(e).forEach(([t,a])=>{!n.has(t)&&a&&n.set(t,a)})}function fb(n,e){let t;if(!n)t={};else try{t=JSON.parse(n)}catch{throw Pt(fg)}return e&&e.length>0&&(t.hasOwnProperty(Iu.ACCESS_TOKEN)||(t[Iu.ACCESS_TOKEN]={}),t[Iu.ACCESS_TOKEN][Iu.XMS_CC]={values:e}),JSON.stringify(t)}function Rg(n,e){e&&(n.set(V_,_t.POP),n.set(q_,e))}function tx(n,e){e&&(n.set(V_,_t.SSH),n.set(q_,e))}function nx(n,e){n.set(U2,e.generateCurrentRequestHeaderValue()),n.set(B2,e.generateLastRequestHeaderValue())}function rx(n){n.set(H2,Pl.X_MS_LIB_CAPABILITY_VALUE)}function db(n,e){n.set(X2,e)}function Dh(n,e,t){n.has(ah)||n.set(ah,e),n.has(ih)||n.set(ih,t)}function gb(n,e){n.set(eb,encodeURIComponent(e)),n.set(tb,"eyJhbGciOiJkaXIiLCJlbmMiOiJBMjU2R0NNIn0")}function mb(n,e){Object.entries(e).forEach(([t,a])=>{a&&n.set(t,a)})}/*! @azure/msal-common v15.12.0 2025-08-19 */const Xr={Default:0,Adfs:1,Dsts:2,Ciam:3};/*! @azure/msal-common v15.12.0 2025-08-19 */function pb(n){return n.hasOwnProperty("authorization_endpoint")&&n.hasOwnProperty("token_endpoint")&&n.hasOwnProperty("issuer")&&n.hasOwnProperty("jwks_uri")}/*! @azure/msal-common v15.12.0 2025-08-19 */function vb(n){return n.hasOwnProperty("tenant_discovery_endpoint")&&n.hasOwnProperty("metadata")}/*! @azure/msal-common v15.12.0 2025-08-19 */function yb(n){return n.hasOwnProperty("error")&&n.hasOwnProperty("error_description")}/*! @azure/msal-common v15.12.0 2025-08-19 */const Er=(n,e,t,a,s)=>(...l)=>{t.trace(`Executing function ${e}`);const c=a?.startMeasurement(e,s);if(s){const h=e+"CallCount";a?.incrementFields({[h]:1},s)}try{const h=n(...l);return c?.end({success:!0}),t.trace(`Returning result from ${e}`),h}catch(h){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(h))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},h),h}},ve=(n,e,t,a,s)=>(...l)=>{t.trace(`Executing function ${e}`);const c=a?.startMeasurement(e,s);if(s){const h=e+"CallCount";a?.incrementFields({[h]:1},s)}return a?.setPreQueueTime(e,s),n(...l).then(h=>(t.trace(`Returning result from ${e}`),c?.end({success:!0}),h)).catch(h=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(h))}catch{t.trace("Unable to print error message.")}throw c?.end({success:!1},h),h})};/*! @azure/msal-common v15.12.0 2025-08-19 */class Ph{constructor(e,t,a,s){this.networkInterface=e,this.logger=t,this.performanceClient=a,this.correlationId=s}async detectRegion(e,t){this.performanceClient?.addQueueMeasurement(W.RegionDiscoveryDetectRegion,this.correlationId);let a=e;if(a)t.region_source=Js.ENVIRONMENT_VARIABLE;else{const s=Ph.IMDS_OPTIONS;try{const l=await ve(this.getRegionFromIMDS.bind(this),W.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(ye.IMDS_VERSION,s);if(l.status===vi.SUCCESS&&(a=l.body,t.region_source=Js.IMDS),l.status===vi.BAD_REQUEST){const c=await ve(this.getCurrentVersion.bind(this),W.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(s);if(!c)return t.region_source=Js.FAILED_AUTO_DETECTION,null;const h=await ve(this.getRegionFromIMDS.bind(this),W.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(c,s);h.status===vi.SUCCESS&&(a=h.body,t.region_source=Js.IMDS)}}catch{return t.region_source=Js.FAILED_AUTO_DETECTION,null}}return a||(t.region_source=Js.FAILED_AUTO_DETECTION),a||null}async getRegionFromIMDS(e,t){return this.performanceClient?.addQueueMeasurement(W.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${ye.IMDS_ENDPOINT}?api-version=${e}&format=text`,t,ye.IMDS_TIMEOUT)}async getCurrentVersion(e){this.performanceClient?.addQueueMeasurement(W.RegionDiscoveryGetCurrentVersion,this.correlationId);try{const t=await this.networkInterface.sendGetRequestAsync(`${ye.IMDS_ENDPOINT}?format=json`,e);return t.status===vi.BAD_REQUEST&&t.body&&t.body["newest-versions"]&&t.body["newest-versions"].length>0?t.body["newest-versions"][0]:null}catch{return null}}}Ph.IMDS_OPTIONS={headers:{Metadata:"true"}};/*! @azure/msal-common v15.12.0 2025-08-19 */function ir(){return Math.round(new Date().getTime()/1e3)}function Ly(n){return n.getTime()/1e3}function co(n){return n?new Date(Number(n)*1e3):new Date}function oh(n,e){const t=Number(n)||0;return ir()+e>t}function Tb(n,e){const t=Number(n)+e*24*60*60*1e3;return Date.now()>t}function _b(n){return Number(n)>ir()}/*! @azure/msal-common v15.12.0 2025-08-19 */function Fh(n,e,t,a,s){return{credentialType:bn.ID_TOKEN,homeAccountId:n,environment:e,clientId:a,secret:t,realm:s,lastUpdatedAt:Date.now().toString()}}function Lh(n,e,t,a,s,l,c,h,d,g,p,v,_,T,C){const x={homeAccountId:n,credentialType:bn.ACCESS_TOKEN,secret:t,cachedAt:ir().toString(),expiresOn:c.toString(),extendedExpiresOn:h.toString(),environment:e,clientId:a,realm:s,target:l,tokenType:p||_t.BEARER,lastUpdatedAt:Date.now().toString()};if(v&&(x.userAssertionHash=v),g&&(x.refreshOn=g.toString()),T&&(x.requestedClaims=T,x.requestedClaimsHash=C),x.tokenType?.toLowerCase()!==_t.BEARER.toLowerCase())switch(x.credentialType=bn.ACCESS_TOKEN_WITH_AUTH_SCHEME,x.tokenType){case _t.POP:const A=_o(t,d);if(!A?.cnf?.kid)throw we(T_);x.keyId=A.cnf.kid;break;case _t.SSH:x.keyId=_}return x}function ax(n,e,t,a,s,l,c){const h={credentialType:bn.REFRESH_TOKEN,homeAccountId:n,environment:e,clientId:a,secret:t,lastUpdatedAt:Date.now().toString()};return l&&(h.userAssertionHash=l),s&&(h.familyId=s),c&&(h.expiresOn=c.toString()),h}function Ng(n){return n.hasOwnProperty("homeAccountId")&&n.hasOwnProperty("environment")&&n.hasOwnProperty("credentialType")&&n.hasOwnProperty("clientId")&&n.hasOwnProperty("secret")}function Uy(n){return n?Ng(n)&&n.hasOwnProperty("realm")&&n.hasOwnProperty("target")&&(n.credentialType===bn.ACCESS_TOKEN||n.credentialType===bn.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function xb(n){return n?Ng(n)&&n.hasOwnProperty("realm")&&n.credentialType===bn.ID_TOKEN:!1}function By(n){return n?Ng(n)&&n.credentialType===bn.REFRESH_TOKEN:!1}function Sb(n,e){const t=n.indexOf(En.CACHE_KEY)===0;let a=!0;return e&&(a=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&a}function Cb(n,e){let t=!1;n&&(t=n.indexOf(Pl.THROTTLING_PREFIX)===0);let a=!0;return e&&(a=e.hasOwnProperty("throttleTime")),t&&a}function Eb({environment:n,clientId:e}){return[ng,n,e].join(ql.CACHE_KEY_SEPARATOR).toLowerCase()}function Ab(n,e){return e?n.indexOf(ng)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function wb(n,e){return e?n.indexOf(Qu.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Hy(){return ir()+Qu.REFRESH_TIME_SECONDS}function ku(n,e,t){n.authorization_endpoint=e.authorization_endpoint,n.token_endpoint=e.token_endpoint,n.end_session_endpoint=e.end_session_endpoint,n.issuer=e.issuer,n.endpointsFromNetwork=t,n.jwks_uri=e.jwks_uri}function y0(n,e,t){n.aliases=e.aliases,n.preferred_cache=e.preferred_cache,n.preferred_network=e.preferred_network,n.aliasesFromNetwork=t}function jy(n){return n.expiresAt<=ir()}/*! @azure/msal-common v15.12.0 2025-08-19 */class Ln{constructor(e,t,a,s,l,c,h,d){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=a,this.authorityOptions=s,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=l,this.performanceClient=h,this.correlationId=c,this.managedIdentity=d||!1,this.regionDiscovery=new Ph(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(ye.CIAM_AUTH_URL))return Xr.Ciam;const t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case ye.ADFS:return Xr.Adfs;case ye.DSTS:return Xr.Dsts}return Xr.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new dt(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw we(Pa)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw we(Pa)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw we(Pa)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw we(S_);return this.replacePath(this.metadata.end_session_endpoint)}else throw we(Pa)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw we(Pa)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw we(Pa)}canReplaceTenant(e){return e.PathSegments.length===1&&!Ln.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Xr.Default&&this.protocolMode!==rr.OIDC}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e;const s=new dt(this.metadata.canonical_authority).getUrlComponents(),l=s.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((h,d)=>{let g=l[d];if(d===0&&this.canReplaceTenant(s)){const p=new dt(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];g!==p&&(this.logger.verbose(`Replacing tenant domain name ${g} with id ${p}`),g=p)}h!==g&&(t=t.replace(`/${g}/`,`/${h}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){const e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Xr.Adfs||this.protocolMode===rr.OIDC&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}async resolveEndpointsAsync(){this.performanceClient?.addQueueMeasurement(W.AuthorityResolveEndpointsAsync,this.correlationId);const e=this.getCurrentMetadataEntity(),t=await ve(this.updateCloudDiscoveryMetadata.bind(this),W.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);const a=await ve(this.updateEndpointMetadata.bind(this),W.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:a}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:a},this.correlationId)}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Hy(),jwks_uri:""}),e}updateCachedMetadata(e,t,a){t!==vr.CACHE&&a?.source!==vr.CACHE&&(e.expiresAt=Hy(),e.canonical_authority=this.canonicalAuthority);const s=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(s,e),this.metadata=e}async updateEndpointMetadata(e){this.performanceClient?.addQueueMeasurement(W.AuthorityUpdateEndpointMetadata,this.correlationId);const t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===vr.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){const s=await ve(this.updateMetadataWithRegionalInformation.bind(this),W.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);ku(e,s,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let a=await ve(this.getEndpointMetadataFromNetwork.bind(this),W.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(a=await ve(this.updateMetadataWithRegionalInformation.bind(this),W.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(a)),ku(e,a,!0),vr.NETWORK;throw we(c_,this.defaultOpenIdConfigurationEndpoint)}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");const t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),ku(e,t,!1),{source:vr.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{const s=this.getEndpointMetadataFromHardcodedValues();if(s)return ku(e,s,!1),{source:vr.HARDCODED_VALUES,metadata:s};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}const a=jy(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!a?(this.logger.verbose("Found endpoint metadata in the cache."),{source:vr.CACHE}):(a&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new dt(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw Pt(N_)}return null}async getEndpointMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(W.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);const e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{const a=await this.networkInterface.sendGetRequestAsync(t,e);return pb(a.body)?a.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(a){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${a}`),null}}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Oy?Oy[this.hostnameAndPort]:null}async updateMetadataWithRegionalInformation(e){this.performanceClient?.addQueueMeasurement(W.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);const t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==ye.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=p0.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,Ln.replaceWithRegionalInformation(e,t);const a=await ve(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),W.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(a)return this.regionDiscoveryMetadata.region_outcome=p0.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=a,Ln.replaceWithRegionalInformation(e,a);this.regionDiscoveryMetadata.region_outcome=p0.AUTO_DETECTION_REQUESTED_FAILED}return e}async updateCloudDiscoveryMetadata(e){this.performanceClient?.addQueueMeasurement(W.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);const t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;const a=await ve(this.getCloudDiscoveryMetadataFromNetwork.bind(this),W.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(a)return y0(e,a,!0),vr.NETWORK;throw Pt(k_)}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||ye.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||ye.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||ye.NOT_APPLICABLE}`);const t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),y0(e,t,!1),vr.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{const s=l2(this.hostnameAndPort);if(s)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),y0(e,s,!1),vr.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}const a=jy(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!a?(this.logger.verbose("Found cloud discovery metadata in the cache."),vr.CACHE):(a&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Xr.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),Ln.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");const e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=th(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),Pt(gg)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),Ln.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}async getCloudDiscoveryMetadataFromNetwork(){this.performanceClient?.addQueueMeasurement(W.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);const e=`${ye.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={};let a=null;try{const s=await this.networkInterface.sendGetRequestAsync(e,t);let l,c;if(vb(s.body))l=s.body,c=l.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${l.tenant_discovery_endpoint}`);else if(yb(s.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${s.status}`),l=s.body,l.error===ye.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${l.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${l.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),c=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),a=th(c,this.hostnameAndPort)}catch(s){if(s instanceof kt)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${s.errorCode}
Error Description: ${s.errorMessage}`);else{const l=s;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${l.name}
Error Description: ${l.message}`)}return null}return a||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),a=Ln.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),a}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&dt.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let a;if(t&&t.azureCloudInstance!==hg.None){const s=t.tenant?t.tenant:ye.DEFAULT_COMMON_TENANT;a=`${t.azureCloudInstance}/${s}/`}return a||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return ye.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw we(Pa)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return j_.has(e)}static isPublicCloudAuthority(e){return ye.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,a){const s=new dt(e);s.validateAsUri();const l=s.getUrlComponents();let c=`${t}.${l.HostNameAndPort}`;this.isPublicCloudAuthority(l.HostNameAndPort)&&(c=`${t}.${ye.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);const h=dt.constructAuthorityUriFromObject({...s.getUrlComponents(),HostNameAndPort:c}).urlString;return a?`${h}?${a}`:h}static replaceWithRegionalInformation(e,t){const a={...e};return a.authorization_endpoint=Ln.buildRegionalAuthorityString(a.authorization_endpoint,t),a.token_endpoint=Ln.buildRegionalAuthorityString(a.token_endpoint,t),a.end_session_endpoint&&(a.end_session_endpoint=Ln.buildRegionalAuthorityString(a.end_session_endpoint,t)),a}static transformCIAMAuthority(e){let t=e;const s=new dt(e).getUrlComponents();if(s.PathSegments.length===0&&s.HostNameAndPort.endsWith(ye.CIAM_AUTH_URL)){const l=s.HostNameAndPort.split(".")[0];t=`${t}${l}${ye.AAD_TENANT_DOMAIN_SUFFIX}`}return t}}Ln.reservedTenantDomains=new Set(["{tenant}","{tenantid}",_i.COMMON,_i.CONSUMERS,_i.ORGANIZATIONS]);function bb(n){const a=new dt(n).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(a){case _i.COMMON:case _i.ORGANIZATIONS:case _i.CONSUMERS:return;default:return a}}function ix(n){return n.endsWith(ye.FORWARD_SLASH)?n:`${n}${ye.FORWARD_SLASH}`}function Ib(n){const e=n.cloudDiscoveryMetadata;let t;if(e)try{t=JSON.parse(e)}catch{throw Pt(gg)}return{canonicalAuthority:n.authority?ix(n.authority):void 0,knownAuthorities:n.knownAuthorities,cloudDiscoveryMetadata:t}}/*! @azure/msal-common v15.12.0 2025-08-19 */async function sx(n,e,t,a,s,l,c){c?.addQueueMeasurement(W.AuthorityFactoryCreateDiscoveredInstance,l);const h=Ln.transformCIAMAuthority(ix(n)),d=new Ln(h,e,t,a,s,l,c);try{return await ve(d.resolveEndpointsAsync.bind(d),W.AuthorityResolveEndpointsAsync,s,c,l)(),d}catch{throw we(Pa)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class hs extends kt{constructor(e,t,a,s,l){super(e,t,a),this.name="ServerError",this.errorNo=s,this.status=l,Object.setPrototypeOf(this,hs.prototype)}}/*! @azure/msal-common v15.12.0 2025-08-19 */function Uh(n,e,t){return{clientId:n,authority:e.authority,scopes:e.scopes,homeAccountIdentifier:t,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,embeddedClientId:e.embeddedClientId||e.tokenBodyParameters?.clientId}}/*! @azure/msal-common v15.12.0 2025-08-19 */class pa{static generateThrottlingStorageKey(e){return`${Pl.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t,a){const s=pa.generateThrottlingStorageKey(t),l=e.getThrottlingCache(s);if(l){if(l.throttleTime<Date.now()){e.removeItem(s,a);return}throw new hs(l.errorCodes?.join(" ")||ye.EMPTY_STRING,l.errorMessage,l.subError)}}static postProcess(e,t,a,s){if(pa.checkResponseStatus(a)||pa.checkResponseForRetryAfter(a)){const l={throttleTime:pa.calculateThrottleTime(parseInt(a.headers[qn.RETRY_AFTER])),error:a.body.error,errorCodes:a.body.error_codes,errorMessage:a.body.error_description,subError:a.body.suberror};e.setThrottlingCache(pa.generateThrottlingStorageKey(t),l,s)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(qn.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){const t=e<=0?0:e,a=Date.now()/1e3;return Math.floor(Math.min(a+(t||Pl.DEFAULT_THROTTLE_TIME_SECONDS),a+Pl.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,a,s){const l=Uh(t,a,s),c=this.generateThrottlingStorageKey(l);e.removeItem(c,a.correlationId)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Bh extends kt{constructor(e,t,a){super(e.errorCode,e.errorMessage,e.subError),Object.setPrototypeOf(this,Bh.prototype),this.name="NetworkError",this.error=e,this.httpStatus=t,this.responseHeaders=a}}function Ol(n,e,t,a){return n.errorMessage=`${n.errorMessage}, additionalErrorInfo: error.name:${a?.name}, error.message:${a?.message}`,new Bh(n,e,t)}/*! @azure/msal-common v15.12.0 2025-08-19 */class kg{constructor(e,t){this.config=y2(e),this.logger=new Ei(this.config.loggerOptions,C_,ug),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){const t={};if(t[qn.CONTENT_TYPE]=ye.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Qr.HOME_ACCOUNT_ID:try{const a=lo(e.credential);t[qn.CCS_HEADER]=`Oid:${a.uid}@${a.utid}`}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Qr.UPN:t[qn.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}async executePostToTokenEndpoint(e,t,a,s,l,c){c&&this.performanceClient?.addQueueMeasurement(c,l);const h=await this.sendPostRequest(s,e,{body:t,headers:a},l);return this.config.serverTelemetryManager&&h.status<500&&h.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),h}async sendPostRequest(e,t,a,s){pa.preProcess(this.cacheManager,e,s);let l;try{l=await ve(this.networkClient.sendPostRequestAsync.bind(this.networkClient),W.NetworkClientSendPostRequestAsync,this.logger,this.performanceClient,s)(t,a);const c=l.headers||{};this.performanceClient?.addFields({refreshTokenSize:l.body.refresh_token?.length||0,httpVerToken:c[qn.X_MS_HTTP_VERSION]||"",requestId:c[qn.X_MS_REQUEST_ID]||""},s)}catch(c){if(c instanceof Bh){const h=c.responseHeaders;throw h&&this.performanceClient?.addFields({httpVerToken:h[qn.X_MS_HTTP_VERSION]||"",requestId:h[qn.X_MS_REQUEST_ID]||"",contentTypeHeader:h[qn.CONTENT_TYPE]||void 0,contentLengthHeader:h[qn.CONTENT_LENGTH]||void 0,httpStatus:c.httpStatus},s),c.error}throw c instanceof kt?c:we(l_)}return pa.postProcess(this.cacheManager,e,l,s),l}async updateAuthority(e,t){this.performanceClient?.addQueueMeasurement(W.UpdateTokenEndpointAuthority,t);const a=`https://${e}/${this.authority.tenant}/`,s=await sx(a,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=s}createTokenQueryParameters(e){const t=new Map;return e.embeddedClientId&&Dh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenQueryParameters&&Si(t,e.tokenQueryParameters),Ag(t,e.correlationId),Mh(t,e.correlationId,this.performanceClient),Yl(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */function ox(n){return n&&(n.tid||n.tfp||n.acr)||null}/*! @azure/msal-common v15.12.0 2025-08-19 */class ta{getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,loginHint:this.loginHint,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static createAccount(e,t,a){const s=new ta;t.authorityType===Xr.Adfs?s.authorityType=Ru.ADFS_ACCOUNT_TYPE:t.protocolMode===rr.OIDC?s.authorityType=Ru.GENERIC_ACCOUNT_TYPE:s.authorityType=Ru.MSSTS_ACCOUNT_TYPE;let l;e.clientInfo&&a&&(l=rh(e.clientInfo,a)),s.clientInfo=e.clientInfo,s.homeAccountId=e.homeAccountId,s.nativeAccountId=e.nativeAccountId;const c=e.environment||t&&t.getPreferredCache();if(!c)throw we(og);s.environment=c,s.realm=l?.utid||ox(e.idTokenClaims)||"",s.localAccountId=l?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";const h=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,d=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(s.username=h||d||"",s.loginHint=e.idTokenClaims?.login_hint,s.name=e.idTokenClaims?.name||"",s.cloudGraphHostName=e.cloudGraphHostName,s.msGraphHost=e.msGraphHost,e.tenantProfiles)s.tenantProfiles=e.tenantProfiles;else{const g=pg(e.homeAccountId,s.localAccountId,s.realm,e.idTokenClaims);s.tenantProfiles=[g]}return s}static createFromAccountInfo(e,t,a){const s=new ta;return s.authorityType=e.authorityType||Ru.GENERIC_ACCOUNT_TYPE,s.homeAccountId=e.homeAccountId,s.localAccountId=e.localAccountId,s.nativeAccountId=e.nativeAccountId,s.realm=e.tenantId,s.environment=e.environment,s.username=e.username,s.name=e.name,s.loginHint=e.loginHint,s.cloudGraphHostName=t,s.msGraphHost=a,s.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),s}static generateHomeAccountId(e,t,a,s,l){if(!(t===Xr.Adfs||t===Xr.Dsts)){if(e)try{const c=rh(e,s.base64Decode);if(c.uid&&c.utid)return`${c.uid}.${c.utid}`}catch{}a.warning("No client info in response")}return l?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,a){if(!e||!t)return!1;let s=!0;if(a){const l=e.idTokenClaims||{},c=t.idTokenClaims||{};s=l.iat===c.iat&&l.nonce===c.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.loginHint===t.loginHint&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&s}}/*! @azure/msal-common v15.12.0 2025-08-19 */const lh="no_tokens_found",lx="native_account_unavailable",Og="refresh_token_expired",Mg="ux_not_allowed",Rb="interaction_required",Nb="consent_required",kb="login_required",Hh="bad_token";/*! @azure/msal-common v15.12.0 2025-08-19 */const zy=[Rb,Nb,kb,Hh,Mg],Ob=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Mb={[lh]:"No refresh token found in the cache. Please sign-in.",[lx]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Og]:"Refresh token has expired.",[Hh]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve.",[Mg]:"`canShowUI` flag in Edge was set to false. User interaction required on web page. Please invoke an interactive API to resolve."};class Hr extends kt{constructor(e,t,a,s,l,c,h,d){super(e,t,a),Object.setPrototypeOf(this,Hr.prototype),this.timestamp=s||ye.EMPTY_STRING,this.traceId=l||ye.EMPTY_STRING,this.correlationId=c||ye.EMPTY_STRING,this.claims=h||ye.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=d}}function cx(n,e,t){const a=!!n&&zy.indexOf(n)>-1,s=!!t&&Ob.indexOf(t)>-1,l=!!e&&zy.some(c=>e.indexOf(c)>-1);return a||l||s}function ch(n){return new Hr(n,Mb[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */class xo{static setRequestState(e,t,a){const s=xo.generateLibraryState(e,a);return t?`${s}${ye.RESOURCE_DELIM}${t}`:s}static generateLibraryState(e,t){if(!e)throw we(L0);const a={id:e.createNewGuid()};t&&(a.meta=t);const s=JSON.stringify(a);return e.base64Encode(s)}static parseRequestState(e,t){if(!e)throw we(L0);if(!t)throw we(po);try{const a=t.split(ye.RESOURCE_DELIM),s=a[0],l=a.length>1?a.slice(1).join(ye.RESOURCE_DELIM):ye.EMPTY_STRING,c=e.base64Decode(s),h=JSON.parse(c);return{userRequestState:l||ye.EMPTY_STRING,libraryState:h}}catch{throw we(po)}}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Db={SW:"sw"};class vo{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}async generateCnf(e,t){this.performanceClient?.addQueueMeasurement(W.PopTokenGenerateCnf,e.correlationId);const a=await ve(this.generateKid.bind(this),W.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),s=this.cryptoUtils.base64UrlEncode(JSON.stringify(a));return{kid:a.kid,reqCnfString:s}}async generateKid(e){return this.performanceClient?.addQueueMeasurement(W.PopTokenGenerateKid,e.correlationId),{kid:await this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:Db.SW}}async signPopToken(e,t,a){return this.signPayload(e,t,a)}async signPayload(e,t,a,s){const{resourceRequestMethod:l,resourceRequestUri:c,shrClaims:h,shrNonce:d,shrOptions:g}=a,v=(c?new dt(c):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt({at:e,ts:ir(),m:l?.toUpperCase(),u:v?.HostNameAndPort,nonce:d||this.cryptoUtils.createNewGuid(),p:v?.AbsolutePath,q:v?.QueryString?[[],v.QueryString]:void 0,client_claims:h||void 0,...s},t,g,a.correlationId)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Pb{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}}/*! @azure/msal-common v15.12.0 2025-08-19 */class is{constructor(e,t,a,s,l,c,h){this.clientId=e,this.cacheStorage=t,this.cryptoObj=a,this.logger=s,this.serializableCache=l,this.persistencePlugin=c,this.performanceClient=h}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){const a=`Error(s): ${e.error_codes||ye.NOT_AVAILABLE} - Timestamp: ${e.timestamp||ye.NOT_AVAILABLE} - Description: ${e.error_description||ye.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||ye.NOT_AVAILABLE} - Trace ID: ${e.trace_id||ye.NOT_AVAILABLE}`,s=e.error_codes?.length?e.error_codes[0]:void 0,l=new hs(e.error,a,e.suberror,s,e.status);if(t&&e.status&&e.status>=vi.SERVER_ERROR_RANGE_START&&e.status<=vi.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${l}`);return}else if(t&&e.status&&e.status>=vi.CLIENT_ERROR_RANGE_START&&e.status<=vi.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${l}`);return}throw cx(e.error,e.error_description,e.suberror)?new Hr(e.error,e.error_description,e.suberror,e.timestamp||ye.EMPTY_STRING,e.trace_id||ye.EMPTY_STRING,e.correlation_id||ye.EMPTY_STRING,e.claims||ye.EMPTY_STRING,s):l}}async handleServerTokenResponse(e,t,a,s,l,c,h,d,g){this.performanceClient?.addQueueMeasurement(W.HandleServerTokenResponse,e.correlation_id);let p;if(e.id_token){if(p=_o(e.id_token||ye.EMPTY_STRING,this.cryptoObj.base64Decode),l&&l.nonce&&p.nonce!==l.nonce)throw we(f_);if(s.maxAge||s.maxAge===0){const C=p.auth_time;if(!C)throw we(ig);U_(C,s.maxAge)}}this.homeAccountIdentifier=ta.generateHomeAccountId(e.client_info||ye.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,p);let v;l&&l.state&&(v=xo.parseRequestState(this.cryptoObj,l.state)),e.key_id=e.key_id||s.sshKid||void 0;const _=this.generateCacheRecord(e,t,a,s,p,c,l);let T;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),T=new Pb(this.serializableCache,!0),await this.persistencePlugin.beforeCacheAccess(T)),h&&!d&&_.account){const C=this.cacheStorage.generateAccountKey(_.account.getAccountInfo());if(!this.cacheStorage.getAccount(C,s.correlationId))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),await is.generateAuthenticationResult(this.cryptoObj,t,_,!1,s,p,v,void 0,g)}await this.cacheStorage.saveCacheRecord(_,s.correlationId,s.storeInCache)}finally{this.persistencePlugin&&this.serializableCache&&T&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),await this.persistencePlugin.afterCacheAccess(T))}return is.generateAuthenticationResult(this.cryptoObj,t,_,!1,s,p,v,e,g)}generateCacheRecord(e,t,a,s,l,c,h){const d=t.getPreferredCache();if(!d)throw we(og);const g=ox(l);let p,v;e.id_token&&l&&(p=Fh(this.homeAccountIdentifier,d,e.id_token,this.clientId,g||""),v=Dg(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,s.correlationId,l,e.client_info,d,g,h,void 0,this.logger));let _=null;if(e.access_token){const x=e.scope?sn.fromString(e.scope):new sn(s.scopes||[]),A=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,B=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,k=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,O=a+A,j=O+B,H=k&&k>0?a+k:void 0;_=Lh(this.homeAccountIdentifier,d,e.access_token,this.clientId,g||t.tenant||"",x.printScopes(),O,j,this.cryptoObj.base64Decode,H,e.token_type,c,e.key_id,s.claims,s.requestedClaimsHash)}let T=null;if(e.refresh_token){let x;if(e.refresh_token_expires_in){const A=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;x=a+A}T=ax(this.homeAccountIdentifier,d,e.refresh_token,this.clientId,e.foci,c,x)}let C=null;return e.foci&&(C={clientId:this.clientId,environment:d,familyId:e.foci}),{account:v,idToken:p,accessToken:_,refreshToken:T,appMetadata:C}}static async generateAuthenticationResult(e,t,a,s,l,c,h,d,g){let p=ye.EMPTY_STRING,v=[],_=null,T,C,x=ye.EMPTY_STRING;if(a.accessToken){if(a.accessToken.tokenType===_t.POP&&!l.popKid){const O=new vo(e),{secret:j,keyId:H}=a.accessToken;if(!H)throw we(lg);p=await O.signPopToken(j,H,l)}else p=a.accessToken.secret;v=sn.fromString(a.accessToken.target).asArray(),_=co(a.accessToken.expiresOn),T=co(a.accessToken.extendedExpiresOn),a.accessToken.refreshOn&&(C=co(a.accessToken.refreshOn))}a.appMetadata&&(x=a.appMetadata.familyId===Wu?Wu:"");const A=c?.oid||c?.sub||"",B=c?.tid||"";d?.spa_accountid&&a.account&&(a.account.nativeAccountId=d?.spa_accountid);const k=a.account?vg(a.account.getAccountInfo(),void 0,c,a.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:A,tenantId:B,scopes:v,account:k,idToken:a?.idToken?.secret||"",idTokenClaims:c||{},accessToken:p,fromCache:s,expiresOn:_,extExpiresOn:T,refreshOn:C,correlationId:l.correlationId,requestId:g||ye.EMPTY_STRING,familyId:x,tokenType:a.accessToken?.tokenType||ye.EMPTY_STRING,state:h?h.userRequestState:ye.EMPTY_STRING,cloudGraphHostName:a.account?.cloudGraphHostName||ye.EMPTY_STRING,msGraphHost:a.account?.msGraphHost||ye.EMPTY_STRING,code:d?.spa_code,fromNativeBroker:!1}}}function Dg(n,e,t,a,s,l,c,h,d,g,p,v){v?.verbose("setCachedAccount called");const T=n.getAccountKeys().find(k=>k.startsWith(t));let C=null;T&&(C=n.getAccount(T,s));const x=C||ta.createAccount({homeAccountId:t,idTokenClaims:l,clientInfo:c,environment:h,cloudGraphHostName:g?.cloud_graph_host_name,msGraphHost:g?.msgraph_host,nativeAccountId:p},e,a),A=x.tenantProfiles||[],B=d||x.realm;if(B&&!A.find(k=>k.tenantId===B)){const k=pg(t,x.localAccountId,B,l);A.push(k)}return x.tenantProfiles=A,x}/*! @azure/msal-common v15.12.0 2025-08-19 */async function ux(n,e,t){return typeof n=="string"?n:n({clientId:e,tokenEndpoint:t})}/*! @azure/msal-common v15.12.0 2025-08-19 */class hx extends kg{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}async acquireToken(e,t){if(this.performanceClient?.addQueueMeasurement(W.AuthClientAcquireToken,e.correlationId),!e.code)throw we(m_);const a=ir(),s=await ve(this.executeTokenRequest.bind(this),W.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),l=s.headers?.[qn.X_MS_REQUEST_ID],c=new is(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return c.validateTokenResponse(s.body),ve(c.handleServerTokenResponse.bind(c),W.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(s.body,this.authority,a,e,t,void 0,void 0,void 0,l)}getLogoutUri(e){if(!e)throw Pt(R_);const t=this.createLogoutUrlQueryString(e);return dt.appendQueryString(this.authority.endSessionEndpoint,t)}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(W.AuthClientExecuteTokenRequest,t.correlationId);const a=this.createTokenQueryParameters(t),s=dt.appendQueryString(e.tokenEndpoint,a),l=await ve(this.createTokenRequestBody.bind(this),W.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t);let c;if(t.clientInfo)try{const g=rh(t.clientInfo,this.cryptoUtils.base64Decode);c={credential:`${g.uid}${ql.CLIENT_INFO_SEPARATOR}${g.utid}`,type:Qr.HOME_ACCOUNT_ID}}catch(g){this.logger.verbose("Could not parse client info for CCS Header: "+g)}const h=this.createTokenRequestHeaders(c||t.ccsCredential),d=Uh(this.config.authOptions.clientId,t);return ve(this.executePostToTokenEndpoint.bind(this),W.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(s,l,h,d,t.correlationId,W.AuthorizationCodeClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(W.AuthClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(Sg(t,e.embeddedClientId||e.tokenBodyParameters?.[as]||this.config.authOptions.clientId),this.includeRedirectUri)Cg(t,e.redirectUri);else if(!e.redirectUri)throw Pt(E_);if(xg(t,e.scopes,!0,this.oidcDefaultScopes),cb(t,e.code),wg(t,this.config.libraryInfo),bg(t,this.config.telemetry.application),rx(t),this.serverTelemetryManager&&!$_(this.config)&&nx(t,this.serverTelemetryManager),e.codeVerifier&&hb(t,e.codeVerifier),this.config.clientCredentials.clientSecret&&W_(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const s=this.config.clientCredentials.clientAssertion;Q_(t,await ux(s.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),J_(t,s.assertionType)}if(Z_(t,a_.AUTHORIZATION_CODE_GRANT),Ig(t),e.authenticationScheme===_t.POP){const s=new vo(this.cryptoUtils,this.performanceClient);let l;e.popKid?l=this.cryptoUtils.encodeKid(e.popKid):l=(await ve(s.generateCnf.bind(s),W.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Rg(t,l)}else if(e.authenticationScheme===_t.SSH)if(e.sshJwk)tx(t,e.sshJwk);else throw Pt(Oh);(!Cr.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Eg(t,e.claims,this.config.authOptions.clientCapabilities);let a;if(e.clientInfo)try{const s=rh(e.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${s.uid}${ql.CLIENT_INFO_SEPARATOR}${s.utid}`,type:Qr.HOME_ACCOUNT_ID}}catch(s){this.logger.verbose("Could not parse client info for CCS Header: "+s)}else a=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&a)switch(a.type){case Qr.HOME_ACCOUNT_ID:try{const s=lo(a.credential);Fl(t,s)}catch(s){this.logger.verbose("Could not parse home account ID for CCS Header: "+s)}break;case Qr.UPN:sh(t,a.credential);break}return e.embeddedClientId&&Dh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Si(t,e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Py])&&Si(t,{[Py]:"1"}),Mh(t,e.correlationId,this.performanceClient),Yl(t)}createLogoutUrlQueryString(e){const t=new Map;return e.postLogoutRedirectUri&&ab(t,e.postLogoutRedirectUri),e.correlationId&&Ag(t,e.correlationId),e.idTokenHint&&ib(t,e.idTokenHint),e.state&&Y_(t,e.state),e.logoutHint&&db(t,e.logoutHint),e.extraQueryParameters&&Si(t,e.extraQueryParameters),this.config.authOptions.instanceAware&&ex(t),Yl(t,this.config.authOptions.encodeExtraQueryParams,e.extraQueryParameters)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Fb=300;class Lb extends kg{constructor(e,t){super(e,t)}async acquireToken(e){this.performanceClient?.addQueueMeasurement(W.RefreshTokenClientAcquireToken,e.correlationId);const t=ir(),a=await ve(this.executeTokenRequest.bind(this),W.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),s=a.headers?.[qn.X_MS_REQUEST_ID],l=new is(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return l.validateTokenResponse(a.body),ve(l.handleServerTokenResponse.bind(l),W.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(a.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,s)}async acquireTokenByRefreshToken(e){if(!e)throw Pt(I_);if(this.performanceClient?.addQueueMeasurement(W.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw we(sg);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return await ve(this.acquireTokenWithCachedRefreshToken.bind(this),W.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(a){const s=a instanceof Hr&&a.errorCode===lh,l=a instanceof hs&&a.errorCode===wy.INVALID_GRANT_ERROR&&a.subError===wy.CLIENT_MISMATCH_ERROR;if(s||l)return ve(this.acquireTokenWithCachedRefreshToken.bind(this),W.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw a}return ve(this.acquireTokenWithCachedRefreshToken.bind(this),W.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)}async acquireTokenWithCachedRefreshToken(e,t){this.performanceClient?.addQueueMeasurement(W.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);const a=Er(this.cacheManager.getRefreshToken.bind(this.cacheManager),W.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,e.correlationId,void 0,this.performanceClient);if(!a)throw ch(lh);if(a.expiresOn&&oh(a.expiresOn,e.refreshTokenExpirationOffsetSeconds||Fb))throw this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),ch(Og);const s={...e,refreshToken:a.secret,authenticationScheme:e.authenticationScheme||_t.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Qr.HOME_ACCOUNT_ID}};try{return await ve(this.acquireToken.bind(this),W.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(s)}catch(l){if(l instanceof Hr&&(this.performanceClient?.addFields({rtExpiresOnMs:Number(a.expiresOn)},e.correlationId),l.subError===Hh)){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");const c=this.cacheManager.generateCredentialKey(a);this.cacheManager.removeRefreshToken(c,e.correlationId)}throw l}}async executeTokenRequest(e,t){this.performanceClient?.addQueueMeasurement(W.RefreshTokenClientExecuteTokenRequest,e.correlationId);const a=this.createTokenQueryParameters(e),s=dt.appendQueryString(t.tokenEndpoint,a),l=await ve(this.createTokenRequestBody.bind(this),W.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),c=this.createTokenRequestHeaders(e.ccsCredential),h=Uh(this.config.authOptions.clientId,e);return ve(this.executePostToTokenEndpoint.bind(this),W.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(s,l,c,h,e.correlationId,W.RefreshTokenClientExecutePostToTokenEndpoint)}async createTokenRequestBody(e){this.performanceClient?.addQueueMeasurement(W.RefreshTokenClientCreateTokenRequestBody,e.correlationId);const t=new Map;if(Sg(t,e.embeddedClientId||e.tokenBodyParameters?.[as]||this.config.authOptions.clientId),e.redirectUri&&Cg(t,e.redirectUri),xg(t,e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),Z_(t,a_.REFRESH_TOKEN_GRANT),Ig(t),wg(t,this.config.libraryInfo),bg(t,this.config.telemetry.application),rx(t),this.serverTelemetryManager&&!$_(this.config)&&nx(t,this.serverTelemetryManager),ub(t,e.refreshToken),this.config.clientCredentials.clientSecret&&W_(t,this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){const a=this.config.clientCredentials.clientAssertion;Q_(t,await ux(a.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),J_(t,a.assertionType)}if(e.authenticationScheme===_t.POP){const a=new vo(this.cryptoUtils,this.performanceClient);let s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(await ve(a.generateCnf.bind(a),W.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,Rg(t,s)}else if(e.authenticationScheme===_t.SSH)if(e.sshJwk)tx(t,e.sshJwk);else throw Pt(Oh);if((!Cr.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&Eg(t,e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Qr.HOME_ACCOUNT_ID:try{const a=lo(e.ccsCredential.credential);Fl(t,a)}catch(a){this.logger.verbose("Could not parse home account ID for CCS Header: "+a)}break;case Qr.UPN:sh(t,e.ccsCredential.credential);break}return e.embeddedClientId&&Dh(t,this.config.authOptions.clientId,this.config.authOptions.redirectUri),e.tokenBodyParameters&&Si(t,e.tokenBodyParameters),Mh(t,e.correlationId,this.performanceClient),Yl(t)}}/*! @azure/msal-common v15.12.0 2025-08-19 */class Ub extends kg{constructor(e,t){super(e,t)}async acquireCachedToken(e){this.performanceClient?.addQueueMeasurement(W.SilentFlowClientAcquireCachedToken,e.correlationId);let t=Zi.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!Cr.isEmptyObj(e.claims))throw this.setCacheOutcome(Zi.FORCE_REFRESH_OR_CLAIMS,e.correlationId),we(xi);if(!e.account)throw we(sg);const a=e.account.tenantId||bb(e.authority),s=this.cacheManager.getTokenKeys(),l=this.cacheManager.getAccessToken(e.account,e,s,a);if(l){if(_b(l.cachedAt)||oh(l.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(Zi.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),we(xi);l.refreshOn&&oh(l.refreshOn,0)&&(t=Zi.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(Zi.NO_CACHED_ACCESS_TOKEN,e.correlationId),we(xi);const c=e.authority||this.authority.getPreferredCache(),h={account:this.cacheManager.getAccount(this.cacheManager.generateAccountKey(e.account),e.correlationId),accessToken:l,idToken:this.cacheManager.getIdToken(e.account,e.correlationId,s,a,this.performanceClient),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(c)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[await ve(this.generateResultFromCacheRecord.bind(this),W.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(h,e),t]}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==Zi.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}async generateResultFromCacheRecord(e,t){this.performanceClient?.addQueueMeasurement(W.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let a;if(e.idToken&&(a=_o(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){const s=a?.auth_time;if(!s)throw we(ig);U_(s,t.maxAge)}return is.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,a)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const Bb={sendGetRequestAsync:()=>Promise.reject(we(tt)),sendPostRequestAsync:()=>Promise.reject(we(tt))};/*! @azure/msal-common v15.12.0 2025-08-19 */function Hb(n,e,t,a){const s=e.correlationId,l=new Map;Sg(l,e.embeddedClientId||e.extraQueryParameters?.[as]||n.clientId);const c=[...e.scopes||[],...e.extraScopesToConsent||[]];if(xg(l,c,!0,n.authority.options.OIDCOptions?.defaultScopes),Cg(l,e.redirectUri),Ag(l,s),nb(l,e.responseMode),Ig(l),e.prompt&&(ob(l,e.prompt),a?.addFields({prompt:e.prompt},s)),e.domainHint&&(sb(l,e.domainHint),a?.addFields({domainHintFromRequest:!0},s)),e.prompt!==Wn.SELECT_ACCOUNT)if(e.sid&&e.prompt===Wn.NONE)t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),Fy(l,e.sid),a?.addFields({sidFromRequest:!0},s);else if(e.account){const h=Gb(e.account);let d=$b(e.account);if(d&&e.domainHint&&(t.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),d=null),d){t.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),Nu(l,d),a?.addFields({loginHintFromClaim:!0},s);try{const g=lo(e.account.homeAccountId);Fl(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(h&&e.prompt===Wn.NONE){t.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),Fy(l,h),a?.addFields({sidFromClaim:!0},s);try{const g=lo(e.account.homeAccountId);Fl(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)t.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),Nu(l,e.loginHint),sh(l,e.loginHint),a?.addFields({loginHintFromRequest:!0},s);else if(e.account.username){t.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),Nu(l,e.account.username),a?.addFields({loginHintFromUpn:!0},s);try{const g=lo(e.account.homeAccountId);Fl(l,g)}catch{t.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(t.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),Nu(l,e.loginHint),sh(l,e.loginHint),a?.addFields({loginHintFromRequest:!0},s));else t.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");return e.nonce&&lb(l,e.nonce),e.state&&Y_(l,e.state),(e.claims||n.clientCapabilities&&n.clientCapabilities.length>0)&&Eg(l,e.claims,n.clientCapabilities),e.embeddedClientId&&Dh(l,n.clientId,n.redirectUri),n.instanceAware&&(!e.extraQueryParameters||!Object.keys(e.extraQueryParameters).includes(H0))&&ex(l),l}function Pg(n,e,t,a){const s=Yl(e,t,a);return dt.appendQueryString(n.authorizationEndpoint,s)}function jb(n,e){if(fx(n,e),!n.code)throw we(__);return n}function fx(n,e){if(!n.state||!e)throw n.state?we(D0,"Cached State"):we(D0,"Server State");let t,a;try{t=decodeURIComponent(n.state)}catch{throw we(po,n.state)}try{a=decodeURIComponent(e)}catch{throw we(po,n.state)}if(t!==a)throw we(h_);if(n.error||n.error_description||n.suberror){const s=zb(n);throw cx(n.error,n.error_description,n.suberror)?new Hr(n.error||"",n.error_description,n.suberror,n.timestamp||"",n.trace_id||"",n.correlation_id||"",n.claims||"",s):new hs(n.error||"",n.error_description,n.suberror,s)}}function zb(n){const e="code=",t=n.error_uri?.lastIndexOf(e);return t&&t>=0?n.error_uri?.substring(t+e.length):void 0}function Gb(n){return n.idTokenClaims?.sid||null}function $b(n){return n.loginHint||n.idTokenClaims?.login_hint||null}/*! @azure/msal-common v15.12.0 2025-08-19 */const Gy=",",dx="|";function Kb(n){const{skus:e,libraryName:t,libraryVersion:a,extensionName:s,extensionVersion:l}=n,c=new Map([[0,[t,a]],[2,[s,l]]]);let h=[];if(e?.length){if(h=e.split(Gy),h.length<4)return e}else h=Array.from({length:4},()=>dx);return c.forEach((d,g)=>{d.length===2&&d[0]?.length&&d[1]?.length&&Vb({skuArr:h,index:g,skuName:d[0],skuVersion:d[1]})}),h.join(Gy)}function Vb(n){const{skuArr:e,index:t,skuName:a,skuVersion:s}=n;t>=e.length||(e[t]=[a,s].join(dx))}class Xl{constructor(e,t){this.cacheOutcome=Zi.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||ye.EMPTY_STRING,this.wrapperVer=e.wrapperVer||ye.EMPTY_STRING,this.telemetryCacheKey=En.CACHE_KEY+ql.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){const e=`${this.apiId}${En.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],a=this.getNativeBrokerErrorCode();a?.length&&t.push(`broker_error=${a}`);const s=t.join(En.VALUE_SEPARATOR),l=this.getRegionDiscoveryFields(),c=[e,l].join(En.VALUE_SEPARATOR);return[En.SCHEMA_VERSION,c,s].join(En.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){const e=this.getLastRequests(),t=Xl.maxErrorsToSend(e),a=e.failedRequests.slice(0,2*t).join(En.VALUE_SEPARATOR),s=e.errors.slice(0,t).join(En.VALUE_SEPARATOR),l=e.errors.length,c=t<l?En.OVERFLOW_TRUE:En.OVERFLOW_FALSE,h=[l,c].join(En.VALUE_SEPARATOR);return[En.SCHEMA_VERSION,e.cacheHits,a,s,h].join(En.CATEGORY_SEPARATOR)}cacheFailedRequest(e){const t=this.getLastRequests();t.errors.length>=En.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof kt?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(En.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}incrementCacheHits(){const e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId),e.cacheHits}getLastRequests(){const e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){const e=this.getLastRequests(),t=Xl.maxErrorsToSend(e),a=e.errors.length;if(t===a)this.cacheManager.removeItem(this.telemetryCacheKey,this.correlationId);else{const s={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,s,this.correlationId)}}static maxErrorsToSend(e){let t,a=0,s=0;const l=e.errors.length;for(t=0;t<l;t++){const c=e.failedRequests[2*t]||ye.EMPTY_STRING,h=e.failedRequests[2*t+1]||ye.EMPTY_STRING,d=e.errors[t]||ye.EMPTY_STRING;if(s+=c.toString().length+h.toString().length+d.length+3,s<En.MAX_LAST_HEADER_BYTES)a+=1;else break}return a}getRegionDiscoveryFields(){const e=[];return e.push(this.regionUsed||ye.EMPTY_STRING),e.push(this.regionSource||ye.EMPTY_STRING),e.push(this.regionOutcome||ye.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){const t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t,this.correlationId)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){const e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e,this.correlationId)}static makeExtraSkuString(e){return Kb(e)}}/*! @azure/msal-common v15.12.0 2025-08-19 */const gx="missing_kid_error",mx="missing_alg_error";/*! @azure/msal-common v15.12.0 2025-08-19 */const qb={[gx]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[mx]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."};class Fg extends kt{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,Fg.prototype)}}function $y(n){return new Fg(n,qb[n])}/*! @azure/msal-common v15.12.0 2025-08-19 */class Lg{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw $y(gx);if(!e.alg)throw $y(mx);const t=new Lg({typ:e.typ||Hw.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const Ug="pkce_not_created",Bg="ear_jwk_empty",px="ear_jwe_empty",j0="crypto_nonexistent",jh="empty_navigate_uri",vx="hash_empty_error",Hg="no_state_in_hash",yx="hash_does_not_contain_known_properties",Tx="unable_to_parse_state",_x="state_interaction_type_mismatch",xx="interaction_in_progress",Sx="popup_window_error",Cx="empty_window_error",Wl="user_cancelled",Yb="monitor_popup_timeout",Ex="monitor_window_timeout",Ax="redirect_in_iframe",wx="block_iframe_reload",bx="block_nested_popups",Xb="iframe_closed_prematurely",zh="silent_logout_unsupported",Ix="no_account_error",Wb="silent_prompt_value_error",Rx="no_token_request_cache_error",Nx="unable_to_parse_token_request_cache_error",Qb="auth_request_not_set_error",Jb="invalid_cache_type",Gh="non_browser_environment",no="database_not_open",uh="no_network_connectivity",kx="post_request_failed",Ox="get_request_failed",z0="failed_to_parse_response",Mx="unable_to_load_token",jg="crypto_key_not_found",Dx="auth_code_required",Px="auth_code_or_nativeAccountId_required",Fx="spa_code_and_nativeAccountId_present",zg="database_unavailable",Lx="unable_to_acquire_token_from_native_platform",Ux="native_handshake_timeout",Bx="native_extension_not_installed",Gg="native_connection_not_established",Ll="uninitialized_public_client_application",Hx="native_prompt_not_supported",jx="invalid_base64_string",zx="invalid_pop_token_request",Gx="failed_to_build_headers",$x="failed_to_parse_headers",qu="failed_to_decrypt_ear_response",hh="timed_out";/*! @azure/msal-browser v4.22.1 2025-09-09 */const Da="For more visit: aka.ms/msaljs/browser-errors",Zb={[Ug]:"The PKCE code challenge and verifier could not be generated.",[Bg]:"No EAR encryption key provided. This is unexpected.",[px]:"Server response does not contain ear_jwe property. This is unexpected.",[j0]:"The crypto object or function is not available.",[jh]:"Navigation URI is empty. Please check stack trace for more info.",[vx]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${Da}`,[Hg]:"Hash does not contain state. Please verify that the request originated from msal.",[yx]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${Da}`,[Tx]:"Unable to parse state. Please verify that the request originated from msal.",[_x]:"Hash contains state but the interaction type does not match the caller.",[xx]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${Da}`,[Sx]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Cx]:"window.open returned null or undefined window object.",[Wl]:"User cancelled the flow.",[Yb]:`Token acquisition in popup failed due to timeout.  ${Da}`,[Ex]:`Token acquisition in iframe failed due to timeout.  ${Da}`,[Ax]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[wx]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${Da}`,[bx]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[Xb]:"The iframe being monitored was closed prematurely.",[zh]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[Ix]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Wb]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Rx]:"No token request found in cache.",[Nx]:"The cached token request could not be parsed.",[Qb]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[Jb]:"Invalid cache type",[Gh]:"Login and token requests are not supported in non-browser environments.",[no]:"Database is not open!",[uh]:"No network connectivity. Check your internet connection.",[kx]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Ox]:"Network request failed. Please check the network trace to determine root cause.",[z0]:"Failed to parse network response. Check network trace.",[Mx]:"Error loading token to cache.",[jg]:"Cryptographic Key or Keypair not found in browser storage.",[Dx]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Px]:"An authorization code or nativeAccountId must be provided to this flow.",[Fx]:"Request cannot contain both spa code and native account id.",[zg]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Lx]:`Unable to acquire token from native platform.  ${Da}`,[Ux]:"Timed out while attempting to establish connection to browser extension",[Bx]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[Gg]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${Da}`,[Ll]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${Da}`,[Hx]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[jx]:"Invalid base64 encoded string.",[zx]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Gx]:"Failed to build request headers object.",[$x]:"Failed to parse response headers",[qu]:"Failed to decrypt ear response",[hh]:"The request timed out."};class sc extends kt{constructor(e,t){super(e,Zb[e],t),Object.setPrototypeOf(this,sc.prototype),this.name="BrowserAuthError"}}function Ue(n,e){return new sc(n,e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const nr={INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Br={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS",MICROSOFT_ENTRA_BROKERID:"MicrosoftEntra",DOM_API_NAME:"DOM API",PLATFORM_DOM_APIS:"get-token-and-sign-out",PLATFORM_DOM_PROVIDER:"PlatformAuthDOMHandler",PLATFORM_EXTENSION_PROVIDER:"PlatformAuthExtensionHandler"},Il={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},on={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Ky={GET:"GET",POST:"POST"},pi={SIGNIN:"signin",SIGNOUT:"signout"},Zt={ORIGIN_URI:"request.origin",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",VERIFIER:"code.verifier",INTERACTION_STATUS_KEY:"interaction.status",NATIVE_REQUEST:"request.native"},Ou={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},Nt={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962};var qe;(function(n){n.Redirect="redirect",n.Popup="popup",n.Silent="silent",n.None="none"})(qe||(qe={}));const Vy={scopes:To},Kx="jwk",G0="msal.db",eI=1,tI=`${G0}.keys`,Vn={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},nI=[Vn.Default,Vn.Skip,Vn.RefreshTokenAndNetwork];/*! @azure/msal-browser v4.22.1 2025-09-09 */function Mu(n){return encodeURIComponent(Ql(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Ai(n){return Vx(n).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function Ql(n){return Vx(new TextEncoder().encode(n))}function Vx(n){const e=Array.from(n,t=>String.fromCodePoint(t)).join("");return btoa(e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Zr(n){return new TextDecoder().decode(Ci(n))}function Ci(n){let e=n.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw Ue(jx)}const t=atob(e);return Uint8Array.from(t,a=>a.codePointAt(0)||0)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const rI="RSASSA-PKCS1-v1_5",So="AES-GCM",qx="HKDF",$g="SHA-256",aI=2048,iI=new Uint8Array([1,0,1]),qy="0123456789abcdef",Yy=new Uint32Array(1),Kg="raw",Yx="encrypt",Vg="decrypt",sI="deriveKey",oI="crypto_subtle_undefined",qg={name:rI,hash:$g,modulusLength:aI,publicExponent:iI};function lI(n){if(!window)throw Ue(Gh);if(!window.crypto)throw Ue(j0);if(!n&&!window.crypto.subtle)throw Ue(j0,oI)}async function Xx(n,e,t){e?.addQueueMeasurement(W.Sha256Digest,t);const s=new TextEncoder().encode(n);return window.crypto.subtle.digest($g,s)}function cI(n){return window.crypto.getRandomValues(n)}function T0(){return window.crypto.getRandomValues(Yy),Yy[0]}function na(){const n=Date.now(),e=T0()*1024+(T0()&1023),t=new Uint8Array(16),a=Math.trunc(e/2**30),s=e&2**30-1,l=T0();t[0]=n/2**40,t[1]=n/2**32,t[2]=n/2**24,t[3]=n/2**16,t[4]=n/2**8,t[5]=n,t[6]=112|a>>>8,t[7]=a,t[8]=128|s>>>24,t[9]=s>>>16,t[10]=s>>>8,t[11]=s,t[12]=l>>>24,t[13]=l>>>16,t[14]=l>>>8,t[15]=l;let c="";for(let h=0;h<t.length;h++)c+=qy.charAt(t[h]>>>4),c+=qy.charAt(t[h]&15),(h===3||h===5||h===7||h===9)&&(c+="-");return c}async function uI(n,e){return window.crypto.subtle.generateKey(qg,n,e)}async function _0(n){return window.crypto.subtle.exportKey(Kx,n)}async function hI(n,e,t){return window.crypto.subtle.importKey(Kx,n,qg,e,t)}async function fI(n,e){return window.crypto.subtle.sign(qg,n,e)}async function Yg(){const n=await Wx(),t={alg:"dir",kty:"oct",k:Ai(new Uint8Array(n))};return Ql(JSON.stringify(t))}async function dI(n){const e=Zr(n),a=JSON.parse(e).k,s=Ci(a);return window.crypto.subtle.importKey(Kg,s,So,!1,[Vg])}async function gI(n,e){const t=e.split(".");if(t.length!==5)throw Ue(qu,"jwe_length");const a=await dI(n).catch(()=>{throw Ue(qu,"import_key")});try{const s=new TextEncoder().encode(t[0]),l=Ci(t[2]),c=Ci(t[3]),h=Ci(t[4]),d=h.byteLength*8,g=new Uint8Array(c.length+h.length);g.set(c),g.set(h,c.length);const p=await window.crypto.subtle.decrypt({name:So,iv:l,tagLength:d,additionalData:s},a,g);return new TextDecoder().decode(p)}catch{throw Ue(qu,"decrypt")}}async function Wx(){const n=await window.crypto.subtle.generateKey({name:So,length:256},!0,[Yx,Vg]);return window.crypto.subtle.exportKey(Kg,n)}async function Xy(n){return window.crypto.subtle.importKey(Kg,n,qx,!1,[sI])}async function Qx(n,e,t){return window.crypto.subtle.deriveKey({name:qx,salt:e,hash:$g,info:new TextEncoder().encode(t)},n,{name:So,length:256},!1,[Yx,Vg])}async function mI(n,e,t){const a=new TextEncoder().encode(e),s=window.crypto.getRandomValues(new Uint8Array(16)),l=await Qx(n,s,t),c=await window.crypto.subtle.encrypt({name:So,iv:new Uint8Array(12)},l,a);return{data:Ai(new Uint8Array(c)),nonce:Ai(s)}}async function Wy(n,e,t,a){const s=Ci(a),l=await Qx(n,Ci(e),t),c=await window.crypto.subtle.decrypt({name:So,iv:new Uint8Array(12)},l,s);return new TextDecoder().decode(c)}async function Jx(n){const e=await Xx(n),t=new Uint8Array(e);return Ai(t)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const $h="storage_not_supported",Zx="stubbed_public_client_application_called",Xg="in_mem_redirect_unavailable";/*! @azure/msal-browser v4.22.1 2025-09-09 */const Yu={[$h]:"Given storage configuration option was not supported.",[Zx]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Xg]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."};Yu[$h],Yu[Zx],Yu[Xg];class Wg extends kt{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,Wg.prototype)}}function Qg(n){return new Wg(n,Yu[n])}/*! @azure/msal-browser v4.22.1 2025-09-09 */function eS(n){n.location.hash="",typeof n.history.replaceState=="function"&&n.history.replaceState(null,"",`${n.location.origin}${n.location.pathname}${n.location.search}`)}function pI(n){const e=n.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Jg(){return window.parent!==window}function vI(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${nr.POPUP_NAME_PREFIX}.`)===0}function Fa(){return typeof window<"u"&&window.location?window.location.href.split("?")[0].split("#")[0]:""}function yI(){const e=new dt(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function TI(){if(dt.hashContainsKnownProperties(window.location.hash)&&Jg())throw Ue(wx)}function _I(n){if(Jg()&&!n)throw Ue(Ax)}function xI(){if(vI())throw Ue(bx)}function tS(){if(typeof window>"u")throw Ue(Gh)}function nS(n){if(!n)throw Ue(Ll)}function Zg(n){tS(),TI(),xI(),nS(n)}function Qy(n,e){if(Zg(n),_I(e.system.allowRedirectInIframe),e.cache.cacheLocation===on.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw Qg(Xg)}function rS(n){const e=document.createElement("link");e.rel="preconnect",e.href=new URL(n).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function SI(){return na()}/*! @azure/msal-browser v4.22.1 2025-09-09 */class fh{navigateInternal(e,t){return fh.defaultNavigateWindow(e,t)}navigateExternal(e,t){return fh.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise((a,s)=>{setTimeout(()=>{s(Ue(hh,"failed_to_redirect"))},t.timeout)})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class CI{async sendGetRequestAsync(e,t){let a,s={},l=0;const c=Jy(t);try{a=await fetch(e,{method:Ky.GET,headers:c})}catch(h){throw Ol(Ue(window.navigator.onLine?Ox:uh),void 0,void 0,h)}s=Zy(a.headers);try{return l=a.status,{headers:s,body:await a.json(),status:l}}catch(h){throw Ol(Ue(z0),l,s,h)}}async sendPostRequestAsync(e,t){const a=t&&t.body||"",s=Jy(t);let l,c=0,h={};try{l=await fetch(e,{method:Ky.POST,headers:s,body:a})}catch(d){throw Ol(Ue(window.navigator.onLine?kx:uh),void 0,void 0,d)}h=Zy(l.headers);try{return c=l.status,{headers:h,body:await l.json(),status:c}}catch(d){throw Ol(Ue(z0),c,h,d)}}}function Jy(n){try{const e=new Headers;if(!(n&&n.headers))return e;const t=n.headers;return Object.entries(t).forEach(([a,s])=>{e.append(a,s)}),e}catch(e){throw Ol(Ue(Gx),void 0,void 0,e)}}function Zy(n){try{const e={};return n.forEach((t,a)=>{e[a]=t}),e}catch{throw Ue($x)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const EI=6e4,$0=1e4,AI=3e4,aS=2e3;function wI({auth:n,cache:e,system:t,telemetry:a},s){const l={clientId:ye.EMPTY_STRING,authority:`${ye.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:ye.EMPTY_STRING,authorityMetadata:ye.EMPTY_STRING,redirectUri:typeof window<"u"?Fa():"",postLogoutRedirectUri:ye.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:rr.AAD,OIDCOptions:{serverResponseType:kh.FRAGMENT,defaultScopes:[ye.OPENID_SCOPE,ye.PROFILE_SCOPE,ye.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:hg.None,tenant:ye.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1,instanceAware:!1,encodeExtraQueryParams:!1},c={cacheLocation:on.SessionStorage,cacheRetentionDays:5,temporaryCacheLocation:on.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===on.LocalStorage),claimsBasedCachingEnabled:!1},h={loggerCallback:()=>{},logLevel:Ht.Info,piiLoggingEnabled:!1},g={...{...G_,loggerOptions:h,networkClient:s?new CI:Bb,navigationClient:new fh,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||EI,iframeHashTimeout:t?.loadFrameTimeout||$0,navigateFrameWait:0,redirectNavigationTimeout:AI,asyncPopups:!1,allowRedirectInIframe:!1,allowPlatformBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||aS,pollIntervalMilliseconds:nr.DEFAULT_POLL_INTERVAL_MS},...t,loggerOptions:t?.loggerOptions||h},p={application:{appName:ye.EMPTY_STRING,appVersion:ye.EMPTY_STRING},client:new z_};if(n?.protocolMode!==rr.OIDC&&n?.OIDCOptions&&new Ei(g.loggerOptions).warning(JSON.stringify(Pt(M_))),n?.protocolMode&&n.protocolMode===rr.OIDC&&g?.allowPlatformBroker)throw Pt(D_);return{auth:{...l,...n,OIDCOptions:{...l.OIDCOptions,...n?.OIDCOptions}},cache:{...c,...e},system:g,telemetry:{...p,...a}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const bI="@azure/msal-browser",ss="4.22.1";/*! @azure/msal-browser v4.22.1 2025-09-09 */const gn="msal",em="browser",x0="-",mi=1,K0=1,II=`${gn}.${em}.log.level`,RI=`${gn}.${em}.log.pii`,NI=`${gn}.${em}.platform.auth.dom`,eT=`${gn}.version`,tT="account.keys",nT="token.keys";function ma(n=K0){return n<1?`${gn}.${tT}`:`${gn}.${n}.${tT}`}function ns(n,e=mi){return e<1?`${gn}.${nT}.${n}`:`${gn}.${e}.${nT}.${n}`}/*! @azure/msal-browser v4.22.1 2025-09-09 */class tm{static loggerCallback(e,t){switch(e){case Ht.Error:console.error(t);return;case Ht.Info:console.info(t);return;case Ht.Verbose:console.debug(t);return;case Ht.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=wI(e,this.browserEnvironment);let t;try{t=window[on.SessionStorage]}catch{}const a=t?.getItem(II),s=t?.getItem(RI)?.toLowerCase(),l=s==="true"?!0:s==="false"?!1:void 0,c={...this.config.system.loggerOptions},h=a&&Object.keys(Ht).includes(a)?Ht[a]:void 0;h&&(c.loggerCallback=tm.loggerCallback,c.logLevel=h),l!==void 0&&(c.piiLoggingEnabled=l),this.logger=new Ei(c,bI,ss),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class os extends tm{getModuleName(){return os.MODULE_NAME}getId(){return os.ID}async initialize(){return this.available=typeof window<"u",this.available}}os.MODULE_NAME="";os.ID="StandardOperatingContext";/*! @azure/msal-browser v4.22.1 2025-09-09 */class kI{constructor(){this.dbName=G0,this.version=eI,this.tableName=tI,this.dbOpen=!1}async open(){return new Promise((e,t)=>{const a=window.indexedDB.open(this.dbName,this.version);a.addEventListener("upgradeneeded",s=>{s.target.result.createObjectStore(this.tableName)}),a.addEventListener("success",s=>{const l=s;this.db=l.target.result,this.dbOpen=!0,e()}),a.addEventListener("error",()=>t(Ue(zg)))})}closeConnection(){const e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}async validateDbIsOpen(){if(!this.dbOpen)return this.open()}async getItem(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(no));const c=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);c.addEventListener("success",h=>{const d=h;this.closeConnection(),t(d.target.result)}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async setItem(e,t){return await this.validateDbIsOpen(),new Promise((a,s)=>{if(!this.db)return s(Ue(no));const h=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);h.addEventListener("success",()=>{this.closeConnection(),a()}),h.addEventListener("error",d=>{this.closeConnection(),s(d)})})}async removeItem(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(no));const c=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);c.addEventListener("success",()=>{this.closeConnection(),t()}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async getKeys(){return await this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(Ue(no));const l=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();l.addEventListener("success",c=>{const h=c;this.closeConnection(),e(h.target.result)}),l.addEventListener("error",c=>{this.closeConnection(),t(c)})})}async containsKey(e){return await this.validateDbIsOpen(),new Promise((t,a)=>{if(!this.db)return a(Ue(no));const c=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);c.addEventListener("success",h=>{const d=h;this.closeConnection(),t(d.target.result===1)}),c.addEventListener("error",h=>{this.closeConnection(),a(h)})})}async deleteDatabase(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{const a=window.indexedDB.deleteDatabase(G0),s=setTimeout(()=>t(!1),200);a.addEventListener("success",()=>(clearTimeout(s),e(!0))),a.addEventListener("blocked",()=>(clearTimeout(s),e(!0))),a.addEventListener("error",()=>(clearTimeout(s),t(!1)))})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Kh{constructor(){this.cache=new Map}async initialize(){}getItem(e){return this.cache.get(e)||null}getUserData(e){return this.getItem(e)}setItem(e,t){this.cache.set(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){const e=[];return this.cache.forEach((t,a)=>{e.push(a)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}decryptData(){return Promise.resolve(null)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class OI{constructor(e){this.inMemoryCache=new Kh,this.indexedDBCache=new kI,this.logger=e}handleDatabaseAccessError(e){if(e instanceof sc&&e.errorCode===zg)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}async getItem(e){const t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.getItem(e)}catch(a){this.handleDatabaseAccessError(a)}return t}async setItem(e,t){this.inMemoryCache.setItem(e,t);try{await this.indexedDBCache.setItem(e,t)}catch(a){this.handleDatabaseAccessError(a)}}async removeItem(e){this.inMemoryCache.removeItem(e);try{await this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}}async getKeys(){const e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),await this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e}async containsKey(e){const t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),await this.indexedDBCache.containsKey(e)}catch(a){this.handleDatabaseAccessError(a)}return t}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}async clearPersistent(){try{this.logger.verbose("Deleting persistent keystore");const e=await this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Ha{constructor(e,t,a){this.logger=e,lI(a??!1),this.cache=new OI(this.logger),this.performanceClient=t}createNewGuid(){return na()}base64Encode(e){return Ql(e)}base64Decode(e){return Zr(e)}base64UrlEncode(e){return Mu(e)}encodeKid(e){return this.base64UrlEncode(JSON.stringify({kid:e}))}async getPublicKeyThumbprint(e){const t=this.performanceClient?.startMeasurement(W.CryptoOptsGetPublicKeyThumbprint,e.correlationId),a=await uI(Ha.EXTRACTABLE,Ha.POP_KEY_USAGES),s=await _0(a.publicKey),l={e:s.e,kty:s.kty,n:s.n},c=rT(l),h=await this.hashString(c),d=await _0(a.privateKey),g=await hI(d,!1,["sign"]);return await this.cache.setItem(h,{privateKey:g,publicKey:a.publicKey,requestMethod:e.resourceRequestMethod,requestUri:e.resourceRequestUri}),t&&t.end({success:!0}),h}async removeTokenBindingKey(e){if(await this.cache.removeItem(e),await this.cache.containsKey(e))throw we(x_)}async clearKeystore(){this.cache.clearInMemory();try{return await this.cache.clearPersistent(),!0}catch(e){return e instanceof Error?this.logger.error(`Clearing keystore failed with error: ${e.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}}async signJwt(e,t,a,s){const l=this.performanceClient?.startMeasurement(W.CryptoOptsSignJwt,s),c=await this.cache.getItem(t);if(!c)throw Ue(jg);const h=await _0(c.publicKey),d=rT(h),g=Mu(JSON.stringify({kid:t})),p=Lg.getShrHeaderString({...a?.header,alg:h.alg,kid:g}),v=Mu(p);e.cnf={jwk:JSON.parse(d)};const _=Mu(JSON.stringify(e)),T=`${v}.${_}`,x=new TextEncoder().encode(T),A=await fI(c.privateKey,x),B=Ai(new Uint8Array(A)),k=`${T}.${B}`;return l&&l.end({success:!0}),k}async hashString(e){return Jx(e)}}Ha.POP_KEY_USAGES=["sign","verify"];Ha.EXTRACTABLE=!0;function rT(n){return JSON.stringify(n,Object.keys(n).sort())}/*! @azure/msal-browser v4.22.1 2025-09-09 */const MI=1440*60*1e3,V0={Lax:"Lax",None:"None"};class iS{initialize(){return Promise.resolve()}getItem(e){const t=`${encodeURIComponent(e)}`,a=document.cookie.split(";");for(let s=0;s<a.length;s++){const l=a[s],[c,...h]=decodeURIComponent(l).trim().split("="),d=h.join("=");if(c===t)return d}return""}getUserData(){throw we(tt)}setItem(e,t,a,s=!0,l=V0.Lax){let c=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=${l};`;if(a){const h=DI(a);c+=`expires=${h};`}(s||l===V0.None)&&(c+="Secure;"),document.cookie=c}async setUserData(){return Promise.reject(we(tt))}removeItem(e){this.setItem(e,"",-1)}getKeys(){const e=document.cookie.split(";"),t=[];return e.forEach(a=>{const s=decodeURIComponent(a).trim().split("=");t.push(s[0])}),t}containsKey(e){return this.getKeys().includes(e)}decryptData(){return Promise.resolve(null)}}function DI(n){const e=new Date;return new Date(e.getTime()+n*MI).toUTCString()}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Ul(n,e){const t=n.getItem(ma(e));return t?JSON.parse(t):[]}function Bl(n,e,t){const a=e.getItem(ns(n,t));if(a){const s=JSON.parse(a);if(s&&s.hasOwnProperty("idToken")&&s.hasOwnProperty("accessToken")&&s.hasOwnProperty("refreshToken"))return s}return{idToken:[],accessToken:[],refreshToken:[]}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function q0(n){return n.hasOwnProperty("id")&&n.hasOwnProperty("nonce")&&n.hasOwnProperty("data")}/*! @azure/msal-browser v4.22.1 2025-09-09 */const aT="msal.cache.encryption",PI="msal.broadcast.cache";class FI{constructor(e,t,a){if(!window.localStorage)throw Qg($h);this.memoryStorage=new Kh,this.initialized=!1,this.clientId=e,this.logger=t,this.performanceClient=a,this.broadcast=new BroadcastChannel(PI)}async initialize(e){const t=new iS,a=t.getItem(aT);let s={key:"",id:""};if(a)try{s=JSON.parse(a)}catch{}if(s.key&&s.id){const l=Er(Ci,W.Base64Decode,this.logger,this.performanceClient,e)(s.key);this.encryptionCookie={id:s.id,key:await ve(Xy,W.GenerateHKDF,this.logger,this.performanceClient,e)(l)}}else{const l=na(),c=await ve(Wx,W.GenerateBaseKey,this.logger,this.performanceClient,e)(),h=Er(Ai,W.UrlEncodeArr,this.logger,this.performanceClient,e)(new Uint8Array(c));this.encryptionCookie={id:l,key:await ve(Xy,W.GenerateHKDF,this.logger,this.performanceClient,e)(c)};const d={id:l,key:h};t.setItem(aT,JSON.stringify(d),0,!0,V0.None)}await ve(this.importExistingCache.bind(this),W.ImportExistingCache,this.logger,this.performanceClient,e)(e),this.broadcast.addEventListener("message",this.updateCache.bind(this)),this.initialized=!0}getItem(e){return window.localStorage.getItem(e)}getUserData(e){if(!this.initialized)throw Ue(Ll);return this.memoryStorage.getItem(e)}async decryptData(e,t,a){if(!this.initialized||!this.encryptionCookie)throw Ue(Ll);if(t.id!==this.encryptionCookie.id)return this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},a),null;const s=await ve(Wy,W.Decrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,t.nonce,this.getContext(e),t.data);if(!s)return null;try{return JSON.parse(s)}catch{return this.performanceClient.incrementFields({encryptedCacheCorruptionCount:1},a),null}}setItem(e,t){window.localStorage.setItem(e,t)}async setUserData(e,t,a,s){if(!this.initialized||!this.encryptionCookie)throw Ue(Ll);const{data:l,nonce:c}=await ve(mI,W.Encrypt,this.logger,this.performanceClient,a)(this.encryptionCookie.key,t,this.getContext(e)),h={id:this.encryptionCookie.id,nonce:c,data:l,lastUpdatedAt:s};this.memoryStorage.setItem(e,t),this.setItem(e,JSON.stringify(h)),this.broadcast.postMessage({key:e,value:t,context:this.getContext(e)})}removeItem(e){this.memoryStorage.containsKey(e)&&(this.memoryStorage.removeItem(e),this.broadcast.postMessage({key:e,value:null,context:this.getContext(e)})),window.localStorage.removeItem(e)}getKeys(){return Object.keys(window.localStorage)}containsKey(e){return window.localStorage.hasOwnProperty(e)}clear(){this.memoryStorage.clear(),Ul(this).forEach(a=>this.removeItem(a));const t=Bl(this.clientId,this);t.idToken.forEach(a=>this.removeItem(a)),t.accessToken.forEach(a=>this.removeItem(a)),t.refreshToken.forEach(a=>this.removeItem(a)),this.getKeys().forEach(a=>{(a.startsWith(gn)||a.indexOf(this.clientId)!==-1)&&this.removeItem(a)})}async importExistingCache(e){if(!this.encryptionCookie)return;let t=Ul(this);t=await this.importArray(t,e),t.length?this.setItem(ma(),JSON.stringify(t)):this.removeItem(ma());const a=Bl(this.clientId,this);a.idToken=await this.importArray(a.idToken,e),a.accessToken=await this.importArray(a.accessToken,e),a.refreshToken=await this.importArray(a.refreshToken,e),a.idToken.length||a.accessToken.length||a.refreshToken.length?this.setItem(ns(this.clientId),JSON.stringify(a)):this.removeItem(ns(this.clientId))}async getItemFromEncryptedCache(e,t){if(!this.encryptionCookie)return null;const a=this.getItem(e);if(!a)return null;let s;try{s=JSON.parse(a)}catch{return null}return q0(s)?s.id!==this.encryptionCookie.id?(this.performanceClient.incrementFields({encryptedCacheExpiredCount:1},t),null):ve(Wy,W.Decrypt,this.logger,this.performanceClient,t)(this.encryptionCookie.key,s.nonce,this.getContext(e),s.data):(this.performanceClient.incrementFields({unencryptedCacheCount:1},t),s)}async importArray(e,t){const a=[],s=[];return e.forEach(l=>{const c=this.getItemFromEncryptedCache(l,t).then(h=>{h?(this.memoryStorage.setItem(l,h),a.push(l)):this.removeItem(l)});s.push(c)}),await Promise.all(s),a}getContext(e){let t="";return e.includes(this.clientId)&&(t=this.clientId),t}updateCache(e){this.logger.trace("Updating internal cache from broadcast event");const t=this.performanceClient.startMeasurement(W.LocalStorageUpdated);t.add({isBackground:!0});const{key:a,value:s,context:l}=e.data;if(!a){this.logger.error("Broadcast event missing key"),t.end({success:!1,errorCode:"noKey"});return}if(l&&l!==this.clientId){this.logger.trace(`Ignoring broadcast event from clientId: ${l}`),t.end({success:!1,errorCode:"contextMismatch"});return}s?(this.memoryStorage.setItem(a,s),this.logger.verbose("Updated item in internal cache")):(this.memoryStorage.removeItem(a),this.logger.verbose("Removed item from internal cache")),t.end({success:!0})}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class LI{constructor(){if(!window.sessionStorage)throw Qg($h)}async initialize(){}getItem(e){return window.sessionStorage.getItem(e)}getUserData(e){return this.getItem(e)}setItem(e,t){window.sessionStorage.setItem(e,t)}async setUserData(e,t){this.setItem(e,t)}removeItem(e){window.sessionStorage.removeItem(e)}getKeys(){return Object.keys(window.sessionStorage)}containsKey(e){return window.sessionStorage.hasOwnProperty(e)}decryptData(){return Promise.resolve(null)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const $e={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache",BROKER_CONNECTION_ESTABLISHED:"msal:brokerConnectionEstablished"};/*! @azure/msal-browser v4.22.1 2025-09-09 */function iT(n,e){const t=n.indexOf(e);t>-1&&n.splice(t,1)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Y0 extends B0{constructor(e,t,a,s,l,c,h){super(e,a,s,l,h),this.cacheConfig=t,this.logger=s,this.internalStorage=new Kh,this.browserStorage=sT(e,t.cacheLocation,s,l),this.temporaryCacheStorage=sT(e,t.temporaryCacheLocation,s,l),this.cookieStorage=new iS,this.eventHandler=c}async initialize(e){this.performanceClient.addFields({cacheLocation:this.cacheConfig.cacheLocation,cacheRetentionDays:this.cacheConfig.cacheRetentionDays},e),await this.browserStorage.initialize(e),await this.migrateExistingCache(e),this.trackVersionChanges(e)}async migrateExistingCache(e){const t=Ul(this.browserStorage,0),a=Bl(this.clientId,this.browserStorage,0);this.performanceClient.addFields({oldAccountCount:t.length,oldAccessCount:a.accessToken.length,oldIdCount:a.idToken.length,oldRefreshCount:a.refreshToken.length},e);const s=Ul(this.browserStorage,1),l=Bl(this.clientId,this.browserStorage,1);this.performanceClient.addFields({currAccountCount:s.length,currAccessCount:l.accessToken.length,currIdCount:l.idToken.length,currRefreshCount:l.refreshToken.length},e),await Promise.all([this.updateV0ToCurrent(K0,t,s,e),this.updateV0ToCurrent(mi,a.idToken,l.idToken,e),this.updateV0ToCurrent(mi,a.accessToken,l.accessToken,e),this.updateV0ToCurrent(mi,a.refreshToken,l.refreshToken,e)]),t.length>0?this.browserStorage.setItem(ma(0),JSON.stringify(t)):this.browserStorage.removeItem(ma(0)),s.length>0?this.browserStorage.setItem(ma(1),JSON.stringify(s)):this.browserStorage.removeItem(ma(1)),this.setTokenKeys(a,e,0),this.setTokenKeys(l,e,1)}async updateV0ToCurrent(e,t,a,s){const l=[];for(const c of[...t]){const h=this.browserStorage.getItem(c),d=this.validateAndParseJson(h||"");if(!d){iT(t,c);continue}d.lastUpdatedAt||(d.lastUpdatedAt=Date.now().toString(),this.setItem(c,JSON.stringify(d),s));const g=q0(d)?await this.browserStorage.decryptData(c,d,s):d;let p;if(g&&(Uy(g)||By(g))&&(p=g.expiresOn),!g||Tb(d.lastUpdatedAt,this.cacheConfig.cacheRetentionDays)||p&&oh(p,i_)){this.browserStorage.removeItem(c),iT(t,c),this.performanceClient.incrementFields({expiredCacheRemovedCount:1},s);continue}if(this.cacheConfig.cacheLocation!==on.LocalStorage||q0(d)){const v=`${gn}.${e}${x0}${c}`,_=this.browserStorage.getItem(v);if(_){const T=this.validateAndParseJson(_);if(Number(d.lastUpdatedAt)>Number(T.lastUpdatedAt)){l.push(this.setUserData(v,JSON.stringify(g),s,d.lastUpdatedAt).then(()=>{this.performanceClient.incrementFields({updatedCacheFromV0Count:1},s)}));continue}}else{l.push(this.setUserData(v,JSON.stringify(g),s,d.lastUpdatedAt).then(()=>{a.push(v),this.performanceClient.incrementFields({upgradedCacheCount:1},s)}));continue}}}return Promise.all(l)}trackVersionChanges(e){const t=this.browserStorage.getItem(eT);t&&(this.logger.info(`MSAL.js was last initialized by version: ${t}`),this.performanceClient.addFields({previousLibraryVersion:t},e)),t!==ss&&this.setItem(eT,ss,e)}validateAndParseJson(e){if(!e)return null;try{const t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}setItem(e,t,a){let s=0,l=[];const c=20;for(let h=0;h<=c;h++)try{this.browserStorage.setItem(e,t),h>0&&(h<=s?this.removeAccessTokenKeys(l.slice(0,h),a,0):(this.removeAccessTokenKeys(l.slice(0,s),a,0),this.removeAccessTokenKeys(l.slice(s,h),a)));break}catch(d){const g=U0(d);if(g.errorCode===nh&&h<c){if(!l.length){const p=e===ns(this.clientId,0)?JSON.parse(t).accessToken:this.getTokenKeys(0).accessToken,v=e===ns(this.clientId)?JSON.parse(t).accessToken:this.getTokenKeys().accessToken;l=[...p,...v],s=p.length}if(l.length<=h)throw g;this.removeAccessToken(l[h],a,!1)}else throw g}}async setUserData(e,t,a,s){let l=0,c=[];const h=20;for(let d=0;d<=h;d++)try{await ve(this.browserStorage.setUserData.bind(this.browserStorage),W.SetUserData,this.logger,this.performanceClient)(e,t,a,s),d>0&&(d<=l?this.removeAccessTokenKeys(c.slice(0,d),a,0):(this.removeAccessTokenKeys(c.slice(0,l),a,0),this.removeAccessTokenKeys(c.slice(l,d),a)));break}catch(g){const p=U0(g);if(p.errorCode===nh&&d<h){if(!c.length){const v=this.getTokenKeys(0).accessToken,_=this.getTokenKeys().accessToken;c=[...v,..._],l=v.length}if(c.length<=d)throw p;this.removeAccessToken(c[d],a,!1)}else throw p}}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");const a=this.browserStorage.getUserData(e);if(!a)return this.removeAccountKeyFromMap(e,t),null;const s=this.validateAndParseJson(a);return!s||!ta.isAccountEntity(s)?null:B0.toObject(new ta,s)}async setAccount(e,t){this.logger.trace("BrowserCacheManager.setAccount called");const a=this.generateAccountKey(e.getAccountInfo()),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.addAccountKeyToMap(a,t);this.cacheConfig.cacheLocation===on.LocalStorage&&l&&this.eventHandler.emitEvent($e.ACCOUNT_ADDED,void 0,e.getAccountInfo())}getAccountKeys(){return Ul(this.browserStorage)}addAccountKeyToMap(e,t){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);const a=this.getAccountKeys();return a.indexOf(e)===-1?(a.push(e),this.setItem(ma(),JSON.stringify(a),t),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added"),!0):(this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map"),!1)}removeAccountKeyFromMap(e,t){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);const a=this.getAccountKeys(),s=a.indexOf(e);if(s>-1){if(a.splice(s,1),a.length===0){this.removeItem(ma());return}else this.setItem(ma(),JSON.stringify(a),t);this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")}else this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e,t){const a=this.getActiveAccount(t);a?.homeAccountId===e.homeAccountId&&a?.environment===e.environment&&this.setActiveAccount(null,t),super.removeAccount(e,t),this.removeAccountKeyFromMap(this.generateAccountKey(e),t),this.browserStorage.getKeys().forEach(s=>{s.includes(e.homeAccountId)&&s.includes(e.environment)&&this.browserStorage.removeItem(s)}),this.cacheConfig.cacheLocation===on.LocalStorage&&this.eventHandler.emitEvent($e.ACCOUNT_REMOVED,void 0,e)}removeIdToken(e,t){super.removeIdToken(e,t);const a=this.getTokenKeys(),s=a.idToken.indexOf(e);s>-1&&(this.logger.info("idToken removed from tokenKeys map"),a.idToken.splice(s,1),this.setTokenKeys(a,t))}removeAccessToken(e,t,a=!0){super.removeAccessToken(e,t),a&&this.removeAccessTokenKeys([e],t)}removeAccessTokenKeys(e,t,a=mi){this.logger.trace("removeAccessTokenKey called");const s=this.getTokenKeys(a);let l=0;if(e.forEach(c=>{const h=s.accessToken.indexOf(c);h>-1&&(s.accessToken.splice(h,1),l++)}),l>0){this.logger.info(`removed ${l} accessToken keys from tokenKeys map`),this.setTokenKeys(s,t,a);return}}removeRefreshToken(e,t){super.removeRefreshToken(e,t);const a=this.getTokenKeys(),s=a.refreshToken.indexOf(e);s>-1&&(this.logger.info("refreshToken removed from tokenKeys map"),a.refreshToken.splice(s,1),this.setTokenKeys(a,t))}getTokenKeys(e=mi){return Bl(this.clientId,this.browserStorage,e)}setTokenKeys(e,t,a=mi){if(e.idToken.length===0&&e.accessToken.length===0&&e.refreshToken.length===0){this.removeItem(ns(this.clientId,a));return}else this.setItem(ns(this.clientId,a),JSON.stringify(e),t)}getIdTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeIdToken(e,t),null;const s=this.validateAndParseJson(a);return!s||!xb(s)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),s)}async setIdTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys();l.idToken.indexOf(a)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),l.idToken.push(a),this.setTokenKeys(l,t))}getAccessTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeAccessTokenKeys([e],t),null;const s=this.validateAndParseJson(a);return!s||!Uy(s)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),s)}async setAccessTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys(),c=l.accessToken.indexOf(a);c!==-1&&l.accessToken.splice(c,1),this.logger.trace(`access token ${c===-1?"added to":"updated in"} map`),l.accessToken.push(a),this.setTokenKeys(l,t)}getRefreshTokenCredential(e,t){const a=this.browserStorage.getUserData(e);if(!a)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeRefreshToken(e,t),null;const s=this.validateAndParseJson(a);return!s||!By(s)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),s)}async setRefreshTokenCredential(e,t){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");const a=this.generateCredentialKey(e),s=Date.now().toString();e.lastUpdatedAt=s,await this.setUserData(a,JSON.stringify(e),t,s);const l=this.getTokenKeys();l.refreshToken.indexOf(a)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),l.refreshToken.push(a),this.setTokenKeys(l,t))}getAppMetadata(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!Ab(e,a)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),a)}setAppMetadata(e,t){this.logger.trace("BrowserCacheManager.setAppMetadata called");const a=Eb(e);this.setItem(a,JSON.stringify(e),t)}getServerTelemetry(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!Sb(e,a)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),a)}setServerTelemetry(e,t,a){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t),a)}getAuthorityMetadata(e){const t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;const a=this.validateAndParseJson(t);return a&&wb(e,a)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),a):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ou.WRAPPER_SKU,e),this.internalStorage.setItem(Ou.WRAPPER_VER,t)}getWrapperMetadata(){const e=this.internalStorage.getItem(Ou.WRAPPER_SKU)||ye.EMPTY_STRING,t=this.internalStorage.getItem(Ou.WRAPPER_VER)||ye.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(e){const t=this.generateCacheKey(Ay.ACTIVE_ACCOUNT_FILTERS),a=this.browserStorage.getItem(t);if(!a)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters found"),null;const s=this.validateAndParseJson(a);return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:s.homeAccountId,localAccountId:s.localAccountId,tenantId:s.tenantId},e)):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e,t){const a=this.generateCacheKey(Ay.ACTIVE_ACCOUNT_FILTERS);if(e){this.logger.verbose("setActiveAccount: Active account set");const s={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId,lastUpdatedAt:ir().toString()};this.setItem(a,JSON.stringify(s),t)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(a);this.eventHandler.emitEvent($e.ACTIVE_ACCOUNT_CHANGED)}getThrottlingCache(e){const t=this.browserStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;const a=this.validateAndParseJson(t);return!a||!Cb(e,a)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),a)}setThrottlingCache(e,t,a){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t),a)}getTemporaryCache(e,t){const a=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){const l=this.cookieStorage.getItem(a);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),l}const s=this.temporaryCacheStorage.getItem(a);if(!s){if(this.cacheConfig.cacheLocation===on.LocalStorage){const l=this.browserStorage.getItem(a);if(l)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),l}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),s}setTemporaryCache(e,t,a){const s=a?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(s,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.cookieStorage.setItem(s,t,void 0,this.cacheConfig.secureCookies))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.cookieStorage.removeItem(e))}getKeys(){return this.browserStorage.getKeys()}clear(e){this.removeAllAccounts(e),this.removeAppMetadata(e),this.temporaryCacheStorage.getKeys().forEach(t=>{(t.indexOf(gn)!==-1||t.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(t)}),this.browserStorage.getKeys().forEach(t=>{(t.indexOf(gn)!==-1||t.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(t)}),this.internalStorage.clear()}clearTokensAndKeysWithClaims(e){this.performanceClient.addQueueMeasurement(W.ClearTokensAndKeysWithClaims,e);const t=this.getTokenKeys();let a=0;t.accessToken.forEach(s=>{const l=this.getAccessTokenCredential(s,e);l?.requestedClaimsHash&&s.includes(l.requestedClaimsHash.toLowerCase())&&(this.removeAccessToken(s,e),a++)}),a>0&&this.logger.warning(`${a} access tokens with claims in the cache keys have been removed from the cache.`)}generateCacheKey(e){return Cr.startsWith(e,gn)?e:`${gn}.${this.clientId}.${e}`}generateCredentialKey(e){const t=e.credentialType===bn.REFRESH_TOKEN&&e.familyId||e.clientId,a=e.tokenType&&e.tokenType.toLowerCase()!==_t.BEARER.toLowerCase()?e.tokenType.toLowerCase():"";return[`${gn}.${mi}`,e.homeAccountId,e.environment,e.credentialType,t,e.realm||"",e.target||"",e.requestedClaimsHash||"",a].join(x0).toLowerCase()}generateAccountKey(e){const t=e.homeAccountId.split(".")[1];return[`${gn}.${K0}`,e.homeAccountId,e.environment,t||e.tenantId||""].join(x0).toLowerCase()}resetRequestCache(){this.logger.trace("BrowserCacheManager.resetRequestCache called"),this.removeTemporaryItem(this.generateCacheKey(Zt.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(Zt.VERIFIER)),this.removeTemporaryItem(this.generateCacheKey(Zt.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(Zt.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(Zt.NATIVE_REQUEST)),this.setInteractionInProgress(!1)}cacheAuthorizeRequest(e,t){this.logger.trace("BrowserCacheManager.cacheAuthorizeRequest called");const a=Ql(JSON.stringify(e));if(this.setTemporaryCache(Zt.REQUEST_PARAMS,a,!0),t){const s=Ql(t);this.setTemporaryCache(Zt.VERIFIER,s,!0)}}getCachedRequest(){this.logger.trace("BrowserCacheManager.getCachedRequest called");const e=this.getTemporaryCache(Zt.REQUEST_PARAMS,!0);if(!e)throw Ue(Rx);const t=this.getTemporaryCache(Zt.VERIFIER,!0);let a,s="";try{a=JSON.parse(Zr(e)),t&&(s=Zr(t))}catch(l){throw this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached token request threw with error: ${l}`),Ue(Nx)}return[a,s]}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");const e=this.getTemporaryCache(Zt.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;const t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){const t=this.getInteractionInProgress()?.clientId;return e?t===this.clientId:!!t}getInteractionInProgress(){const e=`${gn}.${Zt.INTERACTION_STATUS_KEY}`,t=this.getTemporaryCache(e,!1);try{return t?JSON.parse(t):null}catch{return this.logger.error("Cannot parse interaction status. Removing temporary cache items and clearing url hash. Retrying interaction should fix the error"),this.removeTemporaryItem(e),this.resetRequestCache(),eS(window),null}}setInteractionInProgress(e,t=pi.SIGNIN){const a=`${gn}.${Zt.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw Ue(xx);this.setTemporaryCache(a,JSON.stringify({clientId:this.clientId,type:t}),!1)}else!e&&this.getInteractionInProgress()?.clientId===this.clientId&&this.removeTemporaryItem(a)}async hydrateCache(e,t){const a=Fh(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId);let s;t.claims&&(s=await this.cryptoImpl.hashString(t.claims));const l=Lh(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?Ly(e.expiresOn):0,e.extExpiresOn?Ly(e.extExpiresOn):0,Zr,void 0,e.tokenType,void 0,t.sshKid,t.claims,s),c={idToken:a,accessToken:l};return this.saveCacheRecord(c,e.correlationId)}async saveCacheRecord(e,t,a){try{await super.saveCacheRecord(e,t,a)}catch(s){if(s instanceof oo&&this.performanceClient&&t)try{const l=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:l.refreshToken.length,cacheIdCount:l.idToken.length,cacheAtCount:l.accessToken.length},t)}catch{}throw s}}}function sT(n,e,t,a){try{switch(e){case on.LocalStorage:return new FI(n,t,a);case on.SessionStorage:return new LI;case on.MemoryStorage:default:break}}catch(s){t.error(s)}return new Kh}const UI=(n,e,t,a)=>{const s={cacheLocation:on.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:on.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new Y0(n,s,Zu,e,t,a)};/*! @azure/msal-browser v4.22.1 2025-09-09 */function BI(n,e,t,a,s){return n.verbose("getAllAccounts called"),t?e.getAllAccounts(s||{},a):[]}function HI(n,e,t,a){const s=t.getAccountInfoFilteredBy(n,a);return s?(e.verbose("getAccount: Account matching provided filter found, returning"),s):(e.verbose("getAccount: No matching account found, returning null"),null)}function jI(n,e,t,a){if(e.trace("getAccountByUsername called"),!n)return e.warning("getAccountByUsername: No username provided"),null;const s=t.getAccountInfoFilteredBy({username:n},a);return s?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${n}`),s):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function zI(n,e,t,a){if(e.trace("getAccountByHomeId called"),!n)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;const s=t.getAccountInfoFilteredBy({homeAccountId:n},a);return s?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${n}`),s):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function GI(n,e,t,a){if(e.trace("getAccountByLocalId called"),!n)return e.warning("getAccountByLocalId: No localAccountId provided"),null;const s=t.getAccountInfoFilteredBy({localAccountId:n},a);return s?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${n}`),s):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function $I(n,e,t){e.setActiveAccount(n,t)}function KI(n,e){return n.getActiveAccount(e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const VI="msal.broadcast.event";class qI{constructor(e){this.eventCallbacks=new Map,this.logger=e||new Ei({}),typeof BroadcastChannel<"u"&&(this.broadcastChannel=new BroadcastChannel(VI)),this.invokeCrossTabCallbacks=this.invokeCrossTabCallbacks.bind(this)}addEventCallback(e,t,a){if(typeof window<"u"){const s=a||SI();return this.eventCallbacks.has(s)?(this.logger.error(`Event callback with id: ${s} is already registered. Please provide a unique id or remove the existing callback and try again.`),null):(this.eventCallbacks.set(s,[e,t||[]]),this.logger.verbose(`Event callback registered with id: ${s}`),s)}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}emitEvent(e,t,a,s){const l={eventType:e,interactionType:t||null,payload:a||null,error:s||null,timestamp:Date.now()};switch(e){case $e.ACCOUNT_ADDED:case $e.ACCOUNT_REMOVED:case $e.ACTIVE_ACCOUNT_CHANGED:this.broadcastChannel?.postMessage(l);break;default:this.invokeCallbacks(l);break}}invokeCallbacks(e){this.eventCallbacks.forEach(([t,a],s)=>{(a.length===0||a.includes(e.eventType))&&(this.logger.verbose(`Emitting event to callback ${s}: ${e.eventType}`),t.apply(null,[e]))})}invokeCrossTabCallbacks(e){const t=e.data;this.invokeCallbacks(t)}subscribeCrossTab(){this.broadcastChannel?.addEventListener("message",this.invokeCrossTabCallbacks)}unsubscribeCrossTab(){this.broadcastChannel?.removeEventListener("message",this.invokeCrossTabCallbacks)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class sS{constructor(e,t,a,s,l,c,h,d,g){this.config=e,this.browserStorage=t,this.browserCrypto=a,this.networkClient=this.config.system.networkClient,this.eventHandler=l,this.navigationClient=c,this.platformAuthProvider=d,this.correlationId=g||na(),this.logger=s.clone(nr.MSAL_SKU,ss,this.correlationId),this.performanceClient=h}async clearCacheOnLogout(e,t){if(t)try{this.browserStorage.removeAccount(t,e),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),this.browserStorage.clear(e),await this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}}getRedirectUri(e){this.logger.verbose("getRedirectUri called");const t=e||this.config.auth.redirectUri;return dt.getAbsoluteUrl(t,Fa())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");const a={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Xl(a,this.browserStorage)}async getDiscoveredAuthority(e){const{account:t}=e,a=e.requestExtraQueryParameters&&e.requestExtraQueryParameters.hasOwnProperty("instance_aware")?e.requestExtraQueryParameters.instance_aware:void 0;this.performanceClient.addQueueMeasurement(W.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);const s={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},l=e.requestAuthority||this.config.auth.authority,c=a?.length?a==="true":this.config.auth.instanceAware,h=t&&c?this.config.auth.authority.replace(dt.getDomainFromUrl(l),t.environment):l,d=Ln.generateAuthority(h,e.requestAzureCloudOptions||this.config.auth.azureCloudOptions),g=await ve(sx,W.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(d,this.config.system.networkClient,this.browserStorage,s,this.logger,this.correlationId,this.performanceClient);if(t&&!g.isAlias(t.environment))throw Pt(P_);return g}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function nm(n,e,t,a){t.addQueueMeasurement(W.InitializeBaseRequest,n.correlationId);const s=n.authority||e.auth.authority,l=[...n&&n.scopes||[]],c={...n,correlationId:n.correlationId,authority:s,scopes:l};if(!c.authenticationScheme)c.authenticationScheme=_t.BEARER,a.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(c.authenticationScheme===_t.SSH){if(!n.sshJwk)throw Pt(Oh);if(!n.sshKid)throw Pt(O_)}a.verbose(`Authentication Scheme set to "${c.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&n.claims&&!Cr.isEmptyObj(n.claims)&&(c.requestedClaimsHash=await Jx(n.claims)),c}async function YI(n,e,t,a,s){a.addQueueMeasurement(W.InitializeSilentRequest,n.correlationId);const l=await ve(nm,W.InitializeBaseRequest,s,a,n.correlationId)(n,t,a,s);return{...n,...l,account:e,forceRefresh:n.forceRefresh||!1}}function oS(n,e){let t;const a=n.httpMethod;if(e===rr.EAR){if(t=a||ts.POST,t!==ts.POST)throw Pt(F_)}else t=a||ts.GET;if(n.authorizePostBodyParameters&&t!==ts.POST)throw Pt(L_);return t}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Co extends sS{initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);const t={correlationId:this.correlationId||na(),...e};if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){const a=this.getLogoutHintFromIdTokenClaims(e.account);a&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=a)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=dt.getAbsoluteUrl(e.postLogoutRedirectUri,Fa())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=dt.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Fa())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=dt.getAbsoluteUrl(Fa(),Fa())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){const t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}async createAuthCodeClient(e){this.performanceClient.addQueueMeasurement(W.StandardInteractionClientCreateAuthCodeClient,this.correlationId);const t=await ve(this.getClientConfiguration.bind(this),W.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e);return new hx(t,this.performanceClient)}async getClientConfiguration(e){const{serverTelemetryManager:t,requestAuthority:a,requestAzureCloudOptions:s,requestExtraQueryParameters:l,account:c}=e;this.performanceClient.addQueueMeasurement(W.StandardInteractionClientGetClientConfiguration,this.correlationId);const h=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)({requestAuthority:a,requestAzureCloudOptions:s,requestExtraQueryParameters:l,account:c}),d=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:h,clientCapabilities:this.config.auth.clientCapabilities,redirectUri:this.config.auth.redirectUri},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:d.loggerCallback,piiLoggingEnabled:d.piiLoggingEnabled,logLevel:d.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:t,libraryInfo:{sku:nr.MSAL_SKU,version:ss,cpu:ye.EMPTY_STRING,os:ye.EMPTY_STRING},telemetry:this.config.telemetry}}async initializeAuthorizationRequest(e,t){this.performanceClient.addQueueMeasurement(W.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);const a=this.getRedirectUri(e.redirectUri),s={interactionType:t},l=xo.setRequestState(this.browserCrypto,e&&e.state||ye.EMPTY_STRING,s),h={...await ve(nm,W.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)({...e,correlationId:this.correlationId},this.config,this.performanceClient,this.logger),redirectUri:a,state:l,nonce:e.nonce||na(),responseMode:this.config.auth.OIDCOptions.serverResponseType},d={...h,httpMethod:oS(h,this.config.auth.protocolMode)};if(e.loginHint||e.sid)return d;const g=e.account||this.browserStorage.getActiveAccount(this.correlationId);return g&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${g.homeAccountId}`,this.correlationId),d.account=g),d}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function XI(n,e){if(!e)return null;try{return xo.parseRequestState(n,e).libraryState.meta}catch{throw we(po)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function Hl(n,e,t){const a=eh(n);if(!a)throw B_(n)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${n}`),Ue(yx)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),Ue(vx));return a}function WI(n,e,t){if(!n.state)throw Ue(Hg);const a=XI(e,n.state);if(!a)throw Ue(Tx);if(a.interactionType!==t)throw Ue(_x)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class lS{constructor(e,t,a,s,l){this.authModule=e,this.browserStorage=t,this.authCodeRequest=a,this.logger=s,this.performanceClient=l}async handleCodeResponse(e,t){this.performanceClient.addQueueMeasurement(W.HandleCodeResponse,t.correlationId);let a;try{a=jb(e,t.state)}catch(s){throw s instanceof hs&&s.subError===Wl?Ue(Wl):s}return ve(this.handleCodeResponseFromServer.bind(this),W.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(a,t)}async handleCodeResponseFromServer(e,t,a=!0){if(this.performanceClient.addQueueMeasurement(W.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&await ve(this.authModule.updateAuthority.bind(this.authModule),W.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId),a&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{const l=this.createCcsCredentials(t);l&&(this.authCodeRequest.ccsCredential=l)}return await ve(this.authModule.acquireToken.bind(this.authModule),W.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Qr.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Qr.UPN}:null}}/*! @azure/msal-browser v4.22.1 2025-09-09 */const QI="ContentError",cS="user_switch";/*! @azure/msal-browser v4.22.1 2025-09-09 */const JI="USER_INTERACTION_REQUIRED",ZI="USER_CANCEL",eR="NO_NETWORK",tR="DISABLED",nR="ACCOUNT_UNAVAILABLE",rR="UX_NOT_ALLOWED";/*! @azure/msal-browser v4.22.1 2025-09-09 */const aR=-2147186943,iR={[cS]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."};class va extends kt{constructor(e,t,a){super(e,t),Object.setPrototypeOf(this,va.prototype),this.name="NativeAuthError",this.ext=a}}function ro(n){if(n.ext&&n.ext.status&&n.ext.status===tR||n.ext&&n.ext.error&&n.ext.error===aR)return!0;switch(n.errorCode){case QI:return!0;default:return!1}}function dh(n,e,t){if(t&&t.status)switch(t.status){case nR:return ch(lx);case JI:return new Hr(n,e);case ZI:return Ue(Wl);case eR:return Ue(uh);case rR:return ch(Mg)}return new va(n,iR[n]||e,t)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class uS extends Co{async acquireToken(e){this.performanceClient.addQueueMeasurement(W.SilentCacheClientAcquireToken,e.correlationId);const t=this.initializeServerTelemetryManager(Nt.acquireTokenSilent_silentFlow),a=await ve(this.getClientConfiguration.bind(this),W.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:t,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,account:e.account}),s=new Ub(a,this.performanceClient);this.logger.verbose("Silent auth client created");try{const c=(await ve(s.acquireCachedToken.bind(s),W.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),c}catch(l){throw l instanceof sc&&l.errorCode===jg&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),l}}logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t.correlationId,t?.account)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class Xu extends sS{constructor(e,t,a,s,l,c,h,d,g,p,v,_){super(e,t,a,s,l,c,d,g,_),this.apiId=h,this.accountId=p,this.platformAuthProvider=g,this.nativeStorageManager=v,this.silentCacheClient=new uS(e,this.nativeStorageManager,a,s,l,c,d,g,_);const T=this.platformAuthProvider.getExtensionName();this.skus=Xl.makeExtraSkuString({libraryName:nr.MSAL_SKU,libraryVersion:ss,extensionName:T,extensionVersion:this.platformAuthProvider.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters={...e.extraParameters,[Z2]:this.skus}}async acquireToken(e,t){this.performanceClient.addQueueMeasurement(W.NativeInteractionClientAcquireToken,this.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");const a=this.performanceClient.startMeasurement(W.NativeInteractionClientAcquireToken,this.correlationId),s=ir(),l=this.initializeServerTelemetryManager(this.apiId);try{const c=await this.initializeNativeRequest(e);try{const d=await this.acquireTokensFromCache(this.accountId,c);return a.end({success:!0,isNativeBroker:!1,fromCache:!0}),d}catch(d){if(t===Vn.AccessToken)throw this.logger.info("MSAL internal Cache does not contain tokens, return error as per cache policy"),a.end({success:!1,brokerErrorCode:"cache_request_failed"}),d;this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}const h=await this.platformAuthProvider.sendMessage(c);return await this.handleNativeResponse(h,c,s).then(d=>(a.end({success:!0,isNativeBroker:!0,requestId:d.requestId}),l.clearNativeBrokerErrorCode(),d)).catch(d=>{throw a.end({success:!1,errorCode:d.errorCode,subErrorCode:d.subError}),d})}catch(c){throw c instanceof va&&l.setNativeBrokerErrorCode(c.errorCode),a.end({success:!1}),c}}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:sn.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}async acquireTokensFromCache(e,t){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),we(F0);const a=this.browserStorage.getBaseAccountInfo({nativeAccountId:e},this.correlationId);if(!a)throw we(F0);try{const s=this.createSilentCacheRequest(t,a),l=await this.silentCacheClient.acquireToken(s),c={...a,idTokenClaims:l?.idTokenClaims,idToken:l?.idToken};return{...l,account:c}}catch(s){throw s}}async acquireTokenRedirect(e,t){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");const{...a}=e;delete a.onRedirectNavigate;const s=await this.initializeNativeRequest(a);try{await this.platformAuthProvider.sendMessage(s)}catch(h){if(h instanceof va&&(this.initializeServerTelemetryManager(this.apiId).setNativeBrokerErrorCode(h.errorCode),ro(h)))throw h}this.browserStorage.setTemporaryCache(Zt.NATIVE_REQUEST,JSON.stringify(s),!0);const l={apiId:Nt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},c=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),await this.navigationClient.navigateExternal(c,l)}async handleRedirectPromise(e,t){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;const a=this.browserStorage.getCachedNativeRequest();if(!a)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;const{prompt:s,...l}=a;s&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Zt.NATIVE_REQUEST));const c=ir();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");const h=await this.platformAuthProvider.sendMessage(l),d=await this.handleNativeResponse(h,l,c);return this.initializeServerTelemetryManager(this.apiId).clearNativeBrokerErrorCode(),e&&this.correlationId&&this.performanceClient.addFields({isNativeBroker:!0},this.correlationId),d}catch(h){throw h}}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}async handleNativeResponse(e,t,a){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");const s=_o(e.id_token,Zr),l=this.createHomeAccountIdentifier(e,s),c=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId},this.correlationId)?.homeAccountId;if(t.extraParameters?.child_client_id&&e.account.id!==t.accountId)this.logger.info("handleNativeServerResponse: Double broker flow detected, ignoring accountId mismatch");else if(l!==c&&e.account.id!==t.accountId)throw dh(cS);const h=await this.getDiscoveredAuthority({requestAuthority:t.authority}),d=Dg(this.browserStorage,h,l,Zr,this.correlationId,s,e.client_info,void 0,s.tid,void 0,e.account.id,this.logger);e.expires_in=Number(e.expires_in);const g=await this.generateAuthenticationResult(e,t,s,d,h.canonicalAuthority,a);return await this.cacheAccount(d,this.correlationId),await this.cacheNativeTokens(e,t,l,s,e.access_token,g.tenantId,a),g}createHomeAccountIdentifier(e,t){return ta.generateHomeAccountId(e.client_info||ye.EMPTY_STRING,Xr.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return t?sn.fromString(t):sn.fromString(e)}async generatePopAccessToken(e,t){if(t.tokenType===_t.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;const a=new vo(this.browserCrypto),s={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw we(lg);return a.signPopToken(e.access_token,t.keyId,s)}else return e.access_token}async generateAuthenticationResult(e,t,a,s,l,c){const h=this.addTelemetryFromNativeResponse(e.properties.MATS),d=this.generateScopes(t.scope,e.scope),g=e.account.properties||{},p=g.UID||a.oid||a.sub||ye.EMPTY_STRING,v=g.TenantId||a.tid||ye.EMPTY_STRING,_=vg(s.getAccountInfo(),void 0,a,e.id_token);_.nativeAccountId!==e.account.id&&(_.nativeAccountId=e.account.id);const T=await this.generatePopAccessToken(e,t),C=t.tokenType===_t.POP?_t.POP:_t.BEARER;return{authority:l,uniqueId:p,tenantId:v,scopes:d.asArray(),account:_,idToken:e.id_token,idTokenClaims:a,accessToken:T,fromCache:h?this.isResponseFromCache(h):!1,expiresOn:co(c+e.expires_in),tokenType:C,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}}async cacheAccount(e,t){await this.browserStorage.setAccount(e,this.correlationId),this.browserStorage.removeAccountContext(e.getAccountInfo(),t)}cacheNativeTokens(e,t,a,s,l,c,h){const d=Fh(a,t.authority,e.id_token||"",t.clientId,s.tid||""),g=t.tokenType===_t.POP?ye.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,p=h+g,v=this.generateScopes(e.scope,t.scope),_=Lh(a,t.authority,l,t.clientId,s.tid||c,v.printScopes(),p,0,Zr,void 0,t.tokenType,void 0,t.keyId),T={idToken:d,accessToken:_};return this.nativeStorageManager.saveCacheRecord(T,this.correlationId,t.storeInCache)}getExpiresInValue(e,t){return e===_t.POP?ye.SHR_NONCE_VALIDITY:(typeof t=="string"?parseInt(t,10):t)||0}addTelemetryFromNativeResponse(e){const t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.platformAuthProvider.getExtensionId(),extensionVersion:this.platformAuthProvider.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}getMATSFromResponse(e){if(e)try{return JSON.parse(e)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}async initializeNativeRequest(e){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");const t=await this.getCanonicalAuthority(e),{scopes:a,...s}=e,l=new sn(a||[]);l.appendScopes(To);const c={...s,accountId:this.accountId,clientId:this.config.auth.clientId,authority:t.urlString,scope:l.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:this.getPrompt(e.prompt),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:{...e.extraQueryParameters,...e.tokenQueryParameters},extendedExpiryToken:!1,keyId:e.popKid};if(c.signPopToken&&e.popKid)throw Ue(zx);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=Br.MATS_TELEMETRY,e.authenticationScheme===_t.POP){const h={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},d=new vo(this.browserCrypto);let g;if(c.keyId)g=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{const p=await ve(d.generateCnf.bind(d),W.PopTokenGenerateCnf,this.logger,this.performanceClient,this.correlationId)(h,this.logger);g=p.reqCnfString,c.keyId=p.kid,c.signPopToken=!0}c.reqCnf=g}return this.addRequestSKUs(c),c}async getCanonicalAuthority(e){const t=e.authority||this.config.auth.authority;e.account&&await this.getDiscoveredAuthority({requestAuthority:t,requestAzureCloudOptions:e.azureCloudOptions,account:e.account});const a=new dt(t);return a.validateAsUri(),a}getPrompt(e){switch(this.apiId){case Nt.ssoSilent:case Nt.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Wn.NONE}if(!e){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e){case Wn.NONE:case Wn.CONSENT:case Wn.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e} is not compatible with native flow`),Ue(Hx)}}handleExtraBrokerParams(e){const t=e.extraParameters&&e.extraParameters.hasOwnProperty(ah)&&e.extraParameters.hasOwnProperty(ih)&&e.extraParameters.hasOwnProperty(as);if(!e.embeddedClientId&&!t)return;let a="";const s=e.redirectUri;e.embeddedClientId?(e.redirectUri=this.config.auth.redirectUri,a=e.embeddedClientId):e.extraParameters&&(e.redirectUri=e.extraParameters[ih],a=e.extraParameters[as]),e.extraParameters={child_client_id:a,child_redirect_uri:s},this.performanceClient?.addFields({embeddedClientId:a,embeddedRedirectUri:s},this.correlationId)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function rm(n,e,t,a,s){const l=Hb({...n.auth,authority:e},t,a,s);if(wg(l,{sku:nr.MSAL_SKU,version:ss,os:"",cpu:""}),n.auth.protocolMode!==rr.OIDC&&bg(l,n.telemetry.application),t.platformBroker&&(rb(l),s.addFields({isPlatformAuthorizeRequest:!0},t.correlationId),t.authenticationScheme===_t.POP)){const c=new Ha(a,s),h=new vo(c);let d;t.popKid?d=c.encodeKid(t.popKid):d=(await ve(h.generateCnf.bind(h),W.PopTokenGenerateCnf,a,s,t.correlationId)(t,a)).reqCnfString,Rg(l,d)}return Mh(l,t.correlationId,s),l}async function am(n,e,t,a,s){if(!t.codeChallenge)throw Pt(dg);const l=await ve(rm,W.GetStandardParams,a,s,t.correlationId)(n,e,t,a,s);return _g(l,tg.CODE),X_(l,t.codeChallenge,ye.S256_CODE_CHALLENGE_METHOD),Si(l,t.extraQueryParameters||{}),Pg(e,l,n.auth.encodeExtraQueryParams,t.extraQueryParameters)}async function im(n,e,t,a,s,l){if(!a.earJwk)throw Ue(Bg);const c=await rm(e,t,a,s,l);_g(c,tg.IDTOKEN_TOKEN_REFRESHTOKEN),gb(c,a.earJwk);const h=new Map;Si(h,a.extraQueryParameters||{});const d=Pg(t,h,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return hS(n,d,c)}async function sm(n,e,t,a,s,l){const c=await rm(e,t,a,s,l);_g(c,tg.CODE),X_(c,a.codeChallenge,a.codeChallengeMethod||ye.S256_CODE_CHALLENGE_METHOD),mb(c,a.authorizePostBodyParameters||{});const h=new Map;Si(h,a.extraQueryParameters||{});const d=Pg(t,h,e.auth.encodeExtraQueryParams,a.extraQueryParameters);return hS(n,d,c)}function hS(n,e,t){const a=n.createElement("form");return a.method="post",a.action=e,t.forEach((s,l)=>{const c=n.createElement("input");c.hidden=!0,c.name=l,c.value=s,a.appendChild(c)}),n.body.appendChild(a),a}async function fS(n,e,t,a,s,l,c,h,d,g){if(h.verbose("Account id found, calling WAM for token"),!g)throw Ue(Gg);const p=new Ha(h,d),v=new Xu(a,s,p,h,c,a.system.navigationClient,t,d,g,e,l,n.correlationId),{userRequestState:_}=xo.parseRequestState(p,n.state);return ve(v.acquireToken.bind(v),W.NativeInteractionClientAcquireToken,h,d,n.correlationId)({...n,state:_,prompt:void 0})}async function gh(n,e,t,a,s,l,c,h,d,g,p,v){if(pa.removeThrottle(c,s.auth.clientId,n),e.accountId)return ve(fS,W.HandleResponsePlatformBroker,g,p,n.correlationId)(n,e.accountId,a,s,c,h,d,g,p,v);const _={...n,code:e.code||"",codeVerifier:t},T=new lS(l,c,_,g,p);return await ve(T.handleCodeResponse.bind(T),W.HandleCodeResponse,g,p,n.correlationId)(e,n)}async function om(n,e,t,a,s,l,c,h,d,g,p){if(pa.removeThrottle(l,a.auth.clientId,n),fx(e,n.state),!e.ear_jwe)throw Ue(px);if(!n.earJwk)throw Ue(Bg);const v=JSON.parse(await ve(gI,W.DecryptEarResponse,d,g,n.correlationId)(n.earJwk,e.ear_jwe));if(v.accountId)return ve(fS,W.HandleResponsePlatformBroker,d,g,n.correlationId)(n,v.accountId,t,a,l,c,h,d,g,p);const _=new is(a.auth.clientId,l,new Ha(d,g),d,null,null,g);_.validateTokenResponse(v);const T={code:"",state:n.state,nonce:n.nonce,client_info:v.client_info,cloud_graph_host_name:v.cloud_graph_host_name,cloud_instance_host_name:v.cloud_instance_host_name,cloud_instance_name:v.cloud_instance_name,msgraph_host:v.msgraph_host};return await ve(_.handleServerTokenResponse.bind(_),W.HandleServerTokenResponse,d,g,n.correlationId)(v,s,ir(),n,T,void 0,void 0,void 0,void 0)}/*! @azure/msal-browser v4.22.1 2025-09-09 */const sR=32;async function Vh(n,e,t){n.addQueueMeasurement(W.GeneratePkceCodes,t);const a=Er(oR,W.GenerateCodeVerifier,e,n,t)(n,e,t),s=await ve(lR,W.GenerateCodeChallengeFromVerifier,e,n,t)(a,n,e,t);return{verifier:a,challenge:s}}function oR(n,e,t){try{const a=new Uint8Array(sR);return Er(cI,W.GetRandomValues,e,n,t)(a),Ai(a)}catch{throw Ue(Ug)}}async function lR(n,e,t,a){e.addQueueMeasurement(W.GenerateCodeChallengeFromVerifier,a);try{const s=await ve(Xx,W.Sha256Digest,t,e,a)(n,e,a);return Ai(new Uint8Array(s))}catch{throw Ue(Ug)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class mh{constructor(e,t,a,s){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=s,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=a,this.handshakeEvent=a.startMeasurement(W.NativeMessageHandlerHandshake),this.platformAuthType=Br.PLATFORM_EXTENSION_PROVIDER}async sendMessage(e){this.logger.trace(this.platformAuthType+" - sendMessage called.");const t={method:Il.GetToken,request:e},a={channel:Br.CHANNEL_ID,extensionId:this.extensionId,responseId:na(),body:t};this.logger.trace(this.platformAuthType+" - Sending request to browser extension"),this.logger.tracePii(this.platformAuthType+` - Sending request to browser extension: ${JSON.stringify(a)}`),this.messageChannel.port1.postMessage(a);const s=await new Promise((c,h)=>{this.resolvers.set(a.responseId,{resolve:c,reject:h})});return this.validatePlatformBrokerResponse(s)}static async createProvider(e,t,a){e.trace("PlatformAuthExtensionHandler - createProvider called.");try{const s=new mh(e,t,a,Br.PREFERRED_EXTENSION_ID);return await s.sendHandshakeRequest(),s}catch{const l=new mh(e,t,a);return await l.sendHandshakeRequest(),l}}async sendHandshakeRequest(){this.logger.trace(this.platformAuthType+" - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);const e={channel:Br.CHANNEL_ID,extensionId:this.extensionId,responseId:na(),body:{method:Il.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,a)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:a}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),a(Ue(Ux)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})}onWindowMessage(e){if(this.logger.trace(this.platformAuthType+" - onWindowMessage called"),e.source!==window)return;const t=e.data;if(!(!t.channel||t.channel!==Br.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===Il.HandshakeRequest){const a=this.handshakeResolvers.get(t.responseId);if(!a){this.logger.trace(this.platformAuthType+`.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),a.reject(Ue(Bx))}}onChannelMessage(e){this.logger.trace(this.platformAuthType+" - onChannelMessage called.");const t=e.data,a=this.resolvers.get(t.responseId),s=this.handshakeResolvers.get(t.responseId);try{const l=t.body.method;if(l===Il.Response){if(!a)return;const c=t.body.response;if(this.logger.trace(this.platformAuthType+" - Received response from browser extension"),this.logger.tracePii(this.platformAuthType+` - Received response from browser extension: ${JSON.stringify(c)}`),c.status!=="Success")a.reject(dh(c.code,c.description,c.ext));else if(c.result)c.result.code&&c.result.description?a.reject(dh(c.result.code,c.result.description,c.result.ext)):a.resolve(c.result);else throw M0(Ju,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(l===Il.HandshakeResponse){if(!s){this.logger.trace(this.platformAuthType+`.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(this.platformAuthType+` - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),s.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(l){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${l}`),this.logger.errorPii(`Unable to parse ${e}`),a?a.reject(l):s&&s.reject(l)}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw M0(Ju,"Response missing expected properties.")}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}getExtensionName(){return this.getExtensionId()===Br.PREFERRED_EXTENSION_ID?"chrome":this.getExtensionId()?.length?"unknown":void 0}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class lm{constructor(e,t,a){this.logger=e,this.performanceClient=t,this.correlationId=a,this.platformAuthType=Br.PLATFORM_DOM_PROVIDER}static async createProvider(e,t,a){if(e.trace("PlatformAuthDOMHandler: createProvider called"),window.navigator?.platformAuthentication&&(await window.navigator.platformAuthentication.getSupportedContracts(Br.MICROSOFT_ENTRA_BROKERID))?.includes(Br.PLATFORM_DOM_APIS))return e.trace("Platform auth api available in DOM"),new lm(e,t,a)}getExtensionId(){return Br.MICROSOFT_ENTRA_BROKERID}getExtensionVersion(){return""}getExtensionName(){return Br.DOM_API_NAME}async sendMessage(e){this.logger.trace(this.platformAuthType+" - Sending request to browser DOM API");try{const t=this.initializePlatformDOMRequest(e),a=await window.navigator.platformAuthentication.executeGetToken(t);return this.validatePlatformBrokerResponse(a)}catch(t){throw this.logger.error(this.platformAuthType+" - executeGetToken DOM API error"),t}}initializePlatformDOMRequest(e){this.logger.trace(this.platformAuthType+" - initializeNativeDOMRequest called");const{accountId:t,clientId:a,authority:s,scope:l,redirectUri:c,correlationId:h,state:d,storeInCache:g,embeddedClientId:p,extraParameters:v,..._}=e,T=this.getDOMExtraParams(_);return{accountId:t,brokerId:this.getExtensionId(),authority:s,clientId:a,correlationId:h||this.correlationId,extraParameters:{...v,...T},isSecurityTokenService:!1,redirectUri:c,scope:l,state:d,storeInCache:g,embeddedClientId:p}}validatePlatformBrokerResponse(e){if(e.hasOwnProperty("isSuccess")){if(e.hasOwnProperty("accessToken")&&e.hasOwnProperty("idToken")&&e.hasOwnProperty("clientInfo")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scopes")&&e.hasOwnProperty("expiresIn"))return this.logger.trace(this.platformAuthType+" - platform broker returned successful and valid response"),this.convertToPlatformBrokerResponse(e);if(e.hasOwnProperty("error")){const t=e;if(t.isSuccess===!1&&t.error&&t.error.code)throw this.logger.trace(this.platformAuthType+" - platform broker returned error response"),dh(t.error.code,t.error.description,{error:parseInt(t.error.errorCode),protocol_error:t.error.protocolError,status:t.error.status,properties:t.error.properties})}}throw M0(Ju,"Response missing expected properties.")}convertToPlatformBrokerResponse(e){return this.logger.trace(this.platformAuthType+" - convertToNativeResponse called"),{access_token:e.accessToken,id_token:e.idToken,client_info:e.clientInfo,account:e.account,expires_in:e.expiresIn,scope:e.scopes,state:e.state||"",properties:e.properties||{},extendedLifetimeToken:e.extendedLifetimeToken??!1,shr:e.proofOfPossessionPayload}}getDOMExtraParams(e){return{...Object.entries(e).reduce((s,[l,c])=>(s[l]=String(c),s),{})}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function cR(n,e,t,a){n.trace("getPlatformAuthProvider called",t);const s=uR();n.trace("Has client allowed platform auth via DOM API: "+s);let l;try{s&&(l=await lm.createProvider(n,e,t)),l||(n.trace("Platform auth via DOM API not available, checking for extension"),l=await mh.createProvider(n,a||aS,e))}catch(c){n.trace("Platform auth not available",c)}return l}function uR(){let n;try{return n=window[on.SessionStorage],n?.getItem(NI)==="true"}catch{return!1}}function Jl(n,e,t,a){if(e.trace("isPlatformAuthAllowed called"),!n.system.allowPlatformBroker)return e.trace("isPlatformAuthAllowed: allowPlatformBroker is not enabled, returning false"),!1;if(!t)return e.trace("isPlatformAuthAllowed: Platform auth provider is not initialized, returning false"),!1;if(a)switch(a){case _t.BEARER:case _t.POP:return e.trace("isPlatformAuthAllowed: authenticationScheme is supported, returning true"),!0;default:return e.trace("isPlatformAuthAllowed: authenticationScheme is not supported, returning false"),!1}return!0}/*! @azure/msal-browser v4.22.1 2025-09-09 */class hR extends Co{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,h,g,p),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=d,this.eventHandler=l}acquireToken(e,t){let a;try{if(a={popupName:this.generatePopupName(e.scopes||To,e.authority||this.config.auth.authority),popupWindowAttributes:e.popupWindowAttributes||{},popupWindowParent:e.popupWindowParent??window},this.performanceClient.addFields({isAsyncPopup:this.config.system.asyncPopups},this.correlationId),this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,a,t);{const l={...e,httpMethod:oS(e,this.config.auth.protocolMode)};return this.logger.verbose("asyncPopup set to false, opening popup before acquiring token"),a.popup=this.openSizedPopup("about:blank",a),this.acquireTokenPopupAsync(l,a,t)}}catch(s){return Promise.reject(s)}}logout(e){try{this.logger.verbose("logoutPopup called");const t=this.initializeLogoutRequest(e),a={popupName:this.generateLogoutPopupName(t),popupWindowAttributes:e?.popupWindowAttributes||{},popupWindowParent:e?.popupWindowParent??window},s=e&&e.authority,l=e&&e.mainWindowRedirectUri;return this.config.system.asyncPopups?(this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,a,s,l)):(this.logger.verbose("asyncPopup set to false, opening popup"),a.popup=this.openSizedPopup("about:blank",a),this.logoutPopupAsync(t,a,s,l))}catch(t){return Promise.reject(t)}}async acquireTokenPopupAsync(e,t,a){this.logger.verbose("acquireTokenPopupAsync called");const s=await ve(this.initializeAuthorizationRequest.bind(this),W.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qe.Popup);t.popup&&rS(s.authority);const l=Jl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);return s.platformBroker=l,this.config.auth.protocolMode===rr.EAR?this.executeEarFlow(s,t):this.executeCodeFlow(s,t,a)}async executeCodeFlow(e,t,a){const s=e.correlationId,l=this.initializeServerTelemetryManager(Nt.acquireTokenPopup),c=a||await ve(Vh,W.GeneratePkceCodes,this.logger,this.performanceClient,s)(this.performanceClient,this.logger,s),h={...e,codeChallenge:c.challenge};try{const d=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,s)({serverTelemetryManager:l,requestAuthority:h.authority,requestAzureCloudOptions:h.azureCloudOptions,requestExtraQueryParameters:h.extraQueryParameters,account:h.account});if(h.httpMethod===ts.POST)return await this.executeCodeFlowWithPost(h,t,d,c.verifier);{const g=await ve(am,W.GetAuthCodeUrl,this.logger,this.performanceClient,s)(this.config,d.authority,h,this.logger,this.performanceClient),p=this.initiateAuthRequest(g,t);this.eventHandler.emitEvent($e.POPUP_OPENED,qe.Popup,{popupWindow:p},null);const v=await this.monitorPopupForHash(p,t.popupWindowParent),_=Er(Hl,W.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(v,this.config.auth.OIDCOptions.serverResponseType,this.logger);return await ve(gh,W.HandleResponseCode,this.logger,this.performanceClient,s)(e,_,c.verifier,Nt.acquireTokenPopup,this.config,d,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}catch(d){throw t.popup?.close(),d instanceof kt&&(d.setCorrelationId(this.correlationId),l.cacheFailedRequest(d)),d}}async executeEarFlow(e,t){const a=e.correlationId,s=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,a)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),l=await ve(Yg,W.GenerateEarKey,this.logger,this.performanceClient,a)(),c={...e,earJwk:l},h=t.popup||this.openPopup("about:blank",t);(await im(h.document,this.config,s,c,this.logger,this.performanceClient)).submit();const g=await ve(this.monitorPopupForHash.bind(this),W.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(h,t.popupWindowParent),p=Er(Hl,W.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);return ve(om,W.HandleResponseEar,this.logger,this.performanceClient,a)(c,p,Nt.acquireTokenPopup,this.config,s,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async executeCodeFlowWithPost(e,t,a,s){const l=e.correlationId,c=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,l)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),h=t.popup||this.openPopup("about:blank",t);(await sm(h.document,this.config,c,e,this.logger,this.performanceClient)).submit();const g=await ve(this.monitorPopupForHash.bind(this),W.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,l)(h,t.popupWindowParent),p=Er(Hl,W.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(g,this.config.auth.OIDCOptions.serverResponseType,this.logger);return ve(gh,W.HandleResponseCode,this.logger,this.performanceClient,l)(e,p,s,Nt.acquireTokenPopup,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async logoutPopupAsync(e,t,a,s){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent($e.LOGOUT_START,qe.Popup,e);const l=this.initializeServerTelemetryManager(Nt.logoutPopup);try{await this.clearCacheOnLogout(this.correlationId,e.account);const c=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:l,requestAuthority:a,account:e.account||void 0});try{c.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===rr.OIDC){if(this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Popup,e),s){const g={apiId:Nt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=dt.getAbsoluteUrl(s,Fa());await this.navigationClient.navigateInternal(p,g)}t.popup?.close();return}}const h=c.getLogoutUri(e);this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Popup,e);const d=this.openPopup(h,t);if(this.eventHandler.emitEvent($e.POPUP_OPENED,qe.Popup,{popupWindow:d},null),await this.monitorPopupForHash(d,t.popupWindowParent).catch(()=>{}),s){const g={apiId:Nt.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},p=dt.getAbsoluteUrl(s,Fa());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${p}`),await this.navigationClient.navigateInternal(p,g)}else this.logger.verbose("No main window navigation requested")}catch(c){throw t.popup?.close(),c instanceof kt&&(c.setCorrelationId(this.correlationId),l.cacheFailedRequest(c)),this.eventHandler.emitEvent($e.LOGOUT_FAILURE,qe.Popup,null,c),this.eventHandler.emitEvent($e.LOGOUT_END,qe.Popup),c}this.eventHandler.emitEvent($e.LOGOUT_END,qe.Popup)}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),Ue(jh)}monitorPopupForHash(e,t){return new Promise((a,s)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");const l=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(l),s(Ue(Wl));return}let c="";try{c=e.location.href}catch{}if(!c||c==="about:blank")return;clearInterval(l);let h="";const d=this.config.auth.OIDCOptions.serverResponseType;e&&(d===kh.QUERY?h=e.location.search:h=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),a(h)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e,t)})}openPopup(e,t){try{let a;if(t.popup?(a=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),a.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),a=this.openSizedPopup(e,t)),!a)throw Ue(Cx);return a.focus&&a.focus(),this.currentWindow=a,t.popupWindowParent.addEventListener("beforeunload",this.unloadWindow),a}catch(a){throw this.logger.error("error opening popup "+a.message),Ue(Sx)}}openSizedPopup(e,{popupName:t,popupWindowAttributes:a,popupWindowParent:s}){const l=s.screenLeft?s.screenLeft:s.screenX,c=s.screenTop?s.screenTop:s.screenY,h=s.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,d=s.innerHeight||document.documentElement.clientHeight||document.body.clientHeight;let g=a.popupSize?.width,p=a.popupSize?.height,v=a.popupPosition?.top,_=a.popupPosition?.left;return(!g||g<0||g>h)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),g=nr.POPUP_WIDTH),(!p||p<0||p>d)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),p=nr.POPUP_HEIGHT),(!v||v<0||v>d)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),v=Math.max(0,d/2-nr.POPUP_HEIGHT/2+c)),(!_||_<0||_>h)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),_=Math.max(0,h/2-nr.POPUP_WIDTH/2+l)),s.open(e,t,`width=${g}, height=${p}, top=${v}, left=${_}, scrollbars=yes`)}unloadWindow(e){this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e,t){e.close(),t.removeEventListener("beforeunload",this.unloadWindow)}generatePopupName(e,t){return`${nr.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){const t=e.account&&e.account.homeAccountId;return`${nr.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function fR(){if(typeof window>"u"||typeof window.performance>"u"||typeof window.performance.getEntriesByType!="function")return;const n=window.performance.getEntriesByType("navigation");return(n.length?n[0]:void 0)?.type}class dR extends Co{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,h,g,p),this.nativeStorage=d}async acquireToken(e){const t=await ve(this.initializeAuthorizationRequest.bind(this),W.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,qe.Redirect);t.platformBroker=Jl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme);const a=l=>{l.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.resetRequestCache(),this.eventHandler.emitEvent($e.RESTORE_FROM_BFCACHE,qe.Redirect))},s=this.getRedirectStartPage(e.redirectStartPage);this.logger.verbosePii(`Redirect start page: ${s}`),this.browserStorage.setTemporaryCache(Zt.ORIGIN_URI,s,!0),window.addEventListener("pageshow",a);try{this.config.auth.protocolMode===rr.EAR?await this.executeEarFlow(t):await this.executeCodeFlow(t,e.onRedirectNavigate)}catch(l){throw l instanceof kt&&l.setCorrelationId(this.correlationId),window.removeEventListener("pageshow",a),l}}async executeCodeFlow(e,t){const a=e.correlationId,s=this.initializeServerTelemetryManager(Nt.acquireTokenRedirect),l=await ve(Vh,W.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),c={...e,codeChallenge:l.challenge};this.browserStorage.cacheAuthorizeRequest(c,l.verifier);try{if(c.httpMethod===ts.POST)return await this.executeCodeFlowWithPost(c);{const h=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:c.authority,requestAzureCloudOptions:c.azureCloudOptions,requestExtraQueryParameters:c.extraQueryParameters,account:c.account}),d=await ve(am,W.GetAuthCodeUrl,this.logger,this.performanceClient,e.correlationId)(this.config,h.authority,c,this.logger,this.performanceClient);return await this.initiateAuthRequest(d,t)}}catch(h){throw h instanceof kt&&(h.setCorrelationId(this.correlationId),s.cacheFailedRequest(h)),h}}async executeEarFlow(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=await ve(Yg,W.GenerateEarKey,this.logger,this.performanceClient,t)(),l={...e,earJwk:s};return this.browserStorage.cacheAuthorizeRequest(l),(await im(document,this.config,a,l,this.logger,this.performanceClient)).submit(),new Promise((h,d)=>{setTimeout(()=>{d(Ue(hh,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async executeCodeFlowWithPost(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return this.browserStorage.cacheAuthorizeRequest(e),(await sm(document,this.config,a,e,this.logger,this.performanceClient)).submit(),new Promise((l,c)=>{setTimeout(()=>{c(Ue(hh,"failed_to_redirect"))},this.config.system.redirectNavigationTimeout)})}async handleRedirectPromise(e="",t,a,s){const l=this.initializeServerTelemetryManager(Nt.handleRedirectPromise);try{const[c,h]=this.getRedirectResponse(e||"");if(!c)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.resetRequestCache(),fR()!=="back_forward"?s.event.errorCode="no_server_response":this.logger.verbose("Back navigation event detected. Muting no_server_response error"),null;const d=this.browserStorage.getTemporaryCache(Zt.ORIGIN_URI,!0)||ye.EMPTY_STRING,g=ky(d),p=ky(window.location.href);if(g===p&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),d.indexOf("#")>-1&&pI(d),await this.handleResponse(c,t,a,l);if(this.config.auth.navigateToLoginRequestUrl){if(!Jg()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(Zt.URL_HASH,h,!0);const v={apiId:Nt.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0};let _=!0;if(!d||d==="null"){const T=yI();this.browserStorage.setTemporaryCache(Zt.ORIGIN_URI,T,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),_=await this.navigationClient.navigateInternal(T,v)}else this.logger.verbose(`Navigating to loginRequestUrl: ${d}`),_=await this.navigationClient.navigateInternal(d,v);if(!_)return await this.handleResponse(c,t,a,l)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),await this.handleResponse(c,t,a,l);return null}catch(c){throw c instanceof kt&&(c.setCorrelationId(this.correlationId),l.cacheFailedRequest(c)),c}}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===kh.QUERY?t=window.location.search:t=window.location.hash);let a=eh(t);if(a){try{WI(a,this.browserCrypto,qe.Redirect)}catch(l){return l instanceof kt&&this.logger.error(`Interaction type validation failed due to ${l.errorCode}: ${l.errorMessage}`),[null,""]}return eS(window),this.logger.verbose("Hash contains known properties, returning response hash"),[a,t]}const s=this.browserStorage.getTemporaryCache(Zt.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(Zt.URL_HASH)),s&&(a=eh(s),a)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[a,s]):[null,""]}async handleResponse(e,t,a,s){if(!e.state)throw Ue(Hg);if(e.ear_jwe){const h=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t.correlationId)({requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account});return ve(om,W.HandleResponseEar,this.logger,this.performanceClient,t.correlationId)(t,e,Nt.acquireTokenRedirect,this.config,h,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}const c=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:s,requestAuthority:t.authority});return ve(gh,W.HandleResponseCode,this.logger,this.performanceClient,t.correlationId)(t,e,a,Nt.acquireTokenRedirect,this.config,c,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}async initiateAuthRequest(e,t){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);const a={apiId:Nt.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=t||this.config.auth.onRedirectNavigate;if(typeof s=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),s(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),await this.navigationClient.navigateExternal(e,a);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),await this.navigationClient.navigateExternal(e,a);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),Ue(jh)}async logout(e){this.logger.verbose("logoutRedirect called");const t=this.initializeLogoutRequest(e),a=this.initializeServerTelemetryManager(Nt.logout);try{this.eventHandler.emitEvent($e.LOGOUT_START,qe.Redirect,e),await this.clearCacheOnLogout(this.correlationId,t.account);const s={apiId:Nt.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},l=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:a,requestAuthority:e&&e.authority,requestExtraQueryParameters:e?.extraQueryParameters,account:e&&e.account||void 0});if(l.authority.protocolMode===rr.OIDC)try{l.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Redirect,t);return}}const c=l.getLogoutUri(t);if(this.eventHandler.emitEvent($e.LOGOUT_SUCCESS,qe.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(c)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,pi.SIGNOUT),await this.navigationClient.navigateExternal(c,s);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0,pi.SIGNOUT),await this.navigationClient.navigateExternal(c,s);return}}catch(s){throw s instanceof kt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),this.eventHandler.emitEvent($e.LOGOUT_FAILURE,qe.Redirect,null,s),this.eventHandler.emitEvent($e.LOGOUT_END,qe.Redirect),s}this.eventHandler.emitEvent($e.LOGOUT_END,qe.Redirect)}getRedirectStartPage(e){const t=e||window.location.href;return dt.getAbsoluteUrl(t,Fa())}}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function gR(n,e,t,a,s){if(e.addQueueMeasurement(W.SilentHandlerInitiateAuthRequest,a),!n)throw t.info("Navigate url is empty"),Ue(jh);return s?ve(vR,W.SilentHandlerLoadFrame,t,e,a)(n,s,e,a):Er(yR,W.SilentHandlerLoadFrameSync,t,e,a)(n)}async function mR(n,e,t,a,s){const l=qh();if(!l.contentDocument)throw"No document associated with iframe!";return(await sm(l.contentDocument,n,e,t,a,s)).submit(),l}async function pR(n,e,t,a,s){const l=qh();if(!l.contentDocument)throw"No document associated with iframe!";return(await im(l.contentDocument,n,e,t,a,s)).submit(),l}async function oT(n,e,t,a,s,l,c){return a.addQueueMeasurement(W.SilentHandlerMonitorIframeForHash,l),new Promise((h,d)=>{e<$0&&s.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${$0}ms). This may result in timeouts.`);const g=window.setTimeout(()=>{window.clearInterval(p),d(Ue(Ex))},e),p=window.setInterval(()=>{let v="";const _=n.contentWindow;try{v=_?_.location.href:""}catch{}if(!v||v==="about:blank")return;let T="";_&&(c===kh.QUERY?T=_.location.search:T=_.location.hash),window.clearTimeout(g),window.clearInterval(p),h(T)},t)}).finally(()=>{Er(TR,W.RemoveHiddenIframe,s,a,l)(n)})}function vR(n,e,t,a){return t.addQueueMeasurement(W.SilentHandlerLoadFrame,a),new Promise((s,l)=>{const c=qh();window.setTimeout(()=>{if(!c){l("Unable to load iframe");return}c.src=n,s(c)},e)})}function yR(n){const e=qh();return e.src=n,e}function qh(){const n=document.createElement("iframe");return n.className="msalSilentIframe",n.style.visibility="hidden",n.style.position="absolute",n.style.width=n.style.height="0",n.style.border="0",n.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(n),n}function TR(n){document.body===n.parentNode&&document.body.removeChild(n)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class _R extends Co{constructor(e,t,a,s,l,c,h,d,g,p,v){super(e,t,a,s,l,c,d,p,v),this.apiId=h,this.nativeStorage=g}async acquireToken(e){this.performanceClient.addQueueMeasurement(W.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");const t={...e};t.prompt?t.prompt!==Wn.NONE&&t.prompt!==Wn.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Wn.NONE}`),t.prompt=Wn.NONE):t.prompt=Wn.NONE;const a=await ve(this.initializeAuthorizationRequest.bind(this),W.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,qe.Silent);return a.platformBroker=Jl(this.config,this.logger,this.platformAuthProvider,a.authenticationScheme),rS(a.authority),this.config.auth.protocolMode===rr.EAR?this.executeEarFlow(a):this.executeCodeFlow(a)}async executeCodeFlow(e){let t;const a=this.initializeServerTelemetryManager(this.apiId);try{return t=await ve(this.createAuthCodeClient.bind(this),W.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),await ve(this.silentTokenHelper.bind(this),W.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(t,e)}catch(s){if(s instanceof kt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),!t||!(s instanceof kt)||s.errorCode!==nr.INVALID_GRANT_ERROR)throw s;return this.performanceClient.addFields({retryError:s.errorCode},this.correlationId),await ve(this.silentTokenHelper.bind(this),W.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(t,e)}}async executeEarFlow(e){const t=e.correlationId,a=await ve(this.getDiscoveredAuthority.bind(this),W.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,t)({requestAuthority:e.authority,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account}),s=await ve(Yg,W.GenerateEarKey,this.logger,this.performanceClient,t)(),l={...e,earJwk:s},c=await ve(pR,W.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,t)(this.config,a,l,this.logger,this.performanceClient),h=this.config.auth.OIDCOptions.serverResponseType,d=await ve(oT,W.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,t)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,t,h),g=Er(Hl,W.DeserializeResponse,this.logger,this.performanceClient,t)(d,h,this.logger);return ve(om,W.HandleResponseEar,this.logger,this.performanceClient,t)(l,g,this.apiId,this.config,a,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}logout(){return Promise.reject(Ue(zh))}async silentTokenHelper(e,t){const a=t.correlationId;this.performanceClient.addQueueMeasurement(W.SilentIframeClientTokenHelper,a);const s=await ve(Vh,W.GeneratePkceCodes,this.logger,this.performanceClient,a)(this.performanceClient,this.logger,a),l={...t,codeChallenge:s.challenge};let c;if(t.httpMethod===ts.POST)c=await ve(mR,W.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(this.config,e.authority,l,this.logger,this.performanceClient);else{const p=await ve(am,W.GetAuthCodeUrl,this.logger,this.performanceClient,a)(this.config,e.authority,l,this.logger,this.performanceClient);c=await ve(gR,W.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,a)(p,this.performanceClient,this.logger,a,this.config.system.navigateFrameWait)}const h=this.config.auth.OIDCOptions.serverResponseType,d=await ve(oT,W.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,a)(c,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,a,h),g=Er(Hl,W.DeserializeResponse,this.logger,this.performanceClient,a)(d,h,this.logger);return ve(gh,W.HandleResponseCode,this.logger,this.performanceClient,a)(t,g,s.verifier,this.apiId,this.config,e,this.browserStorage,this.nativeStorage,this.eventHandler,this.logger,this.performanceClient,this.platformAuthProvider)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class xR extends Co{async acquireToken(e){this.performanceClient.addQueueMeasurement(W.SilentRefreshClientAcquireToken,e.correlationId);const t=await ve(nm,W.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),a={...e,...t};e.redirectUri&&(a.redirectUri=this.getRedirectUri(e.redirectUri));const s=this.initializeServerTelemetryManager(Nt.acquireTokenSilent_silentFlow),l=await this.createRefreshTokenClient({serverTelemetryManager:s,authorityUrl:a.authority,azureCloudOptions:a.azureCloudOptions,account:a.account});return ve(l.acquireTokenByRefreshToken.bind(l),W.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(a).catch(c=>{throw c.setCorrelationId(this.correlationId),s.cacheFailedRequest(c),c})}logout(){return Promise.reject(Ue(zh))}async createRefreshTokenClient(e){const t=await ve(this.getClientConfiguration.bind(this),W.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)({serverTelemetryManager:e.serverTelemetryManager,requestAuthority:e.authorityUrl,requestAzureCloudOptions:e.azureCloudOptions,requestExtraQueryParameters:e.extraQueryParameters,account:e.account});return new Lb(t,this.performanceClient)}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class SR{constructor(e,t,a,s){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=a,this.cryptoObj=s}async loadExternalTokens(e,t,a){if(!this.isBrowserEnvironment)throw Ue(Gh);const s=e.correlationId||na(),l=t.id_token?_o(t.id_token,Zr):void 0,c={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},h=e.authority?new Ln(Ln.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,c,this.logger,e.correlationId||na()):void 0,d=await this.loadAccount(e,a.clientInfo||t.client_info||"",s,l,h),g=await this.loadIdToken(t,d.homeAccountId,d.environment,d.realm,s),p=await this.loadAccessToken(e,t,d.homeAccountId,d.environment,d.realm,a,s),v=await this.loadRefreshToken(t,d.homeAccountId,d.environment,s);return this.generateAuthenticationResult(e,{account:d,idToken:g,accessToken:p,refreshToken:v},l,h)}async loadAccount(e,t,a,s,l){if(this.logger.verbose("TokenCache - loading account"),e.account){const g=ta.createFromAccountInfo(e.account);return await this.storage.setAccount(g,a),g}else if(!l||!t&&!s)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),Ue(Mx);const c=ta.generateHomeAccountId(t,l.authorityType,this.logger,this.cryptoObj,s),h=s?.tid,d=Dg(this.storage,l,c,Zr,a,s,t,l.hostnameAndPort,h,void 0,void 0,this.logger);return await this.storage.setAccount(d,a),d}async loadIdToken(e,t,a,s,l){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");const c=Fh(t,a,e.id_token,this.config.auth.clientId,s);return await this.storage.setIdTokenCredential(c,l),c}async loadAccessToken(e,t,a,s,l,c,h){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");const d=t.scope?sn.fromString(t.scope):new sn(e.scopes),g=c.expiresOn||t.expires_in+ir(),p=c.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+ir(),v=Lh(a,s,t.access_token,this.config.auth.clientId,l,d.printScopes(),g,p,Zr);return await this.storage.setAccessTokenCredential(v,h),v}async loadRefreshToken(e,t,a,s){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");const l=ax(t,a,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return await this.storage.setRefreshTokenCredential(l,s),l}generateAuthenticationResult(e,t,a,s){let l="",c=[],h=null,d;t?.accessToken&&(l=t.accessToken.secret,c=sn.fromString(t.accessToken.target).asArray(),h=co(t.accessToken.expiresOn),d=co(t.accessToken.extendedExpiresOn));const g=t.account;return{authority:s?s.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:c,account:g.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:a||{},accessToken:l,fromCache:!0,expiresOn:h,correlationId:e.correlationId||"",requestId:"",extExpiresOn:d,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:g.cloudGraphHostName||"",msGraphHost:g.msGraphHost||"",fromNativeBroker:!1}}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class CR extends hx{constructor(e){super(e),this.includeRedirectUri=!1}}/*! @azure/msal-browser v4.22.1 2025-09-09 */class ER extends Co{constructor(e,t,a,s,l,c,h,d,g,p){super(e,t,a,s,l,c,d,g,p),this.apiId=h}async acquireToken(e){if(!e.code)throw Ue(Dx);const t=await ve(this.initializeAuthorizationRequest.bind(this),W.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,qe.Silent),a=this.initializeServerTelemetryManager(this.apiId);try{const s={...t,code:e.code},l=await ve(this.getClientConfiguration.bind(this),W.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)({serverTelemetryManager:a,requestAuthority:t.authority,requestAzureCloudOptions:t.azureCloudOptions,requestExtraQueryParameters:t.extraQueryParameters,account:t.account}),c=new CR(l);this.logger.verbose("Auth code client created");const h=new lS(c,this.browserStorage,s,this.logger,this.performanceClient);return await ve(h.handleCodeResponseFromServer.bind(h),W.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(s){throw s instanceof kt&&(s.setCorrelationId(this.correlationId),a.cacheFailedRequest(s)),s}}logout(){return Promise.reject(Ue(zh))}}/*! @azure/msal-browser v4.22.1 2025-09-09 */function AR(n,e,t){const a=window.msal?.clientIds||[],s=a.length,l=a.filter(c=>c===n).length;l>1&&t.warning("There is already an instance of MSAL.js in the window with the same client id."),e.add({msalInstanceCount:s,sameClientIdInstanceCount:l})}/*! @azure/msal-browser v4.22.1 2025-09-09 */function ha(n){const e=n?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Du(n,e){try{Zg(n)}catch(t){throw e.end({success:!1},t),t}}class Yh{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Ha(this.logger,this.performanceClient):Zu,this.eventHandler=new qI(this.logger),this.browserStorage=this.isBrowserEnvironment?new Y0(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler,Ib(this.config.auth)):UI(this.config.auth.clientId,this.logger,this.performanceClient,this.eventHandler);const t={cacheLocation:on.MemoryStorage,cacheRetentionDays:5,temporaryCacheLocation:on.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new Y0(this.config.auth.clientId,t,this.browserCrypto,this.logger,this.performanceClient,this.eventHandler),this.tokenCache=new SR(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static async createController(e,t){const a=new Yh(e);return await a.initialize(t),a}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}async initialize(e,t){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, exiting early."),this.initialized=!0,this.eventHandler.emitEvent($e.INITIALIZE_END);return}const a=e?.correlationId||this.getRequestCorrelationId(),s=this.config.system.allowPlatformBroker,l=this.performanceClient.startMeasurement(W.InitializeClientApplication,a);if(this.eventHandler.emitEvent($e.INITIALIZE_START),!t)try{this.logMultipleInstances(l)}catch{}if(await ve(this.browserStorage.initialize.bind(this.browserStorage),W.InitializeCache,this.logger,this.performanceClient,a)(a),s)try{this.platformAuthProvider=await cR(this.logger,this.performanceClient,a,this.config.system.nativeBrokerHandshakeTimeout)}catch(c){this.logger.verbose(c)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),Er(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),W.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,a)(a)),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(a),this.initialized=!0,this.eventHandler.emitEvent($e.INITIALIZE_END),l.end({allowPlatformBroker:s,success:!0})}async handleRedirectPromise(e){if(this.logger.verbose("handleRedirectPromise called"),nS(this.initialized),this.isBrowserEnvironment){const t=e||"";let a=this.redirectResponse.get(t);return typeof a>"u"?(a=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,a),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),a}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null}async handleRedirectPromiseInternal(e){if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;if(this.browserStorage.getInteractionInProgress()?.type===pi.SIGNOUT)return this.logger.verbose("handleRedirectPromise removing interaction_in_progress flag and returning null after sign-out"),this.browserStorage.setInteractionInProgress(!1),Promise.resolve(null);const a=this.getAllAccounts(),s=this.browserStorage.getCachedNativeRequest(),l=s&&this.platformAuthProvider&&!e;let c;this.eventHandler.emitEvent($e.HANDLE_REDIRECT_START,qe.Redirect);let h;try{if(l&&this.platformAuthProvider){c=this.performanceClient.startMeasurement(W.AcquireTokenRedirect,s?.correlationId||""),this.logger.trace("handleRedirectPromise - acquiring token from native platform"),c.add({isPlatformBrokerRequest:!0});const d=new Xu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Nt.handleRedirectPromise,this.performanceClient,this.platformAuthProvider,s.accountId,this.nativeInternalStorage,s.correlationId);h=ve(d.handleRedirectPromise.bind(d),W.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,c.event.correlationId)(this.performanceClient,c.event.correlationId)}else{const[d,g]=this.browserStorage.getCachedRequest(),p=d.correlationId;c=this.performanceClient.startMeasurement(W.AcquireTokenRedirect,p),this.logger.trace("handleRedirectPromise - acquiring token from web flow");const v=this.createRedirectClient(p);h=ve(v.handleRedirectPromise.bind(v),W.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,c.event.correlationId)(e,d,g,c)}}catch(d){throw this.browserStorage.resetRequestCache(),d}return h.then(d=>(d?(this.browserStorage.resetRequestCache(),a.length<this.getAllAccounts().length?(this.eventHandler.emitEvent($e.LOGIN_SUCCESS,qe.Redirect,d),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Redirect,d),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),c.end({success:!0,accountType:ha(d.account)})):c.event.errorCode?c.end({success:!1}):c.discard(),this.eventHandler.emitEvent($e.HANDLE_REDIRECT_END,qe.Redirect),d)).catch(d=>{this.browserStorage.resetRequestCache();const g=d;throw a.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Redirect,null,g):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Redirect,null,g),this.eventHandler.emitEvent($e.HANDLE_REDIRECT_END,qe.Redirect),c.end({success:!1},g),d})}async acquireTokenRedirect(e){const t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);const a=this.performanceClient.startMeasurement(W.AcquireTokenPreRedirect,t);a.add({accountType:ha(e.account),scenarioId:e.scenarioId});const s=e.onRedirectNavigate;if(s)e.onRedirectNavigate=c=>{const h=typeof s=="function"?s(c):void 0;return a.add({navigateCallbackResult:h!==!1}),a.event=a.end({success:!0})||a.event,h};else{const c=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=h=>{const d=typeof c=="function"?c(h):void 0;return a.add({navigateCallbackResult:d!==!1}),a.event=a.end({success:!0})||a.event,d}}const l=this.getAllAccounts().length>0;try{Qy(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,pi.SIGNIN),l?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Redirect,e):this.eventHandler.emitEvent($e.LOGIN_START,qe.Redirect,e);let c;return this.platformAuthProvider&&this.canUsePlatformBroker(e)?c=new Xu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Nt.acquireTokenRedirect,this.performanceClient,this.platformAuthProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,a).catch(d=>{if(a.add({brokerErrorName:d.name,brokerErrorCode:d.errorCode}),d instanceof va&&ro(d))return this.platformAuthProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(d instanceof Hr)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw d}):c=this.createRedirectClient(t).acquireToken(e),await c}catch(c){throw this.browserStorage.resetRequestCache(),a.event.status===2?this.performanceClient.startMeasurement(W.AcquireTokenRedirect,t).end({success:!1},c):a.end({success:!1},c),l?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Redirect,null,c):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Redirect,null,c),c}}acquireTokenPopup(e){const t=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(W.AcquireTokenPopup,t);a.add({scenarioId:e.scenarioId,accountType:ha(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Du(this.initialized,a),this.browserStorage.setInteractionInProgress(!0,pi.SIGNIN)}catch(h){return Promise.reject(h)}const s=this.getAllAccounts();s.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Popup,e):this.eventHandler.emitEvent($e.LOGIN_START,qe.Popup,e);let l;const c=this.getPreGeneratedPkceCodes(t);return this.canUsePlatformBroker(e)?(a.add({isPlatformBrokerRequest:!0}),l=this.acquireTokenNative({...e,correlationId:t},Nt.acquireTokenPopup).then(h=>(a.end({success:!0,accountType:ha(h.account)}),h)).catch(h=>{if(a.add({brokerErrorName:h.name,brokerErrorCode:h.errorCode}),h instanceof va&&ro(h))return this.platformAuthProvider=void 0,this.createPopupClient(t).acquireToken(e,c);if(h instanceof Hr)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e,c);throw h})):l=this.createPopupClient(t).acquireToken(e,c),l.then(h=>(s.length<this.getAllAccounts().length?this.eventHandler.emitEvent($e.LOGIN_SUCCESS,qe.Popup,h):this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Popup,h),a.end({success:!0,accessTokenSize:h.accessToken.length,idTokenSize:h.idToken.length,accountType:ha(h.account)}),h)).catch(h=>(s.length>0?this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Popup,null,h):this.eventHandler.emitEvent($e.LOGIN_FAILURE,qe.Popup,null,h),a.end({success:!1},h),Promise.reject(h))).finally(async()=>{this.browserStorage.setInteractionInProgress(!1),this.config.system.asyncPopups&&await this.preGeneratePkceCodes(t)})}trackPageVisibilityWithMeasurement(){const e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}async ssoSilent(e){const t=this.getRequestCorrelationId(e),a={...e,prompt:e.prompt,correlationId:t};this.ssoSilentMeasurement=this.performanceClient.startMeasurement(W.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:ha(e.account)}),Du(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent($e.SSO_SILENT_START,qe.Silent,a);let s;return this.canUsePlatformBroker(a)?(this.ssoSilentMeasurement?.add({isPlatformBrokerRequest:!0}),s=this.acquireTokenNative(a,Nt.ssoSilent).catch(l=>{if(this.ssoSilentMeasurement?.add({brokerErrorName:l.name,brokerErrorCode:l.errorCode}),l instanceof va&&ro(l))return this.platformAuthProvider=void 0,this.createSilentIframeClient(a.correlationId).acquireToken(a);throw l})):s=this.createSilentIframeClient(a.correlationId).acquireToken(a),s.then(l=>(this.eventHandler.emitEvent($e.SSO_SILENT_SUCCESS,qe.Silent,l),this.ssoSilentMeasurement?.end({success:!0,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length,accountType:ha(l.account)}),l)).catch(l=>{throw this.eventHandler.emitEvent($e.SSO_SILENT_FAILURE,qe.Silent,null,l),this.ssoSilentMeasurement?.end({success:!1},l),l}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenByCode(e){const t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);const a=this.performanceClient.startMeasurement(W.AcquireTokenByCode,t);Du(this.initialized,a),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_START,qe.Silent,e),a.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw Ue(Fx);if(e.code){const s=e.code;let l=this.hybridAuthCodeResponses.get(s);return l?(this.logger.verbose("Existing acquireTokenByCode request found",t),a.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),l=this.acquireTokenByCodeAsync({...e,correlationId:t}).then(c=>(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_SUCCESS,qe.Silent,c),this.hybridAuthCodeResponses.delete(s),a.end({success:!0,accessTokenSize:c.accessToken.length,idTokenSize:c.idToken.length,accountType:ha(c.account)}),c)).catch(c=>{throw this.hybridAuthCodeResponses.delete(s),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_FAILURE,qe.Silent,null,c),a.end({success:!1},c),c}),this.hybridAuthCodeResponses.set(s,l)),await l}else if(e.nativeAccountId)if(this.canUsePlatformBroker(e,e.nativeAccountId)){a.add({isPlatformBrokerRequest:!0});const s=await this.acquireTokenNative({...e,correlationId:t},Nt.acquireTokenByCode,e.nativeAccountId).catch(l=>{throw l instanceof va&&ro(l)&&(this.platformAuthProvider=void 0),a.add({brokerErrorName:l.name,brokerErrorCode:l.errorCode}),l});return a.end({accountType:ha(s.account),success:!0}),s}else throw Ue(Lx);else throw Ue(Px)}catch(s){throw this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_BY_CODE_FAILURE,qe.Silent,null,s),a.end({success:!1},s),s}}async acquireTokenByCodeAsync(e){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(W.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),await this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(s=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:s.fromCache}),s)).catch(s=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},s),s}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})}async acquireTokenFromCache(e,t){switch(this.performanceClient.addQueueMeasurement(W.AcquireTokenFromCache,e.correlationId),t){case Vn.Default:case Vn.AccessToken:case Vn.AccessTokenAndRefreshToken:const a=this.createSilentCacheClient(e.correlationId);return ve(a.acquireToken.bind(a),W.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw we(xi)}}async acquireTokenByRefreshToken(e,t){switch(this.performanceClient.addQueueMeasurement(W.AcquireTokenByRefreshToken,e.correlationId),t){case Vn.Default:case Vn.AccessTokenAndRefreshToken:case Vn.RefreshToken:case Vn.RefreshTokenAndNetwork:const a=this.createSilentRefreshClient(e.correlationId);return ve(a.acquireToken.bind(a),W.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw we(xi)}}async acquireTokenBySilentIframe(e){this.performanceClient.addQueueMeasurement(W.AcquireTokenBySilentIframe,e.correlationId);const t=this.createSilentIframeClient(e.correlationId);return ve(t.acquireToken.bind(t),W.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)}async logout(e){const t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect({correlationId:t,...e})}async logoutRedirect(e){const t=this.getRequestCorrelationId(e);return Qy(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0,pi.SIGNOUT),this.createRedirectClient(t).logout(e)}logoutPopup(e){try{const t=this.getRequestCorrelationId(e);return Zg(this.initialized),this.browserStorage.setInteractionInProgress(!0,pi.SIGNOUT),this.createPopupClient(t).logout(e).finally(()=>{this.browserStorage.setInteractionInProgress(!1)})}catch(t){return Promise.reject(t)}}async clearCache(e){if(!this.isBrowserEnvironment){this.logger.info("in non-browser environment, returning early.");return}const t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)}getAllAccounts(e){const t=this.getRequestCorrelationId();return BI(this.logger,this.browserStorage,this.isBrowserEnvironment,t,e)}getAccount(e){const t=this.getRequestCorrelationId();return HI(e,this.logger,this.browserStorage,t)}getAccountByUsername(e){const t=this.getRequestCorrelationId();return jI(e,this.logger,this.browserStorage,t)}getAccountByHomeId(e){const t=this.getRequestCorrelationId();return zI(e,this.logger,this.browserStorage,t)}getAccountByLocalId(e){const t=this.getRequestCorrelationId();return GI(e,this.logger,this.browserStorage,t)}setActiveAccount(e){const t=this.getRequestCorrelationId();$I(e,this.browserStorage,t)}getActiveAccount(){const e=this.getRequestCorrelationId();return KI(this.browserStorage,e)}async hydrateCache(e,t){this.logger.verbose("hydrateCache called");const a=ta.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return await this.browserStorage.setAccount(a,e.correlationId),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)}async acquireTokenNative(e,t,a,s){if(this.logger.trace("acquireTokenNative called"),!this.platformAuthProvider)throw Ue(Gg);return new Xu(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.platformAuthProvider,a||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e,s)}canUsePlatformBroker(e,t){if(this.logger.trace("canUsePlatformBroker called"),!this.platformAuthProvider)return this.logger.trace("canUsePlatformBroker: platform broker unavilable, returning false"),!1;if(!Jl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme))return this.logger.trace("canUsePlatformBroker: isBrokerAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Wn.NONE:case Wn.CONSENT:case Wn.LOGIN:this.logger.trace("canUsePlatformBroker: prompt is compatible with platform broker flow");break;default:return this.logger.trace(`canUsePlatformBroker: prompt = ${e.prompt} is not compatible with platform broker flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUsePlatformBroker: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){const t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new hR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createRedirectClient(e){return new dR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentIframeClient(e){return new _R(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Nt.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.platformAuthProvider,e)}createSilentCacheClient(e){return new uS(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentRefreshClient(e){return new xR(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.platformAuthProvider,e)}createSilentAuthCodeClient(e){return new ER(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,Nt.acquireTokenByCode,this.performanceClient,this.platformAuthProvider,e)}addEventCallback(e,t){return this.eventHandler.addEventCallback(e,t)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return tS(),this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){if(this.config.cache.cacheLocation!==on.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.subscribeCrossTab()}disableAccountStorageEvents(){if(this.config.cache.cacheLocation!==on.LocalStorage){this.logger.info("Account storage events are only available when cacheLocation is set to localStorage");return}this.eventHandler.unsubscribeCrossTab()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?na():ye.EMPTY_STRING}async loginRedirect(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect({correlationId:t,...e||Vy})}loginPopup(e){const t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup({correlationId:t,...e||Vy})}async acquireTokenSilent(e){const t=this.getRequestCorrelationId(e),a=this.performanceClient.startMeasurement(W.AcquireTokenSilent,t);a.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Du(this.initialized,a),this.logger.verbose("acquireTokenSilent called",t);const s=e.account||this.getActiveAccount();if(!s)throw Ue(Ix);return a.add({accountType:ha(s)}),this.acquireTokenSilentDeduped(e,s,t).then(l=>(a.end({success:!0,fromCache:l.fromCache,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),{...l,state:e.state,correlationId:t})).catch(l=>{throw l instanceof kt&&l.setCorrelationId(t),a.end({success:!1},l),l})}async acquireTokenSilentDeduped(e,t,a){const s=Uh(this.config.auth.clientId,{...e,authority:e.authority||this.config.auth.authority},t.homeAccountId),l=JSON.stringify(s),c=this.activeSilentTokenRequests.get(l);if(typeof c>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",a),this.performanceClient.addFields({deduped:!1},a);const h=ve(this.acquireTokenSilentAsync.bind(this),W.AcquireTokenSilentAsync,this.logger,this.performanceClient,a)({...e,correlationId:a},t);return this.activeSilentTokenRequests.set(l,h),h.finally(()=>{this.activeSilentTokenRequests.delete(l)})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",a),this.performanceClient.addFields({deduped:!0},a),c}async acquireTokenSilentAsync(e,t){const a=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(W.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_START,qe.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",a);const s=await ve(YI,W.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),l=e.cacheLookupPolicy||Vn.Default;return this.acquireTokenSilentNoIframe(s,l).catch(async h=>{if(wR(h,l))if(this.activeIframeRequest)if(l!==Vn.Skip){const[g,p]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${p}`,s.correlationId);const v=this.performanceClient.startMeasurement(W.AwaitConcurrentIframe,s.correlationId);v.add({awaitIframeCorrelationId:p});const _=await g;if(v.end({success:_}),_)return this.logger.verbose(`Parallel iframe request with correlationId: ${p} succeeded. Retrying cache and/or RT redemption`,s.correlationId),this.acquireTokenSilentNoIframe(s,l);throw this.logger.info(`Iframe request with correlationId: ${p} failed. Interaction is required.`),h}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",s.correlationId),ve(this.acquireTokenBySilentIframe.bind(this),W.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s);else{let g;return this.activeIframeRequest=[new Promise(p=>{g=p}),s.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",s.correlationId),ve(this.acquireTokenBySilentIframe.bind(this),W.AcquireTokenBySilentIframe,this.logger,this.performanceClient,s.correlationId)(s).then(p=>(g(!0),p)).catch(p=>{throw g(!1),p}).finally(()=>{this.activeIframeRequest=void 0})}else throw h}).then(h=>(this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_SUCCESS,qe.Silent,h),e.correlationId&&this.performanceClient.addFields({fromCache:h.fromCache},e.correlationId),h)).catch(h=>{throw this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_FAILURE,qe.Silent,null,h),h}).finally(()=>{document.removeEventListener("visibilitychange",a)})}async acquireTokenSilentNoIframe(e,t){return Jl(this.config,this.logger,this.platformAuthProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.performanceClient.addFields({isPlatformBrokerRequest:!0},e.correlationId),this.acquireTokenNative(e,Nt.acquireTokenSilent_silentFlow,e.account.nativeAccountId,t).catch(async a=>{throw this.performanceClient.addFields({brokerErrorName:a.name,brokerErrorCode:a.errorCode},e.correlationId),a instanceof va&&ro(a)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.platformAuthProvider=void 0,we(xi)):a})):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),t===Vn.AccessToken&&this.logger.verbose("acquireTokenSilent - cache lookup policy set to AccessToken, attempting to acquire token from local cache"),ve(this.acquireTokenFromCache.bind(this),W.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(a=>{if(t===Vn.AccessToken)throw a;return this.eventHandler.emitEvent($e.ACQUIRE_TOKEN_NETWORK_START,qe.Silent,e),ve(this.acquireTokenByRefreshToken.bind(this),W.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))}async preGeneratePkceCodes(e){return this.logger.verbose("Generating new PKCE codes"),this.pkceCode=await ve(Vh,W.GeneratePkceCodes,this.logger,this.performanceClient,e)(this.performanceClient,this.logger,e),Promise.resolve()}getPreGeneratedPkceCodes(e){this.logger.verbose("Attempting to pick up pre-generated PKCE codes");const t=this.pkceCode?{...this.pkceCode}:void 0;return this.pkceCode=void 0,this.logger.verbose(`${t?"Found":"Did not find"} pre-generated PKCE codes`),this.performanceClient.addFields({usePreGeneratedPkce:!!t},e),t}logMultipleInstances(e){const t=this.config.auth.clientId;if(!window)return;window.msal=window.msal||{},window.msal.clientIds=window.msal.clientIds||[],window.msal.clientIds.length>0&&this.logger.verbose("There is already an instance of MSAL.js in the window."),window.msal.clientIds.push(t),AR(t,e,this.logger)}}function wR(n,e){const t=!(n instanceof Hr&&n.subError!==Hh),a=n.errorCode===nr.INVALID_GRANT_ERROR||n.errorCode===xi,s=t&&a||n.errorCode===lh||n.errorCode===Og,l=nI.includes(e);return s&&l}/*! @azure/msal-browser v4.22.1 2025-09-09 */async function bR(n,e){const t=new os(n);return await t.initialize(),Yh.createController(t,e)}/*! @azure/msal-browser v4.22.1 2025-09-09 */class cm{static async createPublicClientApplication(e){const t=await bR(e);return new cm(e,t)}constructor(e,t){this.isBroker=!1,this.controller=t||new Yh(new os(e))}async initialize(e){return this.controller.initialize(e,this.isBroker)}async acquireTokenPopup(e){return this.controller.acquireTokenPopup(e)}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e,t){return this.controller.addEventCallback(e,t)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}async hydrateCache(e,t){return this.controller.hydrateCache(e,t)}clearCache(e){return this.controller.clearCache(e)}}const _r=new cm({auth:{clientId:"60d9a880-0f6c-4e14-b17a-1cc06ea9ba8a",authority:"https://login.microsoftonline.com/cd48ecd9-7e15-4f4b-97d9-ec813ee42b2c",redirectUri:window.location.origin},cache:{cacheLocation:"localStorage"}}),X0=["User.Read","Sites.ReadWrite.All"];async function lT(){let n=_r.getActiveAccount()??_r.getAllAccounts()[0]??null;return n||(await _r.loginPopup({scopes:X0,prompt:"select_account"}),n=_r.getAllAccounts()[0]),_r.setActiveAccount(n),n}async function IR(){const n=_r.getActiveAccount()??_r.getAllAccounts()[0];if(!n)throw new Error("No hay sesión. Llama a ensureLogin() primero.");try{return(await _r.acquireTokenSilent({scopes:X0,account:n})).accessToken}catch(e){if(e instanceof Hr)return(await _r.acquireTokenPopup({scopes:X0,account:n})).accessToken;throw e}}async function RR(){const n=_r.getActiveAccount()??_r.getAllAccounts()[0];await _r.logoutPopup({account:n})}const dS=V.createContext(null),NR=({children:n})=>{const[e,t]=V.useState(!1),[a,s]=V.useState(null);V.useEffect(()=>{let g=!1;return(async()=>{try{const p=await lT();g||(s(p),t(!0))}catch(p){g||t(!0),console.error("[AuthProvider] ensureLogin error:",p)}})(),()=>{g=!0}},[]);const l=V.useCallback(async()=>{const g=await lT();s(g),t(!0)},[]),c=V.useCallback(async()=>{await RR(),s(null),t(!0)},[]),h=V.useCallback(async()=>await IR(),[]),d=V.useMemo(()=>({ready:e,account:a,getToken:h,signIn:l,signOut:c}),[e,a,h,l,c]);return y.jsx(dS.Provider,{value:d,children:n})};function Xh(){const n=V.useContext(dS);if(!n)throw new Error("useAuth must be used within <AuthProvider>");return n}class gS{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="ParkingSlots"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title,TipoCelda:t.TipoCelda,Itinerancia:t.Itinerancia,Activa:t.Activa}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByCodigo(e,t=1){await this.ensureIds();const a=new URLSearchParams({$expand:"fields",$filter:`fields/Codigo eq '${this.esc(e)}'`,$top:String(t)});return((await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${a.toString()}`)).value??[]).map(l=>this.toModel(l))}async getDisponibles(e=100){return this.getAll({filter:"fields/Disponible eq true",orderby:"fields/Codigo asc",top:e})}}class mS{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Colaboradores fijos"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:Number(e?.id??NaN),Title:t.Title,Correo:t.Correo,Tipodevehiculo:t.Tipodevehiculo,Placa:t.Placa,CodigoCelda:t.CodigoCelda,SpotAsignado:t.SpotAsignado}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async getAllPaged(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return{data:(a.value??[]).map(s=>this.toModel(s)),nextLink:a["@odata.nextLink"]}}async getNextPage(e){const t=await this.graph.get(e.replace("https://graph.microsoft.com/v1.0",""));return{data:(t.value??[]).map(a=>this.toModel(a)),nextLink:t["@odata.nextLink"]}}}class um{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Reservations"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title??"",NombreUsuario:t.NombreUsuario??void 0,Date:t.Date??void 0,Turn:t.Turn??void 0,SpotIdLookupId:typeof t.SpotIdLookupId=="number"?t.SpotIdLookupId:null,SpotId:t.SpotId??null,VehivleType:t.VehivleType??void 0,Status:t.Status??void 0,OData__ColorTag:t.OData__ColorTag??void 0,Modified:t.Modified??void 0,Created:t.Created??void 0,AuthorLookupId:typeof t.AuthorLookupId=="number"?t.AuthorLookupId:null,EditorLookupId:typeof t.EditorLookupId=="number"?t.EditorLookupId:null}}async create(e){await this.ensureIds();const t={Title:e.Title,NombreUsuario:e.NombreUsuario,Date:e.Date,Turn:e.Turn,SpotIdLookupId:e.SpotIdLookupId??void 0,VehivleType:e.VehivleType,Status:e.Status,OData__ColorTag:e.OData__ColorTag},a=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:t});return this.toModel(a)}async update(e,t){await this.ensureIds();const a={};t.Title!==void 0&&(a.Title=t.Title),t.NombreUsuario!==void 0&&(a.NombreUsuario=t.NombreUsuario),t.Date!==void 0&&(a.Date=t.Date),t.Turn!==void 0&&(a.Turn=t.Turn),t.SpotIdLookupId!==void 0&&(a.SpotIdLookupId=t.SpotIdLookupId),t.VehivleType!==void 0&&(a.VehivleType=t.VehivleType),t.Status!==void 0&&(a.Status=t.Status),t.OData__ColorTag!==void 0&&(a.OData__ColorTag=t.OData__ColorTag),Object.keys(a).length>0&&await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,a);const l=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(l)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findBySpotId(e,t=100){return this.getAll({filter:`fields/SpotIdLookupId eq ${e}`,orderby:"fields/Date asc",top:t})}async findByDateRange(e,t,a=200){const s=this.esc(e),l=this.esc(t);return this.getAll({filter:`(fields/Date ge '${s}' and fields/Date le '${l}')`,orderby:"fields/Date asc",top:a})}async findByUser(e,t=100){return this.getAll({filter:`fields/NombreUsuario eq '${this.esc(e)}'`,orderby:"fields/Date desc",top:t})}}class kR{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="UsuariosParking"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:Number(e?.id??""),Title:t.Title,Rol:t.Rol}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByCorreo(e,t=10){return this.getAll({filter:`fields/Correo eq '${this.esc(e)}'`,orderby:"fields/Title asc",top:t})}}class OR{graph;hostname;sitePath;listName;siteId;listId;constructor(e,t="estudiodemoda.sharepoint.com",a="/sites/TransformacionDigital/IN/SA",s="Pico y Placa"){this.graph=e,this.hostname=t,this.sitePath=a.startsWith("/")?a:`/${a}`,this.listName=s}esc(e){return String(e).replace(/'/g,"''")}loadCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`,t=localStorage.getItem(e);if(t){const{siteId:a,listId:s}=JSON.parse(t);this.siteId=a||this.siteId,this.listId=s||this.listId}}catch{}}saveCache(){try{const e=`sp:${this.hostname}${this.sitePath}:${this.listName}`;localStorage.setItem(e,JSON.stringify({siteId:this.siteId,listId:this.listId}))}catch{}}async ensureIds(){if((!this.siteId||!this.listId)&&this.loadCache(),!this.siteId){const e=await this.graph.get(`/sites/${this.hostname}:${this.sitePath}`);if(this.siteId=e?.id,!this.siteId)throw new Error("No se pudo resolver siteId");this.saveCache()}if(!this.listId){const t=(await this.graph.get(`/sites/${this.siteId}/lists?$filter=displayName eq '${this.esc(this.listName)}'`))?.value?.[0];if(!t?.id)throw new Error(`Lista no encontrada: ${this.listName}`);this.listId=t.id,this.saveCache()}}toModel(e){const t=e?.fields??{};return{ID:String(e?.id??""),Title:t.Title,Moto:t.Moto,Carro:t.Carro}}async create(e){await this.ensureIds();const t=await this.graph.post(`/sites/${this.siteId}/lists/${this.listId}/items`,{fields:e});return this.toModel(t)}async update(e,t){await this.ensureIds(),await this.graph.patch(`/sites/${this.siteId}/lists/${this.listId}/items/${e}/fields`,t);const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(a)}async delete(e){await this.ensureIds(),await this.graph.delete(`/sites/${this.siteId}/lists/${this.listId}/items/${e}`)}async get(e){await this.ensureIds();const t=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items/${e}?$expand=fields`);return this.toModel(t)}async getAll(e){await this.ensureIds();const t=new URLSearchParams({$expand:"fields"});e?.filter&&t.set("$filter",e.filter),e?.orderby&&t.set("$orderby",e.orderby),e?.top!=null&&t.set("$top",String(e.top));const a=await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${t.toString()}`);return(Array.isArray(a?.value)?a.value:[]).map(l=>this.toModel(l))}async findByDia(e,t,a=!0){await this.ensureIds();const s=[`fields/Dia eq '${this.esc(e)}'`];t&&s.push(`fields/TipoVehiculo eq '${this.esc(t)}'`),a&&s.push("(fields/Activo eq true or not(fields/Activo))");const l=new URLSearchParams({$expand:"fields",$filter:s.join(" and "),$orderby:"fields/Inicio asc",$top:"100"});return((await this.graph.get(`/sites/${this.siteId}/lists/${this.listId}/items?${l.toString()}`)).value??[]).map(h=>this.toModel(h))}async isRestringido(e,t,a){const l=["Domingo","Lunes","Martes","Miércoles","Jueves","Viernes","Sábado"][t.getDay()],c=`${String(t.getHours()).padStart(2,"0")}:${String(t.getMinutes()).padStart(2,"0")}`,h=await this.findByDia(l,a,!0),d=e.replace(/\D/g,"").slice(-1);if(!d)return!1;const g=v=>{if(!v||!/^\d{2}:\d{2}$/.test(v))return null;const[_,T]=v.split(":").map(Number);return _*60+T},p=g(c);for(const v of h){if(!String(v.Digitos??"").split(/[,\s]+/).filter(Boolean).some(A=>{if(/^\d$/.test(A))return A===d;if(/^\d-\d$/.test(A)){const[B,k]=A.split("-").map(Number);return Number(d)>=B&&Number(d)<=k}return!1}))continue;const C=g(v.Inicio),x=g(v.Fin);if(C==null||x==null||p==null||p>=C&&p<=x)return!0}return!1}}class MR{usuariosSvc;constructor(e){this.usuariosSvc=e}async getRole(e){if(!e)return"Usuario";const a=String(e).replace(/'/g,"''").toLowerCase();try{const l=(await this.usuariosSvc.getAll({filter:`tolower(fields/Correo) eq '${a}'`,orderby:"fields/Title asc",top:1}))[0];if(l?.Rol)return l.Rol;const h=(await this.usuariosSvc.getAll({filter:`tolower(fields/Title) eq '${a}'`,orderby:"fields/Title asc",top:1}))[0];return h?.Rol?h.Rol:"Usuario"}catch(s){return console.error("[SharedServices.getRole] error:",s),"Usuario"}}}const pS=V.createContext(null),DR={hostname:"estudiodemoda.sharepoint.com",sitePath:"/sites/TransformacionDigital/IN/SA",lists:{parkingSlots:"parkingslots",colaboradoresFijos:"Colaboradores fijos",reservations:"reservations",usuariosParking:"usuariosparking",settings:"settings",picoYPlaca:"pico y placa"}},PR=({children:n,config:e})=>{const{getToken:t}=Xh(),a=V.useMemo(()=>{const c=DR,h=e?.sitePath??c.sitePath;return{hostname:e?.hostname??c.hostname,sitePath:h.startsWith("/")?h:`/${h}`,lists:{parkingSlots:e?.lists?.parkingSlots??c.lists.parkingSlots,colaboradoresFijos:e?.lists?.colaboradoresFijos??c.lists.colaboradoresFijos,reservations:e?.lists?.reservations??c.lists.reservations,usuariosParking:e?.lists?.usuariosParking??c.lists.usuariosParking,settings:e?.lists?.settings??c.lists.settings,picoYPlaca:e?.lists?.picoYPlaca??c.lists.picoYPlaca}}},[e]),s=V.useMemo(()=>new mo(t),[t]),l=V.useMemo(()=>{const{hostname:c,sitePath:h,lists:d}=a,g=new gS(s,c,h,d.parkingSlots),p=new mS(s,c,h,d.colaboradoresFijos),v=new um(s,c,h,d.reservations),_=new kR(s,c,h,d.usuariosParking),T=new yw(s,c,h,d.settings),C=new OR(s,c,h,d.picoYPlaca),x=new MR(_);return{graph:s,parkingSlots:g,colaboradoresFijos:p,reservations:v,usuariosParking:_,settings:T,picoYPlaca:C,shared:x}},[s,a]);return y.jsx(pS.Provider,{value:l,children:n})};function Ri(){const n=V.useContext(pS);if(!n)throw new Error("useGraphServices debe usarse dentro de <GraphServicesProvider>.");return n}const FR=({open:n,title:e="Confirmar",children:t,confirmText:a="Confirmar",cancelText:s="Cancelar",onConfirm:l,onClose:c,showTerms:h=!1,settingsItemId:d="1",termsField:g="TerminosyCondiciones"})=>{const{settings:p}=Ri(),[v,_]=V.useState(""),[T,C]=V.useState(!1),[x,A]=V.useState(null),[B,k]=V.useState(!1);if(V.useEffect(()=>{n&&(k(!1),_(""),A(null))},[n]),V.useEffect(()=>{if(!n||!h)return;let H=!1;return(async()=>{try{C(!0),A(null);const Y=await p.get(String(d)),I=Y?.[g]??Y?.TerminosyCondiciones??"";if(H)return;if(!I||typeof I!="string")throw new Error(`No se encontró contenido en Settings.${g}`);_(I)}catch(Y){H||A(Y?.message??"Error al cargar Términos y Condiciones.")}finally{H||C(!1)}})(),()=>{H=!0}},[n,h,d,g,p]),!n)return null;const O=H=>{H.target===H.currentTarget&&c()},j=!h||B&&!T&&!x;return y.jsx("div",{className:ua.backdrop,onMouseDown:O,"aria-modal":"true",role:"dialog","aria-label":e,children:y.jsxs("div",{className:ua.modal,role:"document",children:[y.jsxs("header",{className:ua.header,children:[y.jsx("h3",{className:ua.title,children:e}),y.jsx("button",{className:ua.close,onClick:c,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{className:ua.body,children:[t,h&&y.jsxs("section",{style:{marginTop:12},children:[y.jsx("h4",{style:{margin:"8px 0"},children:"Términos y Condiciones"}),T&&y.jsx("div",{className:"muted",style:{fontSize:12},children:"Cargando Términos y Condiciones…"}),x&&y.jsx("div",{style:{color:"crimson",fontSize:12},children:x}),!T&&!x&&y.jsx("div",{className:ua.termsBox,dangerouslySetInnerHTML:{__html:v}}),y.jsxs("label",{style:{display:"flex",alignItems:"center",gap:8,marginTop:10,fontSize:13},children:[y.jsx("input",{type:"checkbox",checked:B,onChange:H=>k(H.target.checked),disabled:T||!!x}),"Acepto los Términos y Condiciones"]})]})]}),y.jsxs("footer",{className:ua.footer,children:[y.jsx("button",{className:ua.btnGhost,onClick:c,children:s}),y.jsx("button",{className:ua.btnPrimary,onClick:l,disabled:!j,title:j?void 0:"Debes aceptar los Términos y Condiciones",children:a})]})]})})};var LR=n_();const UR="_container_1dr80_1",BR="_toast_1dr80_19",HR="_slideIn_1dr80_1",jR="_success_1dr80_45",zR="_error_1dr80_47",GR="_info_1dr80_49",S0={container:UR,toast:BR,slideIn:HR,success:jR,error:zR,info:GR},vS=V.createContext(null),$R=()=>{const n=V.useContext(vS);if(!n)throw new Error("useToast debe usarse dentro de <ToastProvider>");return n},KR=({children:n})=>{const[e,t]=V.useState([]),a=c=>t(h=>h.filter(d=>d.id!==c)),s=V.useCallback((c,h="info",d=3500)=>{const g=crypto.randomUUID?.()??String(Date.now()+Math.random()),p={id:g,kind:h,message:c,duration:d};t(v=>[...v,p]),window.setTimeout(()=>a(g),d)},[]),l=V.useMemo(()=>({show:(c,h="info",d=3500)=>s(c,h,d),success:(c,h=3500)=>s(c,"success",h),error:(c,h=4500)=>s(c,"error",h),info:(c,h=3500)=>s(c,"info",h)}),[s]);return y.jsxs(vS.Provider,{value:l,children:[n,LR.createPortal(y.jsx("div",{className:S0.container,children:e.map(c=>y.jsx("div",{className:`${S0.toast} ${S0[c.kind]}`,onMouseEnter:()=>a(c.id),role:"status","aria-live":"polite",children:c.message},c.id))}),document.body)]})};function yS(){const[n,e]=V.useState(null),[t,a]=V.useState(!0),[s,l]=V.useState(null);return V.useEffect(()=>{let c=!1;const h=r_();return(async()=>{try{a(!0),l(null);const d=await h.getOne();c||e({InicioManana:d.InicioManana,FinalManana:d.FinalManana,InicioTarde:d.InicioTarde,FinalTarde:d.FinalTarde})}catch(d){c||l(d?.message??"No se pudieron cargar los horarios")}finally{c||a(!1)}})(),()=>{c=!0}},[]),{hours:n,loading:t,error:s}}const VR=4;function qR(n,e,t,a,s,l){const[c,h]=V.useState(null),[d,g]=V.useState(null),[p,v]=V.useState(!0),[_,T]=V.useState(null);V.useEffect(()=>{const B=new Date;(async()=>{try{v(!0);const O=(await t.get("1"))?.VisibleDays??3;h(bw(B,O)),g(B)}catch(k){T(k?.message??"Error cargando configuración")}finally{v(!1)}})()},[t]);const C=V.useCallback(async(B,k,O)=>{const j=await n.getAll({filter:[`fields/SpotIdLookupId eq ${Number(B)}`,`fields/Date eq '${k}'`,`fields/Turn eq '${O}'`,"(fields/Status ne 'Cancelada')"].join(" and "),top:1e3,orderby:"fields/ID asc"});return Array.isArray(j)?j.length:0},[n]),x=V.useCallback(async(B,k,O)=>{if(!B?.trim()||!k)return!1;const j=B.replace(/'/g,"''"),H=await n.getAll({filter:[`fields/Title eq '${j}'`,`fields/Date eq '${k}'`,"(fields/Status ne 'Cancelada')",`fields/Turn eq '${O}'`].join(" and "),top:1,orderby:"fields/ID asc"});return Array.isArray(H)&&H.length>0},[n]),A=V.useCallback(async({vehicle:B,turn:k,dateISO:O})=>{if(await x(a,O,k))return{ok:!1,message:`No puedes reservar: ya tienes una reserva activa para el ${O} en el turno de la ${k}.`};const j=await e.getAll({filter:["(fields/Activa eq 'Activa')",`fields/TipoCelda eq '${B}'`,"fields/Itinerancia eq 'Empleado Itinerante'"].join(" and "),top:2e3,orderby:"fields/Title asc"});if(!Array.isArray(j)||j.length===0)return{ok:!1,message:`No existen celdas activas para ${B}.`};const H=k==="Dia"?["Manana","Tarde"]:[k];for(const I of j){const G=I.ID??I.Id??I.id;if(G==null)continue;let q=!0;for(const J of H){const he=await C(G,O,J);if(B==="Carro"){if(he>=1){q=!1;break}}else if(he>=VR){q=!1;break}}if(!q)continue;const ie=k==="Dia"?["Manana","Tarde"]:[k];try{let J=null;for(const je of ie){const ke={Title:a,Date:O,Turn:je,SpotIdLookupId:Number(G),VehicleType:B,Status:"Activa",NombreUsuario:s};J=await n.create(ke)}await l?.onAfterReserve?.();const he=I.Title??I.Code??I.Name??G;return{ok:!0,message:k==="Dia"?`Reserva de día completo creada en celda ${he} para ${O}.`:`Reserva creada en celda ${he} para ${O} (${k}).`,reservation:J}}catch{continue}}const Y=k==="Dia"?"día completo":String(k).toLowerCase();return{ok:!1,message:`No hay parqueaderos disponibles para ${B} el ${O} en ${Y}.`}},[n,e,x,C,a,s,l]);return{minDate:d,maxDate:c,loading:p,error:_,reservar:A}}const YR=({userEmail:n,userName:e})=>{const{reservations:t,settings:a,parkingSlots:s}=Ri(),{minDate:l,maxDate:c,reservar:h,loading:d,error:g}=qR(t,s,a,n,e),{hours:p,loading:v,error:_}=yS(),T=V.useMemo(()=>Sy(l),[l]),C=V.useMemo(()=>Sy(c),[c]),[x,A]=V.useState("Carro"),[B,k]=V.useState("Manana"),[O,j]=V.useState(""),H=Te=>{if(Te==null||Number.isNaN(Te))return"--:--";const U=Math.max(0,Math.min(23,Math.floor(Te)));return`${String(U).padStart(2,"0")}:00`},[Y,I]=V.useState(!1),[G,q]=V.useState(!1),[ie,J]=V.useState(null),he=!O||!T||!C||v||!!_||!p;V.useEffect(()=>{if(!T||!C)return;const Te=new Date().toISOString().slice(0,10),U=(ue,b,L)=>ue<b?b:ue>L?L:ue;j(ue=>ue||U(Te,T,C))},[T,C]);const Ae=$R();async function je(){try{q(!0),J(null);const Te=await h({vehicle:x,turn:B,dateISO:O,userEmail:n});Te.ok?(I(!1),Ae.success(Te.message)):(J(Te.message),Ae.error(Te.message))}catch(Te){const U=Te?.message??"Error inesperado al reservar";J(U),Ae.error(U)}finally{q(!1)}}if(d||v)return y.jsx("div",{className:pr.wrapper,children:"Cargando…"});if(g||_)return y.jsx("div",{className:pr.wrapper,children:y.jsxs("div",{className:pr.error,children:["Error: ",g||_]})});if(!p)return y.jsx("div",{className:pr.wrapper,children:"Sin configuración de horarios."});const{InicioManana:ke,FinalManana:re,InicioTarde:xe,FinalTarde:fe}=p;return y.jsxs("div",{className:pr.wrapper,children:[y.jsxs("div",{className:pr.toolbar,children:[y.jsxs("label",{className:pr.label,children:["Fecha:",y.jsx("input",{className:pr.input,type:"date",min:T||void 0,max:C||void 0,value:O,onChange:Te=>j(Te.target.value)})]}),y.jsxs("label",{className:pr.label,children:["Turno:",y.jsxs("select",{className:pr.select,value:B,onChange:Te=>k(Te.target.value),children:[y.jsxs("option",{value:"Manana",children:["Mañana (",H(ke),"–",H(re),")"]}),y.jsxs("option",{value:"Tarde",children:["Tarde (",H(xe),"–",H(fe),")"]}),y.jsx("option",{value:"Dia",children:"Día completo"})]})]}),y.jsxs("label",{className:pr.label,children:["Vehículo:",y.jsxs("select",{className:pr.select,value:x,onChange:Te=>A(Te.target.value),children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsx("button",{className:pr.button,onClick:()=>I(!0),disabled:he,children:"Reservar"})]}),y.jsxs(FR,{open:Y,title:"Confirmar reserva",onClose:()=>!G&&I(!1),onConfirm:je,confirmText:G?"Guardando…":"Confirmar",cancelText:"Cancelar",showTerms:!0,settingsItemId:"1",termsField:"TerminosyCondiciones",children:[y.jsxs("p",{children:[y.jsx("strong",{children:"Fecha:"})," ",O]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Turno:"})," ",B==="Dia"?"Día completo":B]}),y.jsxs("p",{children:[y.jsx("strong",{children:"Vehículo:"})," ",x]}),ie&&y.jsx("p",{style:{color:"red",marginTop:"8px"},children:ie})]})]})},XR="_section_1v7dn_3",WR="_card_1v7dn_5",QR="_title_1v7dn_25",JR="_tableWrap_1v7dn_27",ZR="_table_1v7dn_27",eN="_theadRow_1v7dn_31",tN="_th_1v7dn_31",nN="_td_1v7dn_33",rN="_pill_1v7dn_35",aN="_cancelBtn_1v7dn_37",iN="_form_1v7dn_51",sN="_label_1v7dn_89",oN="_input_1v7dn_107",lN="_info_1v7dn_139",cN="_error_1v7dn_141",uN="_paginationBar_1v7dn_161",hN="_paginationLeft_1v7dn_177",fN="_paginationRight_1v7dn_195",dN="_pageBtn_1v7dn_209",gN="_pageInfo_1v7dn_237",mN="_pageSizeLabel_1v7dn_243",pN="_pageSizeSelect_1v7dn_257",vN="_topBar_1v7dn_283",yN="_segmented_1v7dn_305",TN="_segmentBtn_1v7dn_321",_N="_segmentBtnActive_1v7dn_383",Qe={section:XR,card:WR,title:QR,tableWrap:JR,table:ZR,theadRow:eN,th:tN,td:nN,pill:rN,cancelBtn:aN,form:iN,label:sN,input:oN,info:lN,error:cN,paginationBar:uN,paginationLeft:hN,paginationRight:fN,pageBtn:dN,pageInfo:gN,pageSizeLabel:mN,pageSizeSelect:pN,topBar:vN,segmented:yN,segmentBtn:TN,segmentBtnActive:_N},xN=n=>{const e=String(n.Date??"").slice(0,10),t=Number(n.SpotIdLookupId??n.SpotId??0),a=String(n.SpotId??(t?String(t):"")),s={Id:Number(n.ID??n.Id??n.id??0),Date:/^\d{4}-\d{2}-\d{2}$/.test(e)?e:"",Turn:String(n.Turn??""),SpotId:t,Spot:a,VehicleType:String(n.VehicleType??n.VehivleType??""),Status:String(n.Status??""),User:String(n.NombreUsuario??"")},l=n.Title??n.Usuario??n.UserMail??n.Correo??null;return l&&(s.__UserMail=String(l)),s};function SN(n,e,t=!1){const[a,s]=V.useState([]),[l,c]=V.useState([]),[h,d]=V.useState([]),[g,p]=V.useState(!1),[v,_]=V.useState(null),[T,C]=V.useState(ww),x=!T.from||!T.to||T.from>T.to,[A,B]=V.useState(20),[k,O]=V.useState(0),[j,H]=V.useState(!1),[Y,I]=V.useState("upcoming-active"),G=(e??"").replace(/'/g,"''"),q=(()=>{const fe=new Date,Te=fe.getFullYear(),U=String(fe.getMonth()+1).padStart(2,"0"),ue=String(fe.getDate()).padStart(2,"0");return`${Te}-${U}-${ue}`})(),ie=V.useCallback(fe=>{let Te=fe;Y==="upcoming-active"?Te=fe.filter(ue=>ue.Status==="Activa"&&ue.Date>=q):Y==="history"&&(Te=fe.filter(ue=>ue.Status!=="Activa")),c(Te);const U=Te.slice(0,A);d(U),O(0),H(Te.length>A)},[Y,A,q]),J=V.useCallback(async()=>{if(n){if(!t&&!G){s([]),c([]),d([]),_("No hay email de usuario para cargar las reservas.");return}if(x){_("Rango de fechas inválido.");return}p(!0),_(null);try{const Te=[];t||Te.push(`fields/Title eq '${G}'`),Y==="upcoming-active"?Te.push(`fields/Date ge '${q}'`):(Te.push(`fields/Date ge '${T.from}'`),Te.push(`fields/Date le '${T.to}'`));const U=Te.join(" and "),b=(await n.getAll({filter:U,orderby:"fields/Date desc",top:2e3})).map(xN);s(b),ie(b)}catch(fe){console.error("[useMisReservas] fetchAllForRange error:",fe),s([]),c([]),d([]),_(fe?.message??"Error al cargar"),H(!1)}finally{p(!1)}}},[n,t,G,T.from,T.to,x,Y,q,ie]),he=V.useCallback(()=>{if(x){_('El rango seleccionado es inválido. "Desde" no puede ser mayor que "Hasta".');return}J()},[x,J]),Ae=V.useCallback(fe=>{const Te=Number.isFinite(fe)&&fe>0?Math.floor(fe):20;B(Te);const U=l.slice(0,Te);d(U),O(0),H(l.length>Te)},[l]),je=V.useCallback(()=>{if(g)return;const fe=k+1,Te=fe*A,U=Te+A;Te>=l.length||(d(l.slice(Te,U)),O(fe),H(U<l.length))},[g,k,A,l]),ke=V.useCallback(()=>{if(g||k===0)return;const fe=k-1,Te=fe*A,U=Te+A;d(l.slice(Te,U)),O(fe),H(l.length>U)},[g,k,A,l]),re=V.useCallback(()=>{const fe=k*A,Te=fe+A;d(l.slice(fe,Te)),H(Te<l.length)},[l,k,A]),xe=V.useCallback(async fe=>{if(!fe){alert("ID de reserva inválido");return}try{p(!0),await n.update(String(fe),{Status:"Cancelada"}),await J()}catch(Te){console.error("[useMisReservas] cancelReservation error:",Te),alert("No se pudo cancelar la reserva: "+(Te?.message??"error desconocido"))}finally{p(!1)}},[n,J]);return V.useEffect(()=>{ie(a)},[Y]),V.useEffect(()=>{I("upcoming-active")},[t]),V.useEffect(()=>{let fe=!1;return(async()=>fe||await J())(),()=>{fe=!0}},[J]),V.useEffect(()=>{let Te=null;const U=()=>{J()},ue=()=>{Te==null&&(Te=window.setInterval(U,3e5))},b=()=>{Te!=null&&(window.clearInterval(Te),Te=null)};document.hidden||ue();const L=()=>{document.hidden?b():(U(),ue())};return document.addEventListener("visibilitychange",L),()=>{b(),document.removeEventListener("visibilitychange",L)}},[J]),{rows:h,loading:g,error:v,range:T,setRange:C,rangeInvalid:x,applyRange:he,pageSize:A,setPageSize:Ae,pageIndex:k,hasNext:j,nextPage:je,prevPage:ke,reload:re,cancelReservation:xe,filterMode:Y,setFilterMode:I}}const CN=n=>{const e=(n||"").toLowerCase();return e.includes("cancel")?"#f87171":e.includes("termin")?"#a3a3a3":e.includes("act")?"#34d399":"#60a5fa"},cT=({userMail:n,isAdmin:e=!1})=>{const{reservations:t}=Ri(),{rows:a,loading:s,error:l,range:c,setRange:h,applyRange:d,pageSize:g,setPageSize:p,pageIndex:v,hasNext:_,nextPage:T,prevPage:C,cancelReservation:x,filterMode:A,setFilterMode:B}=SN(t,n,e);return y.jsx("section",{className:Qe.section,children:y.jsxs("div",{className:Qe.card,children:[y.jsx("h1",{className:Qe.title,children:"Mis reservas"}),y.jsx("div",{className:Qe.topBar,children:y.jsxs("div",{className:Qe.segmented,children:[y.jsx("button",{type:"button",className:`${Qe.segmentBtn} ${A==="upcoming-active"?Qe.segmentBtnActive:""}`,onClick:()=>B("upcoming-active"),disabled:s,title:"Mostrar próximas con estado Activa",children:"Próximas activas"}),y.jsx("button",{type:"button",className:`${Qe.segmentBtn} ${A==="history"?Qe.segmentBtnActive:""}`,onClick:()=>B("history"),disabled:s,title:"Ver pasadas y canceladas (con rango de fechas)",children:"Historial"})]})}),A==="history"&&y.jsxs("form",{className:Qe.form,onSubmit:k=>{k.preventDefault(),d()},children:[y.jsxs("label",{className:Qe.label,children:["Desde",y.jsx("input",{className:Qe.input,type:"date",value:c.from,max:c.to||void 0,onChange:k=>h(O=>({...O,from:k.target.value}))})]}),y.jsxs("label",{className:Qe.label,children:["Hasta",y.jsx("input",{className:Qe.input,type:"date",value:c.to,min:c.from||void 0,onChange:k=>h(O=>({...O,to:k.target.value}))})]})]}),s&&y.jsx("div",{className:Qe.info,children:"Cargando…"}),l&&y.jsx("div",{className:Qe.error,children:l}),!s&&!l&&a.length>0&&y.jsxs(y.Fragment,{children:[y.jsx("div",{className:Qe.tableWrap,children:y.jsxs("table",{className:Qe.table,children:[y.jsx("thead",{children:y.jsxs("tr",{className:Qe.theadRow,children:[e?y.jsx("th",{className:Qe.th,children:"Usuario"}):null,y.jsx("th",{className:Qe.th,children:"Fecha"}),y.jsx("th",{className:Qe.th,children:"Turno"}),y.jsx("th",{className:Qe.th,children:"Celda"}),y.jsx("th",{className:Qe.th,children:"Vehículo"}),y.jsx("th",{className:Qe.th,children:"Estado"}),y.jsx("th",{className:Qe.th,children:"Acciones"})]})}),y.jsx("tbody",{children:a.map(k=>y.jsxs("tr",{children:[e?y.jsx("td",{className:Qe.td,children:k.User}):null,y.jsx("td",{className:Qe.td,children:k.Date}),y.jsx("td",{className:Qe.td,children:k.Turn}),y.jsx("td",{className:Qe.td,children:k.Spot}),y.jsx("td",{className:Qe.td,children:k.VehicleType}),y.jsx("td",{className:Qe.td,children:y.jsx("span",{className:Qe.pill,style:{background:CN(k.Status)},children:k.Status})}),y.jsx("td",{className:Qe.td,children:k.Status==="Activa"?y.jsx("button",{className:Qe.cancelBtn,onClick:()=>{x(k.Id)},disabled:s,title:"Cancelar esta reserva",children:"Cancelar"}):y.jsx("p",{children:"No hay acciones disponibles"})})]},k.Id))})]})}),y.jsxs("div",{className:Qe.paginationBar,children:[y.jsxs("div",{className:Qe.paginationLeft,children:[y.jsx("button",{className:Qe.pageBtn,onClick:C,disabled:s||v===0,children:"← Anterior"}),y.jsx("button",{className:Qe.pageBtn,onClick:T,disabled:s||!_,children:"Siguiente →"}),y.jsxs("span",{className:Qe.pageInfo,children:["Página ",v+1]})]}),y.jsx("div",{className:Qe.paginationRight,children:y.jsxs("label",{className:Qe.pageSizeLabel,children:["Filas por página",y.jsxs("select",{className:Qe.pageSizeSelect,value:g,onChange:k=>p(Number(k.target.value)||20),disabled:s,children:[y.jsx("option",{value:5,children:"5"}),y.jsx("option",{value:10,children:"10"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]})})]})]}),!s&&!l&&a.length===0&&y.jsx("div",{className:Qe.info,children:n?"No hay reservas para los filtros seleccionados.":"Proporciona un email para ver reservas."})]})})},EN="_wrapper_1l0bv_33",AN="_h3_1l0bv_45",wN="_filtersBar_1l0bv_61",bN="_searchBox_1l0bv_97",IN="_searchInput_1l0bv_113",RN="_pageSizeBox_1l0bv_141",NN="_pageSizeSelect_1l0bv_157",kN="_cardGrid_1l0bv_185",ON="_card_1l0bv_185",MN="_cardHeader_1l0bv_225",DN="_cardCode_1l0bv_245",PN="_badgeInactive_1l0bv_267",FN="_metaLabel_1l0bv_289",LN="_btnPrimary_1l0bv_299",UN="_emptyGrid_1l0bv_315",BN="_badgeGroup_1l0bv_327",HN="_badge_1l0bv_255",jN="_badgeFree_1l0bv_385",zN="_badgeReserved_1l0bv_397",GN="_badgeInUse_1l0bv_409",$N="_celdaTitle_1l0bv_433",KN="_btnLink_1l0bv_445",VN="_btn_1l0bv_299",qN="_paginationBar_1l0bv_493",YN="_pageBtn_1l0bv_509",XN="_pageInfo_1l0bv_531",WN="_capacityCard_1l0bv_577",QN="_capacityHeader_1l0bv_603",JN="_turnPill_1l0bv_617",ZN="_capacityGrid_1l0bv_635",ek="_capacityItem_1l0bv_651",tk="_capacityLabel_1l0bv_669",nk="_capacityValue_1l0bv_681",rk="_capacityTotal_1l0bv_693",ak="_modalBackdrop_1l0bv_721",ik="_modal_1l0bv_721",sk="_field_1l0bv_763",ok="_modalActions_1l0bv_775",lk="_actionsRight_1l0bv_789",ck="_btnGhost_1l0bv_801",He={wrapper:EN,h3:AN,filtersBar:wN,searchBox:bN,searchInput:IN,pageSizeBox:RN,pageSizeSelect:NN,cardGrid:kN,card:ON,cardHeader:MN,cardCode:DN,badgeInactive:PN,metaLabel:FN,btnPrimary:LN,emptyGrid:UN,badgeGroup:BN,badge:HN,badgeFree:jN,badgeReserved:zN,badgeInUse:GN,celdaTitle:$N,btnLink:KN,btn:VN,paginationBar:qN,pageBtn:YN,pageInfo:XN,capacityCard:WN,capacityHeader:QN,turnPill:JN,capacityGrid:ZN,capacityItem:ek,capacityLabel:tk,capacityValue:nk,capacityTotal:rk,modalBackdrop:ak,modal:ik,field:sk,modalActions:ok,actionsRight:lk,btnGhost:ck},uk=n=>({Id:Number(n.ID??n.Id??n.id??0),Title:String(n.Title??n.title??""),TipoCelda:n.TipoCelda??n.tipoCelda??"-",Activa:n.Activa??n.estado??"-",Raw:n,Itinerancia:n.Itinerancia});function hk(n){const[e,t]=V.useState([]),[a,s]=V.useState([]),[l,c]=V.useState(!1),[h,d]=V.useState(null),[g,p]=V.useState(""),[v,_]=V.useState("all"),[T,C]=V.useState("all"),[x,A]=V.useState(50),[B,k]=V.useState(0),[O,j]=V.useState(!1),[H,Y]=V.useState(!1),[I,G]=V.useState(!1),[q,ie]=V.useState(null),[J,he]=V.useState({Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"}),Ae=J.Title.trim().length>0&&(J.TipoCelda==="Carro"||J.TipoCelda==="Moto")&&(J.Activa==="Activa"||J.Activa==="Inactiva")&&(J.Itinerancia==="Empleado Itinerante"||J.Itinerancia==="Directivo"||J.Itinerancia==="Empleado Fijo"),je=()=>{he({Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"}),ie(null),Y(!0)},ke=()=>{Y(!1),ie(null)},re=V.useCallback(async(b,L)=>{if(!b){alert("ID inválido");return}try{c(!0);const P=L==="Activa"?"No Activa":"Activa";await n.update(String(b),{Activa:P}),t(K=>K.map(Z=>Z.Id===Number(b)?{...Z,Activa:P}:Z)),s(K=>K.map(Z=>Z.Id===Number(b)?{...Z,Activa:P}:Z))}catch(P){console.error("[useCeldas] toggleEstado error:",P),alert(P?.message??"No se pudo actualizar el estado")}finally{c(!1)}},[n]),xe=async()=>{if(Ae){G(!0),ie(null);try{const b=J.Title.trim(),L={TipoCelda:J.TipoCelda,Activa:J.Activa,Itinerancia:J.Itinerancia};if(J.TipoCelda==="Moto"){const K=["A","B","C","D","E"].map(Ce=>({Title:`${b}${Ce}`,...L})),be=(await Promise.allSettled(K.map(Ce=>n.create(Ce)))).map((Ce,Pe)=>({r:Ce,i:Pe})).filter(({r:Ce})=>Ce.status==="rejected");if(be.length>0){const Ce=be.map(({i:Pe})=>String(K[Pe].Title)).join(", ");throw new Error(`No se pudieron crear estas celdas: ${Ce}. Verifica duplicados o permisos.`)}}else{const P={Title:b,...L};await n.create(P)}ke(),await fe()}catch(b){ie(b?.message??"No se pudo crear la celda")}finally{G(!1)}}},fe=V.useCallback(async()=>{c(!0),d(null);try{const L=g.trim().toLowerCase().replace(/'/g,"''"),P=[];L&&P.push(`contains(tolower(fields/Title),'${L}')`),v!=="all"&&P.push(`fields/TipoCelda eq '${v}'`),T!=="all"&&P.push(`fields/Itinerancia eq '${T}'`);const Z=(await n.getAll({orderby:"fields/Title asc",top:2e3,...P.length?{filter:P.join(" and ")}:{}})).map(uk);t(Z),s(Z.slice(0,x)),k(0),j(Z.length>x)}catch(b){console.error("[useCeldas] reloadAll error:",b),t([]),s([]),d(b?.message??"Error al cargar celdas"),j(!1)}finally{c(!1)}},[n,g,x,v,T]),Te=V.useCallback(b=>{const L=Number.isFinite(b)&&b>0?Math.floor(b):20;A(L);const P=e.slice(0,L);s(P),k(0),j(e.length>L)},[e]),U=V.useCallback(()=>{if(l)return;const b=B+1,L=b*x,P=L+x;L>=e.length||(s(e.slice(L,P)),k(b),j(P<e.length))},[l,B,x,e]),ue=V.useCallback(()=>{if(l||B===0)return;const b=B-1,L=b*x,P=L+x;s(e.slice(L,P)),k(b),j(e.length>P)},[l,B,x,e]);return V.useEffect(()=>{let b=!1;return(async()=>b||await fe())(),()=>{b=!0}},[fe]),V.useEffect(()=>{fe()},[v,T]),{rows:a,loading:l,error:h,search:g,setSearch:p,tipo:v,setTipo:_,itinerancia:T,setItinerancia:C,pageSize:x,setPageSize:Te,pageIndex:B,hasNext:O,nextPage:U,prevPage:ue,reloadAll:fe,toggleEstado:re,createOpen:H,createSaving:I,createError:q,createForm:J,setCreateForm:he,canCreate:Ae,openModal:je,closeModal:ke,create:xe}}function fk(n){const[e,t]=V.useState({}),[a,s]=V.useState(!1),[l,c]=V.useState(null),h=V.useCallback(async()=>{try{s(!0),c(null);const d=new Date,g=`${d.getFullYear()}-${String(d.getMonth()+1).padStart(2,"0")}-${String(d.getDate()).padStart(2,"0")}`,p=await n.getAll({filter:`fields/Date eq '${g}' and (fields/Status ne 'Cancelada')`,top:5e3,orderby:"fields/Turn asc"}),v={};for(const _ of p){const T=Number(_.SpotIdLookupId??_.SpotId??NaN);if(!Number.isFinite(T))continue;const C=String(_.Turn??"").toLowerCase(),x=_.NombreUsuario??"";v[T]||(v[T]={}),C==="manana"||C==="mañana"?(v[T].Manana=!0,v[T].PorManana=x):C==="tarde"?(v[T].Tarde=!0,v[T].PorTarde=x):(v[T].Manana=!0,v[T].Tarde=!0,v[T].PorManana=x,v[T].PorTarde=x)}t(v)}catch(d){c(d?.message??"No se pudo cargar ocupación"),t({})}finally{s(!1)}},[n]);return V.useEffect(()=>{h()},[h]),{occByTurn:e,loading:a,error:l,reload:h}}const uT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),fa={};function TS(n){return JSON.stringify({onlyEnabled:n.onlyEnabled??!0,domainFilter:(n.domainFilter??"").toLowerCase()})}function dk(n,e){const t=n.id??n.userPrincipalName??n.mail??e;return{id:String(t),displayName:String(n.displayName??"—"),mail:String(n.mail??n.userPrincipalName??""),jobTitle:String(n.jobTitle??"")}}async function gk(n,e){const t=TS(e);if(fa[t]?.data)return fa[t].data;if(fa[t]||(fa[t]={data:null,promise:null}),!fa[t].promise){const a=e.onlyEnabled??!0,s=(e.domainFilter??"").toLowerCase(),l=encodeURIComponent("id,displayName,mail,userPrincipalName,jobTitle,accountEnabled"),c=999,h=[];a&&h.push("accountEnabled eq true");let d=`/users?$select=${l}&$top=${c}`+(h.length?`&$filter=${encodeURIComponent(h.join(" and "))}`:"");const g=[];async function p(){for(;d;){const v=await n.get(d),_=Array.isArray(v?.value)?v.value:[];g.push(..._);const T=v?.["@odata.nextLink"];d=T?T.replace("https://graph.microsoft.com/v1.0",""):""}}fa[t].promise=p().then(()=>{const v=new Map;for(const T of g){const C=String(T.mail||T.userPrincipalName||"").trim().toLowerCase();C&&(s&&!C.endsWith(`@${s}`)||v.has(C)||v.set(C,T))}const _=Array.from(v.values()).map(dk);return fa[t].data=_,_}).finally(()=>{fa[t].promise=null})}return fa[t].promise}function _S(n={}){const{ready:e,getToken:t}=Xh(),[a,s]=V.useState([]),[l,c]=V.useState(!0),[h,d]=V.useState(null),g=TS(n),p=V.useCallback(async()=>{if(e){c(!0),d(null);try{const T=new mo(t),C=await gk(T,n);s(typeof n.previewLimit=="number"?C.slice(0,n.previewLimit):C)}catch(T){s([]),d(T?.message??"Error cargando usuarios")}finally{c(!1)}}},[e,t,n]);V.useEffect(()=>{p()},[p,g]);const v=V.useCallback(T=>{if(!T)return a;const C=uT(T);return a.filter(x=>uT(`${x.displayName} ${x.jobTitle??""} ${x.mail??""}`).includes(C))},[a]),_=V.useCallback(async()=>{e&&(fa[g]={data:null,promise:null},await p())},[e,p,g]);return{workers:a,loading:l,error:h,filter:v,refresh:_}}const Ml=n=>{const e=Number.isFinite(n)?Math.floor(Number(n)):0;return Math.min(23,Math.max(0,e))},Pu=n=>`${String(Ml(n)).padStart(2,"0")}:00`;function mk(n){return{amStart:Pu(n?.InicioManana??6),amEnd:Pu(n?.FinalManana??12),pmStart:Pu(n?.InicioTarde??13),pmEnd:Pu(n?.FinalTarde??19)}}function pk(n){const e={h:Ml(n?.InicioManana??6),m:0},t={h:Ml(n?.FinalManana??12),m:59},a={h:Ml(n?.InicioTarde??13),m:0},s={h:Ml(n?.FinalTarde??19),m:0},l=new Date,c=l.getHours()*60+l.getMinutes(),h=(d,g)=>c>=d.h*60+d.m&&c<=g.h*60+g.m;return h(e,t)?"Manana":h(a,s)?"Tarde":null}const vk=()=>{const{ready:n,getToken:e}=Xh(),t=V.useMemo(()=>{if(!n)return null;const Y=new mo(e);return new gS(Y,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","parkingslots")},[n,e]),a=V.useMemo(()=>{if(!n)return null;const Y=new mo(e);return new um(Y,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","reservations")},[n,e]),s=t?hk(t):{rows:[],loading:!0,error:null,search:"",setSearch:Y=>{},tipo:"all",setTipo:Y=>{},itinerancia:"all",setItinerancia:Y=>{},pageSize:50,setPageSize:Y=>{},pageIndex:0,hasNext:!1,nextPage:()=>{},prevPage:()=>{},reloadAll:async()=>{},toggleEstado:async()=>{},createOpen:!1,createSaving:!1,createError:null,createForm:{Title:"",TipoCelda:"Carro",Activa:"Activa",Itinerancia:"Empleado Fijo"},setCreateForm:()=>{},canCreate:!1,openModal:()=>{},closeModal:()=>{},create:async()=>{}},l=yS(),c=a?fk(a):{occByTurn:{},loading:!0,error:null,reload:async()=>{}},{workers:h,loading:d}=_S(),g=V.useMemo(()=>s.rows.map(Y=>({...Y,__occ:c.occByTurn[Y.Id]})),[s.rows,c.occByTurn]),p=V.useMemo(()=>l.hours?pk(l.hours):null,[l.hours]),v=V.useMemo(()=>{if(!l.hours)return"Cargando horarios…";const Y=mk(l.hours);return`Mañana: ${Y.amStart}–${Y.amEnd} · Tarde: ${Y.pmStart}–${Y.pmEnd}`},[l.hours]),_=V.useMemo(()=>{const Y=g.filter(je=>je.Activa==="Activa"),I=je=>{const ke=c.occByTurn[je]||{};return p?p==="Manana"?!!ke?.Manana:!!ke?.Tarde:!!(ke?.Manana||ke?.Tarde)},G=Y.filter(je=>je.TipoCelda==="Carro").length,q=Y.filter(je=>je.TipoCelda==="Carro"&&I(je.Id)).length,ie=Math.max(0,G-q),J=Y.filter(je=>je.TipoCelda==="Moto").length,he=Y.filter(je=>je.TipoCelda==="Moto"&&I(je.Id)).length,Ae=Math.max(0,J-he);return{turno:p,totalCarros:G,libresCarros:ie,totalMotos:J,libresMotos:Ae}},[g,c.occByTurn,p]),[T,C]=V.useState(!1),[x,A]=V.useState(null),B=Y=>{A(Y),C(!0)},k=()=>{A(null),C(!1)};V.useEffect(()=>{let I=null;const G=()=>{s.reloadAll(),c.reload()},q=()=>{I==null&&(I=window.setInterval(G,3e5))},ie=()=>{I!=null&&(window.clearInterval(I),I=null)};document.hidden||q();const J=()=>document.hidden?ie():(G(),q());return document.addEventListener("visibilitychange",J),()=>{ie(),document.removeEventListener("visibilitychange",J)}},[s.reloadAll,c.reload]);const O=Y=>{Y.key==="Enter"&&(Y.preventDefault(),s.reloadAll())},j=s.loading||l.loading||c.loading,H=s.createSaving;return{loading:j,error:s.error||l.error||null,rows:g,search:s.search,setSearch:s.setSearch,onSearchEnter:O,tipo:s.tipo,setTipo:s.setTipo,itinerancia:s.itinerancia,setItinerancia:s.setItinerancia,pageSize:s.pageSize,setPageSize:s.setPageSize,pageIndex:s.pageIndex,hasNext:s.hasNext,nextPage:s.nextPage,prevPage:s.prevPage,createOpen:s.createOpen,createSaving:s.createSaving,createError:s.createError,createForm:s.createForm,canCreate:s.canCreate,openModal:s.openModal,closeModal:s.closeModal,setCreateForm:s.setCreateForm,create:s.create,occLoading:c.loading,capacidadAhora:_,currentTurn:p,hoursLabel:v,open:T,selected:x,openDetails:B,closeDetails:k,workers:h,workersLoading:d,actionsDisabled:H}},yk=2e3;async function xS(n,e){if(!e)return null;const a=(await n.getAll({filter:`fields/SpotAsignado eq ${Number(e)}`,top:1,orderby:"fields/Title asc"}))?.[0];return a?{id:Number(a.ID??""),name:String(a.Title??""),email:a.Correo??void 0,slotAsignado:a.SpotAsignado??null}:null}async function Tk(n,e,t,a){if(!e||!t)throw new Error("Parámetros inválidos para asignación.");await n.update(String(t),{SpotAsignado:Number(e),CodigoCelda:a})}async function _k(n,e){if(!e)throw new Error("ID de celda inválido.");const t=await xS(n,e);t&&await n.update(String(t.id),{SpotAsignado:null,CodigoCelda:null})}async function xk(n,e,t){const a=(e||"").replace(/'/g,"''").toLowerCase(),s=[];s.push("(fields/SpotAsignado eq null or fields/SpotAsignado eq 0)"),a&&s.push(`(contains(tolower(fields/Title),'${a}') or contains(tolower(fields/Correo),'${a}'))`);const l=s.join(" and ");return(await n.getAll({filter:l,top:yk,orderby:"fields/Title asc"})).map(d=>({id:String(d.ID??""),name:String(d.Title??""),email:d.Correo??void 0,slotAsignado:d.SpotAsignado??null}))}const SS=n=>n.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLocaleLowerCase("es"),Sk=["practicante","aprendiz","auxiliar","admin","administrativa","administrativo","callcenter","facturas","cedi","facturacion"],hT=Sk.map(SS);async function CS(n){const e=(n??"").trim();if(!e)return!1;const t=SS(e),a=t.split(/[^\p{L}\d]+/u).filter(Boolean),s=new Set(a);for(const l of hT)if(s.has(l))return!1;for(const l of hT)if(t.includes(l))return!1;return!0}const Je={backdrop:{position:"fixed",inset:0,background:"rgba(0,0,0,.45)",zIndex:99999,display:"flex",alignItems:"center",justifyContent:"center"},modal:{background:"#fff",width:"min(900px, 96vw)",maxHeight:"90vh",overflow:"auto",borderRadius:12,boxShadow:"0 10px 30px rgba(0,0,0,.2)",border:"1px solid #e5e7eb"},header:{padding:"12px 16px",borderBottom:"1px solid #e5e7eb",display:"flex",alignItems:"center",justifyContent:"space-between"},title:{margin:0,fontSize:18,fontWeight:700},closeBtn:{background:"transparent",border:0,fontSize:20,lineHeight:1,cursor:"pointer"},body:{padding:"12px 16px",display:"grid",gap:10,fontSize:14},footer:{padding:"12px 16px",borderTop:"1px solid #e5e7eb",display:"flex",justifyContent:"flex-end",gap:8},muted:{color:"#6b7280"},card:{border:"1px solid #e5e7eb",borderRadius:10,padding:12,display:"grid",gap:10},rowBetween:{display:"flex",alignItems:"center",justifyContent:"space-between",gap:10},btnPrimary:{background:"#2563eb",color:"#fff",border:0,padding:"8px 12px",borderRadius:8,cursor:"pointer"},btnGhost:{background:"transparent",border:"1px solid #e5e7eb",padding:"8px 12px",borderRadius:8,cursor:"pointer"},btnDanger:{background:"#dc2626",color:"#fff",border:0,padding:"8px 12px",borderRadius:8,cursor:"pointer"},input:{width:"90%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:14},select:{width:"93%",padding:"8px 10px",border:"1px solid #e5e7eb",borderRadius:8,fontSize:14,background:"#fff"},pickerPanel:{marginTop:8,border:"1px solid #e5e7eb",borderRadius:8,padding:10,display:"grid",gap:10},list:{listStyle:"none",margin:0,padding:0},listItem:{display:"flex",justifyContent:"space-between",alignItems:"center",padding:"8px 0",borderTop:"1px solid #f3f4f6"},labelCol:{display:"grid",gap:6}},fT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim();function Ck({open:n,slot:e,workers:t=[],workersLoading:a=!1,onClose:s,onChanged:l}){const{ready:c,getToken:h}=Xh(),d=V.useMemo(()=>{if(!c)return null;const Me=new mo(h);return new um(Me,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","reservations")},[c,h]),g=V.useMemo(()=>{if(!c)return null;const Me=new mo(h);return new mS(Me,"estudiodemoda.sharepoint.com","/sites/TransformacionDigital/IN/SA","Colaboradores fijos")},[c,h]),[p,v]=V.useState(!1),[_,T]=V.useState(null),[C,x]=V.useState(null),[A,B]=V.useState(!1),[k,O]=V.useState(""),[j,H]=V.useState([]),[Y,I]=V.useState(!1),G=V.useMemo(()=>new Date().toISOString().slice(0,10),[]),[q,ie]=V.useState(G),[J,he]=V.useState("Manana"),[Ae,je]=V.useState(!1),[ke,re]=V.useState(null),[xe,fe]=V.useState(""),[Te,U]=V.useState(""),[ue,b]=V.useState({name:!1,mail:!1}),L=Me=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(Me.trim()),P=xe.trim()?null:"El nombre es obligatorio.",K=Te.trim()?L(Te)?null:"El correo no tiene un formato válido.":"El correo es obligatorio.",Z=!Ae&&!P&&!K,be=V.useMemo(()=>(t??[]).map((Me,Mt)=>({key:String(Me.id??Me.mail??Me.displayName??Mt),id:Me.id,name:Me.displayName??"",email:Me.mail??"",job:Me.jobTitle??""})),[t]),[Ce,Pe]=V.useState(""),[De,lt]=V.useState(""),et=V.useMemo(()=>{if(!Ce)return be;const Me=fT(Ce);return be.filter(Mt=>fT(`${Mt.name} ${Mt.email} ${Mt.job}`).includes(Me))},[be,Ce]),zt=V.useRef(null),ct=V.useCallback(async Me=>{lt(Me);const Mt=be.find(zn=>zn.key===Me);if(!Mt)return;const yn=Symbol();zt.current=yn;try{const zn=await CS(Mt.name);if(zt.current!==yn)return;fe(zn?Mt.name??"":""),U(Mt.email??""),re(null),b(Gn=>({...Gn,name:!0,mail:!!Mt.email||Gn.mail}))}catch(zn){console.error("[onSelectWorker] nameProve error:",zn),fe(""),U(Mt.email??"")}},[be]),Hn=V.useMemo(()=>String(e?.Itinerancia??"").toLowerCase().includes("itinerante")?"reserva":"fijar",[e?.Itinerancia]);V.useEffect(()=>{if(!n||!e||!g)return;let Me=!1;return(async()=>{try{v(!0),T(null);const Mt=await xS(g,e.Id);Me||x(Mt)}catch(Mt){Me||T(Mt?.message??"Error al cargar asignación")}finally{Me||v(!1)}})(),()=>{Me=!0}},[n,e?.Id,g]),V.useEffect(()=>{n&&(C?(fe(C.name??""),U(C.email??"")):(fe(""),U("")),ie(G),he("Manana"),re(null),b({name:!1,mail:!1}),Pe(""),lt(""))},[n,C,G]);const Ot=V.useCallback(async()=>{if(g){I(!0),T(null);try{const Me=await xk(g,k);H(Me)}catch(Me){T(Me?.message??"Error buscando colaboradores"),H([])}finally{I(!1)}}},[k,g]),Fe=V.useCallback(async Me=>{if(!(!Me||!e||!g)){v(!0),T(null);try{await Tk(g,e.Id,Me.id,e.Title),x(Me),B(!1),O(""),H([]),await l?.()}catch(Mt){T(Mt?.message??"No se pudo asignar la celda")}finally{v(!1)}}},[e,l,g]),On=V.useCallback(async()=>{if(!(!C||!g)){if(!C.slotAsignado){console.warn("[onUnassign] assignee sin slot",C),T("Asignado inválido: falta ID de la celda.");return}v(!0),T(null);try{await _k(g,Number(C.slotAsignado)),x(null),await l?.()}catch(Me){console.error("[onUnassign] error",Me),T(Me?.message??"No se pudo desasignar la celda")}finally{v(!1)}}},[C,l,g]),jn=V.useCallback(async(Me,Mt,yn)=>{if(!d)return!1;const zn=await d.getAll({select:["ID"],top:1,filter:`SpotId eq ${Me} and Date eq '${Mt}' and Turn eq '${yn}' and (Status ne 'Cancelada')`}),Gn=zn?.data??zn?.value??[];return Array.isArray(Gn)&&Gn.length>0},[d]),wr=V.useCallback(async()=>{if(!(!e||!d)){if(b({name:!0,mail:!0}),P||K){re(P||K);return}je(!0),re(null);try{if(await jn(e.Id,q,J)){re("Ya existe una reserva para esa fecha y turno en esta celda."),je(!1);return}await d.create({SpotId:{Id:Number(e.Id)},Date:q,Turn:J,Status:"Activa",NombreUsuario:xe,Title:Te,VehicleType:e.TipoCelda}),await l?.(),alert("Reserva creada correctamente."),s()}catch(Me){re(Me?.message??"No fue posible crear la reserva.")}finally{je(!1)}}},[e,q,J,xe,Te,jn,l,s,P,K,d]);if(!n||!e)return null;const lr=Me=>{Me.target===Me.currentTarget&&s()};return y.jsx("div",{style:Je.backdrop,onMouseDown:lr,children:y.jsxs("div",{style:Je.modal,children:[y.jsxs("header",{style:Je.header,children:[y.jsxs("h3",{style:Je.title,children:["Celda ",e.Title]}),y.jsx("button",{style:Je.closeBtn,onClick:s,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{style:Je.body,children:[y.jsxs("div",{children:[y.jsx("strong",{children:"Tipo:"})," ",e.TipoCelda]}),y.jsxs("div",{children:[y.jsx("strong",{children:"Estado:"})," ",e.Activa]}),y.jsxs("div",{style:Je.muted,children:[y.jsx("strong",{children:"Itinerancia:"})," ",e.Itinerancia??"—","  → ",y.jsx("strong",{children:Hn==="reserva"?"Modo Reserva (turno)":"Modo Asignación fija"})]}),Hn==="fijar"&&y.jsxs("div",{style:Je.card,children:[y.jsx("h4",{style:{margin:0},children:"Asignación fija"}),p&&y.jsx("div",{style:Je.muted,children:"Cargando…"}),_&&y.jsx("div",{style:{color:"crimson"},children:_}),!p&&y.jsx(y.Fragment,{children:C?y.jsxs("div",{style:Je.rowBetween,children:[y.jsxs("div",{children:[y.jsxs("div",{children:[y.jsx("strong",{children:"Asignado a:"})," ",C.name]}),C.email&&y.jsx("div",{style:Je.muted,children:C.email})]}),y.jsx("button",{type:"button",style:Je.btnDanger,onClick:()=>On(),children:"Desasignar"})]}):y.jsxs("div",{style:Je.rowBetween,children:[y.jsx("div",{style:Je.muted,children:"Sin asignación"}),y.jsx("button",{style:Je.btnPrimary,onClick:()=>B(!0),children:"Asignar"})]})}),A&&y.jsxs("div",{style:Je.pickerPanel,children:[y.jsxs("div",{style:{display:"flex",gap:8},children:[y.jsx("input",{style:Je.input,placeholder:"Buscar colaborador (nombre o correo)…",value:k,onChange:Me=>O(Me.target.value),onKeyDown:Me=>Me.key==="Enter"&&Ot()}),y.jsx("button",{style:Je.btnPrimary,onClick:Ot,disabled:Y||!g,children:Y?"Buscando…":"Buscar"}),y.jsx("button",{style:Je.btnGhost,onClick:()=>{B(!1),O(""),H([])},children:"Cerrar"})]}),y.jsxs("ul",{style:Je.list,children:[j.length===0&&!Y&&y.jsx("li",{style:Je.muted,children:"Sin resultados"}),j.map(Me=>y.jsxs("li",{style:Je.listItem,children:[y.jsxs("div",{children:[y.jsx("div",{style:{fontWeight:600},children:Me?.name}),Me?.email&&y.jsx("div",{style:Je.muted,children:Me.email})]}),y.jsx("button",{style:Je.btnPrimary,onClick:()=>Fe(Me),children:"Asignar"})]},Me?.id))]})]})]}),Hn==="reserva"&&y.jsxs("div",{style:Je.card,children:[y.jsx("h4",{style:{margin:0},children:"Reserva puntual por turno"}),y.jsxs("div",{style:{...Je.muted,marginBottom:8},children:["Crea una reserva para un ",y.jsx("strong",{children:"día"})," y ",y.jsx("strong",{children:"turno"})," (AM/PM)."]}),y.jsxs("fieldset",{style:{border:0,padding:0,margin:0},children:[y.jsxs("label",{style:{...Je.labelCol,marginBottom:6},children:[y.jsx("span",{children:y.jsx("strong",{children:"Colaborador"})}),y.jsx("input",{style:Je.input,type:"text",placeholder:"Buscar por nombre/correo/cargo…",value:Ce,onChange:Me=>Pe(Me.target.value),disabled:a})]}),y.jsxs("select",{style:Je.select,value:De,onChange:Me=>ct(Me.target.value),disabled:a,children:[y.jsx("option",{value:"",children:a?"Cargando colaboradores…":et.length===0?"Sin resultados":"Selecciona un colaborador (opcional)"}),et.map(Me=>y.jsxs("option",{value:Me.key,children:[Me.name,Me.job?` · ${Me.job}`:""]},Me.key))]}),y.jsx("br",{}),y.jsx("small",{style:Je.muted,children:"Al seleccionar, se rellenan Nombre y Correo (puedes editarlos)."})]}),ke&&y.jsx("div",{style:{color:"crimson"},children:ke}),y.jsxs("div",{style:{display:"grid",gap:10,marginTop:8},children:[y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Fecha"})}),y.jsx("input",{type:"date",style:Je.input,value:q,onChange:Me=>ie(Me.target.value),min:G})]}),y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Turno"})}),y.jsxs("select",{style:Je.select,value:J,onChange:Me=>he(Me.target.value),children:[y.jsx("option",{value:"Manana",children:"AM (06:00–12:59)"}),y.jsx("option",{value:"Tarde",children:"PM (13:00–19:00)"})]})]}),y.jsxs("div",{style:{display:"grid",gap:8},children:[y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Nombre"})}),y.jsx("input",{style:{...Je.input,borderColor:ue.name&&P?"#dc2626":Je.input.borderColor,outlineColor:ue.name&&P?"#dc2626":void 0},value:xe,onChange:Me=>{fe(Me.target.value),ke&&re(null)},onBlur:()=>b(Me=>({...Me,name:!0})),placeholder:"Nombre del usuario",required:!0,"aria-required":"true","aria-invalid":!!(ue.name&&P)}),ue.name&&P&&y.jsx("small",{style:{color:"#dc2626"},children:P})]}),y.jsxs("label",{style:Je.labelCol,children:[y.jsx("span",{children:y.jsx("strong",{children:"Correo"})}),y.jsx("input",{style:{...Je.input,borderColor:ue.mail&&K?"#dc2626":Je.input.borderColor,outlineColor:ue.mail&&K?"#dc2626":void 0},type:"email",value:Te,onChange:Me=>{U(Me.target.value),ke&&re(null)},onBlur:()=>b(Me=>({...Me,mail:!0})),placeholder:"correo@empresa.com",required:!0,"aria-required":"true","aria-invalid":!!(ue.mail&&K)}),ue.mail&&K&&y.jsx("small",{style:{color:"#dc2626"},children:K})]})]}),y.jsxs("div",{style:{display:"flex",justifyContent:"flex-end",gap:8},children:[y.jsx("button",{style:Je.btnGhost,type:"button",onClick:()=>{ie(G),he("Manana"),fe(C?.name??""),U(C?.email??""),re(null),b({name:!1,mail:!1}),Pe(""),lt("")},children:"Limpiar"}),y.jsx("button",{style:Je.btnPrimary,type:"button",onClick:wr,disabled:!Z||!d,children:Ae?"Creando…":"Crear reserva"})]})]})]})]}),y.jsx("footer",{style:Je.footer,children:y.jsx("button",{style:Je.btnGhost,onClick:s,children:"Cerrar"})})]})})}const Ek=()=>{const{loading:n,error:e,rows:t,pageIndex:a,hasNext:s,search:l,setSearch:c,onSearchEnter:h,tipo:d,setTipo:g,itinerancia:p,setItinerancia:v,pageSize:_,setPageSize:T,nextPage:C,prevPage:x,createOpen:A,createSaving:B,createError:k,createForm:O,canCreate:j,openModal:H,closeModal:Y,setCreateForm:I,create:G,occLoading:q,capacidadAhora:ie,currentTurn:J,hoursLabel:he,openDetails:Ae,closeDetails:je,open:ke,selected:re,workers:xe,workersLoading:fe,actionsDisabled:Te}=vk(),U=V.useMemo(()=>{const b=String(J??"").toLowerCase();return b==="manana"||b==="mañana"?"Manana":b==="tarde"?"Tarde":"Fuera"},[J]),ue=(b,L,P,K,Z)=>{let be=He.badge,Ce="Disponible";return b?L?K?(be=`${He.badge} ${He.badgeInUse}`,Ce="En uso"):(be=`${He.badge} ${He.badgeReserved}`,Ce="Reservada"):(be=`${He.badge} ${He.badgeFree}`,Ce="Disponible"):(be=`${He.badge} ${He.badgeInactive}`,Ce="Inactiva"),y.jsxs("span",{className:be,"aria-label":`${P}: ${Ce}${Z?` por ${Z}`:""}`,children:[y.jsxs("span",{className:He.badgeLine,children:[P,": ",Ce]}),y.jsx("br",{}),Z&&y.jsx("small",{className:He.badgeWho,children:Z})]})};return y.jsxs("section",{className:He.wrapper,children:[n&&y.jsx("div",{className:He.loadingBar,role:"status",children:"Cargando…"}),e&&y.jsxs("div",{className:He.error,role:"alert",children:["Error: ",e]}),y.jsx("h3",{className:He.h3,children:"Listado de celdas"}),y.jsxs("div",{className:He.capacityCard,children:[y.jsxs("div",{className:He.capacityHeader,children:[y.jsx("strong",{children:"Capacidad hoy"}),y.jsx("span",{className:He.turnPill,children:U==="Manana"?"Turno actual: AM":U==="Tarde"?"Turno actual: PM":"Fuera de horario"})]}),y.jsxs("div",{className:He.capacityGrid,children:[y.jsxs("div",{className:He.capacityItem,children:[y.jsx("div",{className:He.capacityLabel,children:"Carros disponibles"}),y.jsxs("div",{className:He.capacityValue,children:[ie.libresCarros,y.jsxs("span",{className:He.capacityTotal,children:["/ ",ie.totalCarros]})]})]}),y.jsxs("div",{className:He.capacityItem,children:[y.jsx("div",{className:He.capacityLabel,children:"Motos disponibles"}),y.jsxs("div",{className:He.capacityValue,children:[ie.libresMotos,y.jsxs("span",{className:He.capacityTotal,children:["/ ",ie.totalMotos]})]})]})]}),y.jsx("div",{style:{marginTop:6},children:y.jsx("small",{children:he})})]}),y.jsxs("div",{className:He.filtersBar,children:[y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Tipo de celda"}),y.jsxs("select",{className:He.pageSizeSelect,value:d,onChange:b=>g(b.target.value),children:[y.jsx("option",{value:"all",children:"Todas"}),y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Itinerancia"}),y.jsxs("select",{className:He.pageSizeSelect,value:p,onChange:b=>v(b.target.value),children:[y.jsx("option",{value:"all",children:"Todas"}),y.jsx("option",{value:"Empleado Fijo",children:"Empleado Fijo"}),y.jsx("option",{value:"Empleado Itinerante",children:"Empleado Itinerante"}),y.jsx("option",{value:"Directivo",children:"Directivo"})]})]}),y.jsx("div",{className:He.searchBox,children:y.jsx("input",{className:He.searchInput,type:"text",placeholder:"Buscar por código…",value:l,onChange:b=>c(b.target.value),onKeyDown:h,"aria-label":"Buscar celda por código"})}),y.jsxs("div",{className:He.pageSizeBox,children:[y.jsx("span",{children:"Registros por página"}),y.jsxs("select",{className:He.pageSizeSelect,value:_,onChange:b=>T(Number(b.target.value)||50),children:[y.jsx("option",{value:6,children:"6"}),y.jsx("option",{value:12,children:"12"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]}),y.jsx("div",{className:He.actionsRight,children:y.jsx("button",{type:"button",className:`${He.btn} ${He.btnPrimary} ${He.btnAdd}`,onClick:H,disabled:Te,children:"Añadir celda"})})]}),t.length===0?y.jsx("div",{className:He.emptyGrid,children:"Sin resultados."}):y.jsx("ul",{className:He.cardGrid,children:t.map(b=>{const L=b.Activa==="Activa",P=b.__occ||{},K=!!P.Manana,Z=!!P.Tarde,be=ue(L,K,"AM",U==="Manana"&&K,P.PorManana),Ce=ue(L,Z,"PM",U==="Tarde"&&Z,P.PorTarde);return y.jsx("li",{className:He.card,children:y.jsxs("div",{className:He.cardHeader,children:[y.jsxs("div",{className:He.celdaTitle,children:[y.jsx("span",{className:He.cardCode,children:b.Title}),y.jsx("br",{}),y.jsxs("span",{className:He.metaLabel,children:["Tipo: ",b.TipoCelda]}),y.jsx("br",{}),y.jsxs("span",{className:He.metaLabel,children:["Itinerancia: ",b.Itinerancia]})]}),y.jsx("button",{type:"button",className:He.btnLink,onClick:()=>Ae(b),disabled:q,"aria-disabled":q,children:"Detalles"}),y.jsxs("div",{className:He.badgeGroup,children:[be,Ce]})]})},b.Id)})}),y.jsxs("div",{className:He.paginationBar,children:[y.jsx("button",{type:"button",className:He.pageBtn,onClick:x,disabled:a===0,children:"← Anterior"}),y.jsxs("span",{className:He.pageInfo,children:["Página ",a+1]}),y.jsx("button",{type:"button",className:He.pageBtn,onClick:C,disabled:!s,children:"Siguiente →"})]}),A&&y.jsx("div",{className:He.modalBackdrop,onClick:Y,children:y.jsxs("div",{className:He.modal,onClick:b=>b.stopPropagation(),children:[y.jsx("h4",{children:"Nueva celda"}),k&&y.jsx("div",{className:He.error,children:k}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Código"}),y.jsx("input",{className:He.searchInput,value:O.Title,onChange:b=>I(L=>({...L,Title:b.target.value})),placeholder:"Ej: A-02"})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Tipo"}),y.jsxs("select",{className:He.pageSizeSelect,value:O.TipoCelda,onChange:b=>I(L=>({...L,TipoCelda:b.target.value})),children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Estado"}),y.jsxs("select",{className:He.pageSizeSelect,value:O.Activa,onChange:b=>I(L=>({...L,Activa:b.target.value})),children:[y.jsx("option",{value:"Activa",children:"Activa"}),y.jsx("option",{value:"Inactiva",children:"Inactiva"})]})]}),y.jsxs("label",{className:He.field,children:[y.jsx("span",{children:"Itinerancia"}),y.jsxs("select",{className:He.pageSizeSelect,value:O.Itinerancia,onChange:b=>I(L=>({...L,Itinerancia:b.target.value})),children:[y.jsx("option",{value:"Empleado Fijo",children:"Empleado Fijo"}),y.jsx("option",{value:"Empleado Itinerante",children:"Empleado Itinerante"}),y.jsx("option",{value:"Directivo",children:"Directivo"})]})]}),y.jsxs("div",{className:He.modalActions,children:[y.jsx("button",{type:"button",className:He.btnGhost,onClick:Y,disabled:B,children:"Cancelar"}),y.jsx("button",{type:"button",className:He.btn,onClick:G,disabled:!j||B,children:B?"Creando…":"Crear"})]})]})}),ke&&re&&y.jsx(Ck,{open:ke,slot:re,onClose:je,workers:xe,workersLoading:fe})]})},Ak="_wrapper_4727i_43",wk="_card_4727i_57",bk="_title_4727i_77",Ik="_form_4727i_93",Rk="_field_4727i_105",Nk="_label_4727i_115",kk="_input_4727i_125",Ok="_horarioswrap_4727i_193",Mk="_horBadge_4727i_211",Dk="_sep_4727i_241",Pk="_error_4727i_309",Fk="_ok_4727i_329",Lk="_actions_4727i_351",Uk="_button_4727i_365",Bk="_horInline_4727i_537",Hk="_time_4727i_229",it={wrapper:Ak,card:wk,title:bk,form:Ik,field:Rk,label:Nk,input:kk,horarioswrap:Ok,horBadge:Mk,sep:Dk,error:Pk,ok:Fk,actions:Lk,button:Uk,horInline:Bk,time:Hk},ao=(n,e,t)=>Math.max(e,Math.min(t,Number.isFinite(n)?n:e)),Fu=n=>String(ao(n,0,23)).padStart(2,"0")+":00",Lu=(n,e)=>{if(!n)return e;const[t]=n.split(":"),a=Number(t);return Number.isFinite(a)?a:e},C0=n=>typeof n=="string"?n:n==null?"":String(n),Kt={VisibleDays:3,TyC:"",InicioManana:7,FinalManana:12,InicioTarde:12,FinalTarde:18,PicoPlaca:!1},jk=({port:n,initial:e})=>{const[t,a]=V.useState({VisibleDays:e?.VisibleDays??Kt.VisibleDays,TyC:C0(e?.TyC??Kt.TyC),InicioManana:e?.InicioManana??Kt.InicioManana,FinalManana:e?.FinalManana??Kt.FinalManana,InicioTarde:e?.InicioTarde??Kt.InicioTarde,FinalTarde:e?.FinalTarde??Kt.FinalTarde,PicoPlaca:e?.PicoPlaca??Kt.PicoPlaca}),[s,l]=V.useState(null),[c,h]=V.useState(!0),[d,g]=V.useState(!1),[p,v]=V.useState(null),[_,T]=V.useState(null),C=V.useRef(!1);V.useEffect(()=>{if(C.current)return;let H=!1;return(async()=>{try{h(!0);const Y=await n.getOne();if(H)return;l(Y),a(I=>({VisibleDays:Y.VisibleDays??I.VisibleDays??Kt.VisibleDays,TyC:I.TyC&&I.TyC!==Kt.TyC?I.TyC:C0(Y.TyC??Kt.TyC),InicioManana:Y.InicioManana??I.InicioManana??Kt.InicioManana,FinalManana:Y.FinalManana??I.FinalManana??Kt.FinalManana,InicioTarde:Y.InicioTarde??I.InicioTarde??Kt.InicioTarde,FinalTarde:Y.FinalTarde??I.FinalTarde??Kt.FinalTarde,PicoPlaca:Y.PicoPlaca??I.PicoPlaca??Kt.PicoPlaca}))}catch(Y){H||v(Y?.message??"No se pudieron cargar los ajustes.")}finally{H||(C.current=!0,h(!1))}})(),()=>{H=!0}},[n]);const x=V.useMemo(()=>{const H={};return t.VisibleDays<1&&(H.VisibleDays="Debe ser ≥ 1 día."),(t.InicioManana<0||t.InicioManana>12)&&(H.InicioManana="Debe estar entre 0 y 12."),(t.FinalManana<0||t.FinalManana>12)&&(H.FinalManana="Debe estar entre 0 y 12."),!H.InicioManana&&!H.FinalManana&&t.InicioManana>=t.FinalManana&&(H.FinalManana="Debe ser mayor que el inicio AM."),(t.InicioTarde<12||t.InicioTarde>23)&&(H.InicioTarde="Debe estar entre 12 y 23."),(t.FinalTarde<12||t.FinalTarde>23)&&(H.FinalTarde="Debe estar entre 12 y 23."),!H.InicioTarde&&!H.FinalTarde&&t.InicioTarde>=t.FinalTarde&&(H.FinalTarde="Debe ser mayor que el inicio PM."),!H.FinalManana&&!H.InicioTarde&&t.FinalManana>t.InicioTarde&&(H.InicioTarde="El inicio PM debe ser ≥ al final AM."),H},[t]),A=Object.keys(x).length>0,B=(H,Y,I)=>G=>{const q=Number(G.target.value);a(ie=>({...ie,[H]:ao(q,Y,I)})),T(null),v(null)},k=H=>Y=>{a(I=>({...I,[H]:Y.target.value??""})),T(null),v(null)},O=H=>Y=>{a(I=>({...I,[H]:Y.target.checked})),T(null),v(null)},j=async()=>{if(!(!s||A)){g(!0),v(null),T(null);try{const H={VisibleDays:s.VisibleDays??Kt.VisibleDays,TyC:C0(s.TyC??Kt.TyC),InicioManana:s.InicioManana??Kt.InicioManana,FinalManana:s.FinalManana??Kt.FinalManana,InicioTarde:s.InicioTarde??Kt.InicioTarde,FinalTarde:s.FinalTarde??Kt.FinalTarde,PicoPlaca:s.PicoPlaca??Kt.PicoPlaca},Y={};if(t.VisibleDays!==H.VisibleDays&&(Y.VisibleDays=t.VisibleDays),t.TyC!==H.TyC&&(Y.TyC=t.TyC),t.InicioManana!==H.InicioManana&&(Y.InicioManana=t.InicioManana),t.FinalManana!==H.FinalManana&&(Y.FinalManana=t.FinalManana),t.InicioTarde!==H.InicioTarde&&(Y.InicioTarde=t.InicioTarde),t.FinalTarde!==H.FinalTarde&&(Y.FinalTarde=t.FinalTarde),t.PicoPlaca!==H.PicoPlaca&&(Y.PicoPlaca=t.PicoPlaca),Object.keys(Y).length===0){T("No hay cambios por guardar.");return}await n.update(s.ID,Y),l({...s,...Y}),T("Ajustes guardados correctamente.")}catch(H){console.error(H),v(H?.message??"No se pudo guardar los ajustes.")}finally{g(!1)}}};return c?y.jsx("div",{children:"Cargando ajustes…"}):y.jsx("div",{className:it.wrapper,children:y.jsxs("div",{className:it.card,children:[y.jsx("h2",{className:it.title,children:"Parámetros de Reservas"}),y.jsx("div",{className:it.form,children:y.jsxs("div",{className:it.field,children:[y.jsxs("label",{className:it.label,htmlFor:"VisibleDays",children:["Días máximos visibles",y.jsx("span",{title:"Con cuánto tiempo de antelación permite reservar la aplicación",style:{cursor:"help"},children:" ℹ️"})]}),y.jsx("input",{id:"VisibleDays",className:it.input,type:"number",min:1,max:60,value:t.VisibleDays,onChange:B("VisibleDays",1,60)}),x.VisibleDays&&y.jsx("div",{className:it.error,children:x.VisibleDays})]})}),y.jsx("div",{className:it.form,children:y.jsxs("div",{className:it.field,children:[y.jsxs("label",{className:it.label,htmlFor:"TyC",children:["Términos y condiciones",y.jsx("span",{title:"Términos y condiciones del parqueadero.",style:{cursor:"help"},children:" ℹ️"})]}),y.jsx("textarea",{id:"TyC",className:it.textarea,value:t.TyC,onChange:k("TyC"),rows:12,placeholder:"Escribe los términos y condiciones…"})]})}),y.jsx("div",{className:it.form,children:y.jsxs("div",{className:it.field,children:[y.jsxs("label",{className:it.label,htmlFor:"Horarios",children:["Horarios Parqueaderos",y.jsx("span",{title:"A qué hora inician y finalizan los turnos del parqueadero",style:{cursor:"help"},children:" ℹ️"})]}),y.jsxs("div",{className:it.horarioswrap,children:[y.jsxs("div",{className:it.horInline,children:[y.jsx("span",{className:it.horBadge,children:"AM"}),y.jsx("input",{id:"InicioManana",type:"time",className:it.time,step:3600,min:"00:00",max:"12:00",value:Fu(t.InicioManana),onChange:H=>{const Y=ao(Lu(H.target.value,t.InicioManana),0,12);a(I=>({...I,InicioManana:Y})),T(null),v(null)}}),y.jsx("span",{className:it.sep,children:"–"}),y.jsx("input",{id:"FinalManana",type:"time",className:it.time,step:3600,min:"00:00",max:"12:00",value:Fu(t.FinalManana),onChange:H=>{const Y=ao(Lu(H.target.value,t.FinalManana),0,12);a(I=>({...I,FinalManana:Y})),T(null),v(null)}})]}),y.jsxs("div",{className:it.horInline,children:[y.jsx("span",{className:it.horBadge,children:"PM"}),y.jsx("input",{id:"InicioTarde",type:"time",className:it.time,step:3600,min:"12:00",max:"23:00",value:Fu(t.InicioTarde),onChange:H=>{const Y=ao(Lu(H.target.value,t.InicioTarde),12,23);a(I=>({...I,InicioTarde:Y})),T(null),v(null)}}),y.jsx("span",{className:it.sep,children:"–"}),y.jsx("input",{id:"FinalTarde",type:"time",className:it.time,step:3600,min:"12:00",max:"23:00",value:Fu(t.FinalTarde),onChange:H=>{const Y=ao(Lu(H.target.value,t.FinalTarde),12,23);a(I=>({...I,FinalTarde:Y})),T(null),v(null)}})]})]}),y.jsxs("div",{children:[x.InicioManana&&y.jsxs("div",{className:it.error,children:["Inicio AM: ",x.InicioManana]}),x.FinalManana&&y.jsxs("div",{className:it.error,children:["Final AM: ",x.FinalManana]}),x.InicioTarde&&y.jsxs("div",{className:it.error,children:["Inicio PM: ",x.InicioTarde]}),x.FinalTarde&&y.jsxs("div",{className:it.error,children:["Final PM: ",x.FinalTarde]})]})]})}),y.jsx("div",{className:it.form,children:y.jsxs("div",{className:it.field,children:[y.jsxs("label",{className:it.label,htmlFor:"PicoPlaca",children:["Pico y Placa activo",y.jsx("span",{title:"Si está activo, se aplican las exclusiones de pico y placa en reservas.",style:{cursor:"help"},children:" ℹ️"})]}),y.jsx("input",{id:"PicoPlaca",className:it.checkbox,type:"checkbox",checked:!!t.PicoPlaca,onChange:O("PicoPlaca")})]})}),p&&y.jsx("div",{className:it.error,children:p}),_&&y.jsx("div",{className:it.ok,children:_}),y.jsx("div",{className:it.actions,children:y.jsx("button",{className:it.button,onClick:j,disabled:d||A,children:d?"Guardando…":"Guardar"})})]})})},zk="_section_ibg0g_3",Gk="_card_ibg0g_15",$k="_title_ibg0g_33",Kk="_topBarGrid_ibg0g_49",Vk="_groupLeft_ibg0g_65",qk="_groupCenter_ibg0g_67",Yk="_groupRight_ibg0g_69",Xk="_segmented_ibg0g_75",Wk="_segmentBtn_ibg0g_91",Qk="_segmentBtnActive_ibg0g_123",Jk="_searchForm_ibg0g_129",Zk="_searchInput_ibg0g_143",eO="_searchClear_ibg0g_173",tO="_button_ibg0g_197",nO="_tableWrap_ibg0g_231",rO="_table_ibg0g_231",aO="_theadRow_ibg0g_259",iO="_th_ibg0g_259",sO="_td_ibg0g_291",oO="_paginationBar_ibg0g_309",lO="_paginationLeft_ibg0g_325",cO="_pageBtn_ibg0g_327",uO="_pageInfo_ibg0g_349",hO="_paginationRight_ibg0g_353",fO="_pageSizeLabel_ibg0g_355",dO="_pageSizeSelect_ibg0g_357",gO="_info_ibg0g_375",mO="_error_ibg0g_385",pO="_iconBtn_ibg0g_463",vO="_iconBtnDanger_ibg0g_505",Xe={section:zk,card:Gk,title:$k,topBarGrid:Kk,groupLeft:Vk,groupCenter:qk,groupRight:Yk,segmented:Xk,segmentBtn:Wk,segmentBtnActive:Qk,searchForm:Jk,searchInput:Zk,searchClear:eO,button:tO,tableWrap:nO,table:rO,theadRow:aO,th:iO,td:sO,paginationBar:oO,paginationLeft:lO,pageBtn:cO,pageInfo:uO,paginationRight:hO,pageSizeLabel:fO,pageSizeSelect:dO,info:gO,error:mO,iconBtn:pO,iconBtnDanger:vO},yO="_overlay_1ly26_51",TO="_modal_1ly26_51",_O="_header_1ly26_105",xO="_title_1ly26_113",SO="_closeBtn_1ly26_115",CO="_body_1ly26_133",EO="_label_1ly26_151",AO="_fieldset_1ly26_153",wO="_comboColab_1ly26_179",bO="_input_1ly26_199",IO="_select_1ly26_199",RO="_hint_1ly26_237",NO="_actions_1ly26_251",kO="_btnPrimary_1ly26_267",OO="_btnGhost_1ly26_267",MO="_row2_1ly26_311",It={overlay:yO,modal:TO,header:_O,title:xO,closeBtn:SO,body:CO,label:EO,fieldset:AO,comboColab:wO,input:bO,select:IO,hint:RO,actions:NO,btnPrimary:kO,btnGhost:OO,row2:MO},dT={nombre:"",correo:"",tipoVehiculo:"Carro",placa:"",codigoCelda:"",IdSpot:""},gT=n=>n.normalize("NFD").replace(new RegExp("\\p{Diacritic}","gu"),"").toLowerCase().trim(),DO=n=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(String(n).trim()),PO=n=>/^[A-Z]{3}\d{3}$/i.test(String(n).trim()),FO=({isOpen:n,onClose:e,onSave:t,workers:a=[],workersLoading:s=!1})=>{const[l,c]=V.useState(dT),[h,d]=V.useState(!1),[g,p]=V.useState(null),[v,_]=V.useState(""),[T,C]=V.useState(""),x=V.useRef(null);V.useEffect(()=>{n&&(c(dT),_(""),C(""),p(null),setTimeout(()=>x.current?.focus(),0))},[n]),V.useEffect(()=>{if(!n)return;const I=G=>{G.key==="Escape"&&!h&&e()};return window.addEventListener("keydown",I),()=>window.removeEventListener("keydown",I)},[n,h,e]);const A=V.useMemo(()=>{if(!v)return a;const I=gT(v);return a.filter(G=>gT(`${G.displayName} ${G.mail??""} ${G.jobTitle??""}`).includes(I))},[a,v]),B=V.useRef(null),k=async I=>{C(I);const G=a.find(J=>String(J.id)===String(I));if(!G){c(J=>({...J,nombre:"",correo:""}));return}const q=Symbol();B.current=q;let ie=G.displayName||"";try{const J=await CS(ie);if(B.current!==q)return;J||(ie="")}catch{if(B.current!==q)return;ie=""}c(J=>({...J,nombre:ie,correo:G.mail||""})),p(null)},O=V.useMemo(()=>{const I={};return l.nombre.trim()||(I.nombre="El nombre es obligatorio."),DO(l.correo)||(I.correo="Correo inválido."),PO(l.placa)||(I.placa="Formato de placa inválido (ej: ABC123)."),I},[l]),j=Object.keys(O).length>0,H=async I=>{if(I.preventDefault(),!(h||j))try{d(!0),p(null),await t?.(l),e()}catch(G){p(G?.message??"No se pudo guardar el colaborador.")}finally{d(!1)}};if(!n)return null;const Y=I=>{I.target===I.currentTarget&&!h&&e()};return y.jsx("div",{className:It.overlay,role:"dialog","aria-modal":"true",onMouseDown:Y,children:y.jsxs("div",{className:It.modal,onMouseDown:I=>I.stopPropagation(),children:[y.jsxs("header",{className:It.header,children:[y.jsx("h2",{className:It.title,children:"Agregar colaborador"}),y.jsx("button",{className:It.closeBtn,onClick:e,"aria-label":"Cerrar",disabled:h,children:"×"})]}),y.jsxs("form",{className:It.body,onSubmit:H,noValidate:!0,children:[y.jsxs("fieldset",{className:It.fieldset,children:[y.jsx("label",{className:It.label,children:"Colaborador"}),y.jsxs("div",{className:It.comboColab,children:[y.jsx("input",{ref:x,className:It.input,type:"text",placeholder:"Buscar por nombre, correo o cargo…",value:v,onChange:I=>_(I.target.value),disabled:s||h,autoComplete:"off"}),y.jsxs("select",{className:It.select,value:T,onChange:I=>k(I.target.value),disabled:s||h,children:[y.jsx("option",{value:"",children:s?"Cargando colaboradores…":A.length===0?"Sin resultados":"Selecciona un colaborador (opcional)"}),A.map(I=>y.jsxs("option",{value:String(I.id),children:[I.displayName,I.mail?` · ${I.mail}`:"",I.jobTitle?` · ${I.jobTitle}`:""]},String(I.id)))]})]}),y.jsx("small",{className:It.hint,children:"Al seleccionar un colaborador, se llenan Nombre y Correo (puedes editarlos)."})]}),y.jsxs("label",{className:It.label,children:["Nombre",y.jsx("input",{className:It.input,type:"text",value:l.nombre,onChange:I=>c(G=>({...G,nombre:I.target.value})),required:!0,"aria-invalid":!!O.nombre}),O.nombre&&y.jsx("small",{className:It.error,children:O.nombre})]}),y.jsxs("label",{className:It.label,children:["Correo electrónico",y.jsx("input",{className:It.input,type:"email",value:l.correo,onChange:I=>c(G=>({...G,correo:I.target.value})),required:!0,"aria-invalid":!!O.correo}),O.correo&&y.jsx("small",{className:It.error,children:O.correo})]}),y.jsxs("div",{className:It.row2,children:[y.jsxs("label",{className:It.label,children:["Tipo de vehículo",y.jsxs("select",{className:It.select,value:l.tipoVehiculo,onChange:I=>c(G=>({...G,tipoVehiculo:I.target.value})),disabled:h,children:[y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("label",{className:It.label,children:["Placa del vehículo",y.jsx("input",{className:It.input,type:"text",value:l.placa,onChange:I=>c(G=>({...G,placa:I.target.value.toUpperCase()})),placeholder:"Ej: ABC123",required:!0,"aria-invalid":!!O.placa}),O.placa&&y.jsx("small",{className:It.error,children:O.placa})]})]}),g&&y.jsx("div",{className:It.error,children:g}),y.jsxs("div",{className:It.actions,children:[y.jsx("button",{type:"button",className:It.btnGhost,onClick:e,disabled:h,children:"Cancelar"}),y.jsx("button",{type:"submit",className:It.btnPrimary,disabled:h||j,children:h?"Guardando…":"Guardar"})]})]})]})})},LO="_overlay_1bwmb_1",UO="_modal_1bwmb_19",BO="_header_1bwmb_35",HO="_title_1bwmb_43",jO="_closeBtn_1bwmb_45",zO="_body_1bwmb_57",GO="_label_1bwmb_67",$O="_actions_1bwmb_97",KO="_btnGhost_1bwmb_123",Fn={overlay:LO,modal:UO,header:BO,title:HO,closeBtn:jO,body:zO,label:GO,actions:$O,btnGhost:KO},VO=({isOpen:n,onClose:e,collaborator:t})=>!n||!t?null:y.jsx("div",{className:Fn.overlay,role:"dialog","aria-modal":"true",children:y.jsxs("div",{className:Fn.modal,children:[y.jsxs("header",{className:Fn.header,children:[y.jsx("h2",{className:Fn.title,children:"Detalle del colaborador"}),y.jsx("button",{className:Fn.closeBtn,onClick:e,"aria-label":"Cerrar",children:"×"})]}),y.jsxs("div",{className:Fn.body,children:[y.jsxs("div",{style:{display:"grid",gap:12},children:[y.jsxs("div",{children:[y.jsx("div",{className:Fn.label,children:"Nombre"}),y.jsx("div",{className:Fn.value,children:t.nombre})]}),y.jsxs("div",{children:[y.jsx("div",{className:Fn.label,children:"Correo electrónico"}),y.jsx("div",{className:Fn.value,children:t.correo})]}),y.jsxs("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:12},children:[y.jsxs("div",{children:[y.jsx("div",{className:Fn.label,children:"Tipo de vehículo"}),y.jsx("div",{className:Fn.value,children:y.jsx("span",{className:"pill",children:t.tipoVehiculo})})]}),y.jsxs("div",{children:[y.jsx("div",{className:Fn.label,children:"Placa"}),y.jsx("div",{className:Fn.value,children:t.placa||"-"})]})]})]}),y.jsx("div",{className:Fn.actions,children:y.jsx("button",{type:"button",className:Fn.btnGhost,onClick:e,children:"Cerrar"})})]})]})}),qO=n=>({id:Number(n.ID??n.Id??n.id??0),nombre:String(n.Title??n.title??""),correo:String(n.Correo??n.correo??"-"),tipoVehiculo:n.Tipodevehiculo??n.tipoVehiculo,placa:String(n.Placa??n.placa??""),CodigoCelda:String(n.CodigoCelda??"")});function YO(n){const[e,t]=V.useState([]),[a,s]=V.useState([]),[l,c]=V.useState(!1),[h,d]=V.useState(null),[g,p]=V.useState(""),[v,_]=V.useState(20),[T,C]=V.useState(0),[x,A]=V.useState(!1),B=V.useCallback(async I=>{if(I)try{c(!0),d(null),await n.delete(String(I)),t(G=>{const q=G.filter(he=>String(he.id)!==String(I)),ie=Math.min(T*v,Math.max(0,q.length-1)),J=Math.floor(ie/v)*v;return s(q.slice(J,J+v)),C(J/v),A(J+v<q.length),q})}catch(G){throw console.error("[useCollaborators] deleteCollaborator error:",G),d(G?.message??"Error al eliminar colaborador"),G}finally{c(!1)}},[n,T,v]),k=V.useCallback(async I=>{try{c(!0),d(null);const G={Title:I.nombre,Correo:I.correo,Tipodevehiculo:I.tipoVehiculo,Placa:I.placa,CodigoCelda:I.codigoCelda},q=await n.create(G),ie=q?{id:Number(q.ID??Date.now()),nombre:String(q.Title??I.nombre),correo:String(q.Correo??I.correo),tipoVehiculo:q.Tipodevehiculo??I.tipoVehiculo,placa:String(q.Placa??I.placa),CodigoCelda:String(q.CodigoCelda??I.codigoCelda??"")}:{id:Date.now(),nombre:I.nombre,correo:I.correo,tipoVehiculo:I.tipoVehiculo,placa:I.placa,CodigoCelda:String(I.codigoCelda??"")};t(J=>{const he=[ie,...J];return s(he.slice(0,v)),A(he.length>v),C(0),he})}catch(G){console.error("[useCollaborators] addCollaborator error:",G),d(G?.message??"No se pudo agregar el colaborador")}finally{c(!1)}},[n,v]),O=V.useCallback(async()=>{c(!0),d(null);try{const G=g.trim().toLowerCase().replace(/'/g,"''"),q=[];G&&q.push(`(contains(tolower(fields/Title),'${G}') or contains(tolower(fields/Correo),'${G}'))`);const J=(await n.getAll({top:2e3,orderby:"fields/Title asc",...q.length?{filter:q.join(" and ")}:{}})).map(qO);t(J),s(J.slice(0,v)),C(0),A(J.length>v)}catch(I){console.error("[useCollaborators] reloadAll error:",I),t([]),s([]),d(I?.message??"Error al cargar colaboradores"),A(!1)}finally{c(!1)}},[n,g,v]),j=V.useCallback(I=>{const G=Number.isFinite(I)&&I>0?Math.floor(I):20;_(G);const q=e.slice(0,G);s(q),C(0),A(e.length>G)},[e]),H=V.useCallback(()=>{if(l)return;const I=T+1,G=I*v,q=G+v;G>=e.length||(s(e.slice(G,q)),C(I),A(q<e.length))},[l,T,v,e]),Y=V.useCallback(()=>{if(l||T===0)return;const I=T-1,G=I*v,q=G+v;s(e.slice(G,q)),C(I),A(e.length>q)},[l,T,v,e]);return V.useEffect(()=>{let I=!1;return(async()=>I||await O())(),()=>{I=!0}},[O]),{rows:a,loading:l,error:h,search:g,setSearch:p,pageSize:v,setPageSize:j,pageIndex:T,hasNext:x,nextPage:H,prevPage:Y,reloadAll:O,addCollaborator:k,deleteCollaborator:B}}const XO=()=>{const{colaboradoresFijos:n}=Ri(),{rows:e,loading:t,error:a,search:s,setSearch:l,pageSize:c,setPageSize:h,pageIndex:d,hasNext:g,nextPage:p,prevPage:v,reloadAll:_,addCollaborator:T,deleteCollaborator:C}=YO(n),{workers:x,loading:A,refresh:B}=_S(),[k,O]=V.useState(!1),[j,H]=V.useState(!1),[Y,I]=V.useState(null),[G]=V.useState([]),[q]=V.useState(!1),[ie,J]=V.useState("all"),he=async()=>{try{(!x||x.length===0)&&await B()}finally{O(!0)}},Ae=()=>O(!1),je=()=>{H(!1),I(null)},ke=V.useMemo(()=>ie==="all"?e:e.filter(fe=>fe.tipoVehiculo===ie),[e,ie]),re=fe=>{fe.key==="Enter"&&(fe.preventDefault(),_())},xe=async fe=>{!fe?.id||!window.confirm(`¿Eliminar a "${fe.nombre}"? Esta acción no se puede deshacer.`)||await C(String(fe.id))};return y.jsx("section",{className:Xe.section,children:y.jsxs("div",{className:Xe.card,children:[y.jsx("h1",{className:Xe.title,children:"Colaboradores inscritos"}),y.jsxs("div",{className:Xe.topBarGrid,children:[y.jsx("div",{className:Xe.groupLeft,children:y.jsxs("div",{className:Xe.segmented,children:[y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="all"?Xe.segmentBtnActive:""}`,onClick:()=>J("all"),disabled:t,title:"Ver todos",children:"Todos"}),y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="Carro"?Xe.segmentBtnActive:""}`,onClick:()=>J("Carro"),disabled:t,title:"Solo Carro",children:"Carro"}),y.jsx("button",{type:"button",className:`${Xe.segmentBtn} ${ie==="Moto"?Xe.segmentBtnActive:""}`,onClick:()=>J("Moto"),disabled:t,title:"Solo Moto",children:"Moto"})]})}),y.jsx("div",{className:Xe.groupCenter,children:y.jsxs("div",{className:Xe.searchForm,children:[y.jsx("input",{className:Xe.searchInput,type:"text",placeholder:"Buscar por nombre, correo o placa…",value:s,onChange:fe=>l(fe.target.value),onKeyDown:re}),s&&y.jsx("button",{type:"button",className:Xe.searchClear,onClick:()=>l(""),"aria-label":"Limpiar búsqueda",children:"✕"})]})}),y.jsx("div",{className:Xe.groupRight,children:y.jsx("button",{className:Xe.button,type:"button",onClick:he,children:"Agregar colaborador"})})]}),t&&y.jsx("div",{className:Xe.info,children:"Cargando…"}),a&&y.jsx("div",{className:Xe.error,children:a}),!t&&!a&&y.jsxs(y.Fragment,{children:[ke.length===0?y.jsx("div",{className:Xe.empty,children:"No hay colaboradores que coincidan."}):y.jsx("div",{className:Xe.tableWrap,children:y.jsxs("table",{className:Xe.table,children:[y.jsx("thead",{children:y.jsxs("tr",{className:Xe.theadRow,children:[y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Nombre"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Correo electrónico"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Tipo de vehículo"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Placa del vehículo"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Celda Asignada"}),y.jsx("th",{className:Xe.th,style:{textAlign:"center"},children:"Acciones"})]})}),y.jsx("tbody",{children:ke.map(fe=>y.jsxs("tr",{children:[y.jsx("td",{className:Xe.td,children:fe.nombre}),y.jsx("td",{className:Xe.td,children:fe.correo}),y.jsx("td",{className:Xe.td,children:fe.tipoVehiculo}),y.jsx("td",{className:Xe.td,children:fe.placa}),y.jsx("td",{className:Xe.td,children:fe.CodigoCelda}),y.jsx("td",{className:Xe.td,children:y.jsx("button",{type:"button",className:`${Xe.iconBtn} ${Xe.iconBtnDanger}`,title:"Eliminar colaborador","aria-label":`Eliminar ${fe.nombre}`,onClick:()=>xe(fe),disabled:t,children:y.jsx("svg",{width:"16",height:"16",viewBox:"0 0 24 24","aria-hidden":"true",children:y.jsx("path",{d:"M9 3h6a1 1 0 0 1 1 1v1h4v2H4V5h4V4a1 1 0 0 1 1-1zm2 0v1h2V3h-2zM6 9h12l-1 11a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2L6 9zm4 2v8h2v-8h-2zm-4 0h2v8H8v-8zm8 0h2v8h-2v-8z"})})})})]},fe.id))})]})}),y.jsxs("div",{className:Xe.paginationBar,children:[y.jsxs("div",{className:Xe.paginationLeft,children:[y.jsx("button",{className:Xe.pageBtn,onClick:v,disabled:d===0,children:"← Anterior"}),y.jsx("button",{className:Xe.pageBtn,onClick:p,disabled:!g,children:"Siguiente →"}),y.jsxs("span",{className:Xe.pageInfo,children:["Página ",d+1]})]}),y.jsx("div",{className:Xe.paginationRight,children:y.jsxs("label",{className:Xe.pageSizeLabel,children:["Filas por página",y.jsxs("select",{className:Xe.pageSizeSelect,value:c,onChange:fe=>h(Number(fe.target.value)||10),children:[y.jsx("option",{value:5,children:"5"}),y.jsx("option",{value:10,children:"10"}),y.jsx("option",{value:20,children:"20"}),y.jsx("option",{value:50,children:"50"})]})]})})]})]}),y.jsx(FO,{isOpen:k,onClose:Ae,onSave:async fe=>{await T(fe),Ae()},slots:G,slotsLoading:q,workers:x,workersLoading:A}),y.jsx(VO,{isOpen:j,onClose:je,collaborator:Y})]})})},WO="_wrapper_19t0b_29",QO="_header_19t0b_39",JO="_title_19t0b_53",ZO="_aforo_19t0b_65",e4="_aforoCap_19t0b_75",t4="_filters_19t0b_79",n4="_field_19t0b_101",r4="_actions_19t0b_161",a4="_btn_19t0b_177",i4="_btnPrimary_19t0b_179",s4="_info_19t0b_231",o4="_error_19t0b_233",l4="_tableWrap_19t0b_237",c4="_table_19t0b_237",u4="_empty_19t0b_301",dn={wrapper:WO,header:QO,title:JO,aforo:ZO,aforoCap:e4,filters:t4,field:n4,actions:r4,btn:a4,btnPrimary:i4,info:s4,error:o4,tableWrap:l4,table:c4,empty:u4};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var ph={};ph.version="0.18.5";var ES=1252,h4=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],AS=function(n){h4.indexOf(n)!=-1&&(ES=n)};function f4(){AS(1252)}var Zl=function(n){AS(n)};function d4(){Zl(1200),f4()}var Uu=function(e){return String.fromCharCode(e)},mT=function(e){return String.fromCharCode(e)},vh,yi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ec(n){for(var e="",t=0,a=0,s=0,l=0,c=0,h=0,d=0,g=0;g<n.length;)t=n.charCodeAt(g++),l=t>>2,a=n.charCodeAt(g++),c=(t&3)<<4|a>>4,s=n.charCodeAt(g++),h=(a&15)<<2|s>>6,d=s&63,isNaN(a)?h=d=64:isNaN(s)&&(d=64),e+=yi.charAt(l)+yi.charAt(c)+yi.charAt(h)+yi.charAt(d);return e}function ja(n){var e="",t=0,a=0,s=0,l=0,c=0,h=0,d=0;n=n.replace(/[^\w\+\/\=]/g,"");for(var g=0;g<n.length;)l=yi.indexOf(n.charAt(g++)),c=yi.indexOf(n.charAt(g++)),t=l<<2|c>>4,e+=String.fromCharCode(t),h=yi.indexOf(n.charAt(g++)),a=(c&15)<<4|h>>2,h!==64&&(e+=String.fromCharCode(a)),d=yi.indexOf(n.charAt(g++)),s=(h&3)<<6|d,d!==64&&(e+=String.fromCharCode(s));return e}var mt=(function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node})(),Ga=(function(){if(typeof Buffer<"u"){var n=!Buffer.from;if(!n)try{Buffer.from("foo","utf8")}catch{n=!0}return n?function(e,t){return t?new Buffer(e,t):new Buffer(e)}:Buffer.from.bind(Buffer)}return function(){}})();function ls(n){return mt?Buffer.alloc?Buffer.alloc(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}function pT(n){return mt?Buffer.allocUnsafe?Buffer.allocUnsafe(n):new Buffer(n):typeof Uint8Array<"u"?new Uint8Array(n):new Array(n)}var Wr=function(e){return mt?Ga(e,"binary"):e.split("").map(function(t){return t.charCodeAt(0)&255})};function Wh(n){if(typeof ArrayBuffer>"u")return Wr(n);for(var e=new ArrayBuffer(n.length),t=new Uint8Array(e),a=0;a!=n.length;++a)t[a]=n.charCodeAt(a)&255;return e}function oc(n){if(Array.isArray(n))return n.map(function(a){return String.fromCharCode(a)}).join("");for(var e=[],t=0;t<n.length;++t)e[t]=String.fromCharCode(n[t]);return e.join("")}function g4(n){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(n)}var In=mt?function(n){return Buffer.concat(n.map(function(e){return Buffer.isBuffer(e)?e:Ga(e)}))}:function(n){if(typeof Uint8Array<"u"){var e=0,t=0;for(e=0;e<n.length;++e)t+=n[e].length;var a=new Uint8Array(t),s=0;for(e=0,t=0;e<n.length;t+=s,++e)if(s=n[e].length,n[e]instanceof Uint8Array)a.set(n[e],t);else{if(typeof n[e]=="string")throw"wtf";a.set(new Uint8Array(n[e]),t)}return a}return[].concat.apply([],n.map(function(l){return Array.isArray(l)?l:[].slice.call(l)}))};function m4(n){for(var e=[],t=0,a=n.length+250,s=ls(n.length+255),l=0;l<n.length;++l){var c=n.charCodeAt(l);if(c<128)s[t++]=c;else if(c<2048)s[t++]=192|c>>6&31,s[t++]=128|c&63;else if(c>=55296&&c<57344){c=(c&1023)+64;var h=n.charCodeAt(++l)&1023;s[t++]=240|c>>8&7,s[t++]=128|c>>2&63,s[t++]=128|h>>6&15|(c&3)<<4,s[t++]=128|h&63}else s[t++]=224|c>>12&15,s[t++]=128|c>>6&63,s[t++]=128|c&63;t>a&&(e.push(s.slice(0,t)),t=0,s=ls(65535),a=65530)}return e.push(s.slice(0,t)),In(e)}var jl=/\u0000/g,Bu=/[\u0001-\u0006]/g;function uo(n){for(var e="",t=n.length-1;t>=0;)e+=n.charAt(t--);return e}function Jr(n,e){var t=""+n;return t.length>=e?t:Vt("0",e-t.length)+t}function hm(n,e){var t=""+n;return t.length>=e?t:Vt(" ",e-t.length)+t}function yh(n,e){var t=""+n;return t.length>=e?t:t+Vt(" ",e-t.length)}function p4(n,e){var t=""+Math.round(n);return t.length>=e?t:Vt("0",e-t.length)+t}function v4(n,e){var t=""+n;return t.length>=e?t:Vt("0",e-t.length)+t}var vT=Math.pow(2,32);function Zs(n,e){if(n>vT||n<-vT)return p4(n,e);var t=Math.round(n);return v4(t,e)}function Th(n,e){return e=e||0,n.length>=7+e&&(n.charCodeAt(e)|32)===103&&(n.charCodeAt(e+1)|32)===101&&(n.charCodeAt(e+2)|32)===110&&(n.charCodeAt(e+3)|32)===101&&(n.charCodeAt(e+4)|32)===114&&(n.charCodeAt(e+5)|32)===97&&(n.charCodeAt(e+6)|32)===108}var yT=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],E0=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function y4(n){return n||(n={}),n[0]="General",n[1]="0",n[2]="0.00",n[3]="#,##0",n[4]="#,##0.00",n[9]="0%",n[10]="0.00%",n[11]="0.00E+00",n[12]="# ?/?",n[13]="# ??/??",n[14]="m/d/yy",n[15]="d-mmm-yy",n[16]="d-mmm",n[17]="mmm-yy",n[18]="h:mm AM/PM",n[19]="h:mm:ss AM/PM",n[20]="h:mm",n[21]="h:mm:ss",n[22]="m/d/yy h:mm",n[37]="#,##0 ;(#,##0)",n[38]="#,##0 ;[Red](#,##0)",n[39]="#,##0.00;(#,##0.00)",n[40]="#,##0.00;[Red](#,##0.00)",n[45]="mm:ss",n[46]="[h]:mm:ss",n[47]="mmss.0",n[48]="##0.0E+0",n[49]="@",n[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',n}var qt={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},TT={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},T4={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function _h(n,e,t){for(var a=n<0?-1:1,s=n*a,l=0,c=1,h=0,d=1,g=0,p=0,v=Math.floor(s);g<e&&(v=Math.floor(s),h=v*c+l,p=v*g+d,!(s-v<5e-8));)s=1/(s-v),l=c,c=h,d=g,g=p;if(p>e&&(g>e?(p=d,h=l):(p=g,h=c)),!t)return[0,a*h,p];var _=Math.floor(a*h/p);return[_,a*h-_*p,p]}function Hu(n,e,t){if(n>2958465||n<0)return null;var a=n|0,s=Math.floor(86400*(n-a)),l=0,c=[],h={D:a,T:s,u:86400*(n-a)-s,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(h.u)<1e-6&&(h.u=0),e&&e.date1904&&(a+=1462),h.u>.9999&&(h.u=0,++s==86400&&(h.T=s=0,++a,++h.D)),a===60)c=t?[1317,10,29]:[1900,2,29],l=3;else if(a===0)c=t?[1317,8,29]:[1900,1,0],l=6;else{a>60&&--a;var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),c=[d.getFullYear(),d.getMonth()+1,d.getDate()],l=d.getDay(),a<60&&(l=(l+6)%7),t&&(l=w4(d,c))}return h.y=c[0],h.m=c[1],h.d=c[2],h.S=s%60,s=Math.floor(s/60),h.M=s%60,s=Math.floor(s/60),h.H=s,h.q=l,h}var wS=new Date(1899,11,31,0,0,0),_4=wS.getTime(),x4=new Date(1900,2,1,0,0,0);function bS(n,e){var t=n.getTime();return e?t-=1461*24*60*60*1e3:n>=x4&&(t+=1440*60*1e3),(t-(_4+(n.getTimezoneOffset()-wS.getTimezoneOffset())*6e4))/(1440*60*1e3)}function fm(n){return n.indexOf(".")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function S4(n){return n.indexOf("E")==-1?n:n.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function C4(n){var e=n<0?12:11,t=fm(n.toFixed(12));return t.length<=e||(t=n.toPrecision(10),t.length<=e)?t:n.toExponential(5)}function E4(n){var e=fm(n.toFixed(11));return e.length>(n<0?12:11)||e==="0"||e==="-0"?n.toPrecision(6):e}function A4(n){var e=Math.floor(Math.log(Math.abs(n))*Math.LOG10E),t;return e>=-4&&e<=-1?t=n.toPrecision(10+e):Math.abs(e)<=9?t=C4(n):e===10?t=n.toFixed(10).substr(0,12):t=E4(n),fm(S4(t.toUpperCase()))}function W0(n,e){switch(typeof n){case"string":return n;case"boolean":return n?"TRUE":"FALSE";case"number":return(n|0)===n?n.toString(10):A4(n);case"undefined":return"";case"object":if(n==null)return"";if(n instanceof Date)return wi(14,bS(n,e&&e.date1904),e)}throw new Error("unsupported value in General format: "+n)}function w4(n,e){e[0]-=581;var t=n.getDay();return n<60&&(t=(t+6)%7),t}function b4(n,e,t,a){var s="",l=0,c=0,h=t.y,d,g=0;switch(n){case 98:h=t.y+543;case 121:switch(e.length){case 1:case 2:d=h%100,g=2;break;default:d=h%1e4,g=4;break}break;case 109:switch(e.length){case 1:case 2:d=t.m,g=e.length;break;case 3:return E0[t.m-1][1];case 5:return E0[t.m-1][0];default:return E0[t.m-1][2]}break;case 100:switch(e.length){case 1:case 2:d=t.d,g=e.length;break;case 3:return yT[t.q][0];default:return yT[t.q][1]}break;case 104:switch(e.length){case 1:case 2:d=1+(t.H+11)%12,g=e.length;break;default:throw"bad hour format: "+e}break;case 72:switch(e.length){case 1:case 2:d=t.H,g=e.length;break;default:throw"bad hour format: "+e}break;case 77:switch(e.length){case 1:case 2:d=t.M,g=e.length;break;default:throw"bad minute format: "+e}break;case 115:if(e!="s"&&e!="ss"&&e!=".0"&&e!=".00"&&e!=".000")throw"bad second format: "+e;return t.u===0&&(e=="s"||e=="ss")?Jr(t.S,e.length):(a>=2?c=a===3?1e3:100:c=a===1?10:1,l=Math.round(c*(t.S+t.u)),l>=60*c&&(l=0),e==="s"?l===0?"0":""+l/c:(s=Jr(l,2+a),e==="ss"?s.substr(0,2):"."+s.substr(2,e.length-1)));case 90:switch(e){case"[h]":case"[hh]":d=t.D*24+t.H;break;case"[m]":case"[mm]":d=(t.D*24+t.H)*60+t.M;break;case"[s]":case"[ss]":d=((t.D*24+t.H)*60+t.M)*60+Math.round(t.S+t.u);break;default:throw"bad abstime format: "+e}g=e.length===3?1:2;break;case 101:d=h,g=1;break}var p=g>0?Jr(d,g):"";return p}function Ti(n){var e=3;if(n.length<=e)return n;for(var t=n.length%e,a=n.substr(0,t);t!=n.length;t+=e)a+=(a.length>0?",":"")+n.substr(t,e);return a}var IS=/%/g;function I4(n,e,t){var a=e.replace(IS,""),s=e.length-a.length;return La(n,a,t*Math.pow(10,2*s))+Vt("%",s)}function R4(n,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return La(n,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function RS(n,e){var t,a=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+RS(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(e/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),t.indexOf("e")===-1){var c=Math.floor(Math.log(e)*Math.LOG10E);for(t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l);t.substr(0,2)==="0.";)t=t.charAt(0)+t.substr(2,s)+"."+t.substr(2+s),t=t.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,d,g,p){return d+g+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=e.toExponential(a);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}var NS=/# (\?+)( ?)\/( ?)(\d+)/;function N4(n,e,t){var a=parseInt(n[4],10),s=Math.round(e*a),l=Math.floor(s/a),c=s-l*a,h=a;return t+(l===0?"":""+l)+" "+(c===0?Vt(" ",n[1].length+1+n[4].length):hm(c,n[1].length)+n[2]+"/"+n[3]+Jr(h,n[4].length))}function k4(n,e,t){return t+(e===0?"":""+e)+Vt(" ",n[1].length+2+n[4].length)}var kS=/^#*0*\.([0#]+)/,OS=/\).*[0#]/,MS=/\(###\) ###\\?-####/;function Yn(n){for(var e="",t,a=0;a!=n.length;++a)switch(t=n.charCodeAt(a)){case 35:break;case 63:e+=" ";break;case 48:e+="0";break;default:e+=String.fromCharCode(t)}return e}function _T(n,e){var t=Math.pow(10,e);return""+Math.round(n*t)/t}function xT(n,e){var t=n-Math.floor(n),a=Math.pow(10,e);return e<(""+Math.round(t*a)).length?0:Math.round(t*a)}function O4(n,e){return e<(""+Math.round((n-Math.floor(n))*Math.pow(10,e))).length?1:0}function M4(n){return n<2147483647&&n>-2147483648?""+(n>=0?n|0:n-1|0):""+Math.floor(n)}function Lr(n,e,t){if(n.charCodeAt(0)===40&&!e.match(OS)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?Lr("n",a,t):"("+Lr("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return R4(n,e,t);if(e.indexOf("%")!==-1)return I4(n,e,t);if(e.indexOf("E")!==-1)return RS(e,t);if(e.charCodeAt(0)===36)return"$"+Lr(n,e.substr(e.charAt(1)==" "?2:1),t);var s,l,c,h,d=Math.abs(t),g=t<0?"-":"";if(e.match(/^00+$/))return g+Zs(d,e.length);if(e.match(/^[#?]+$/))return s=Zs(t,0),s==="0"&&(s=""),s.length>e.length?s:Yn(e.substr(0,e.length-s.length))+s;if(l=e.match(NS))return N4(l,d,g);if(e.match(/^#+0+$/))return g+Zs(d,e.length-e.indexOf("0"));if(l=e.match(kS))return s=_T(t,l[1].length).replace(/^([^\.]+)$/,"$1."+Yn(l[1])).replace(/\.$/,"."+Yn(l[1])).replace(/\.(\d*)$/,function(C,x){return"."+x+Vt("0",Yn(l[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return g+_T(d,l[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return g+Ti(Zs(d,0));if(l=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+Lr(n,e,-t):Ti(""+(Math.floor(t)+O4(t,l[1].length)))+"."+Jr(xT(t,l[1].length),l[1].length);if(l=e.match(/^#,#*,#0/))return Lr(n,e.replace(/^#,#*,/,""),t);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=uo(Lr(n,e.replace(/[\\-]/g,""),t)),c=0,uo(uo(e.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<s.length?s.charAt(c++):C==="0"?"0":""}));if(e.match(MS))return s=Lr(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),h=_h(d,Math.pow(10,c)-1,!1),s=""+g,p=La("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=yh(h[2],c),p.length<l[4].length&&(p=Yn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),h=_h(d,Math.pow(10,c)-1,!0),g+(h[0]||(h[1]?"":"0"))+" "+(h[1]?hm(h[1],c)+l[2]+"/"+l[3]+yh(h[2],c):Vt(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return s=Zs(t,0),e.length<=s.length?s:Yn(e.substr(0,e.length-s.length))+s;if(l=e.match(/^([#0?]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=e.indexOf(".")-c,_=e.length-s.length-v;return Yn(e.substr(0,v)+s+e.substr(e.length-_))}if(l=e.match(/^00,000\.([#0]*0)$/))return c=xT(t,l[1].length),t<0?"-"+Lr(n,e,-t):Ti(M4(t)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?Jr(0,3-C.length):"")+C})+"."+Jr(c,l[1].length);switch(e){case"###,##0.00":return Lr(n,"#,##0.00",t);case"###,###":case"##,###":case"#,###":var T=Ti(Zs(d,0));return T!=="0"?g+T:"";case"###,###.00":return Lr(n,"###,##0.00",t).replace(/^0\./,".");case"#,###.00":return Lr(n,"#,##0.00",t).replace(/^0\./,".")}throw new Error("unsupported format |"+e+"|")}function D4(n,e,t){for(var a=e.length-1;e.charCodeAt(a-1)===44;)--a;return La(n,e.substr(0,a),t/Math.pow(10,3*(e.length-a)))}function P4(n,e,t){var a=e.replace(IS,""),s=e.length-a.length;return La(n,a,t*Math.pow(10,2*s))+Vt("%",s)}function DS(n,e){var t,a=n.indexOf("E")-n.indexOf(".")-1;if(n.match(/^#+0.0E\+0$/)){if(e==0)return"0.0E+0";if(e<0)return"-"+DS(n,-e);var s=n.indexOf(".");s===-1&&(s=n.indexOf("E"));var l=Math.floor(Math.log(e)*Math.LOG10E)%s;if(l<0&&(l+=s),t=(e/Math.pow(10,l)).toPrecision(a+1+(s+l)%s),!t.match(/[Ee]/)){var c=Math.floor(Math.log(e)*Math.LOG10E);t.indexOf(".")===-1?t=t.charAt(0)+"."+t.substr(1)+"E+"+(c-t.length+l):t+="E+"+(c-l),t=t.replace(/\+-/,"-")}t=t.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(h,d,g,p){return d+g+p.substr(0,(s+l)%s)+"."+p.substr(l)+"E"})}else t=e.toExponential(a);return n.match(/E\+00$/)&&t.match(/e[+-]\d$/)&&(t=t.substr(0,t.length-1)+"0"+t.charAt(t.length-1)),n.match(/E\-/)&&t.match(/e\+/)&&(t=t.replace(/e\+/,"e")),t.replace("e","E")}function da(n,e,t){if(n.charCodeAt(0)===40&&!e.match(OS)){var a=e.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return t>=0?da("n",a,t):"("+da("n",a,-t)+")"}if(e.charCodeAt(e.length-1)===44)return D4(n,e,t);if(e.indexOf("%")!==-1)return P4(n,e,t);if(e.indexOf("E")!==-1)return DS(e,t);if(e.charCodeAt(0)===36)return"$"+da(n,e.substr(e.charAt(1)==" "?2:1),t);var s,l,c,h,d=Math.abs(t),g=t<0?"-":"";if(e.match(/^00+$/))return g+Jr(d,e.length);if(e.match(/^[#?]+$/))return s=""+t,t===0&&(s=""),s.length>e.length?s:Yn(e.substr(0,e.length-s.length))+s;if(l=e.match(NS))return k4(l,d,g);if(e.match(/^#+0+$/))return g+Jr(d,e.length-e.indexOf("0"));if(l=e.match(kS))return s=(""+t).replace(/^([^\.]+)$/,"$1."+Yn(l[1])).replace(/\.$/,"."+Yn(l[1])),s=s.replace(/\.(\d*)$/,function(C,x){return"."+x+Vt("0",Yn(l[1]).length-x.length)}),e.indexOf("0.")!==-1?s:s.replace(/^0\./,".");if(e=e.replace(/^#+([0.])/,"$1"),l=e.match(/^(0*)\.(#*)$/))return g+(""+d).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,l[1].length?"0.":".");if(l=e.match(/^#{1,3},##0(\.?)$/))return g+Ti(""+d);if(l=e.match(/^#,##0\.([#0]*0)$/))return t<0?"-"+da(n,e,-t):Ti(""+t)+"."+Vt("0",l[1].length);if(l=e.match(/^#,#*,#0/))return da(n,e.replace(/^#,#*,/,""),t);if(l=e.match(/^([0#]+)(\\?-([0#]+))+$/))return s=uo(da(n,e.replace(/[\\-]/g,""),t)),c=0,uo(uo(e.replace(/\\/g,"")).replace(/[0#]/g,function(C){return c<s.length?s.charAt(c++):C==="0"?"0":""}));if(e.match(MS))return s=da(n,"##########",t),"("+s.substr(0,3)+") "+s.substr(3,3)+"-"+s.substr(6);var p="";if(l=e.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(l[4].length,7),h=_h(d,Math.pow(10,c)-1,!1),s=""+g,p=La("n",l[1],h[1]),p.charAt(p.length-1)==" "&&(p=p.substr(0,p.length-1)+"0"),s+=p+l[2]+"/"+l[3],p=yh(h[2],c),p.length<l[4].length&&(p=Yn(l[4].substr(l[4].length-p.length))+p),s+=p,s;if(l=e.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return c=Math.min(Math.max(l[1].length,l[4].length),7),h=_h(d,Math.pow(10,c)-1,!0),g+(h[0]||(h[1]?"":"0"))+" "+(h[1]?hm(h[1],c)+l[2]+"/"+l[3]+yh(h[2],c):Vt(" ",2*c+1+l[2].length+l[3].length));if(l=e.match(/^[#0?]+$/))return s=""+t,e.length<=s.length?s:Yn(e.substr(0,e.length-s.length))+s;if(l=e.match(/^([#0]+)\.([#0]+)$/)){s=""+t.toFixed(Math.min(l[2].length,10)).replace(/([^0])0+$/,"$1"),c=s.indexOf(".");var v=e.indexOf(".")-c,_=e.length-s.length-v;return Yn(e.substr(0,v)+s+e.substr(e.length-_))}if(l=e.match(/^00,000\.([#0]*0)$/))return t<0?"-"+da(n,e,-t):Ti(""+t).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(C){return"00,"+(C.length<3?Jr(0,3-C.length):"")+C})+"."+Jr(0,l[1].length);switch(e){case"###,###":case"##,###":case"#,###":var T=Ti(""+d);return T!=="0"?g+T:"";default:if(e.match(/\.[0#?]*$/))return da(n,e.slice(0,e.lastIndexOf(".")),t)+Yn(e.slice(e.lastIndexOf(".")))}throw new Error("unsupported format |"+e+"|")}function La(n,e,t){return(t|0)===t?da(n,e,t):Lr(n,e,t)}function F4(n){for(var e=[],t=!1,a=0,s=0;a<n.length;++a)switch(n.charCodeAt(a)){case 34:t=!t;break;case 95:case 42:case 92:++a;break;case 59:e[e.length]=n.substr(s,a-s),s=a+1}if(e[e.length]=n.substr(s),t===!0)throw new Error("Format |"+n+"| unterminated string ");return e}var PS=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function FS(n){for(var e=0,t="",a="";e<n.length;)switch(t=n.charAt(e)){case"G":Th(n,e)&&(e+=6),e++;break;case'"':for(;n.charCodeAt(++e)!==34&&e<n.length;);++e;break;case"\\":e+=2;break;case"_":e+=2;break;case"@":++e;break;case"B":case"b":if(n.charAt(e+1)==="1"||n.charAt(e+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(n.substr(e,3).toUpperCase()==="A/P"||n.substr(e,5).toUpperCase()==="AM/PM"||n.substr(e,5).toUpperCase()==="上午/下午")return!0;++e;break;case"[":for(a=t;n.charAt(e++)!=="]"&&e<n.length;)a+=n.charAt(e);if(a.match(PS))return!0;break;case".":case"0":case"#":for(;e<n.length&&("0#?.,E+-%".indexOf(t=n.charAt(++e))>-1||t=="\\"&&n.charAt(e+1)=="-"&&"0#".indexOf(n.charAt(e+2))>-1););break;case"?":for(;n.charAt(++e)===t;);break;case"*":++e,(n.charAt(e)==" "||n.charAt(e)=="*")&&++e;break;case"(":case")":++e;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;e<n.length&&"0123456789".indexOf(n.charAt(++e))>-1;);break;case" ":++e;break;default:++e;break}return!1}function L4(n,e,t,a){for(var s=[],l="",c=0,h="",d="t",g,p,v,_="H";c<n.length;)switch(h=n.charAt(c)){case"G":if(!Th(n,c))throw new Error("unrecognized character "+h+" in "+n);s[s.length]={t:"G",v:"General"},c+=7;break;case'"':for(l="";(v=n.charCodeAt(++c))!==34&&c<n.length;)l+=String.fromCharCode(v);s[s.length]={t:"t",v:l},++c;break;case"\\":var T=n.charAt(++c),C=T==="("||T===")"?T:"t";s[s.length]={t:C,v:T},++c;break;case"_":s[s.length]={t:"t",v:" "},c+=2;break;case"@":s[s.length]={t:"T",v:e},++c;break;case"B":case"b":if(n.charAt(c+1)==="1"||n.charAt(c+1)==="2"){if(g==null&&(g=Hu(e,t,n.charAt(c+1)==="2"),g==null))return"";s[s.length]={t:"X",v:n.substr(c,2)},d=h,c+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":h=h.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(e<0||g==null&&(g=Hu(e,t),g==null))return"";for(l=h;++c<n.length&&n.charAt(c).toLowerCase()===h;)l+=h;h==="m"&&d.toLowerCase()==="h"&&(h="M"),h==="h"&&(h=_),s[s.length]={t:h,v:l},d=h;break;case"A":case"a":case"上":var x={t:h,v:h};if(g==null&&(g=Hu(e,t)),n.substr(c,3).toUpperCase()==="A/P"?(g!=null&&(x.v=g.H>=12?"P":"A"),x.t="T",_="h",c+=3):n.substr(c,5).toUpperCase()==="AM/PM"?(g!=null&&(x.v=g.H>=12?"PM":"AM"),x.t="T",c+=5,_="h"):n.substr(c,5).toUpperCase()==="上午/下午"?(g!=null&&(x.v=g.H>=12?"下午":"上午"),x.t="T",c+=5,_="h"):(x.t="t",++c),g==null&&x.t==="T")return"";s[s.length]=x,d=h;break;case"[":for(l=h;n.charAt(c++)!=="]"&&c<n.length;)l+=n.charAt(c);if(l.slice(-1)!=="]")throw'unterminated "[" block: |'+l+"|";if(l.match(PS)){if(g==null&&(g=Hu(e,t),g==null))return"";s[s.length]={t:"Z",v:l.toLowerCase()},d=l.charAt(1)}else l.indexOf("$")>-1&&(l=(l.match(/\$([^-\[\]]*)/)||[])[1]||"$",FS(n)||(s[s.length]={t:"t",v:l}));break;case".":if(g!=null){for(l=h;++c<n.length&&(h=n.charAt(c))==="0";)l+=h;s[s.length]={t:"s",v:l};break}case"0":case"#":for(l=h;++c<n.length&&"0#?.,E+-%".indexOf(h=n.charAt(c))>-1;)l+=h;s[s.length]={t:"n",v:l};break;case"?":for(l=h;n.charAt(++c)===h;)l+=h;s[s.length]={t:h,v:l},d=h;break;case"*":++c,(n.charAt(c)==" "||n.charAt(c)=="*")&&++c;break;case"(":case")":s[s.length]={t:a===1?"t":h,v:h},++c;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(l=h;c<n.length&&"0123456789".indexOf(n.charAt(++c))>-1;)l+=n.charAt(c);s[s.length]={t:"D",v:l};break;case" ":s[s.length]={t:h,v:h},++c;break;case"$":s[s.length]={t:"t",v:"$"},++c;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(h)===-1)throw new Error("unrecognized character "+h+" in "+n);s[s.length]={t:"t",v:h},++c;break}var A=0,B=0,k;for(c=s.length-1,d="t";c>=0;--c)switch(s[c].t){case"h":case"H":s[c].t=_,d="h",A<1&&(A=1);break;case"s":(k=s[c].v.match(/\.0+$/))&&(B=Math.max(B,k[0].length-1)),A<3&&(A=3);case"d":case"y":case"M":case"e":d=s[c].t;break;case"m":d==="s"&&(s[c].t="M",A<2&&(A=2));break;case"X":break;case"Z":A<1&&s[c].v.match(/[Hh]/)&&(A=1),A<2&&s[c].v.match(/[Mm]/)&&(A=2),A<3&&s[c].v.match(/[Ss]/)&&(A=3)}switch(A){case 0:break;case 1:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M),g.M>=60&&(g.M=0,++g.H);break;case 2:g.u>=.5&&(g.u=0,++g.S),g.S>=60&&(g.S=0,++g.M);break}var O="",j;for(c=0;c<s.length;++c)switch(s[c].t){case"t":case"T":case" ":case"D":break;case"X":s[c].v="",s[c].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":s[c].v=b4(s[c].t.charCodeAt(0),s[c].v,g,B),s[c].t="t";break;case"n":case"?":for(j=c+1;s[j]!=null&&((h=s[j].t)==="?"||h==="D"||(h===" "||h==="t")&&s[j+1]!=null&&(s[j+1].t==="?"||s[j+1].t==="t"&&s[j+1].v==="/")||s[c].t==="("&&(h===" "||h==="n"||h===")")||h==="t"&&(s[j].v==="/"||s[j].v===" "&&s[j+1]!=null&&s[j+1].t=="?"));)s[c].v+=s[j].v,s[j]={v:"",t:";"},++j;O+=s[c].v,c=j-1;break;case"G":s[c].t="t",s[c].v=W0(e,t);break}var H="",Y,I;if(O.length>0){O.charCodeAt(0)==40?(Y=e<0&&O.charCodeAt(0)===45?-e:e,I=La("n",O,Y)):(Y=e<0&&a>1?-e:e,I=La("n",O,Y),Y<0&&s[0]&&s[0].t=="t"&&(I=I.substr(1),s[0].v="-"+s[0].v)),j=I.length-1;var G=s.length;for(c=0;c<s.length;++c)if(s[c]!=null&&s[c].t!="t"&&s[c].v.indexOf(".")>-1){G=c;break}var q=s.length;if(G===s.length&&I.indexOf("E")===-1){for(c=s.length-1;c>=0;--c)s[c]==null||"n?".indexOf(s[c].t)===-1||(j>=s[c].v.length-1?(j-=s[c].v.length,s[c].v=I.substr(j+1,s[c].v.length)):j<0?s[c].v="":(s[c].v=I.substr(0,j+1),j=-1),s[c].t="t",q=c);j>=0&&q<s.length&&(s[q].v=I.substr(0,j+1)+s[q].v)}else if(G!==s.length&&I.indexOf("E")===-1){for(j=I.indexOf(".")-1,c=G;c>=0;--c)if(!(s[c]==null||"n?".indexOf(s[c].t)===-1)){for(p=s[c].v.indexOf(".")>-1&&c===G?s[c].v.indexOf(".")-1:s[c].v.length-1,H=s[c].v.substr(p+1);p>=0;--p)j>=0&&(s[c].v.charAt(p)==="0"||s[c].v.charAt(p)==="#")&&(H=I.charAt(j--)+H);s[c].v=H,s[c].t="t",q=c}for(j>=0&&q<s.length&&(s[q].v=I.substr(0,j+1)+s[q].v),j=I.indexOf(".")+1,c=G;c<s.length;++c)if(!(s[c]==null||"n?(".indexOf(s[c].t)===-1&&c!==G)){for(p=s[c].v.indexOf(".")>-1&&c===G?s[c].v.indexOf(".")+1:0,H=s[c].v.substr(0,p);p<s[c].v.length;++p)j<I.length&&(H+=I.charAt(j++));s[c].v=H,s[c].t="t",q=c}}}for(c=0;c<s.length;++c)s[c]!=null&&"n?".indexOf(s[c].t)>-1&&(Y=a>1&&e<0&&c>0&&s[c-1].v==="-"?-e:e,s[c].v=La(s[c].t,s[c].v,Y),s[c].t="t");var ie="";for(c=0;c!==s.length;++c)s[c]!=null&&(ie+=s[c].v);return ie}var ST=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function CT(n,e){if(e==null)return!1;var t=parseFloat(e[2]);switch(e[1]){case"=":if(n==t)return!0;break;case">":if(n>t)return!0;break;case"<":if(n<t)return!0;break;case"<>":if(n!=t)return!0;break;case">=":if(n>=t)return!0;break;case"<=":if(n<=t)return!0;break}return!1}function U4(n,e){var t=F4(n),a=t.length,s=t[a-1].indexOf("@");if(a<4&&s>-1&&--a,t.length>4)throw new Error("cannot find right format for |"+t.join("|")+"|");if(typeof e!="number")return[4,t.length===4||s>-1?t[t.length-1]:"@"];switch(t.length){case 1:t=s>-1?["General","General","General",t[0]]:[t[0],t[0],t[0],"@"];break;case 2:t=s>-1?[t[0],t[0],t[0],t[1]]:[t[0],t[1],t[0],"@"];break;case 3:t=s>-1?[t[0],t[1],t[0],t[2]]:[t[0],t[1],t[2],"@"];break}var l=e>0?t[0]:e<0?t[1]:t[2];if(t[0].indexOf("[")===-1&&t[1].indexOf("[")===-1)return[a,l];if(t[0].match(/\[[=<>]/)!=null||t[1].match(/\[[=<>]/)!=null){var c=t[0].match(ST),h=t[1].match(ST);return CT(e,c)?[a,t[0]]:CT(e,h)?[a,t[1]]:[a,t[c!=null&&h!=null?2:1]]}return[a,l]}function wi(n,e,t){t==null&&(t={});var a="";switch(typeof n){case"string":n=="m/d/yy"&&t.dateNF?a=t.dateNF:a=n;break;case"number":n==14&&t.dateNF?a=t.dateNF:a=(t.table!=null?t.table:qt)[n],a==null&&(a=t.table&&t.table[TT[n]]||qt[TT[n]]),a==null&&(a=T4[n]||"General");break}if(Th(a,0))return W0(e,t);e instanceof Date&&(e=bS(e,t.date1904));var s=U4(a,e);if(Th(s[1]))return W0(e,t);if(e===!0)e="TRUE";else if(e===!1)e="FALSE";else if(e===""||e==null)return"";return L4(s[1],e,t,s[0])}function LS(n,e){if(typeof e!="number"){e=+e||-1;for(var t=0;t<392;++t){if(qt[t]==null){e<0&&(e=t);continue}if(qt[t]==n){e=t;break}}e<0&&(e=391)}return qt[e]=n,e}function Qh(n){for(var e=0;e!=392;++e)n[e]!==void 0&&LS(n[e],e)}function Jh(){qt=y4()}var US=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function B4(n){var e=typeof n=="number"?qt[n]:n;return e=e.replace(US,"(\\d+)"),new RegExp("^"+e+"$")}function H4(n,e,t){var a=-1,s=-1,l=-1,c=-1,h=-1,d=-1;(e.match(US)||[]).forEach(function(v,_){var T=parseInt(t[_+1],10);switch(v.toLowerCase().charAt(0)){case"y":a=T;break;case"d":l=T;break;case"h":c=T;break;case"s":d=T;break;case"m":c>=0?h=T:s=T;break}}),d>=0&&h==-1&&s>=0&&(h=s,s=-1);var g=(""+(a>=0?a:new Date().getFullYear())).slice(-4)+"-"+("00"+(s>=1?s:1)).slice(-2)+"-"+("00"+(l>=1?l:1)).slice(-2);g.length==7&&(g="0"+g),g.length==8&&(g="20"+g);var p=("00"+(c>=0?c:0)).slice(-2)+":"+("00"+(h>=0?h:0)).slice(-2)+":"+("00"+(d>=0?d:0)).slice(-2);return c==-1&&h==-1&&d==-1?g:a==-1&&s==-1&&l==-1?p:g+"T"+p}var j4=(function(){var n={};n.version="1.2.0";function e(){for(var I=0,G=new Array(256),q=0;q!=256;++q)I=q,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,I=I&1?-306674912^I>>>1:I>>>1,G[q]=I;return typeof Int32Array<"u"?new Int32Array(G):G}var t=e();function a(I){var G=0,q=0,ie=0,J=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(ie=0;ie!=256;++ie)J[ie]=I[ie];for(ie=0;ie!=256;++ie)for(q=I[ie],G=256+ie;G<4096;G+=256)q=J[G]=q>>>8^I[q&255];var he=[];for(ie=1;ie!=16;++ie)he[ie-1]=typeof Int32Array<"u"?J.subarray(ie*256,ie*256+256):J.slice(ie*256,ie*256+256);return he}var s=a(t),l=s[0],c=s[1],h=s[2],d=s[3],g=s[4],p=s[5],v=s[6],_=s[7],T=s[8],C=s[9],x=s[10],A=s[11],B=s[12],k=s[13],O=s[14];function j(I,G){for(var q=G^-1,ie=0,J=I.length;ie<J;)q=q>>>8^t[(q^I.charCodeAt(ie++))&255];return~q}function H(I,G){for(var q=G^-1,ie=I.length-15,J=0;J<ie;)q=O[I[J++]^q&255]^k[I[J++]^q>>8&255]^B[I[J++]^q>>16&255]^A[I[J++]^q>>>24]^x[I[J++]]^C[I[J++]]^T[I[J++]]^_[I[J++]]^v[I[J++]]^p[I[J++]]^g[I[J++]]^d[I[J++]]^h[I[J++]]^c[I[J++]]^l[I[J++]]^t[I[J++]];for(ie+=15;J<ie;)q=q>>>8^t[(q^I[J++])&255];return~q}function Y(I,G){for(var q=G^-1,ie=0,J=I.length,he=0,Ae=0;ie<J;)he=I.charCodeAt(ie++),he<128?q=q>>>8^t[(q^he)&255]:he<2048?(q=q>>>8^t[(q^(192|he>>6&31))&255],q=q>>>8^t[(q^(128|he&63))&255]):he>=55296&&he<57344?(he=(he&1023)+64,Ae=I.charCodeAt(ie++)&1023,q=q>>>8^t[(q^(240|he>>8&7))&255],q=q>>>8^t[(q^(128|he>>2&63))&255],q=q>>>8^t[(q^(128|Ae>>6&15|(he&3)<<4))&255],q=q>>>8^t[(q^(128|Ae&63))&255]):(q=q>>>8^t[(q^(224|he>>12&15))&255],q=q>>>8^t[(q^(128|he>>6&63))&255],q=q>>>8^t[(q^(128|he&63))&255]);return~q}return n.table=t,n.bstr=j,n.buf=H,n.str=Y,n})(),Rt=(function(){var e={};e.version="1.2.1";function t(E,D){for(var R=E.split("/"),N=D.split("/"),M=0,F=0,ae=Math.min(R.length,N.length);M<ae;++M){if(F=R[M].length-N[M].length)return F;if(R[M]!=N[M])return R[M]<N[M]?-1:1}return R.length-N.length}function a(E){if(E.charAt(E.length-1)=="/")return E.slice(0,-1).indexOf("/")===-1?E:a(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(0,D+1)}function s(E){if(E.charAt(E.length-1)=="/")return s(E.slice(0,-1));var D=E.lastIndexOf("/");return D===-1?E:E.slice(D+1)}function l(E,D){typeof D=="string"&&(D=new Date(D));var R=D.getHours();R=R<<6|D.getMinutes(),R=R<<5|D.getSeconds()>>>1,E.write_shift(2,R);var N=D.getFullYear()-1980;N=N<<4|D.getMonth()+1,N=N<<5|D.getDate(),E.write_shift(2,N)}function c(E){var D=E.read_shift(2)&65535,R=E.read_shift(2)&65535,N=new Date,M=R&31;R>>>=5;var F=R&15;R>>>=4,N.setMilliseconds(0),N.setFullYear(R+1980),N.setMonth(F-1),N.setDate(M);var ae=D&31;D>>>=5;var de=D&63;return D>>>=6,N.setHours(D),N.setMinutes(de),N.setSeconds(ae<<1),N}function h(E){Tr(E,0);for(var D={},R=0;E.l<=E.length-4;){var N=E.read_shift(2),M=E.read_shift(2),F=E.l+M,ae={};switch(N){case 21589:R=E.read_shift(1),R&1&&(ae.mtime=E.read_shift(4)),M>5&&(R&2&&(ae.atime=E.read_shift(4)),R&4&&(ae.ctime=E.read_shift(4))),ae.mtime&&(ae.mt=new Date(ae.mtime*1e3));break}E.l=F,D[N]=ae}return D}var d;function g(){return d||(d={})}function p(E,D){if(E[0]==80&&E[1]==75)return Ro(E,D);if((E[0]|32)==109&&(E[1]|32)==105)return af(E,D);if(E.length<512)throw new Error("CFB file size "+E.length+" < 512");var R=3,N=512,M=0,F=0,ae=0,de=0,ee=0,se=[],le=E.slice(0,512);Tr(le,0);var Ee=v(le);switch(R=Ee[0],R){case 3:N=512;break;case 4:N=4096;break;case 0:if(Ee[1]==0)return Ro(E,D);default:throw new Error("Major Version: Expected 3 or 4 saw "+R)}N!==512&&(le=E.slice(0,N),Tr(le,28));var Re=E.slice(0,N);_(le,R);var Be=le.read_shift(4,"i");if(R===3&&Be!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Be);le.l+=4,ae=le.read_shift(4,"i"),le.l+=4,le.chk("00100000","Mini Stream Cutoff Size: "),de=le.read_shift(4,"i"),M=le.read_shift(4,"i"),ee=le.read_shift(4,"i"),F=le.read_shift(4,"i");for(var Ie=-1,Le=0;Le<109&&(Ie=le.read_shift(4,"i"),!(Ie<0));++Le)se[Le]=Ie;var We=T(E,N);A(ee,F,We,N,se);var Ct=k(We,ae,se,N);Ct[ae].name="!Directory",M>0&&de!==Ae&&(Ct[de].name="!MiniFAT"),Ct[se[0]].name="!FAT",Ct.fat_addrs=se,Ct.ssz=N;var Et={},Ft=[],Ta=[],Ka=[];O(ae,Ct,We,Ft,M,Et,Ta,de),C(Ta,Ka,Ft),Ft.shift();var br={FileIndex:Ta,FullPaths:Ka};return D&&D.raw&&(br.raw={header:Re,sectors:We}),br}function v(E){if(E[E.l]==80&&E[E.l+1]==75)return[0,0];E.chk(je,"Header Signature: "),E.l+=16;var D=E.read_shift(2,"u");return[E.read_shift(2,"u"),D]}function _(E,D){var R=9;switch(E.l+=2,R=E.read_shift(2)){case 9:if(D!=3)throw new Error("Sector Shift: Expected 9 saw "+R);break;case 12:if(D!=4)throw new Error("Sector Shift: Expected 12 saw "+R);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+R)}E.chk("0600","Mini Sector Shift: "),E.chk("000000000000","Reserved: ")}function T(E,D){for(var R=Math.ceil(E.length/D)-1,N=[],M=1;M<R;++M)N[M-1]=E.slice(M*D,(M+1)*D);return N[R-1]=E.slice(R*D),N}function C(E,D,R){for(var N=0,M=0,F=0,ae=0,de=0,ee=R.length,se=[],le=[];N<ee;++N)se[N]=le[N]=N,D[N]=R[N];for(;de<le.length;++de)N=le[de],M=E[N].L,F=E[N].R,ae=E[N].C,se[N]===N&&(M!==-1&&se[M]!==M&&(se[N]=se[M]),F!==-1&&se[F]!==F&&(se[N]=se[F])),ae!==-1&&(se[ae]=N),M!==-1&&N!=se[N]&&(se[M]=se[N],le.lastIndexOf(M)<de&&le.push(M)),F!==-1&&N!=se[N]&&(se[F]=se[N],le.lastIndexOf(F)<de&&le.push(F));for(N=1;N<ee;++N)se[N]===N&&(F!==-1&&se[F]!==F?se[N]=se[F]:M!==-1&&se[M]!==M&&(se[N]=se[M]));for(N=1;N<ee;++N)if(E[N].type!==0){if(de=N,de!=se[de])do de=se[de],D[N]=D[de]+"/"+D[N];while(de!==0&&se[de]!==-1&&de!=se[de]);se[N]=-1}for(D[0]+="/",N=1;N<ee;++N)E[N].type!==2&&(D[N]+="/")}function x(E,D,R){for(var N=E.start,M=E.size,F=[],ae=N;R&&M>0&&ae>=0;)F.push(D.slice(ae*he,ae*he+he)),M-=he,ae=es(R,ae*4);return F.length===0?ge(0):In(F).slice(0,E.size)}function A(E,D,R,N,M){var F=Ae;if(E===Ae){if(D!==0)throw new Error("DIFAT chain shorter than expected")}else if(E!==-1){var ae=R[E],de=(N>>>2)-1;if(!ae)return;for(var ee=0;ee<de&&(F=es(ae,ee*4))!==Ae;++ee)M.push(F);A(es(ae,N-4),D-1,R,N,M)}}function B(E,D,R,N,M){var F=[],ae=[];M||(M=[]);var de=N-1,ee=0,se=0;for(ee=D;ee>=0;){M[ee]=!0,F[F.length]=ee,ae.push(E[ee]);var le=R[Math.floor(ee*4/N)];if(se=ee*4&de,N<4+se)throw new Error("FAT boundary crossed: "+ee+" 4 "+N);if(!E[le])break;ee=es(E[le],se)}return{nodes:F,data:kT([ae])}}function k(E,D,R,N){var M=E.length,F=[],ae=[],de=[],ee=[],se=N-1,le=0,Ee=0,Re=0,Be=0;for(le=0;le<M;++le)if(de=[],Re=le+D,Re>=M&&(Re-=M),!ae[Re]){ee=[];var Ie=[];for(Ee=Re;Ee>=0;){Ie[Ee]=!0,ae[Ee]=!0,de[de.length]=Ee,ee.push(E[Ee]);var Le=R[Math.floor(Ee*4/N)];if(Be=Ee*4&se,N<4+Be)throw new Error("FAT boundary crossed: "+Ee+" 4 "+N);if(!E[Le]||(Ee=es(E[Le],Be),Ie[Ee]))break}F[Re]={nodes:de,data:kT([ee])}}return F}function O(E,D,R,N,M,F,ae,de){for(var ee=0,se=N.length?2:0,le=D[E].data,Ee=0,Re=0,Be;Ee<le.length;Ee+=128){var Ie=le.slice(Ee,Ee+128);Tr(Ie,64),Re=Ie.read_shift(2),Be=vm(Ie,0,Re-se),N.push(Be);var Le={name:Be,type:Ie.read_shift(1),color:Ie.read_shift(1),L:Ie.read_shift(4,"i"),R:Ie.read_shift(4,"i"),C:Ie.read_shift(4,"i"),clsid:Ie.read_shift(16),state:Ie.read_shift(4,"i"),start:0,size:0},We=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);We!==0&&(Le.ct=j(Ie,Ie.l-8));var Ct=Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2)+Ie.read_shift(2);Ct!==0&&(Le.mt=j(Ie,Ie.l-8)),Le.start=Ie.read_shift(4,"i"),Le.size=Ie.read_shift(4,"i"),Le.size<0&&Le.start<0&&(Le.size=Le.type=0,Le.start=Ae,Le.name=""),Le.type===5?(ee=Le.start,M>0&&ee!==Ae&&(D[ee].name="!StreamData")):Le.size>=4096?(Le.storage="fat",D[Le.start]===void 0&&(D[Le.start]=B(R,Le.start,D.fat_addrs,D.ssz)),D[Le.start].name=Le.name,Le.content=D[Le.start].data.slice(0,Le.size)):(Le.storage="minifat",Le.size<0?Le.size=0:ee!==Ae&&Le.start!==Ae&&D[ee]&&(Le.content=x(Le,D[ee].data,(D[de]||{}).data))),Le.content&&Tr(Le.content,0),F[Be]=Le,ae.push(Le)}}function j(E,D){return new Date((Sr(E,D+4)/1e7*Math.pow(2,32)+Sr(E,D)/1e7-11644473600)*1e3)}function H(E,D){return g(),p(d.readFileSync(E),D)}function Y(E,D){var R=D&&D.type;switch(R||mt&&Buffer.isBuffer(E)&&(R="buffer"),R||"base64"){case"file":return H(E,D);case"base64":return p(Wr(ja(E)),D);case"binary":return p(Wr(E),D)}return p(E,D)}function I(E,D){var R=D||{},N=R.root||"Root Entry";if(E.FullPaths||(E.FullPaths=[]),E.FileIndex||(E.FileIndex=[]),E.FullPaths.length!==E.FileIndex.length)throw new Error("inconsistent CFB structure");E.FullPaths.length===0&&(E.FullPaths[0]=N+"/",E.FileIndex[0]={name:N,type:5}),R.CLSID&&(E.FileIndex[0].clsid=R.CLSID),G(E)}function G(E){var D="Sh33tJ5";if(!Rt.find(E,"/"+D)){var R=ge(4);R[0]=55,R[1]=R[3]=50,R[2]=54,E.FileIndex.push({name:D,type:2,content:R,size:4,L:69,R:69,C:69}),E.FullPaths.push(E.FullPaths[0]+D),q(E)}}function q(E,D){I(E);for(var R=!1,N=!1,M=E.FullPaths.length-1;M>=0;--M){var F=E.FileIndex[M];switch(F.type){case 0:N?R=!0:(E.FileIndex.pop(),E.FullPaths.pop());break;case 1:case 2:case 5:N=!0,isNaN(F.R*F.L*F.C)&&(R=!0),F.R>-1&&F.L>-1&&F.R==F.L&&(R=!0);break;default:R=!0;break}}if(!(!R&&!D)){var ae=new Date(1987,1,19),de=0,ee=Object.create?Object.create(null):{},se=[];for(M=0;M<E.FullPaths.length;++M)ee[E.FullPaths[M]]=!0,E.FileIndex[M].type!==0&&se.push([E.FullPaths[M],E.FileIndex[M]]);for(M=0;M<se.length;++M){var le=a(se[M][0]);N=ee[le],N||(se.push([le,{name:s(le).replace("/",""),type:1,clsid:re,ct:ae,mt:ae,content:null}]),ee[le]=!0)}for(se.sort(function(Be,Ie){return t(Be[0],Ie[0])}),E.FullPaths=[],E.FileIndex=[],M=0;M<se.length;++M)E.FullPaths[M]=se[M][0],E.FileIndex[M]=se[M][1];for(M=0;M<se.length;++M){var Ee=E.FileIndex[M],Re=E.FullPaths[M];if(Ee.name=s(Re).replace("/",""),Ee.L=Ee.R=Ee.C=-(Ee.color=1),Ee.size=Ee.content?Ee.content.length:0,Ee.start=0,Ee.clsid=Ee.clsid||re,M===0)Ee.C=se.length>1?1:-1,Ee.size=0,Ee.type=5;else if(Re.slice(-1)=="/"){for(de=M+1;de<se.length&&a(E.FullPaths[de])!=Re;++de);for(Ee.C=de>=se.length?-1:de,de=M+1;de<se.length&&a(E.FullPaths[de])!=a(Re);++de);Ee.R=de>=se.length?-1:de,Ee.type=1}else a(E.FullPaths[M+1]||"")==a(Re)&&(Ee.R=M+1),Ee.type=2}}}function ie(E,D){var R=D||{};if(R.fileType=="mad")return aa(E,R);switch(q(E),R.fileType){case"zip":return Di(E,R)}var N=(function(Be){for(var Ie=0,Le=0,We=0;We<Be.FileIndex.length;++We){var Ct=Be.FileIndex[We];if(Ct.content){var Et=Ct.content.length;Et>0&&(Et<4096?Ie+=Et+63>>6:Le+=Et+511>>9)}}for(var Ft=Be.FullPaths.length+3>>2,Ta=Ie+7>>3,Ka=Ie+127>>7,br=Ta+Le+Ft+Ka,zr=br+127>>7,Pi=zr<=109?0:Math.ceil((zr-109)/127);br+zr+Pi+127>>7>zr;)Pi=++zr<=109?0:Math.ceil((zr-109)/127);var Gr=[1,Pi,zr,Ka,Ft,Le,Ie,0];return Be.FileIndex[0].size=Ie<<6,Gr[7]=(Be.FileIndex[0].start=Gr[0]+Gr[1]+Gr[2]+Gr[3]+Gr[4]+Gr[5])+(Gr[6]+7>>3),Gr})(E),M=ge(N[7]<<9),F=0,ae=0;{for(F=0;F<8;++F)M.write_shift(1,ke[F]);for(F=0;F<8;++F)M.write_shift(2,0);for(M.write_shift(2,62),M.write_shift(2,3),M.write_shift(2,65534),M.write_shift(2,9),M.write_shift(2,6),F=0;F<3;++F)M.write_shift(2,0);for(M.write_shift(4,0),M.write_shift(4,N[2]),M.write_shift(4,N[0]+N[1]+N[2]+N[3]-1),M.write_shift(4,0),M.write_shift(4,4096),M.write_shift(4,N[3]?N[0]+N[1]+N[2]-1:Ae),M.write_shift(4,N[3]),M.write_shift(-4,N[1]?N[0]-1:Ae),M.write_shift(4,N[1]),F=0;F<109;++F)M.write_shift(-4,F<N[2]?N[1]+F:-1)}if(N[1])for(ae=0;ae<N[1];++ae){for(;F<236+ae*127;++F)M.write_shift(-4,F<N[2]?N[1]+F:-1);M.write_shift(-4,ae===N[1]-1?Ae:ae+1)}var de=function(Be){for(ae+=Be;F<ae-1;++F)M.write_shift(-4,F+1);Be&&(++F,M.write_shift(-4,Ae))};for(ae=F=0,ae+=N[1];F<ae;++F)M.write_shift(-4,xe.DIFSECT);for(ae+=N[2];F<ae;++F)M.write_shift(-4,xe.FATSECT);de(N[3]),de(N[4]);for(var ee=0,se=0,le=E.FileIndex[0];ee<E.FileIndex.length;++ee)le=E.FileIndex[ee],le.content&&(se=le.content.length,!(se<4096)&&(le.start=ae,de(se+511>>9)));for(de(N[6]+7>>3);M.l&511;)M.write_shift(-4,xe.ENDOFCHAIN);for(ae=F=0,ee=0;ee<E.FileIndex.length;++ee)le=E.FileIndex[ee],le.content&&(se=le.content.length,!(!se||se>=4096)&&(le.start=ae,de(se+63>>6)));for(;M.l&511;)M.write_shift(-4,xe.ENDOFCHAIN);for(F=0;F<N[4]<<2;++F){var Ee=E.FullPaths[F];if(!Ee||Ee.length===0){for(ee=0;ee<17;++ee)M.write_shift(4,0);for(ee=0;ee<3;++ee)M.write_shift(4,-1);for(ee=0;ee<12;++ee)M.write_shift(4,0);continue}le=E.FileIndex[F],F===0&&(le.start=le.size?le.start-1:Ae);var Re=F===0&&R.root||le.name;if(se=2*(Re.length+1),M.write_shift(64,Re,"utf16le"),M.write_shift(2,se),M.write_shift(1,le.type),M.write_shift(1,le.color),M.write_shift(-4,le.L),M.write_shift(-4,le.R),M.write_shift(-4,le.C),le.clsid)M.write_shift(16,le.clsid,"hex");else for(ee=0;ee<4;++ee)M.write_shift(4,0);M.write_shift(4,le.state||0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,0),M.write_shift(4,le.start),M.write_shift(4,le.size),M.write_shift(4,0)}for(F=1;F<E.FileIndex.length;++F)if(le=E.FileIndex[F],le.size>=4096)if(M.l=le.start+1<<9,mt&&Buffer.isBuffer(le.content))le.content.copy(M,M.l,0,le.size),M.l+=le.size+511&-512;else{for(ee=0;ee<le.size;++ee)M.write_shift(1,le.content[ee]);for(;ee&511;++ee)M.write_shift(1,0)}for(F=1;F<E.FileIndex.length;++F)if(le=E.FileIndex[F],le.size>0&&le.size<4096)if(mt&&Buffer.isBuffer(le.content))le.content.copy(M,M.l,0,le.size),M.l+=le.size+63&-64;else{for(ee=0;ee<le.size;++ee)M.write_shift(1,le.content[ee]);for(;ee&63;++ee)M.write_shift(1,0)}if(mt)M.l=M.length;else for(;M.l<M.length;)M.write_shift(1,0);return M}function J(E,D){var R=E.FullPaths.map(function(ee){return ee.toUpperCase()}),N=R.map(function(ee){var se=ee.split("/");return se[se.length-(ee.slice(-1)=="/"?2:1)]}),M=!1;D.charCodeAt(0)===47?(M=!0,D=R[0].slice(0,-1)+D):M=D.indexOf("/")!==-1;var F=D.toUpperCase(),ae=M===!0?R.indexOf(F):N.indexOf(F);if(ae!==-1)return E.FileIndex[ae];var de=!F.match(Bu);for(F=F.replace(jl,""),de&&(F=F.replace(Bu,"!")),ae=0;ae<R.length;++ae)if((de?R[ae].replace(Bu,"!"):R[ae]).replace(jl,"")==F||(de?N[ae].replace(Bu,"!"):N[ae]).replace(jl,"")==F)return E.FileIndex[ae];return null}var he=64,Ae=-2,je="d0cf11e0a1b11ae1",ke=[208,207,17,224,161,177,26,225],re="00000000000000000000000000000000",xe={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:Ae,FREESECT:-1,HEADER_SIGNATURE:je,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:re,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function fe(E,D,R){g();var N=ie(E,R);d.writeFileSync(D,N)}function Te(E){for(var D=new Array(E.length),R=0;R<E.length;++R)D[R]=String.fromCharCode(E[R]);return D.join("")}function U(E,D){var R=ie(E,D);switch(D&&D.type||"buffer"){case"file":return g(),d.writeFileSync(D.filename,R),R;case"binary":return typeof R=="string"?R:Te(R);case"base64":return ec(typeof R=="string"?R:Te(R));case"buffer":if(mt)return Buffer.isBuffer(R)?R:Ga(R);case"array":return typeof R=="string"?Wr(R):R}return R}var ue;function b(E){try{var D=E.InflateRaw,R=new D;if(R._processChunk(new Uint8Array([3,0]),R._finishFlushFlag),R.bytesRead)ue=E;else throw new Error("zlib does not expose bytesRead")}catch(N){console.error("cannot use native zlib: "+(N.message||N))}}function L(E,D){if(!ue)return pc(E,D);var R=ue.InflateRaw,N=new R,M=N._processChunk(E.slice(E.l),N._finishFlushFlag);return E.l+=N.bytesRead,M}function P(E){return ue?ue.deflateRawSync(E):dc(E)}var K=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],be=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Ce(E){var D=(E<<1|E<<11)&139536|(E<<5|E<<15)&558144;return(D>>16|D>>8|D)&255}for(var Pe=typeof Uint8Array<"u",De=Pe?new Uint8Array(256):[],lt=0;lt<256;++lt)De[lt]=Ce(lt);function et(E,D){var R=De[E&255];return D<=8?R>>>8-D:(R=R<<8|De[E>>8&255],D<=16?R>>>16-D:(R=R<<8|De[E>>16&255],R>>>24-D))}function zt(E,D){var R=D&7,N=D>>>3;return(E[N]|(R<=6?0:E[N+1]<<8))>>>R&3}function ct(E,D){var R=D&7,N=D>>>3;return(E[N]|(R<=5?0:E[N+1]<<8))>>>R&7}function Hn(E,D){var R=D&7,N=D>>>3;return(E[N]|(R<=4?0:E[N+1]<<8))>>>R&15}function Ot(E,D){var R=D&7,N=D>>>3;return(E[N]|(R<=3?0:E[N+1]<<8))>>>R&31}function Fe(E,D){var R=D&7,N=D>>>3;return(E[N]|(R<=1?0:E[N+1]<<8))>>>R&127}function On(E,D,R){var N=D&7,M=D>>>3,F=(1<<R)-1,ae=E[M]>>>N;return R<8-N||(ae|=E[M+1]<<8-N,R<16-N)||(ae|=E[M+2]<<16-N,R<24-N)||(ae|=E[M+3]<<24-N),ae&F}function jn(E,D,R){var N=D&7,M=D>>>3;return N<=5?E[M]|=(R&7)<<N:(E[M]|=R<<N&255,E[M+1]=(R&7)>>8-N),D+3}function wr(E,D,R){var N=D&7,M=D>>>3;return R=(R&1)<<N,E[M]|=R,D+1}function lr(E,D,R){var N=D&7,M=D>>>3;return R<<=N,E[M]|=R&255,R>>>=8,E[M+1]=R,D+8}function Me(E,D,R){var N=D&7,M=D>>>3;return R<<=N,E[M]|=R&255,R>>>=8,E[M+1]=R&255,E[M+2]=R>>>8,D+16}function Mt(E,D){var R=E.length,N=2*R>D?2*R:D+5,M=0;if(R>=D)return E;if(mt){var F=pT(N);if(E.copy)E.copy(F);else for(;M<E.length;++M)F[M]=E[M];return F}else if(Pe){var ae=new Uint8Array(N);if(ae.set)ae.set(E);else for(;M<R;++M)ae[M]=E[M];return ae}return E.length=N,E}function yn(E){for(var D=new Array(E),R=0;R<E;++R)D[R]=0;return D}function zn(E,D,R){var N=1,M=0,F=0,ae=0,de=0,ee=E.length,se=Pe?new Uint16Array(32):yn(32);for(F=0;F<32;++F)se[F]=0;for(F=ee;F<R;++F)E[F]=0;ee=E.length;var le=Pe?new Uint16Array(ee):yn(ee);for(F=0;F<ee;++F)se[M=E[F]]++,N<M&&(N=M),le[F]=0;for(se[0]=0,F=1;F<=N;++F)se[F+16]=de=de+se[F-1]<<1;for(F=0;F<ee;++F)de=E[F],de!=0&&(le[F]=se[de+16]++);var Ee=0;for(F=0;F<ee;++F)if(Ee=E[F],Ee!=0)for(de=et(le[F],N)>>N-Ee,ae=(1<<N+4-Ee)-1;ae>=0;--ae)D[de|ae<<Ee]=Ee&15|F<<4;return N}var Gn=Pe?new Uint16Array(512):yn(512),Tn=Pe?new Uint16Array(32):yn(32);if(!Pe){for(var Mn=0;Mn<512;++Mn)Gn[Mn]=0;for(Mn=0;Mn<32;++Mn)Tn[Mn]=0}(function(){for(var E=[],D=0;D<32;D++)E.push(5);zn(E,Tn,32);var R=[];for(D=0;D<=143;D++)R.push(8);for(;D<=255;D++)R.push(9);for(;D<=279;D++)R.push(7);for(;D<=287;D++)R.push(8);zn(R,Gn,288)})();var $n=(function(){for(var D=Pe?new Uint8Array(32768):[],R=0,N=0;R<be.length-1;++R)for(;N<be[R+1];++N)D[N]=R;for(;N<32768;++N)D[N]=29;var M=Pe?new Uint8Array(259):[];for(R=0,N=0;R<Z.length-1;++R)for(;N<Z[R+1];++N)M[N]=R;function F(de,ee){for(var se=0;se<de.length;){var le=Math.min(65535,de.length-se),Ee=se+le==de.length;for(ee.write_shift(1,+Ee),ee.write_shift(2,le),ee.write_shift(2,~le&65535);le-- >0;)ee[ee.l++]=de[se++]}return ee.l}function ae(de,ee){for(var se=0,le=0,Ee=Pe?new Uint16Array(32768):[];le<de.length;){var Re=Math.min(65535,de.length-le);if(Re<10){for(se=jn(ee,se,+(le+Re==de.length)),se&7&&(se+=8-(se&7)),ee.l=se/8|0,ee.write_shift(2,Re),ee.write_shift(2,~Re&65535);Re-- >0;)ee[ee.l++]=de[le++];se=ee.l*8;continue}se=jn(ee,se,+(le+Re==de.length)+2);for(var Be=0;Re-- >0;){var Ie=de[le];Be=(Be<<5^Ie)&32767;var Le=-1,We=0;if((Le=Ee[Be])&&(Le|=le&-32768,Le>le&&(Le-=32768),Le<le))for(;de[Le+We]==de[le+We]&&We<250;)++We;if(We>2){Ie=M[We],Ie<=22?se=lr(ee,se,De[Ie+1]>>1)-1:(lr(ee,se,3),se+=5,lr(ee,se,De[Ie-23]>>5),se+=3);var Ct=Ie<8?0:Ie-4>>2;Ct>0&&(Me(ee,se,We-Z[Ie]),se+=Ct),Ie=D[le-Le],se=lr(ee,se,De[Ie]>>3),se-=3;var Et=Ie<4?0:Ie-2>>1;Et>0&&(Me(ee,se,le-Le-be[Ie]),se+=Et);for(var Ft=0;Ft<We;++Ft)Ee[Be]=le&32767,Be=(Be<<5^de[le])&32767,++le;Re-=We-1}else Ie<=143?Ie=Ie+48:se=wr(ee,se,1),se=lr(ee,se,De[Ie]),Ee[Be]=le&32767,++le}se=lr(ee,se,0)-1}return ee.l=(se+7)/8|0,ee.l}return function(ee,se){return ee.length<8?F(ee,se):ae(ee,se)}})();function dc(E){var D=ge(50+Math.floor(E.length*1.1)),R=$n(E,D);return D.slice(0,R)}var gc=Pe?new Uint16Array(32768):yn(32768),mc=Pe?new Uint16Array(32768):yn(32768),ki=Pe?new Uint16Array(128):yn(128),Oi=1,ra=1;function vs(E,D){var R=Ot(E,D)+257;D+=5;var N=Ot(E,D)+1;D+=5;var M=Hn(E,D)+4;D+=4;for(var F=0,ae=Pe?new Uint8Array(19):yn(19),de=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ee=1,se=Pe?new Uint8Array(8):yn(8),le=Pe?new Uint8Array(8):yn(8),Ee=ae.length,Re=0;Re<M;++Re)ae[K[Re]]=F=ct(E,D),ee<F&&(ee=F),se[F]++,D+=3;var Be=0;for(se[0]=0,Re=1;Re<=ee;++Re)le[Re]=Be=Be+se[Re-1]<<1;for(Re=0;Re<Ee;++Re)(Be=ae[Re])!=0&&(de[Re]=le[Be]++);var Ie=0;for(Re=0;Re<Ee;++Re)if(Ie=ae[Re],Ie!=0){Be=De[de[Re]]>>8-Ie;for(var Le=(1<<7-Ie)-1;Le>=0;--Le)ki[Be|Le<<Ie]=Ie&7|Re<<3}var We=[];for(ee=1;We.length<R+N;)switch(Be=ki[Fe(E,D)],D+=Be&7,Be>>>=3){case 16:for(F=3+zt(E,D),D+=2,Be=We[We.length-1];F-- >0;)We.push(Be);break;case 17:for(F=3+ct(E,D),D+=3;F-- >0;)We.push(0);break;case 18:for(F=11+Fe(E,D),D+=7;F-- >0;)We.push(0);break;default:We.push(Be),ee<Be&&(ee=Be);break}var Ct=We.slice(0,R),Et=We.slice(R);for(Re=R;Re<286;++Re)Ct[Re]=0;for(Re=N;Re<30;++Re)Et[Re]=0;return Oi=zn(Ct,gc,286),ra=zn(Et,mc,30),D}function Mi(E,D){if(E[0]==3&&!(E[1]&3))return[ls(D),2];for(var R=0,N=0,M=pT(D||1<<18),F=0,ae=M.length>>>0,de=0,ee=0;(N&1)==0;){if(N=ct(E,R),R+=3,N>>>1)N>>1==1?(de=9,ee=5):(R=vs(E,R),de=Oi,ee=ra);else{R&7&&(R+=8-(R&7));var se=E[R>>>3]|E[(R>>>3)+1]<<8;if(R+=32,se>0)for(!D&&ae<F+se&&(M=Mt(M,F+se),ae=M.length);se-- >0;)M[F++]=E[R>>>3],R+=8;continue}for(;;){!D&&ae<F+32767&&(M=Mt(M,F+32767),ae=M.length);var le=On(E,R,de),Ee=N>>>1==1?Gn[le]:gc[le];if(R+=Ee&15,Ee>>>=4,(Ee>>>8&255)===0)M[F++]=Ee;else{if(Ee==256)break;Ee-=257;var Re=Ee<8?0:Ee-4>>2;Re>5&&(Re=0);var Be=F+Z[Ee];Re>0&&(Be+=On(E,R,Re),R+=Re),le=On(E,R,ee),Ee=N>>>1==1?Tn[le]:mc[le],R+=Ee&15,Ee>>>=4;var Ie=Ee<4?0:Ee-2>>1,Le=be[Ee];for(Ie>0&&(Le+=On(E,R,Ie),R+=Ie),!D&&ae<Be&&(M=Mt(M,Be+100),ae=M.length);F<Be;)M[F]=M[F-Le],++F}}}return D?[M,R+7>>>3]:[M.slice(0,F),R+7>>>3]}function pc(E,D){var R=E.slice(E.l||0),N=Mi(R,D);return E.l+=N[1],N[0]}function Io(E,D){if(E)typeof console<"u"&&console.error(D);else throw new Error(D)}function Ro(E,D){var R=E;Tr(R,0);var N=[],M=[],F={FileIndex:N,FullPaths:M};I(F,{root:D.root});for(var ae=R.length-4;(R[ae]!=80||R[ae+1]!=75||R[ae+2]!=5||R[ae+3]!=6)&&ae>=0;)--ae;R.l=ae+4,R.l+=4;var de=R.read_shift(2);R.l+=6;var ee=R.read_shift(4);for(R.l=ee,ae=0;ae<de;++ae){R.l+=20;var se=R.read_shift(4),le=R.read_shift(4),Ee=R.read_shift(2),Re=R.read_shift(2),Be=R.read_shift(2);R.l+=8;var Ie=R.read_shift(4),Le=h(R.slice(R.l+Ee,R.l+Ee+Re));R.l+=Ee+Re+Be;var We=R.l;R.l=Ie+4,No(R,se,le,F,Le),R.l=We}return F}function No(E,D,R,N,M){E.l+=2;var F=E.read_shift(2),ae=E.read_shift(2),de=c(E);if(F&8257)throw new Error("Unsupported ZIP encryption");for(var ee=E.read_shift(4),se=E.read_shift(4),le=E.read_shift(4),Ee=E.read_shift(2),Re=E.read_shift(2),Be="",Ie=0;Ie<Ee;++Ie)Be+=String.fromCharCode(E[E.l++]);if(Re){var Le=h(E.slice(E.l,E.l+Re));(Le[21589]||{}).mt&&(de=Le[21589].mt),((M||{})[21589]||{}).mt&&(de=M[21589].mt)}E.l+=Re;var We=E.slice(E.l,E.l+se);switch(ae){case 8:We=L(E,le);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+ae)}var Ct=!1;F&8&&(ee=E.read_shift(4),ee==134695760&&(ee=E.read_shift(4),Ct=!0),se=E.read_shift(4),le=E.read_shift(4)),se!=D&&Io(Ct,"Bad compressed size: "+D+" != "+se),le!=R&&Io(Ct,"Bad uncompressed size: "+R+" != "+le),cn(N,Be,We,{unsafe:!0,mt:de})}function Di(E,D){var R=D||{},N=[],M=[],F=ge(1),ae=R.compression?8:0,de=0,ee=0,se=0,le=0,Ee=0,Re=E.FullPaths[0],Be=Re,Ie=E.FileIndex[0],Le=[],We=0;for(ee=1;ee<E.FullPaths.length;++ee)if(Be=E.FullPaths[ee].slice(Re.length),Ie=E.FileIndex[ee],!(!Ie.size||!Ie.content||Be=="Sh33tJ5")){var Ct=le,Et=ge(Be.length);for(se=0;se<Be.length;++se)Et.write_shift(1,Be.charCodeAt(se)&127);Et=Et.slice(0,Et.l),Le[Ee]=j4.buf(Ie.content,0);var Ft=Ie.content;ae==8&&(Ft=P(Ft)),F=ge(30),F.write_shift(4,67324752),F.write_shift(2,20),F.write_shift(2,de),F.write_shift(2,ae),Ie.mt?l(F,Ie.mt):F.write_shift(4,0),F.write_shift(-4,Le[Ee]),F.write_shift(4,Ft.length),F.write_shift(4,Ie.content.length),F.write_shift(2,Et.length),F.write_shift(2,0),le+=F.length,N.push(F),le+=Et.length,N.push(Et),le+=Ft.length,N.push(Ft),F=ge(46),F.write_shift(4,33639248),F.write_shift(2,0),F.write_shift(2,20),F.write_shift(2,de),F.write_shift(2,ae),F.write_shift(4,0),F.write_shift(-4,Le[Ee]),F.write_shift(4,Ft.length),F.write_shift(4,Ie.content.length),F.write_shift(2,Et.length),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(4,0),F.write_shift(4,Ct),We+=F.l,M.push(F),We+=Et.length,M.push(Et),++Ee}return F=ge(22),F.write_shift(4,101010256),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(2,Ee),F.write_shift(2,Ee),F.write_shift(4,We),F.write_shift(4,le),F.write_shift(2,0),In([In(N),In(M),F])}var ys={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function vc(E,D){if(E.ctype)return E.ctype;var R=E.name||"",N=R.match(/\.([^\.]+)$/);return N&&ys[N[1]]||D&&(N=(R=D).match(/[\.\\]([^\.\\])+$/),N&&ys[N[1]])?ys[N[1]]:"application/octet-stream"}function yc(E){for(var D=ec(E),R=[],N=0;N<D.length;N+=76)R.push(D.slice(N,N+76));return R.join(`\r
`)+`\r
`}function ko(E){var D=E.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(se){var le=se.charCodeAt(0).toString(16).toUpperCase();return"="+(le.length==1?"0"+le:le)});D=D.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),D.charAt(0)==`
`&&(D="=0D"+D.slice(1)),D=D.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var R=[],N=D.split(`\r
`),M=0;M<N.length;++M){var F=N[M];if(F.length==0){R.push("");continue}for(var ae=0;ae<F.length;){var de=76,ee=F.slice(ae,ae+de);ee.charAt(de-1)=="="?de--:ee.charAt(de-2)=="="?de-=2:ee.charAt(de-3)=="="&&(de-=3),ee=F.slice(ae,ae+de),ae+=de,ae<F.length&&(ee+="="),R.push(ee)}}return R.join(`\r
`)}function Oo(E){for(var D=[],R=0;R<E.length;++R){for(var N=E[R];R<=E.length&&N.charAt(N.length-1)=="=";)N=N.slice(0,N.length-1)+E[++R];D.push(N)}for(var M=0;M<D.length;++M)D[M]=D[M].replace(/[=][0-9A-Fa-f]{2}/g,function(F){return String.fromCharCode(parseInt(F.slice(1),16))});return Wr(D.join(`\r
`))}function Tc(E,D,R){for(var N="",M="",F="",ae,de=0;de<10;++de){var ee=D[de];if(!ee||ee.match(/^\s*$/))break;var se=ee.match(/^(.*?):\s*([^\s].*)$/);if(se)switch(se[1].toLowerCase()){case"content-location":N=se[2].trim();break;case"content-type":F=se[2].trim();break;case"content-transfer-encoding":M=se[2].trim();break}}switch(++de,M.toLowerCase()){case"base64":ae=Wr(ja(D.slice(de).join("")));break;case"quoted-printable":ae=Oo(D.slice(de));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+M)}var le=cn(E,N.slice(R.length),ae,{unsafe:!0});F&&(le.ctype=F)}function af(E,D){if(Te(E.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var R=D&&D.root||"",N=(mt&&Buffer.isBuffer(E)?E.toString("binary"):Te(E)).split(`\r
`),M=0,F="";for(M=0;M<N.length;++M)if(F=N[M],!!/^Content-Location:/i.test(F)&&(F=F.slice(F.indexOf("file")),R||(R=F.slice(0,F.lastIndexOf("/")+1)),F.slice(0,R.length)!=R))for(;R.length>0&&(R=R.slice(0,R.length-1),R=R.slice(0,R.lastIndexOf("/")+1),F.slice(0,R.length)!=R););var ae=(N[1]||"").match(/boundary="(.*?)"/);if(!ae)throw new Error("MAD cannot find boundary");var de="--"+(ae[1]||""),ee=[],se=[],le={FileIndex:ee,FullPaths:se};I(le);var Ee,Re=0;for(M=0;M<N.length;++M){var Be=N[M];Be!==de&&Be!==de+"--"||(Re++&&Tc(le,N.slice(Ee,M),R),Ee=M)}return le}function aa(E,D){var R=D||{},N=R.boundary||"SheetJS";N="------="+N;for(var M=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+N.slice(2)+'"',"","",""],F=E.FullPaths[0],ae=F,de=E.FileIndex[0],ee=1;ee<E.FullPaths.length;++ee)if(ae=E.FullPaths[ee].slice(F.length),de=E.FileIndex[ee],!(!de.size||!de.content||ae=="Sh33tJ5")){ae=ae.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(We){return"_x"+We.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(We){return"_u"+We.charCodeAt(0).toString(16)+"_"});for(var se=de.content,le=mt&&Buffer.isBuffer(se)?se.toString("binary"):Te(se),Ee=0,Re=Math.min(1024,le.length),Be=0,Ie=0;Ie<=Re;++Ie)(Be=le.charCodeAt(Ie))>=32&&Be<128&&++Ee;var Le=Ee>=Re*4/5;M.push(N),M.push("Content-Location: "+(R.root||"file:///C:/SheetJS/")+ae),M.push("Content-Transfer-Encoding: "+(Le?"quoted-printable":"base64")),M.push("Content-Type: "+vc(de,ae)),M.push(""),M.push(Le?ko(le):yc(le))}return M.push(N+`--\r
`),M.join(`\r
`)}function ln(E){var D={};return I(D,E),D}function cn(E,D,R,N){var M=N&&N.unsafe;M||I(E);var F=!M&&Rt.find(E,D);if(!F){var ae=E.FullPaths[0];D.slice(0,ae.length)==ae?ae=D:(ae.slice(-1)!="/"&&(ae+="/"),ae=(ae+D).replace("//","/")),F={name:s(D),type:2},E.FileIndex.push(F),E.FullPaths.push(ae),M||Rt.utils.cfb_gc(E)}return F.content=R,F.size=R?R.length:0,N&&(N.CLSID&&(F.clsid=N.CLSID),N.mt&&(F.mt=N.mt),N.ct&&(F.ct=N.ct)),F}function $a(E,D){I(E);var R=Rt.find(E,D);if(R){for(var N=0;N<E.FileIndex.length;++N)if(E.FileIndex[N]==R)return E.FileIndex.splice(N,1),E.FullPaths.splice(N,1),!0}return!1}function Mo(E,D,R){I(E);var N=Rt.find(E,D);if(N){for(var M=0;M<E.FileIndex.length;++M)if(E.FileIndex[M]==N)return E.FileIndex[M].name=s(R),E.FullPaths[M]=R,!0}return!1}function sf(E){q(E,!0)}return e.find=J,e.read=Y,e.parse=p,e.write=U,e.writeFile=fe,e.utils={cfb_new:ln,cfb_add:cn,cfb_del:$a,cfb_mov:Mo,cfb_gc:sf,ReadShift:Gl,CheckField:nC,prep_blob:Tr,bconcat:In,use_zlib:b,_deflateRaw:dc,_inflateRaw:pc,consts:xe},e})();function z4(n){return typeof n=="string"?Wh(n):Array.isArray(n)?g4(n):n}function lc(n,e,t){if(typeof Deno<"u"){if(t&&typeof e=="string")switch(t){case"utf8":e=new TextEncoder(t).encode(e);break;case"binary":e=Wh(e);break;default:throw new Error("Unsupported encoding "+t)}return Deno.writeFileSync(n,e)}var a=t=="utf8"?nc(e):e;if(typeof IE_SaveFile<"u")return IE_SaveFile(a,n);if(typeof Blob<"u"){var s=new Blob([z4(a)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(s,n);if(typeof saveAs<"u")return saveAs(s,n);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var l=URL.createObjectURL(s);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),chrome.downloads.download({url:l,filename:n,saveAs:!0});var c=document.createElement("a");if(c.download!=null)return c.download=n,c.href=l,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(l)},6e4),l}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var h=File(n);return h.open("w"),h.encoding="binary",Array.isArray(e)&&(e=oc(e)),h.write(e),h.close(),e}catch(d){if(!d.message||!d.message.match(/onstruct/))throw d}throw new Error("cannot save file "+n)}function kn(n){for(var e=Object.keys(n),t=[],a=0;a<e.length;++a)Object.prototype.hasOwnProperty.call(n,e[a])&&t.push(e[a]);return t}function ET(n,e){for(var t=[],a=kn(n),s=0;s!==a.length;++s)t[n[a[s]][e]]==null&&(t[n[a[s]][e]]=a[s]);return t}function dm(n){for(var e=[],t=kn(n),a=0;a!==t.length;++a)e[n[t[a]]]=t[a];return e}function Zh(n){for(var e=[],t=kn(n),a=0;a!==t.length;++a)e[n[t[a]]]=parseInt(t[a],10);return e}function G4(n){for(var e=[],t=kn(n),a=0;a!==t.length;++a)e[n[t[a]]]==null&&(e[n[t[a]]]=[]),e[n[t[a]]].push(t[a]);return e}var xh=new Date(1899,11,30,0,0,0);function sr(n,e){var t=n.getTime(),a=xh.getTime()+(n.getTimezoneOffset()-xh.getTimezoneOffset())*6e4;return(t-a)/(1440*60*1e3)}var BS=new Date,$4=xh.getTime()+(BS.getTimezoneOffset()-xh.getTimezoneOffset())*6e4,AT=BS.getTimezoneOffset();function HS(n){var e=new Date;return e.setTime(n*24*60*60*1e3+$4),e.getTimezoneOffset()!==AT&&e.setTime(e.getTime()+(e.getTimezoneOffset()-AT)*6e4),e}var wT=new Date("2017-02-19T19:06:09.000Z"),jS=isNaN(wT.getFullYear())?new Date("2/19/17"):wT,K4=jS.getFullYear()==2017;function Qn(n,e){var t=new Date(n);if(K4)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(jS.getFullYear()==1917&&!isNaN(t.getFullYear())){var a=t.getFullYear();return n.indexOf(""+a)>-1||t.setFullYear(t.getFullYear()+100),t}var s=n.match(/\d+/g)||["2017","2","19","0","0","0"],l=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return n.indexOf("Z")>-1&&(l=new Date(l.getTime()-l.getTimezoneOffset()*60*1e3)),l}function ef(n,e){if(mt&&Buffer.isBuffer(n))return n.toString("binary");if(typeof TextDecoder<"u")try{var t={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(n)&&(n=new Uint8Array(n)),new TextDecoder("latin1").decode(n).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(l){return t[l]||l})}catch{}for(var a=[],s=0;s!=n.length;++s)a.push(String.fromCharCode(n[s]));return a.join("")}function or(n){if(typeof JSON<"u"&&!Array.isArray(n))return JSON.parse(JSON.stringify(n));if(typeof n!="object"||n==null)return n;if(n instanceof Date)return new Date(n.getTime());var e={};for(var t in n)Object.prototype.hasOwnProperty.call(n,t)&&(e[t]=or(n[t]));return e}function Vt(n,e){for(var t="";t.length<e;)t+=n;return t}function Ua(n){var e=Number(n);if(!isNaN(e))return isFinite(e)?e:NaN;if(!/\d/.test(n))return e;var t=1,a=n.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return t*=100,""});return!isNaN(e=Number(a))||(a=a.replace(/[(](.*)[)]/,function(s,l){return t=-t,l}),!isNaN(e=Number(a)))?e/t:e}var V4=["january","february","march","april","may","june","july","august","september","october","november","december"];function tc(n){var e=new Date(n),t=new Date(NaN),a=e.getYear(),s=e.getMonth(),l=e.getDate();if(isNaN(l))return t;var c=n.toLowerCase();if(c.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(c=c.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),c.length>3&&V4.indexOf(c)==-1)return t}else if(c.match(/[a-z]/))return t;return a<0||a>8099?t:(s>0||l>1)&&a!=101?e:n.match(/[^-0-9:,\/\\]/)?t:e}function nt(n,e,t){if(n.FullPaths){if(typeof t=="string"){var a;return mt?a=Ga(t):a=m4(t),Rt.utils.cfb_add(n,e,a)}Rt.utils.cfb_add(n,e,t)}else n.file(e,t)}function gm(){return Rt.utils.cfb_new()}var tn=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,q4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},mm=dm(q4),pm=/[&<>'"]/g,Y4=/[\u0000-\u0008\u000b-\u001f]/g;function xt(n){var e=n+"";return e.replace(pm,function(t){return mm[t]}).replace(Y4,function(t){return"_x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+"_"})}function bT(n){return xt(n).replace(/ /g,"_x0020_")}var zS=/[\u0000-\u001f]/g;function X4(n){var e=n+"";return e.replace(pm,function(t){return mm[t]}).replace(/\n/g,"<br/>").replace(zS,function(t){return"&#x"+("000"+t.charCodeAt(0).toString(16)).slice(-4)+";"})}function W4(n){var e=n+"";return e.replace(pm,function(t){return mm[t]}).replace(zS,function(t){return"&#x"+t.charCodeAt(0).toString(16).toUpperCase()+";"})}function Q4(n){return n.replace(/(\r\n|[\r\n])/g,"&#10;")}function J4(n){switch(n){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function A0(n){for(var e="",t=0,a=0,s=0,l=0,c=0,h=0;t<n.length;){if(a=n.charCodeAt(t++),a<128){e+=String.fromCharCode(a);continue}if(s=n.charCodeAt(t++),a>191&&a<224){c=(a&31)<<6,c|=s&63,e+=String.fromCharCode(c);continue}if(l=n.charCodeAt(t++),a<240){e+=String.fromCharCode((a&15)<<12|(s&63)<<6|l&63);continue}c=n.charCodeAt(t++),h=((a&7)<<18|(s&63)<<12|(l&63)<<6|c&63)-65536,e+=String.fromCharCode(55296+(h>>>10&1023)),e+=String.fromCharCode(56320+(h&1023))}return e}function IT(n){var e=ls(2*n.length),t,a,s=1,l=0,c=0,h;for(a=0;a<n.length;a+=s)s=1,(h=n.charCodeAt(a))<128?t=h:h<224?(t=(h&31)*64+(n.charCodeAt(a+1)&63),s=2):h<240?(t=(h&15)*4096+(n.charCodeAt(a+1)&63)*64+(n.charCodeAt(a+2)&63),s=3):(s=4,t=(h&7)*262144+(n.charCodeAt(a+1)&63)*4096+(n.charCodeAt(a+2)&63)*64+(n.charCodeAt(a+3)&63),t-=65536,c=55296+(t>>>10&1023),t=56320+(t&1023)),c!==0&&(e[l++]=c&255,e[l++]=c>>>8,c=0),e[l++]=t%256,e[l++]=t>>>8;return e.slice(0,l).toString("ucs2")}function RT(n){return Ga(n,"binary").toString("utf8")}var ju="foo bar bazâð£",zl=mt&&(RT(ju)==A0(ju)&&RT||IT(ju)==A0(ju)&&IT)||A0,nc=mt?function(n){return Ga(n,"utf8").toString("binary")}:function(n){for(var e=[],t=0,a=0,s=0;t<n.length;)switch(a=n.charCodeAt(t++),!0){case a<128:e.push(String.fromCharCode(a));break;case a<2048:e.push(String.fromCharCode(192+(a>>6))),e.push(String.fromCharCode(128+(a&63)));break;case(a>=55296&&a<57344):a-=55296,s=n.charCodeAt(t++)-56320+(a<<10),e.push(String.fromCharCode(240+(s>>18&7))),e.push(String.fromCharCode(144+(s>>12&63))),e.push(String.fromCharCode(128+(s>>6&63))),e.push(String.fromCharCode(128+(s&63)));break;default:e.push(String.fromCharCode(224+(a>>12))),e.push(String.fromCharCode(128+(a>>6&63))),e.push(String.fromCharCode(128+(a&63)))}return e.join("")},Z4=(function(){var n=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(e){return[new RegExp("&"+e[0]+";","ig"),e[1]]});return function(t){for(var a=t.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),s=0;s<n.length;++s)a=a.replace(n[s][0],n[s][1]);return a}})(),GS=/(^\s|\s$|\n)/;function Rn(n,e){return"<"+n+(e.match(GS)?' xml:space="preserve"':"")+">"+e+"</"+n+">"}function rc(n){return kn(n).map(function(e){return" "+e+'="'+n[e]+'"'}).join("")}function Ne(n,e,t){return"<"+n+(t!=null?rc(t):"")+(e!=null?(e.match(GS)?' xml:space="preserve"':"")+">"+e+"</"+n:"/")+">"}function Q0(n,e){try{return n.toISOString().replace(/\.\d*/,"")}catch(t){if(e)throw t}return""}function eM(n,e){switch(typeof n){case"string":var t=Ne("vt:lpwstr",xt(n));return t=t.replace(/&quot;/g,"_x0022_"),t;case"number":return Ne((n|0)==n?"vt:i4":"vt:r8",xt(String(n)));case"boolean":return Ne("vt:bool",n?"true":"false")}if(n instanceof Date)return Ne("vt:filetime",Q0(n));throw new Error("Unable to serialize "+n)}var mn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Eo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],xr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function tM(n,e){for(var t=1-2*(n[e+7]>>>7),a=((n[e+7]&127)<<4)+(n[e+6]>>>4&15),s=n[e+6]&15,l=5;l>=0;--l)s=s*256+n[e+l];return a==2047?s==0?t*(1/0):NaN:(a==0?a=-1022:(a-=1023,s+=Math.pow(2,52)),t*Math.pow(2,a-52)*s)}function nM(n,e,t){var a=(e<0||1/e==-1/0?1:0)<<7,s=0,l=0,c=a?-e:e;isFinite(c)?c==0?s=l=0:(s=Math.floor(Math.log(c)/Math.LN2),l=c*Math.pow(2,52-s),s<=-1023&&(!isFinite(l)||l<Math.pow(2,52))?s=-1022:(l-=Math.pow(2,52),s+=1023)):(s=2047,l=isNaN(e)?26985:0);for(var h=0;h<=5;++h,l/=256)n[t+h]=l&255;n[t+6]=(s&15)<<4|l&15,n[t+7]=s>>4|a}var NT=function(n){for(var e=[],t=10240,a=0;a<n[0].length;++a)if(n[0][a])for(var s=0,l=n[0][a].length;s<l;s+=t)e.push.apply(e,n[0][a].slice(s,s+t));return e},kT=mt?function(n){return n[0].length>0&&Buffer.isBuffer(n[0][0])?Buffer.concat(n[0].map(function(e){return Buffer.isBuffer(e)?e:Ga(e)})):NT(n)}:NT,OT=function(n,e,t){for(var a=[],s=e;s<t;s+=2)a.push(String.fromCharCode(Dl(n,s)));return a.join("").replace(jl,"")},vm=mt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("utf16le",e,t).replace(jl,""):OT(n,e,t)}:OT,MT=function(n,e,t){for(var a=[],s=e;s<e+t;++s)a.push(("0"+n[s].toString(16)).slice(-2));return a.join("")},$S=mt?function(n,e,t){return Buffer.isBuffer(n)?n.toString("hex",e,e+t):MT(n,e,t)}:MT,DT=function(n,e,t){for(var a=[],s=e;s<t;s++)a.push(String.fromCharCode(io(n,s)));return a.join("")},cc=mt?function(e,t,a){return Buffer.isBuffer(e)?e.toString("utf8",t,a):DT(e,t,a)}:DT,KS=function(n,e){var t=Sr(n,e);return t>0?cc(n,e+4,e+4+t-1):""},VS=KS,qS=function(n,e){var t=Sr(n,e);return t>0?cc(n,e+4,e+4+t-1):""},YS=qS,XS=function(n,e){var t=2*Sr(n,e);return t>0?cc(n,e+4,e+4+t-1):""},WS=XS,QS=function(e,t){var a=Sr(e,t);return a>0?vm(e,t+4,t+4+a):""},JS=QS,ZS=function(n,e){var t=Sr(n,e);return t>0?cc(n,e+4,e+4+t):""},eC=ZS,tC=function(n,e){return tM(n,e)},Sh=tC,ym=function(e){return Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array};mt&&(VS=function(e,t){if(!Buffer.isBuffer(e))return KS(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},YS=function(e,t){if(!Buffer.isBuffer(e))return qS(e,t);var a=e.readUInt32LE(t);return a>0?e.toString("utf8",t+4,t+4+a-1):""},WS=function(e,t){if(!Buffer.isBuffer(e))return XS(e,t);var a=2*e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a-1)},JS=function(e,t){if(!Buffer.isBuffer(e))return QS(e,t);var a=e.readUInt32LE(t);return e.toString("utf16le",t+4,t+4+a)},eC=function(e,t){if(!Buffer.isBuffer(e))return ZS(e,t);var a=e.readUInt32LE(t);return e.toString("utf8",t+4,t+4+a)},Sh=function(e,t){return Buffer.isBuffer(e)?e.readDoubleLE(t):tC(e,t)},ym=function(e){return Buffer.isBuffer(e)||Array.isArray(e)||typeof Uint8Array<"u"&&e instanceof Uint8Array});var io=function(n,e){return n[e]},Dl=function(n,e){return n[e+1]*256+n[e]},rM=function(n,e){var t=n[e+1]*256+n[e];return t<32768?t:(65535-t+1)*-1},Sr=function(n,e){return n[e+3]*(1<<24)+(n[e+2]<<16)+(n[e+1]<<8)+n[e]},es=function(n,e){return n[e+3]<<24|n[e+2]<<16|n[e+1]<<8|n[e]},aM=function(n,e){return n[e]<<24|n[e+1]<<16|n[e+2]<<8|n[e+3]};function Gl(n,e){var t="",a,s,l=[],c,h,d,g;switch(e){case"dbcs":if(g=this.l,mt&&Buffer.isBuffer(this))t=this.slice(this.l,this.l+2*n).toString("utf16le");else for(d=0;d<n;++d)t+=String.fromCharCode(Dl(this,g)),g+=2;n*=2;break;case"utf8":t=cc(this,this.l,this.l+n);break;case"utf16le":n*=2,t=vm(this,this.l,this.l+n);break;case"wstr":return Gl.call(this,n,"dbcs");case"lpstr-ansi":t=VS(this,this.l),n=4+Sr(this,this.l);break;case"lpstr-cp":t=YS(this,this.l),n=4+Sr(this,this.l);break;case"lpwstr":t=WS(this,this.l),n=4+2*Sr(this,this.l);break;case"lpp4":n=4+Sr(this,this.l),t=JS(this,this.l),n&2&&(n+=2);break;case"8lpp4":n=4+Sr(this,this.l),t=eC(this,this.l),n&3&&(n+=4-(n&3));break;case"cstr":for(n=0,t="";(c=io(this,this.l+n++))!==0;)l.push(Uu(c));t=l.join("");break;case"_wstr":for(n=0,t="";(c=Dl(this,this.l+n))!==0;)l.push(Uu(c)),n+=2;n+=2,t=l.join("");break;case"dbcs-cont":for(t="",g=this.l,d=0;d<n;++d){if(this.lens&&this.lens.indexOf(g)!==-1)return c=io(this,g),this.l=g+1,h=Gl.call(this,n-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Uu(Dl(this,g))),g+=2}t=l.join(""),n*=2;break;case"cpstr":case"sbcs-cont":for(t="",g=this.l,d=0;d!=n;++d){if(this.lens&&this.lens.indexOf(g)!==-1)return c=io(this,g),this.l=g+1,h=Gl.call(this,n-d,c?"dbcs-cont":"sbcs-cont"),l.join("")+h;l.push(Uu(io(this,g))),g+=1}t=l.join("");break;default:switch(n){case 1:return a=io(this,this.l),this.l++,a;case 2:return a=(e==="i"?rM:Dl)(this,this.l),this.l+=2,a;case 4:case-4:return e==="i"||(this[this.l+3]&128)===0?(a=(n>0?es:aM)(this,this.l),this.l+=4,a):(s=Sr(this,this.l),this.l+=4,s);case 8:case-8:if(e==="f")return n==8?s=Sh(this,this.l):s=Sh([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,s;n=8;case 16:t=$S(this,this.l,n);break}}return this.l+=n,t}var iM=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255,n[t+2]=e>>>16&255,n[t+3]=e>>>24&255},sM=function(n,e,t){n[t]=e&255,n[t+1]=e>>8&255,n[t+2]=e>>16&255,n[t+3]=e>>24&255},oM=function(n,e,t){n[t]=e&255,n[t+1]=e>>>8&255};function lM(n,e,t){var a=0,s=0;if(t==="dbcs"){for(s=0;s!=e.length;++s)oM(this,e.charCodeAt(s),this.l+2*s);a=2*e.length}else if(t==="sbcs"){for(e=e.replace(/[^\x00-\x7F]/g,"_"),s=0;s!=e.length;++s)this[this.l+s]=e.charCodeAt(s)&255;a=e.length}else if(t==="hex"){for(;s<n;++s)this[this.l++]=parseInt(e.slice(2*s,2*s+2),16)||0;return this}else if(t==="utf16le"){var l=Math.min(this.l+n,this.length);for(s=0;s<Math.min(e.length,n);++s){var c=e.charCodeAt(s);this[this.l++]=c&255,this[this.l++]=c>>8}for(;this.l<l;)this[this.l++]=0;return this}else switch(n){case 1:a=1,this[this.l]=e&255;break;case 2:a=2,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255;break;case 3:a=3,this[this.l]=e&255,e>>>=8,this[this.l+1]=e&255,e>>>=8,this[this.l+2]=e&255;break;case 4:a=4,iM(this,e,this.l);break;case 8:if(a=8,t==="f"){nM(this,e,this.l);break}case 16:break;case-4:a=4,sM(this,e,this.l);break}return this.l+=a,this}function nC(n,e){var t=$S(this,this.l,n.length>>1);if(t!==n)throw new Error(e+"Expected "+n+" saw "+t);this.l+=n.length>>1}function Tr(n,e){n.l=e,n.read_shift=Gl,n.chk=nC,n.write_shift=lM}function ya(n,e){n.l+=e}function ge(n){var e=ls(n);return Tr(e,0),e}function ar(){var n=[],e=mt?256:2048,t=function(g){var p=ge(g);return Tr(p,0),p},a=t(e),s=function(){a&&(a.length>a.l&&(a=a.slice(0,a.l),a.l=a.length),a.length>0&&n.push(a),a=null)},l=function(g){return a&&g<a.length-a.l?a:(s(),a=t(Math.max(g+1,e)))},c=function(){return s(),In(n)},h=function(g){s(),a=g,a.l==null&&(a.l=a.length),l(e)};return{next:l,push:h,end:c,_bufs:n}}function Se(n,e,t,a){var s=+e,l;if(!isNaN(s)){a||(a=tL[s].p||(t||[]).length||0),l=1+(s>=128?1:0)+1,a>=128&&++l,a>=16384&&++l,a>=2097152&&++l;var c=n.next(l);s<=127?c.write_shift(1,s):(c.write_shift(1,(s&127)+128),c.write_shift(1,s>>7));for(var h=0;h!=4;++h)if(a>=128)c.write_shift(1,(a&127)+128),a>>=7;else{c.write_shift(1,a);break}a>0&&ym(t)&&n.push(t)}}function $l(n,e,t){var a=or(n);if(e.s?(a.cRel&&(a.c+=e.s.c),a.rRel&&(a.r+=e.s.r)):(a.cRel&&(a.c+=e.c),a.rRel&&(a.r+=e.r)),!t||t.biff<12){for(;a.c>=256;)a.c-=256;for(;a.r>=65536;)a.r-=65536}return a}function PT(n,e,t){var a=or(n);return a.s=$l(a.s,e.s,t),a.e=$l(a.e,e.s,t),a}function Kl(n,e){if(n.cRel&&n.c<0)for(n=or(n);n.c<0;)n.c+=e>8?16384:256;if(n.rRel&&n.r<0)for(n=or(n);n.r<0;)n.r+=e>8?1048576:e>5?65536:16384;var t=St(n);return!n.cRel&&n.cRel!=null&&(t=hM(t)),!n.rRel&&n.rRel!=null&&(t=cM(t)),t}function w0(n,e){return n.s.r==0&&!n.s.rRel&&n.e.r==(e.biff>=12?1048575:e.biff>=8?65536:16384)&&!n.e.rRel?(n.s.cRel?"":"$")+Un(n.s.c)+":"+(n.e.cRel?"":"$")+Un(n.e.c):n.s.c==0&&!n.s.cRel&&n.e.c==(e.biff>=12?16383:255)&&!n.e.cRel?(n.s.rRel?"":"$")+Nn(n.s.r)+":"+(n.e.rRel?"":"$")+Nn(n.e.r):Kl(n.s,e.biff)+":"+Kl(n.e,e.biff)}function Tm(n){return parseInt(uM(n),10)-1}function Nn(n){return""+(n+1)}function cM(n){return n.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function uM(n){return n.replace(/\$(\d+)$/,"$1")}function _m(n){for(var e=fM(n),t=0,a=0;a!==e.length;++a)t=26*t+e.charCodeAt(a)-64;return t-1}function Un(n){if(n<0)throw new Error("invalid column "+n);var e="";for(++n;n;n=Math.floor((n-1)/26))e=String.fromCharCode((n-1)%26+65)+e;return e}function hM(n){return n.replace(/^([A-Z])/,"$$$1")}function fM(n){return n.replace(/^\$([A-Z])/,"$1")}function dM(n){return n.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function pn(n){for(var e=0,t=0,a=0;a<n.length;++a){var s=n.charCodeAt(a);s>=48&&s<=57?e=10*e+(s-48):s>=65&&s<=90&&(t=26*t+(s-64))}return{c:t-1,r:e-1}}function St(n){for(var e=n.c+1,t="";e;e=(e-1)/26|0)t=String.fromCharCode((e-1)%26+65)+t;return t+(n.r+1)}function Ar(n){var e=n.indexOf(":");return e==-1?{s:pn(n),e:pn(n)}:{s:pn(n.slice(0,e)),e:pn(n.slice(e+1))}}function en(n,e){return typeof e>"u"||typeof e=="number"?en(n.s,n.e):(typeof n!="string"&&(n=St(n)),typeof e!="string"&&(e=St(e)),n==e?n:n+":"+e)}function Ut(n){var e={s:{c:0,r:0},e:{c:0,r:0}},t=0,a=0,s=0,l=n.length;for(t=0;a<l&&!((s=n.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.s.c=--t,t=0;a<l&&!((s=n.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;if(e.s.r=--t,a===l||s!=10)return e.e.c=e.s.c,e.e.r=e.s.r,e;for(++a,t=0;a!=l&&!((s=n.charCodeAt(a)-64)<1||s>26);++a)t=26*t+s;for(e.e.c=--t,t=0;a!=l&&!((s=n.charCodeAt(a)-48)<0||s>9);++a)t=10*t+s;return e.e.r=--t,e}function FT(n,e){var t=n.t=="d"&&e instanceof Date;if(n.z!=null)try{return n.w=wi(n.z,t?sr(e):e)}catch{}try{return n.w=wi((n.XF||{}).numFmtId||(t?14:0),t?sr(e):e)}catch{return""+e}}function za(n,e,t){return n==null||n.t==null||n.t=="z"?"":n.w!==void 0?n.w:(n.t=="d"&&!n.z&&t&&t.dateNF&&(n.z=t.dateNF),n.t=="e"?uc[n.v]||n.v:e==null?FT(n,n.v):FT(n,e))}function fs(n,e){var t=e&&e.sheet?e.sheet:"Sheet1",a={};return a[t]=n,{SheetNames:[t],Sheets:a}}function rC(n,e,t){var a=t||{},s=n?Array.isArray(n):a.dense,l=n||(s?[]:{}),c=0,h=0;if(l&&a.origin!=null){if(typeof a.origin=="number")c=a.origin;else{var d=typeof a.origin=="string"?pn(a.origin):a.origin;c=d.r,h=d.c}l["!ref"]||(l["!ref"]="A1:A1")}var g={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(l["!ref"]){var p=Ut(l["!ref"]);g.s.c=p.s.c,g.s.r=p.s.r,g.e.c=Math.max(g.e.c,p.e.c),g.e.r=Math.max(g.e.r,p.e.r),c==-1&&(g.e.r=c=p.e.r+1)}for(var v=0;v!=e.length;++v)if(e[v]){if(!Array.isArray(e[v]))throw new Error("aoa_to_sheet expects an array of arrays");for(var _=0;_!=e[v].length;++_)if(!(typeof e[v][_]>"u")){var T={v:e[v][_]},C=c+v,x=h+_;if(g.s.r>C&&(g.s.r=C),g.s.c>x&&(g.s.c=x),g.e.r<C&&(g.e.r=C),g.e.c<x&&(g.e.c=x),e[v][_]&&typeof e[v][_]=="object"&&!Array.isArray(e[v][_])&&!(e[v][_]instanceof Date))T=e[v][_];else if(Array.isArray(T.v)&&(T.f=e[v][_][1],T.v=T.v[0]),T.v===null)if(T.f)T.t="n";else if(a.nullError)T.t="e",T.v=0;else if(a.sheetStubs)T.t="z";else continue;else typeof T.v=="number"?T.t="n":typeof T.v=="boolean"?T.t="b":T.v instanceof Date?(T.z=a.dateNF||qt[14],a.cellDates?(T.t="d",T.w=wi(T.z,sr(T.v))):(T.t="n",T.v=sr(T.v),T.w=wi(T.z,T.v))):T.t="s";if(s)l[C]||(l[C]=[]),l[C][x]&&l[C][x].z&&(T.z=l[C][x].z),l[C][x]=T;else{var A=St({c:x,r:C});l[A]&&l[A].z&&(T.z=l[A].z),l[A]=T}}}return g.s.c<1e7&&(l["!ref"]=en(g)),l}function Ao(n,e){return rC(null,n,e)}function gM(n){return n.read_shift(4,"i")}function ea(n,e){return e||(e=ge(4)),e.write_shift(4,n),e}function Bn(n){var e=n.read_shift(4);return e===0?"":n.read_shift(e,"dbcs")}function vn(n,e){var t=!1;return e==null&&(t=!0,e=ge(4+2*n.length)),e.write_shift(4,n.length),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}function mM(n){return{ich:n.read_shift(2),ifnt:n.read_shift(2)}}function pM(n,e){return e||(e=ge(4)),e.write_shift(2,0),e.write_shift(2,0),e}function xm(n,e){var t=n.l,a=n.read_shift(1),s=Bn(n),l=[],c={t:s,h:s};if((a&1)!==0){for(var h=n.read_shift(4),d=0;d!=h;++d)l.push(mM(n));c.r=l}else c.r=[{ich:0,ifnt:0}];return n.l=t+e,c}function vM(n,e){var t=!1;return e==null&&(t=!0,e=ge(15+4*n.t.length)),e.write_shift(1,0),vn(n.t,e),t?e.slice(0,e.l):e}var yM=xm;function TM(n,e){var t=!1;return e==null&&(t=!0,e=ge(23+4*n.t.length)),e.write_shift(1,1),vn(n.t,e),e.write_shift(4,1),pM({},e),t?e.slice(0,e.l):e}function jr(n){var e=n.read_shift(4),t=n.read_shift(2);return t+=n.read_shift(1)<<16,n.l++,{c:e,iStyleRef:t}}function ds(n,e){return e==null&&(e=ge(8)),e.write_shift(-4,n.c),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}function gs(n){var e=n.read_shift(2);return e+=n.read_shift(1)<<16,n.l++,{c:-1,iStyleRef:e}}function ms(n,e){return e==null&&(e=ge(4)),e.write_shift(3,n.iStyleRef||n.s),e.write_shift(1,0),e}var _M=Bn,aC=vn;function Sm(n){var e=n.read_shift(4);return e===0||e===4294967295?"":n.read_shift(e,"dbcs")}function Ch(n,e){var t=!1;return e==null&&(t=!0,e=ge(127)),e.write_shift(4,n.length>0?n.length:4294967295),n.length>0&&e.write_shift(0,n,"dbcs"),t?e.slice(0,e.l):e}var xM=Bn,J0=Sm,Cm=Ch;function iC(n){var e=n.slice(n.l,n.l+4),t=e[0]&1,a=e[0]&2;n.l+=4;var s=a===0?Sh([0,0,0,0,e[0]&252,e[1],e[2],e[3]],0):es(e,0)>>2;return t?s/100:s}function sC(n,e){e==null&&(e=ge(4));var t=0,a=0,s=n*100;if(n==(n|0)&&n>=-536870912&&n<1<<29?a=1:s==(s|0)&&s>=-536870912&&s<1<<29&&(a=1,t=1),a)e.write_shift(-4,((t?s:n)<<2)+(t+2));else throw new Error("unsupported RkNumber "+n)}function oC(n){var e={s:{},e:{}};return e.s.r=n.read_shift(4),e.e.r=n.read_shift(4),e.s.c=n.read_shift(4),e.e.c=n.read_shift(4),e}function SM(n,e){return e||(e=ge(16)),e.write_shift(4,n.s.r),e.write_shift(4,n.e.r),e.write_shift(4,n.s.c),e.write_shift(4,n.e.c),e}var ps=oC,wo=SM;function bo(n){if(n.length-n.l<8)throw"XLS Xnum Buffer underflow";return n.read_shift(8,"f")}function cs(n,e){return(e||ge(8)).write_shift(8,n,"f")}function CM(n){var e={},t=n.read_shift(1),a=t>>>1,s=n.read_shift(1),l=n.read_shift(2,"i"),c=n.read_shift(1),h=n.read_shift(1),d=n.read_shift(1);switch(n.l++,a){case 0:e.auto=1;break;case 1:e.index=s;var g=OM[s];g&&(e.rgb=qT(g));break;case 2:e.rgb=qT([c,h,d]);break;case 3:e.theme=s;break}return l!=0&&(e.tint=l>0?l/32767:l/32768),e}function Eh(n,e){if(e||(e=ge(8)),!n||n.auto)return e.write_shift(4,0),e.write_shift(4,0),e;n.index!=null?(e.write_shift(1,2),e.write_shift(1,n.index)):n.theme!=null?(e.write_shift(1,6),e.write_shift(1,n.theme)):(e.write_shift(1,5),e.write_shift(1,0));var t=n.tint||0;if(t>0?t*=32767:t<0&&(t*=32768),e.write_shift(2,t),!n.rgb||n.theme!=null)e.write_shift(2,0),e.write_shift(1,0),e.write_shift(1,0);else{var a=n.rgb||"FFFFFF";typeof a=="number"&&(a=("000000"+a.toString(16)).slice(-6)),e.write_shift(1,parseInt(a.slice(0,2),16)),e.write_shift(1,parseInt(a.slice(2,4),16)),e.write_shift(1,parseInt(a.slice(4,6),16)),e.write_shift(1,255)}return e}function EM(n){var e=n.read_shift(1);n.l++;var t={fBold:e&1,fItalic:e&2,fUnderline:e&4,fStrikeout:e&8,fOutline:e&16,fShadow:e&32,fCondense:e&64,fExtend:e&128};return t}function AM(n,e){e||(e=ge(2));var t=(n.italic?2:0)|(n.strike?8:0)|(n.outline?16:0)|(n.shadow?32:0)|(n.condense?64:0)|(n.extend?128:0);return e.write_shift(1,t),e.write_shift(1,0),e}var lC=2,yr=3,zu=11,Ah=19,Gu=64,wM=65,bM=71,IM=4108,RM=4126,wn=80,LT={1:{n:"CodePage",t:lC},2:{n:"Category",t:wn},3:{n:"PresentationFormat",t:wn},4:{n:"ByteCount",t:yr},5:{n:"LineCount",t:yr},6:{n:"ParagraphCount",t:yr},7:{n:"SlideCount",t:yr},8:{n:"NoteCount",t:yr},9:{n:"HiddenCount",t:yr},10:{n:"MultimediaClipCount",t:yr},11:{n:"ScaleCrop",t:zu},12:{n:"HeadingPairs",t:IM},13:{n:"TitlesOfParts",t:RM},14:{n:"Manager",t:wn},15:{n:"Company",t:wn},16:{n:"LinksUpToDate",t:zu},17:{n:"CharacterCount",t:yr},19:{n:"SharedDoc",t:zu},22:{n:"HyperlinksChanged",t:zu},23:{n:"AppVersion",t:yr,p:"version"},24:{n:"DigSig",t:wM},26:{n:"ContentType",t:wn},27:{n:"ContentStatus",t:wn},28:{n:"Language",t:wn},29:{n:"Version",t:wn},255:{},2147483648:{n:"Locale",t:Ah},2147483651:{n:"Behavior",t:Ah},1919054434:{}},UT={1:{n:"CodePage",t:lC},2:{n:"Title",t:wn},3:{n:"Subject",t:wn},4:{n:"Author",t:wn},5:{n:"Keywords",t:wn},6:{n:"Comments",t:wn},7:{n:"Template",t:wn},8:{n:"LastAuthor",t:wn},9:{n:"RevNumber",t:wn},10:{n:"EditTime",t:Gu},11:{n:"LastPrinted",t:Gu},12:{n:"CreatedDate",t:Gu},13:{n:"ModifiedDate",t:Gu},14:{n:"PageCount",t:yr},15:{n:"WordCount",t:yr},16:{n:"CharCount",t:yr},17:{n:"Thumbnail",t:bM},18:{n:"Application",t:wn},19:{n:"DocSecurity",t:yr},255:{},2147483648:{n:"Locale",t:Ah},2147483651:{n:"Behavior",t:Ah},1919054434:{}};function NM(n){return n.map(function(e){return[e>>16&255,e>>8&255,e&255]})}var kM=NM([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),OM=or(kM),uc={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},MM={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},$u={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function cC(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function uC(n,e){var t=G4(MM),a=[],s;a[a.length]=tn,a[a.length]=Ne("Types",null,{xmlns:mn.CT,"xmlns:xsd":mn.xsd,"xmlns:xsi":mn.xsi}),a=a.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(d){return Ne("Default",null,{Extension:d[0],ContentType:d[1]})}));var l=function(d){n[d]&&n[d].length>0&&(s=n[d][0],a[a.length]=Ne("Override",null,{PartName:(s[0]=="/"?"":"/")+s,ContentType:$u[d][e.bookType]||$u[d].xlsx}))},c=function(d){(n[d]||[]).forEach(function(g){a[a.length]=Ne("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:$u[d][e.bookType]||$u[d].xlsx})})},h=function(d){(n[d]||[]).forEach(function(g){a[a.length]=Ne("Override",null,{PartName:(g[0]=="/"?"":"/")+g,ContentType:t[d][0]})})};return l("workbooks"),c("sheets"),c("charts"),h("themes"),["strs","styles"].forEach(l),["coreprops","extprops","custprops"].forEach(h),h("vba"),h("comments"),h("threadedcomments"),h("drawings"),c("metadata"),h("people"),a.length>2&&(a[a.length]="</Types>",a[1]=a[1].replace("/>",">")),a.join("")}var ft={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function hC(n){var e=n.lastIndexOf("/");return n.slice(0,e+1)+"_rels/"+n.slice(e+1)+".rels"}function ho(n){var e=[tn,Ne("Relationships",null,{xmlns:mn.RELS})];return kn(n["!id"]).forEach(function(t){e[e.length]=Ne("Relationship",null,n["!id"][t])}),e.length>2&&(e[e.length]="</Relationships>",e[1]=e[1].replace("/>",">")),e.join("")}function Tt(n,e,t,a,s,l){if(s||(s={}),n["!id"]||(n["!id"]={}),n["!idx"]||(n["!idx"]=1),e<0)for(e=n["!idx"];n["!id"]["rId"+e];++e);if(n["!idx"]=e+1,s.Id="rId"+e,s.Type=a,s.Target=t,[ft.HLINK,ft.XPATH,ft.XMISS].indexOf(s.Type)>-1&&(s.TargetMode="External"),n["!id"][s.Id])throw new Error("Cannot rewrite rId "+e);return n["!id"][s.Id]=s,n[("/"+s.Target).replace("//","/")]=s,e}function DM(n){var e=[tn];e.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),e.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var t=0;t<n.length;++t)e.push('  <manifest:file-entry manifest:full-path="'+n[t][0]+'" manifest:media-type="'+n[t][1]+`"/>
`);return e.push("</manifest:manifest>"),e.join("")}function BT(n,e,t){return['  <rdf:Description rdf:about="'+n+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(t||"odf")+"#"+e+`"/>
`,`  </rdf:Description>
`].join("")}function PM(n,e){return['  <rdf:Description rdf:about="'+n+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+e+`"/>
`,`  </rdf:Description>
`].join("")}function FM(n){var e=[tn];e.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var t=0;t!=n.length;++t)e.push(BT(n[t][0],n[t][1])),e.push(PM("",n[t][0]));return e.push(BT("","Document","pkg")),e.push("</rdf:RDF>"),e.join("")}function fC(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+ph.version+"</meta:generator></office:meta></office:document-meta>"}var rs=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]];function b0(n,e,t,a,s){s[n]!=null||e==null||e===""||(s[n]=e,e=xt(e),a[a.length]=t?Ne(n,e,t):Rn(n,e))}function dC(n,e){var t=e||{},a=[tn,Ne("cp:coreProperties",null,{"xmlns:cp":mn.CORE_PROPS,"xmlns:dc":mn.dc,"xmlns:dcterms":mn.dcterms,"xmlns:dcmitype":mn.dcmitype,"xmlns:xsi":mn.xsi})],s={};if(!n&&!t.Props)return a.join("");n&&(n.CreatedDate!=null&&b0("dcterms:created",typeof n.CreatedDate=="string"?n.CreatedDate:Q0(n.CreatedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s),n.ModifiedDate!=null&&b0("dcterms:modified",typeof n.ModifiedDate=="string"?n.ModifiedDate:Q0(n.ModifiedDate,t.WTF),{"xsi:type":"dcterms:W3CDTF"},a,s));for(var l=0;l!=rs.length;++l){var c=rs[l],h=t.Props&&t.Props[c[1]]!=null?t.Props[c[1]]:n?n[c[1]]:null;h===!0?h="1":h===!1?h="0":typeof h=="number"&&(h=String(h)),h!=null&&b0(c[0],h,null,a,s)}return a.length>2&&(a[a.length]="</cp:coreProperties>",a[1]=a[1].replace("/>",">")),a.join("")}var fo=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],gC=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function mC(n){var e=[],t=Ne;return n||(n={}),n.Application="SheetJS",e[e.length]=tn,e[e.length]=Ne("Properties",null,{xmlns:mn.EXT_PROPS,"xmlns:vt":mn.vt}),fo.forEach(function(a){if(n[a[1]]!==void 0){var s;switch(a[2]){case"string":s=xt(String(n[a[1]]));break;case"bool":s=n[a[1]]?"true":"false";break}s!==void 0&&(e[e.length]=t(a[0],s))}}),e[e.length]=t("HeadingPairs",t("vt:vector",t("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+t("vt:variant",t("vt:i4",String(n.Worksheets))),{size:2,baseType:"variant"})),e[e.length]=t("TitlesOfParts",t("vt:vector",n.SheetNames.map(function(a){return"<vt:lpstr>"+xt(a)+"</vt:lpstr>"}).join(""),{size:n.Worksheets,baseType:"lpstr"})),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}function pC(n){var e=[tn,Ne("Properties",null,{xmlns:mn.CUST_PROPS,"xmlns:vt":mn.vt})];if(!n)return e.join("");var t=1;return kn(n).forEach(function(s){++t,e[e.length]=Ne("property",eM(n[s]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:t,name:xt(s)})}),e.length>2&&(e[e.length]="</Properties>",e[1]=e[1].replace("/>",">")),e.join("")}var HT={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"};function LM(n,e){var t=[];return kn(HT).map(function(a){for(var s=0;s<rs.length;++s)if(rs[s][1]==a)return rs[s];for(s=0;s<fo.length;++s)if(fo[s][1]==a)return fo[s];throw a}).forEach(function(a){if(n[a[1]]!=null){var s=e&&e.Props&&e.Props[a[1]]!=null?e.Props[a[1]]:n[a[1]];switch(a[2]){case"date":s=new Date(s).toISOString().replace(/\.\d*Z/,"Z");break}typeof s=="number"?s=String(s):s===!0||s===!1?s=s?"1":"0":s instanceof Date&&(s=new Date(s).toISOString().replace(/\.\d*Z/,"")),t.push(Rn(HT[a[1]]||a[1],s))}}),Ne("DocumentProperties",t.join(""),{xmlns:xr.o})}function UM(n,e){var t=["Worksheets","SheetNames"],a="CustomDocumentProperties",s=[];return n&&kn(n).forEach(function(l){if(Object.prototype.hasOwnProperty.call(n,l)){for(var c=0;c<rs.length;++c)if(l==rs[c][1])return;for(c=0;c<fo.length;++c)if(l==fo[c][1])return;for(c=0;c<t.length;++c)if(l==t[c])return;var h=n[l],d="string";typeof h=="number"?(d="float",h=String(h)):h===!0||h===!1?(d="boolean",h=h?"1":"0"):h=String(h),s.push(Ne(bT(l),h,{"dt:dt":d}))}}),e&&kn(e).forEach(function(l){if(Object.prototype.hasOwnProperty.call(e,l)&&!(n&&Object.prototype.hasOwnProperty.call(n,l))){var c=e[l],h="string";typeof c=="number"?(h="float",c=String(c)):c===!0||c===!1?(h="boolean",c=c?"1":"0"):c instanceof Date?(h="dateTime.tz",c=c.toISOString()):c=String(c),s.push(Ne(bT(l),c,{"dt:dt":h}))}}),"<"+a+' xmlns="'+xr.o+'">'+s.join("")+"</"+a+">"}function BM(n){var e=typeof n=="string"?new Date(Date.parse(n)):n,t=e.getTime()/1e3+11644473600,a=t%Math.pow(2,32),s=(t-a)/Math.pow(2,32);a*=1e7,s*=1e7;var l=a/Math.pow(2,32)|0;l>0&&(a=a%Math.pow(2,32),s+=l);var c=ge(8);return c.write_shift(4,a),c.write_shift(4,s),c}function jT(n,e){var t=ge(4),a=ge(4);switch(t.write_shift(4,n==80?31:n),n){case 3:a.write_shift(-4,e);break;case 5:a=ge(8),a.write_shift(8,e,"f");break;case 11:a.write_shift(4,e?1:0);break;case 64:a=BM(e);break;case 31:case 80:for(a=ge(4+2*(e.length+1)+(e.length%2?0:2)),a.write_shift(4,e.length+1),a.write_shift(0,e,"dbcs");a.l!=a.length;)a.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+n+" "+e)}return In([t,a])}var vC=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function HM(n){switch(typeof n){case"boolean":return 11;case"number":return(n|0)==n?3:5;case"string":return 31;case"object":if(n instanceof Date)return 64;break}return-1}function zT(n,e,t){var a=ge(8),s=[],l=[],c=8,h=0,d=ge(8),g=ge(8);if(d.write_shift(4,2),d.write_shift(4,1200),g.write_shift(4,1),l.push(d),s.push(g),c+=8+d.length,!e){g=ge(8),g.write_shift(4,0),s.unshift(g);var p=[ge(4)];for(p[0].write_shift(4,n.length),h=0;h<n.length;++h){var v=n[h][0];for(d=ge(8+2*(v.length+1)+(v.length%2?0:2)),d.write_shift(4,h+2),d.write_shift(4,v.length+1),d.write_shift(0,v,"dbcs");d.l!=d.length;)d.write_shift(1,0);p.push(d)}d=In(p),l.unshift(d),c+=8+d.length}for(h=0;h<n.length;++h)if(!(e&&!e[n[h][0]])&&!(vC.indexOf(n[h][0])>-1||gC.indexOf(n[h][0])>-1)&&n[h][1]!=null){var _=n[h][1],T=0;if(e){T=+e[n[h][0]];var C=t[T];if(C.p=="version"&&typeof _=="string"){var x=_.split(".");_=(+x[0]<<16)+(+x[1]||0)}d=jT(C.t,_)}else{var A=HM(_);A==-1&&(A=31,_=String(_)),d=jT(A,_)}l.push(d),g=ge(8),g.write_shift(4,e?T:2+h),s.push(g),c+=8+d.length}var B=8*(l.length+1);for(h=0;h<l.length;++h)s[h].write_shift(4,B),B+=l[h].length;return a.write_shift(4,c),a.write_shift(4,l.length),In([a].concat(s).concat(l))}function GT(n,e,t,a,s,l){var c=ge(s?68:48),h=[c];c.write_shift(2,65534),c.write_shift(2,0),c.write_shift(4,842412599),c.write_shift(16,Rt.utils.consts.HEADER_CLSID,"hex"),c.write_shift(4,s?2:1),c.write_shift(16,e,"hex"),c.write_shift(4,s?68:48);var d=zT(n,t,a);if(h.push(d),s){var g=zT(s,null,null);c.write_shift(16,l,"hex"),c.write_shift(4,68+d.length),h.push(g)}return In(h)}function jM(n,e){e||(e=ge(n));for(var t=0;t<n;++t)e.write_shift(1,0);return e}function zM(n,e){return n.read_shift(e)===1}function Xn(n,e){return e||(e=ge(2)),e.write_shift(2,+!!n),e}function yC(n){return n.read_shift(2,"u")}function Ur(n,e){return e||(e=ge(2)),e.write_shift(2,n),e}function TC(n,e,t){return t||(t=ge(2)),t.write_shift(1,e=="e"?+n:+!!n),t.write_shift(1,e=="e"?1:0),t}function _C(n,e,t){var a=n.read_shift(t&&t.biff>=12?2:1),s="sbcs-cont";if(t&&t.biff>=8,!t||t.biff==8){var l=n.read_shift(1);l&&(s="dbcs-cont")}else t.biff==12&&(s="wstr");t.biff>=2&&t.biff<=5&&(s="cpstr");var c=a?n.read_shift(a,s):"";return c}function GM(n){var e=n.t||"",t=ge(3);t.write_shift(2,e.length),t.write_shift(1,1);var a=ge(2*e.length);a.write_shift(2*e.length,e,"utf16le");var s=[t,a];return In(s)}function $M(n,e,t){var a;if(t){if(t.biff>=2&&t.biff<=5)return n.read_shift(e,"cpstr");if(t.biff>=12)return n.read_shift(e,"dbcs-cont")}var s=n.read_shift(1);return s===0?a=n.read_shift(e,"sbcs-cont"):a=n.read_shift(e,"dbcs-cont"),a}function KM(n,e,t){var a=n.read_shift(t&&t.biff==2?1:2);return a===0?(n.l++,""):$M(n,a,t)}function VM(n,e,t){if(t.biff>5)return KM(n,e,t);var a=n.read_shift(1);return a===0?(n.l++,""):n.read_shift(a,t.biff<=4||!n.lens?"cpstr":"sbcs-cont")}function xC(n,e,t){return t||(t=ge(3+2*n.length)),t.write_shift(2,n.length),t.write_shift(1,1),t.write_shift(31,n,"utf16le"),t}function $T(n,e){e||(e=ge(6+n.length*2)),e.write_shift(4,1+n.length);for(var t=0;t<n.length;++t)e.write_shift(2,n.charCodeAt(t));return e.write_shift(2,0),e}function qM(n){var e=ge(512),t=0,a=n.Target;a.slice(0,7)=="file://"&&(a=a.slice(7));var s=a.indexOf("#"),l=s>-1?31:23;switch(a.charAt(0)){case"#":l=28;break;case".":l&=-3;break}e.write_shift(4,2),e.write_shift(4,l);var c=[8,6815827,6619237,4849780,83];for(t=0;t<c.length;++t)e.write_shift(4,c[t]);if(l==28)a=a.slice(1),$T(a,e);else if(l&2){for(c="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));var h=s>-1?a.slice(0,s):a;for(e.write_shift(4,2*(h.length+1)),t=0;t<h.length;++t)e.write_shift(2,h.charCodeAt(t));e.write_shift(2,0),l&8&&$T(s>-1?a.slice(s+1):"",e)}else{for(c="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),t=0;t<c.length;++t)e.write_shift(1,parseInt(c[t],16));for(var d=0;a.slice(d*3,d*3+3)=="../"||a.slice(d*3,d*3+3)=="..\\";)++d;for(e.write_shift(2,d),e.write_shift(4,a.length-3*d+1),t=0;t<a.length-3*d;++t)e.write_shift(1,a.charCodeAt(t+3*d)&255);for(e.write_shift(1,0),e.write_shift(2,65535),e.write_shift(2,57005),t=0;t<6;++t)e.write_shift(4,0)}return e.slice(0,e.l)}function us(n,e,t,a){return a||(a=ge(6)),a.write_shift(2,n),a.write_shift(2,e),a.write_shift(2,t||0),a}function YM(n,e,t){var a=t.biff>8?4:2,s=n.read_shift(a),l=n.read_shift(a,"i"),c=n.read_shift(a,"i");return[s,l,c]}function XM(n){var e=n.read_shift(2),t=n.read_shift(2),a=n.read_shift(2),s=n.read_shift(2);return{s:{c:a,r:e},e:{c:s,r:t}}}function SC(n,e){return e||(e=ge(8)),e.write_shift(2,n.s.r),e.write_shift(2,n.e.r),e.write_shift(2,n.s.c),e.write_shift(2,n.e.c),e}function Em(n,e,t){var a=1536,s=16;switch(t.bookType){case"biff8":break;case"biff5":a=1280,s=8;break;case"biff4":a=4,s=6;break;case"biff3":a=3,s=6;break;case"biff2":a=2,s=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var l=ge(s);return l.write_shift(2,a),l.write_shift(2,e),s>4&&l.write_shift(2,29282),s>6&&l.write_shift(2,1997),s>8&&(l.write_shift(2,49161),l.write_shift(2,1),l.write_shift(2,1798),l.write_shift(2,0)),l}function WM(n,e){var t=!e||e.biff==8,a=ge(t?112:54);for(a.write_shift(e.biff==8?2:1,7),t&&a.write_shift(1,0),a.write_shift(4,859007059),a.write_shift(4,5458548|(t?0:536870912));a.l<a.length;)a.write_shift(1,t?0:32);return a}function QM(n,e){var t=!e||e.biff>=8?2:1,a=ge(8+t*n.name.length);a.write_shift(4,n.pos),a.write_shift(1,n.hs||0),a.write_shift(1,n.dt),a.write_shift(1,n.name.length),e.biff>=8&&a.write_shift(1,1),a.write_shift(t*n.name.length,n.name,e.biff<8?"sbcs":"utf16le");var s=a.slice(0,a.l);return s.l=a.l,s}function JM(n,e){var t=ge(8);t.write_shift(4,n.Count),t.write_shift(4,n.Unique);for(var a=[],s=0;s<n.length;++s)a[s]=GM(n[s]);var l=In([t].concat(a));return l.parts=[t.length].concat(a.map(function(c){return c.length})),l}function ZM(){var n=ge(18);return n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,29280),n.write_shift(2,17600),n.write_shift(2,56),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,1),n.write_shift(2,500),n}function e3(n){var e=ge(18),t=1718;return n&&n.RTL&&(t|=64),e.write_shift(2,t),e.write_shift(4,0),e.write_shift(4,64),e.write_shift(4,0),e.write_shift(4,0),e}function t3(n,e){var t=n.name||"Arial",a=e&&e.biff==5,s=a?15+t.length:16+2*t.length,l=ge(s);return l.write_shift(2,n.sz*20),l.write_shift(4,0),l.write_shift(2,400),l.write_shift(4,0),l.write_shift(2,0),l.write_shift(1,t.length),a||l.write_shift(1,1),l.write_shift((a?1:2)*t.length,t,a?"sbcs":"utf16le"),l}function n3(n,e,t,a){var s=ge(10);return us(n,e,a,s),s.write_shift(4,t),s}function r3(n,e,t,a,s){var l=!s||s.biff==8,c=ge(8+ +l+(1+l)*t.length);return us(n,e,a,c),c.write_shift(2,t.length),l&&c.write_shift(1,1),c.write_shift((1+l)*t.length,t,l?"utf16le":"sbcs"),c}function a3(n,e,t,a){var s=t&&t.biff==5;a||(a=ge(s?3+e.length:5+2*e.length)),a.write_shift(2,n),a.write_shift(s?1:2,e.length),s||a.write_shift(1,1),a.write_shift((s?1:2)*e.length,e,s?"sbcs":"utf16le");var l=a.length>a.l?a.slice(0,a.l):a;return l.l==null&&(l.l=l.length),l}function i3(n,e){var t=e.biff==8||!e.biff?4:2,a=ge(2*t+6);return a.write_shift(t,n.s.r),a.write_shift(t,n.e.r+1),a.write_shift(2,n.s.c),a.write_shift(2,n.e.c+1),a.write_shift(2,0),a}function KT(n,e,t,a){var s=t&&t.biff==5;a||(a=ge(s?16:20)),a.write_shift(2,0),n.style?(a.write_shift(2,n.numFmtId||0),a.write_shift(2,65524)):(a.write_shift(2,n.numFmtId||0),a.write_shift(2,e<<4));var l=0;return n.numFmtId>0&&s&&(l|=1024),a.write_shift(4,l),a.write_shift(4,0),s||a.write_shift(4,0),a.write_shift(2,0),a}function s3(n){var e=ge(8);return e.write_shift(4,0),e.write_shift(2,0),e.write_shift(2,0),e}function o3(n,e,t,a,s,l){var c=ge(8);return us(n,e,a,c),TC(t,l,c),c}function l3(n,e,t,a){var s=ge(14);return us(n,e,a,s),cs(t,s),s}function c3(n,e,t){if(t.biff<8)return u3(n,e,t);for(var a=[],s=n.l+e,l=n.read_shift(t.biff>8?4:2);l--!==0;)a.push(YM(n,t.biff>8?12:6,t));if(n.l!=s)throw new Error("Bad ExternSheet: "+n.l+" != "+s);return a}function u3(n,e,t){n[n.l+1]==3&&n[n.l]++;var a=_C(n,e,t);return a.charCodeAt(0)==3?a.slice(1):a}function h3(n){var e=ge(2+n.length*8);e.write_shift(2,n.length);for(var t=0;t<n.length;++t)SC(n[t],e);return e}function f3(n){var e=ge(24),t=pn(n[0]);e.write_shift(2,t.r),e.write_shift(2,t.r),e.write_shift(2,t.c),e.write_shift(2,t.c);for(var a="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),s=0;s<16;++s)e.write_shift(1,parseInt(a[s],16));return In([e,qM(n[1])])}function d3(n){var e=n[1].Tooltip,t=ge(10+2*(e.length+1));t.write_shift(2,2048);var a=pn(n[0]);t.write_shift(2,a.r),t.write_shift(2,a.r),t.write_shift(2,a.c),t.write_shift(2,a.c);for(var s=0;s<e.length;++s)t.write_shift(2,e.charCodeAt(s));return t.write_shift(2,0),t}function g3(n){return n||(n=ge(4)),n.write_shift(2,1),n.write_shift(2,1),n}function m3(n,e,t){if(!t.cellStyles)return ya(n,e);var a=t&&t.biff>=12?4:2,s=n.read_shift(a),l=n.read_shift(a),c=n.read_shift(a),h=n.read_shift(a),d=n.read_shift(2);a==2&&(n.l+=2);var g={s,e:l,w:c,ixfe:h,flags:d};return(t.biff>=5||!t.biff)&&(g.level=d>>8&7),g}function p3(n,e){var t=ge(12);t.write_shift(2,e),t.write_shift(2,e),t.write_shift(2,n.width*256),t.write_shift(2,0);var a=0;return n.hidden&&(a|=1),t.write_shift(1,a),a=n.level||0,t.write_shift(1,a),t.write_shift(2,0),t}function v3(n){for(var e=ge(2*n),t=0;t<n;++t)e.write_shift(2,t+1);return e}function y3(n,e,t){var a=ge(15);return fc(a,n,e),a.write_shift(8,t,"f"),a}function T3(n,e,t){var a=ge(9);return fc(a,n,e),a.write_shift(2,t),a}var _3=(function(){var n={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},e=dm({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function t(h,d){var g=[],p=ls(1);switch(d.type){case"base64":p=Wr(ja(h));break;case"binary":p=Wr(h);break;case"buffer":case"array":p=h;break}Tr(p,0);var v=p.read_shift(1),_=!!(v&136),T=!1,C=!1;switch(v){case 2:break;case 3:break;case 48:T=!0,_=!0;break;case 49:T=!0,_=!0;break;case 131:break;case 139:break;case 140:C=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+v.toString(16))}var x=0,A=521;v==2&&(x=p.read_shift(2)),p.l+=3,v!=2&&(x=p.read_shift(4)),x>1048576&&(x=1e6),v!=2&&(A=p.read_shift(2));var B=p.read_shift(2),k=d.codepage||1252;v!=2&&(p.l+=16,p.read_shift(1),p[p.l]!==0&&(k=n[p[p.l]]),p.l+=1,p.l+=2),C&&(p.l+=36);for(var O=[],j={},H=Math.min(p.length,v==2?521:A-10-(T?264:0)),Y=C?32:11;p.l<H&&p[p.l]!=13;)switch(j={},j.name=vh.utils.decode(k,p.slice(p.l,p.l+Y)).replace(/[\u0000\r\n].*$/g,""),p.l+=Y,j.type=String.fromCharCode(p.read_shift(1)),v!=2&&!C&&(j.offset=p.read_shift(4)),j.len=p.read_shift(1),v==2&&(j.offset=p.read_shift(2)),j.dec=p.read_shift(1),j.name.length&&O.push(j),v!=2&&(p.l+=C?13:14),j.type){case"B":(!T||j.len!=8)&&d.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"G":case"P":d.WTF&&console.log("Skipping "+j.name+":"+j.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+j.type)}if(p[p.l]!==13&&(p.l=A-1),p.read_shift(1)!==13)throw new Error("DBF Terminator not found "+p.l+" "+p[p.l]);p.l=A;var I=0,G=0;for(g[0]=[],G=0;G!=O.length;++G)g[0][G]=O[G].name;for(;x-- >0;){if(p[p.l]===42){p.l+=B;continue}for(++p.l,g[++I]=[],G=0,G=0;G!=O.length;++G){var q=p.slice(p.l,p.l+O[G].len);p.l+=O[G].len,Tr(q,0);var ie=vh.utils.decode(k,q);switch(O[G].type){case"C":ie.trim().length&&(g[I][G]=ie.replace(/\s+$/,""));break;case"D":ie.length===8?g[I][G]=new Date(+ie.slice(0,4),+ie.slice(4,6)-1,+ie.slice(6,8)):g[I][G]=ie;break;case"F":g[I][G]=parseFloat(ie.trim());break;case"+":case"I":g[I][G]=C?q.read_shift(-4,"i")^2147483648:q.read_shift(4,"i");break;case"L":switch(ie.trim().toUpperCase()){case"Y":case"T":g[I][G]=!0;break;case"N":case"F":g[I][G]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+ie+"|")}break;case"M":if(!_)throw new Error("DBF Unexpected MEMO for type "+v.toString(16));g[I][G]="##MEMO##"+(C?parseInt(ie.trim(),10):q.read_shift(4));break;case"N":ie=ie.replace(/\u0000/g,"").trim(),ie&&ie!="."&&(g[I][G]=+ie||0);break;case"@":g[I][G]=new Date(q.read_shift(-8,"f")-621356832e5);break;case"T":g[I][G]=new Date((q.read_shift(4)-2440588)*864e5+q.read_shift(4));break;case"Y":g[I][G]=q.read_shift(4,"i")/1e4+q.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":g[I][G]=-q.read_shift(-8,"f");break;case"B":if(T&&O[G].len==8){g[I][G]=q.read_shift(8,"f");break}case"G":case"P":q.l+=O[G].len;break;case"0":if(O[G].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+O[G].type)}}}if(v!=2&&p.l<p.length&&p[p.l++]!=26)throw new Error("DBF EOF Marker missing "+(p.l-1)+" of "+p.length+" "+p[p.l-1].toString(16));return d&&d.sheetRows&&(g=g.slice(0,d.sheetRows)),d.DBF=O,g}function a(h,d){var g=d||{};g.dateNF||(g.dateNF="yyyymmdd");var p=Ao(t(h,g),g);return p["!cols"]=g.DBF.map(function(v){return{wch:v.len,DBF:v}}),delete g.DBF,p}function s(h,d){try{return fs(a(h,d),d)}catch(g){if(d&&d.WTF)throw g}return{SheetNames:[],Sheets:{}}}var l={B:8,C:250,L:1,D:8,"?":0,"":0};function c(h,d){var g=d||{};if(+g.codepage>=0&&Zl(+g.codepage),g.type=="string")throw new Error("Cannot write DBF to JS string");var p=ar(),v=Nh(h,{header:1,raw:!0,cellDates:!0}),_=v[0],T=v.slice(1),C=h["!cols"]||[],x=0,A=0,B=0,k=1;for(x=0;x<_.length;++x){if(((C[x]||{}).DBF||{}).name){_[x]=C[x].DBF.name,++B;continue}if(_[x]!=null){if(++B,typeof _[x]=="number"&&(_[x]=_[x].toString(10)),typeof _[x]!="string")throw new Error("DBF Invalid column name "+_[x]+" |"+typeof _[x]+"|");if(_.indexOf(_[x])!==x){for(A=0;A<1024;++A)if(_.indexOf(_[x]+"_"+A)==-1){_[x]+="_"+A;break}}}}var O=Ut(h["!ref"]),j=[],H=[],Y=[];for(x=0;x<=O.e.c-O.s.c;++x){var I="",G="",q=0,ie=[];for(A=0;A<T.length;++A)T[A][x]!=null&&ie.push(T[A][x]);if(ie.length==0||_[x]==null){j[x]="?";continue}for(A=0;A<ie.length;++A){switch(typeof ie[A]){case"number":G="B";break;case"string":G="C";break;case"boolean":G="L";break;case"object":G=ie[A]instanceof Date?"D":"C";break;default:G="C"}q=Math.max(q,String(ie[A]).length),I=I&&I!=G?"C":G}q>250&&(q=250),G=((C[x]||{}).DBF||{}).type,G=="C"&&C[x].DBF.len>q&&(q=C[x].DBF.len),I=="B"&&G=="N"&&(I="N",Y[x]=C[x].DBF.dec,q=C[x].DBF.len),H[x]=I=="C"||G=="N"?q:l[I]||0,k+=H[x],j[x]=I}var J=p.next(32);for(J.write_shift(4,318902576),J.write_shift(4,T.length),J.write_shift(2,296+32*B),J.write_shift(2,k),x=0;x<4;++x)J.write_shift(4,0);for(J.write_shift(4,0|(+e[ES]||3)<<8),x=0,A=0;x<_.length;++x)if(_[x]!=null){var he=p.next(32),Ae=(_[x].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);he.write_shift(1,Ae,"sbcs"),he.write_shift(1,j[x]=="?"?"C":j[x],"sbcs"),he.write_shift(4,A),he.write_shift(1,H[x]||l[j[x]]||0),he.write_shift(1,Y[x]||0),he.write_shift(1,2),he.write_shift(4,0),he.write_shift(1,0),he.write_shift(4,0),he.write_shift(4,0),A+=H[x]||l[j[x]]||0}var je=p.next(264);for(je.write_shift(4,13),x=0;x<65;++x)je.write_shift(4,0);for(x=0;x<T.length;++x){var ke=p.next(k);for(ke.write_shift(1,0),A=0;A<_.length;++A)if(_[A]!=null)switch(j[A]){case"L":ke.write_shift(1,T[x][A]==null?63:T[x][A]?84:70);break;case"B":ke.write_shift(8,T[x][A]||0,"f");break;case"N":var re="0";for(typeof T[x][A]=="number"&&(re=T[x][A].toFixed(Y[A]||0)),B=0;B<H[A]-re.length;++B)ke.write_shift(1,32);ke.write_shift(1,re,"sbcs");break;case"D":T[x][A]?(ke.write_shift(4,("0000"+T[x][A].getFullYear()).slice(-4),"sbcs"),ke.write_shift(2,("00"+(T[x][A].getMonth()+1)).slice(-2),"sbcs"),ke.write_shift(2,("00"+T[x][A].getDate()).slice(-2),"sbcs")):ke.write_shift(8,"00000000","sbcs");break;case"C":var xe=String(T[x][A]!=null?T[x][A]:"").slice(0,H[A]);for(ke.write_shift(1,xe,"sbcs"),B=0;B<H[A]-xe.length;++B)ke.write_shift(1,32);break}}return p.next(1).write_shift(1,26),p.end()}return{to_workbook:s,to_sheet:a,from_sheet:c}})(),x3=(function(){var n={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},e=new RegExp("\x1BN("+kn(n).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),t=function(_,T){var C=n[T];return typeof C=="number"?mT(C):C},a=function(_,T,C){var x=T.charCodeAt(0)-32<<4|C.charCodeAt(0)-48;return x==59?_:mT(x)};n["|"]=254;function s(_,T){switch(T.type){case"base64":return l(ja(_),T);case"binary":return l(_,T);case"buffer":return l(mt&&Buffer.isBuffer(_)?_.toString("binary"):oc(_),T);case"array":return l(ef(_),T)}throw new Error("Unrecognized type "+T.type)}function l(_,T){var C=_.split(/[\n\r]+/),x=-1,A=-1,B=0,k=0,O=[],j=[],H=null,Y={},I=[],G=[],q=[],ie=0,J;for(+T.codepage>=0&&Zl(+T.codepage);B!==C.length;++B){ie=0;var he=C[B].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,a).replace(e,t),Ae=he.replace(/;;/g,"\0").split(";").map(function(K){return K.replace(/\u0000/g,";")}),je=Ae[0],ke;if(he.length>0)switch(je){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":Ae[1].charAt(0)=="P"&&j.push(he.slice(3).replace(/;;/g,";"));break;case"C":var re=!1,xe=!1,fe=!1,Te=!1,U=-1,ue=-1;for(k=1;k<Ae.length;++k)switch(Ae[k].charAt(0)){case"A":break;case"X":A=parseInt(Ae[k].slice(1))-1,xe=!0;break;case"Y":for(x=parseInt(Ae[k].slice(1))-1,xe||(A=0),J=O.length;J<=x;++J)O[J]=[];break;case"K":ke=Ae[k].slice(1),ke.charAt(0)==='"'?ke=ke.slice(1,ke.length-1):ke==="TRUE"?ke=!0:ke==="FALSE"?ke=!1:isNaN(Ua(ke))?isNaN(tc(ke).getDate())||(ke=Qn(ke)):(ke=Ua(ke),H!==null&&FS(H)&&(ke=HS(ke))),re=!0;break;case"E":Te=!0;var b=TD(Ae[k].slice(1),{r:x,c:A});O[x][A]=[O[x][A],b];break;case"S":fe=!0,O[x][A]=[O[x][A],"S5S"];break;case"G":break;case"R":U=parseInt(Ae[k].slice(1))-1;break;case"C":ue=parseInt(Ae[k].slice(1))-1;break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+he)}if(re&&(O[x][A]&&O[x][A].length==2?O[x][A][0]=ke:O[x][A]=ke,H=null),fe){if(Te)throw new Error("SYLK shared formula cannot have own formula");var L=U>-1&&O[U][ue];if(!L||!L[1])throw new Error("SYLK shared formula cannot find base");O[x][A][1]=_D(L[1],{r:x-U,c:A-ue})}break;case"F":var P=0;for(k=1;k<Ae.length;++k)switch(Ae[k].charAt(0)){case"X":A=parseInt(Ae[k].slice(1))-1,++P;break;case"Y":for(x=parseInt(Ae[k].slice(1))-1,J=O.length;J<=x;++J)O[J]=[];break;case"M":ie=parseInt(Ae[k].slice(1))/20;break;case"F":break;case"G":break;case"P":H=j[parseInt(Ae[k].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(q=Ae[k].slice(1).split(" "),J=parseInt(q[0],10);J<=parseInt(q[1],10);++J)ie=parseInt(q[2],10),G[J-1]=ie===0?{hidden:!0}:{wch:ie},Am(G[J-1]);break;case"C":A=parseInt(Ae[k].slice(1))-1,G[A]||(G[A]={});break;case"R":x=parseInt(Ae[k].slice(1))-1,I[x]||(I[x]={}),ie>0?(I[x].hpt=ie,I[x].hpx=bC(ie)):ie===0&&(I[x].hidden=!0);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+he)}P<1&&(H=null);break;default:if(T&&T.WTF)throw new Error("SYLK bad record "+he)}}return I.length>0&&(Y["!rows"]=I),G.length>0&&(Y["!cols"]=G),T&&T.sheetRows&&(O=O.slice(0,T.sheetRows)),[O,Y]}function c(_,T){var C=s(_,T),x=C[0],A=C[1],B=Ao(x,T);return kn(A).forEach(function(k){B[k]=A[k]}),B}function h(_,T){return fs(c(_,T),T)}function d(_,T,C,x){var A="C;Y"+(C+1)+";X"+(x+1)+";K";switch(_.t){case"n":A+=_.v||0,_.f&&!_.F&&(A+=";E"+bm(_.f,{r:C,c:x}));break;case"b":A+=_.v?"TRUE":"FALSE";break;case"e":A+=_.w||_.v;break;case"d":A+='"'+(_.w||_.v)+'"';break;case"s":A+='"'+_.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return A}function g(_,T){T.forEach(function(C,x){var A="F;W"+(x+1)+" "+(x+1)+" ";C.hidden?A+="0":(typeof C.width=="number"&&!C.wpx&&(C.wpx=wh(C.width)),typeof C.wpx=="number"&&!C.wch&&(C.wch=bh(C.wpx)),typeof C.wch=="number"&&(A+=Math.round(C.wch))),A.charAt(A.length-1)!=" "&&_.push(A)})}function p(_,T){T.forEach(function(C,x){var A="F;";C.hidden?A+="M0;":C.hpt?A+="M"+20*C.hpt+";":C.hpx&&(A+="M"+20*Ih(C.hpx)+";"),A.length>2&&_.push(A+"R"+(x+1))})}function v(_,T){var C=["ID;PWXL;N;E"],x=[],A=Ut(_["!ref"]),B,k=Array.isArray(_),O=`\r
`;C.push("P;PGeneral"),C.push("F;P0;DG0G8;M255"),_["!cols"]&&g(C,_["!cols"]),_["!rows"]&&p(C,_["!rows"]),C.push("B;Y"+(A.e.r-A.s.r+1)+";X"+(A.e.c-A.s.c+1)+";D"+[A.s.c,A.s.r,A.e.c,A.e.r].join(" "));for(var j=A.s.r;j<=A.e.r;++j)for(var H=A.s.c;H<=A.e.c;++H){var Y=St({r:j,c:H});B=k?(_[j]||[])[H]:_[Y],!(!B||B.v==null&&(!B.f||B.F))&&x.push(d(B,_,j,H))}return C.join(O)+O+x.join(O)+O+"E"+O}return{to_workbook:h,to_sheet:c,from_sheet:v}})(),S3=(function(){function n(l,c){switch(c.type){case"base64":return e(ja(l),c);case"binary":return e(l,c);case"buffer":return e(mt&&Buffer.isBuffer(l)?l.toString("binary"):oc(l),c);case"array":return e(ef(l),c)}throw new Error("Unrecognized type "+c.type)}function e(l,c){for(var h=l.split(`
`),d=-1,g=-1,p=0,v=[];p!==h.length;++p){if(h[p].trim()==="BOT"){v[++d]=[],g=0;continue}if(!(d<0)){var _=h[p].trim().split(","),T=_[0],C=_[1];++p;for(var x=h[p]||"";(x.match(/["]/g)||[]).length&1&&p<h.length-1;)x+=`
`+h[++p];switch(x=x.trim(),+T){case-1:if(x==="BOT"){v[++d]=[],g=0;continue}else if(x!=="EOD")throw new Error("Unrecognized DIF special command "+x);break;case 0:x==="TRUE"?v[d][g]=!0:x==="FALSE"?v[d][g]=!1:isNaN(Ua(C))?isNaN(tc(C).getDate())?v[d][g]=C:v[d][g]=Qn(C):v[d][g]=Ua(C),++g;break;case 1:x=x.slice(1,x.length-1),x=x.replace(/""/g,'"'),x&&x.match(/^=".*"$/)&&(x=x.slice(2,-1)),v[d][g++]=x!==""?x:null;break}if(x==="EOD")break}}return c&&c.sheetRows&&(v=v.slice(0,c.sheetRows)),v}function t(l,c){return Ao(n(l,c),c)}function a(l,c){return fs(t(l,c),c)}var s=(function(){var l=function(d,g,p,v,_){d.push(g),d.push(p+","+v),d.push('"'+_.replace(/"/g,'""')+'"')},c=function(d,g,p,v){d.push(g+","+p),d.push(g==1?'"'+v.replace(/"/g,'""')+'"':v)};return function(d){var g=[],p=Ut(d["!ref"]),v,_=Array.isArray(d);l(g,"TABLE",0,1,"sheetjs"),l(g,"VECTORS",0,p.e.r-p.s.r+1,""),l(g,"TUPLES",0,p.e.c-p.s.c+1,""),l(g,"DATA",0,0,"");for(var T=p.s.r;T<=p.e.r;++T){c(g,-1,0,"BOT");for(var C=p.s.c;C<=p.e.c;++C){var x=St({r:T,c:C});if(v=_?(d[T]||[])[C]:d[x],!v){c(g,1,0,"");continue}switch(v.t){case"n":var A=v.w;!A&&v.v!=null&&(A=v.v),A==null?v.f&&!v.F?c(g,1,0,"="+v.f):c(g,1,0,""):c(g,0,A,"V");break;case"b":c(g,0,v.v?1:0,v.v?"TRUE":"FALSE");break;case"s":c(g,1,0,isNaN(v.v)?v.v:'="'+v.v+'"');break;case"d":v.w||(v.w=wi(v.z||qt[14],sr(Qn(v.v)))),c(g,0,v.w,"V");break;default:c(g,1,0,"")}}}c(g,-1,0,"EOD");var B=`\r
`,k=g.join(B);return k}})();return{to_workbook:a,to_sheet:t,from_sheet:s}})(),CC=(function(){function n(v){return v.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function e(v){return v.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function t(v,_){for(var T=v.split(`
`),C=-1,x=-1,A=0,B=[];A!==T.length;++A){var k=T[A].trim().split(":");if(k[0]==="cell"){var O=pn(k[1]);if(B.length<=O.r)for(C=B.length;C<=O.r;++C)B[C]||(B[C]=[]);switch(C=O.r,x=O.c,k[2]){case"t":B[C][x]=n(k[3]);break;case"v":B[C][x]=+k[3];break;case"vtf":var j=k[k.length-1];case"vtc":switch(k[3]){case"nl":B[C][x]=!!+k[4];break;default:B[C][x]=+k[4];break}k[2]=="vtf"&&(B[C][x]=[B[C][x],j])}}}return _&&_.sheetRows&&(B=B.slice(0,_.sheetRows)),B}function a(v,_){return Ao(t(v,_),_)}function s(v,_){return fs(a(v,_),_)}var l=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),c=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,h=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),d="--SocialCalcSpreadsheetControlSave--";function g(v){if(!v||!v["!ref"])return"";for(var _=[],T=[],C,x="",A=Ar(v["!ref"]),B=Array.isArray(v),k=A.s.r;k<=A.e.r;++k)for(var O=A.s.c;O<=A.e.c;++O)if(x=St({r:k,c:O}),C=B?(v[k]||[])[O]:v[x],!(!C||C.v==null||C.t==="z")){switch(T=["cell",x,"t"],C.t){case"s":case"str":T.push(e(C.v));break;case"n":C.f?(T[2]="vtf",T[3]="n",T[4]=C.v,T[5]=e(C.f)):(T[2]="v",T[3]=C.v);break;case"b":T[2]="vt"+(C.f?"f":"c"),T[3]="nl",T[4]=C.v?"1":"0",T[5]=e(C.f||(C.v?"TRUE":"FALSE"));break;case"d":var j=sr(Qn(C.v));T[2]="vtc",T[3]="nd",T[4]=""+j,T[5]=C.w||wi(C.z||qt[14],j);break;case"e":continue}_.push(T.join(":"))}return _.push("sheet:c:"+(A.e.c-A.s.c+1)+":r:"+(A.e.r-A.s.r+1)+":tvf:1"),_.push("valueformat:1:text-wiki"),_.join(`
`)}function p(v){return[l,c,h,c,g(v),d].join(`
`)}return{to_workbook:s,to_sheet:a,from_sheet:p}})(),C3=(function(){function n(p,v,_,T,C){C.raw?v[_][T]=p:p===""||(p==="TRUE"?v[_][T]=!0:p==="FALSE"?v[_][T]=!1:isNaN(Ua(p))?isNaN(tc(p).getDate())?v[_][T]=p:v[_][T]=Qn(p):v[_][T]=Ua(p))}function e(p,v){var _=v||{},T=[];if(!p||p.length===0)return T;for(var C=p.split(/[\r\n]/),x=C.length-1;x>=0&&C[x].length===0;)--x;for(var A=10,B=0,k=0;k<=x;++k)B=C[k].indexOf(" "),B==-1?B=C[k].length:B++,A=Math.max(A,B);for(k=0;k<=x;++k){T[k]=[];var O=0;for(n(C[k].slice(0,A).trim(),T,k,O,_),O=1;O<=(C[k].length-A)/10+1;++O)n(C[k].slice(A+(O-1)*10,A+O*10).trim(),T,k,O,_)}return _.sheetRows&&(T=T.slice(0,_.sheetRows)),T}var t={44:",",9:"	",59:";",124:"|"},a={44:3,9:2,59:1,124:0};function s(p){for(var v={},_=!1,T=0,C=0;T<p.length;++T)(C=p.charCodeAt(T))==34?_=!_:!_&&C in t&&(v[C]=(v[C]||0)+1);C=[];for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&C.push([v[T],T]);if(!C.length){v=a;for(T in v)Object.prototype.hasOwnProperty.call(v,T)&&C.push([v[T],T])}return C.sort(function(x,A){return x[0]-A[0]||a[x[1]]-a[A[1]]}),t[C.pop()[1]]||44}function l(p,v){var _=v||{},T="",C=_.dense?[]:{},x={s:{c:0,r:0},e:{c:0,r:0}};p.slice(0,4)=="sep="?p.charCodeAt(5)==13&&p.charCodeAt(6)==10?(T=p.charAt(4),p=p.slice(7)):p.charCodeAt(5)==13||p.charCodeAt(5)==10?(T=p.charAt(4),p=p.slice(6)):T=s(p.slice(0,1024)):_&&_.FS?T=_.FS:T=s(p.slice(0,1024));var A=0,B=0,k=0,O=0,j=0,H=T.charCodeAt(0),Y=!1,I=0,G=p.charCodeAt(0);p=p.replace(/\r\n/mg,`
`);var q=_.dateNF!=null?B4(_.dateNF):null;function ie(){var J=p.slice(O,j),he={};if(J.charAt(0)=='"'&&J.charAt(J.length-1)=='"'&&(J=J.slice(1,-1).replace(/""/g,'"')),J.length===0)he.t="z";else if(_.raw)he.t="s",he.v=J;else if(J.trim().length===0)he.t="s",he.v=J;else if(J.charCodeAt(0)==61)J.charCodeAt(1)==34&&J.charCodeAt(J.length-1)==34?(he.t="s",he.v=J.slice(2,-1).replace(/""/g,'"')):xD(J)?(he.t="n",he.f=J.slice(1)):(he.t="s",he.v=J);else if(J=="TRUE")he.t="b",he.v=!0;else if(J=="FALSE")he.t="b",he.v=!1;else if(!isNaN(k=Ua(J)))he.t="n",_.cellText!==!1&&(he.w=J),he.v=k;else if(!isNaN(tc(J).getDate())||q&&J.match(q)){he.z=_.dateNF||qt[14];var Ae=0;q&&J.match(q)&&(J=H4(J,_.dateNF,J.match(q)||[]),Ae=1),_.cellDates?(he.t="d",he.v=Qn(J,Ae)):(he.t="n",he.v=sr(Qn(J,Ae))),_.cellText!==!1&&(he.w=wi(he.z,he.v instanceof Date?sr(he.v):he.v)),_.cellNF||delete he.z}else he.t="s",he.v=J;if(he.t=="z"||(_.dense?(C[A]||(C[A]=[]),C[A][B]=he):C[St({c:B,r:A})]=he),O=j+1,G=p.charCodeAt(O),x.e.c<B&&(x.e.c=B),x.e.r<A&&(x.e.r=A),I==H)++B;else if(B=0,++A,_.sheetRows&&_.sheetRows<=A)return!0}e:for(;j<p.length;++j)switch(I=p.charCodeAt(j)){case 34:G===34&&(Y=!Y);break;case H:case 10:case 13:if(!Y&&ie())break e;break}return j-O>0&&ie(),C["!ref"]=en(x),C}function c(p,v){return!(v&&v.PRN)||v.FS||p.slice(0,4)=="sep="||p.indexOf("	")>=0||p.indexOf(",")>=0||p.indexOf(";")>=0?l(p,v):Ao(e(p,v),v)}function h(p,v){var _="",T=v.type=="string"?[0,0,0,0]:PL(p,v);switch(v.type){case"base64":_=ja(p);break;case"binary":_=p;break;case"buffer":v.codepage==65001?_=p.toString("utf8"):v.codepage&&typeof vh<"u"||(_=mt&&Buffer.isBuffer(p)?p.toString("binary"):oc(p));break;case"array":_=ef(p);break;case"string":_=p;break;default:throw new Error("Unrecognized type "+v.type)}return T[0]==239&&T[1]==187&&T[2]==191?_=zl(_.slice(3)):v.type!="string"&&v.type!="buffer"&&v.codepage==65001?_=zl(_):v.type=="binary"&&typeof vh<"u",_.slice(0,19)=="socialcalc:version:"?CC.to_sheet(v.type=="string"?_:zl(_),v):c(_,v)}function d(p,v){return fs(h(p,v),v)}function g(p){for(var v=[],_=Ut(p["!ref"]),T,C=Array.isArray(p),x=_.s.r;x<=_.e.r;++x){for(var A=[],B=_.s.c;B<=_.e.c;++B){var k=St({r:x,c:B});if(T=C?(p[x]||[])[B]:p[k],!T||T.v==null){A.push("          ");continue}for(var O=(T.w||(za(T),T.w)||"").slice(0,10);O.length<10;)O+=" ";A.push(O+(B===0?" ":""))}v.push(A.join(""))}return v.join(`
`)}return{to_workbook:d,to_sheet:h,from_sheet:g}})(),VT=(function(){function n(b,L,P){if(b){Tr(b,b.l||0);for(var K=P.Enum||U;b.l<b.length;){var Z=b.read_shift(2),be=K[Z]||K[65535],Ce=b.read_shift(2),Pe=b.l+Ce,De=be.f&&be.f(b,Ce,P);if(b.l=Pe,L(De,be,Z))return}}}function e(b,L){switch(L.type){case"base64":return t(Wr(ja(b)),L);case"binary":return t(Wr(b),L);case"buffer":case"array":return t(b,L)}throw"Unsupported type "+L.type}function t(b,L){if(!b)return b;var P=L||{},K=P.dense?[]:{},Z="Sheet1",be="",Ce=0,Pe={},De=[],lt=[],et={s:{r:0,c:0},e:{r:0,c:0}},zt=P.sheetRows||0;if(b[2]==0&&(b[3]==8||b[3]==9)&&b.length>=16&&b[14]==5&&b[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(b[2]==2)P.Enum=U,n(b,function(Fe,On,jn){switch(jn){case 0:P.vers=Fe,Fe>=4096&&(P.qpro=!0);break;case 6:et=Fe;break;case 204:Fe&&(be=Fe);break;case 222:be=Fe;break;case 15:case 51:P.qpro||(Fe[1].v=Fe[1].v.slice(1));case 13:case 14:case 16:jn==14&&(Fe[2]&112)==112&&(Fe[2]&15)>1&&(Fe[2]&15)<15&&(Fe[1].z=P.dateNF||qt[14],P.cellDates&&(Fe[1].t="d",Fe[1].v=HS(Fe[1].v))),P.qpro&&Fe[3]>Ce&&(K["!ref"]=en(et),Pe[Z]=K,De.push(Z),K=P.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Fe[3],Z=be||"Sheet"+(Ce+1),be="");var wr=P.dense?(K[Fe[0].r]||[])[Fe[0].c]:K[St(Fe[0])];if(wr){wr.t=Fe[1].t,wr.v=Fe[1].v,Fe[1].z!=null&&(wr.z=Fe[1].z),Fe[1].f!=null&&(wr.f=Fe[1].f);break}P.dense?(K[Fe[0].r]||(K[Fe[0].r]=[]),K[Fe[0].r][Fe[0].c]=Fe[1]):K[St(Fe[0])]=Fe[1];break}},P);else if(b[2]==26||b[2]==14)P.Enum=ue,b[2]==14&&(P.qpro=!0,b.l=0),n(b,function(Fe,On,jn){switch(jn){case 204:Z=Fe;break;case 22:Fe[1].v=Fe[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Fe[3]>Ce&&(K["!ref"]=en(et),Pe[Z]=K,De.push(Z),K=P.dense?[]:{},et={s:{r:0,c:0},e:{r:0,c:0}},Ce=Fe[3],Z="Sheet"+(Ce+1)),zt>0&&Fe[0].r>=zt)break;P.dense?(K[Fe[0].r]||(K[Fe[0].r]=[]),K[Fe[0].r][Fe[0].c]=Fe[1]):K[St(Fe[0])]=Fe[1],et.e.c<Fe[0].c&&(et.e.c=Fe[0].c),et.e.r<Fe[0].r&&(et.e.r=Fe[0].r);break;case 27:Fe[14e3]&&(lt[Fe[14e3][0]]=Fe[14e3][1]);break;case 1537:lt[Fe[0]]=Fe[1],Fe[0]==Ce&&(Z=Fe[1]);break}},P);else throw new Error("Unrecognized LOTUS BOF "+b[2]);if(K["!ref"]=en(et),Pe[be||Z]=K,De.push(be||Z),!lt.length)return{SheetNames:De,Sheets:Pe};for(var ct={},Hn=[],Ot=0;Ot<lt.length;++Ot)Pe[De[Ot]]?(Hn.push(lt[Ot]||De[Ot]),ct[lt[Ot]]=Pe[lt[Ot]]||Pe[De[Ot]]):(Hn.push(lt[Ot]),ct[lt[Ot]]={"!ref":"A1"});return{SheetNames:Hn,Sheets:ct}}function a(b,L){var P=L||{};if(+P.codepage>=0&&Zl(+P.codepage),P.type=="string")throw new Error("Cannot write WK1 to JS string");var K=ar(),Z=Ut(b["!ref"]),be=Array.isArray(b),Ce=[];Oe(K,0,l(1030)),Oe(K,6,d(Z));for(var Pe=Math.min(Z.e.r,8191),De=Z.s.r;De<=Pe;++De)for(var lt=Nn(De),et=Z.s.c;et<=Z.e.c;++et){De===Z.s.r&&(Ce[et]=Un(et));var zt=Ce[et]+lt,ct=be?(b[De]||[])[et]:b[zt];if(!(!ct||ct.t=="z"))if(ct.t=="n")(ct.v|0)==ct.v&&ct.v>=-32768&&ct.v<=32767?Oe(K,13,T(De,et,ct.v)):Oe(K,14,x(De,et,ct.v));else{var Hn=za(ct);Oe(K,15,v(De,et,Hn.slice(0,239)))}}return Oe(K,1),K.end()}function s(b,L){var P=L||{};if(+P.codepage>=0&&Zl(+P.codepage),P.type=="string")throw new Error("Cannot write WK3 to JS string");var K=ar();Oe(K,0,c(b));for(var Z=0,be=0;Z<b.SheetNames.length;++Z)(b.Sheets[b.SheetNames[Z]]||{})["!ref"]&&Oe(K,27,Te(b.SheetNames[Z],be++));var Ce=0;for(Z=0;Z<b.SheetNames.length;++Z){var Pe=b.Sheets[b.SheetNames[Z]];if(!(!Pe||!Pe["!ref"])){for(var De=Ut(Pe["!ref"]),lt=Array.isArray(Pe),et=[],zt=Math.min(De.e.r,8191),ct=De.s.r;ct<=zt;++ct)for(var Hn=Nn(ct),Ot=De.s.c;Ot<=De.e.c;++Ot){ct===De.s.r&&(et[Ot]=Un(Ot));var Fe=et[Ot]+Hn,On=lt?(Pe[ct]||[])[Ot]:Pe[Fe];if(!(!On||On.t=="z"))if(On.t=="n")Oe(K,23,ie(ct,Ot,Ce,On.v));else{var jn=za(On);Oe(K,22,I(ct,Ot,Ce,jn.slice(0,239)))}}++Ce}}return Oe(K,1),K.end()}function l(b){var L=ge(2);return L.write_shift(2,b),L}function c(b){var L=ge(26);L.write_shift(2,4096),L.write_shift(2,4),L.write_shift(4,0);for(var P=0,K=0,Z=0,be=0;be<b.SheetNames.length;++be){var Ce=b.SheetNames[be],Pe=b.Sheets[Ce];if(!(!Pe||!Pe["!ref"])){++Z;var De=Ar(Pe["!ref"]);P<De.e.r&&(P=De.e.r),K<De.e.c&&(K=De.e.c)}}return P>8191&&(P=8191),L.write_shift(2,P),L.write_shift(1,Z),L.write_shift(1,K),L.write_shift(2,0),L.write_shift(2,0),L.write_shift(1,1),L.write_shift(1,2),L.write_shift(4,0),L.write_shift(4,0),L}function h(b,L,P){var K={s:{c:0,r:0},e:{c:0,r:0}};return L==8&&P.qpro?(K.s.c=b.read_shift(1),b.l++,K.s.r=b.read_shift(2),K.e.c=b.read_shift(1),b.l++,K.e.r=b.read_shift(2),K):(K.s.c=b.read_shift(2),K.s.r=b.read_shift(2),L==12&&P.qpro&&(b.l+=2),K.e.c=b.read_shift(2),K.e.r=b.read_shift(2),L==12&&P.qpro&&(b.l+=2),K.s.c==65535&&(K.s.c=K.e.c=K.s.r=K.e.r=0),K)}function d(b){var L=ge(8);return L.write_shift(2,b.s.c),L.write_shift(2,b.s.r),L.write_shift(2,b.e.c),L.write_shift(2,b.e.r),L}function g(b,L,P){var K=[{c:0,r:0},{t:"n",v:0},0,0];return P.qpro&&P.vers!=20768?(K[0].c=b.read_shift(1),K[3]=b.read_shift(1),K[0].r=b.read_shift(2),b.l+=2):(K[2]=b.read_shift(1),K[0].c=b.read_shift(2),K[0].r=b.read_shift(2)),K}function p(b,L,P){var K=b.l+L,Z=g(b,L,P);if(Z[1].t="s",P.vers==20768){b.l++;var be=b.read_shift(1);return Z[1].v=b.read_shift(be,"utf8"),Z}return P.qpro&&b.l++,Z[1].v=b.read_shift(K-b.l,"cstr"),Z}function v(b,L,P){var K=ge(7+P.length);K.write_shift(1,255),K.write_shift(2,L),K.write_shift(2,b),K.write_shift(1,39);for(var Z=0;Z<K.length;++Z){var be=P.charCodeAt(Z);K.write_shift(1,be>=128?95:be)}return K.write_shift(1,0),K}function _(b,L,P){var K=g(b,L,P);return K[1].v=b.read_shift(2,"i"),K}function T(b,L,P){var K=ge(7);return K.write_shift(1,255),K.write_shift(2,L),K.write_shift(2,b),K.write_shift(2,P,"i"),K}function C(b,L,P){var K=g(b,L,P);return K[1].v=b.read_shift(8,"f"),K}function x(b,L,P){var K=ge(13);return K.write_shift(1,255),K.write_shift(2,L),K.write_shift(2,b),K.write_shift(8,P,"f"),K}function A(b,L,P){var K=b.l+L,Z=g(b,L,P);if(Z[1].v=b.read_shift(8,"f"),P.qpro)b.l=K;else{var be=b.read_shift(2);j(b.slice(b.l,b.l+be),Z),b.l+=be}return Z}function B(b,L,P){var K=L&32768;return L&=-32769,L=(K?b:0)+(L>=8192?L-16384:L),(K?"":"$")+(P?Un(L):Nn(L))}var k={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},O=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function j(b,L){Tr(b,0);for(var P=[],K=0,Z="",be="",Ce="",Pe="";b.l<b.length;){var De=b[b.l++];switch(De){case 0:P.push(b.read_shift(8,"f"));break;case 1:be=B(L[0].c,b.read_shift(2),!0),Z=B(L[0].r,b.read_shift(2),!1),P.push(be+Z);break;case 2:{var lt=B(L[0].c,b.read_shift(2),!0),et=B(L[0].r,b.read_shift(2),!1);be=B(L[0].c,b.read_shift(2),!0),Z=B(L[0].r,b.read_shift(2),!1),P.push(lt+et+":"+be+Z)}break;case 3:if(b.l<b.length){console.error("WK1 premature formula end");return}break;case 4:P.push("("+P.pop()+")");break;case 5:P.push(b.read_shift(2));break;case 6:{for(var zt="";De=b[b.l++];)zt+=String.fromCharCode(De);P.push('"'+zt.replace(/"/g,'""')+'"')}break;case 8:P.push("-"+P.pop());break;case 23:P.push("+"+P.pop());break;case 22:P.push("NOT("+P.pop()+")");break;case 20:case 21:Pe=P.pop(),Ce=P.pop(),P.push(["AND","OR"][De-20]+"("+Ce+","+Pe+")");break;default:if(De<32&&O[De])Pe=P.pop(),Ce=P.pop(),P.push(Ce+O[De]+Pe);else if(k[De]){if(K=k[De][1],K==69&&(K=b[b.l++]),K>P.length){console.error("WK1 bad formula parse 0x"+De.toString(16)+":|"+P.join("|")+"|");return}var ct=P.slice(-K);P.length-=K,P.push(k[De][0]+"("+ct.join(",")+")")}else return De<=7?console.error("WK1 invalid opcode "+De.toString(16)):De<=24?console.error("WK1 unsupported op "+De.toString(16)):De<=30?console.error("WK1 invalid opcode "+De.toString(16)):De<=115?console.error("WK1 unsupported function opcode "+De.toString(16)):console.error("WK1 unrecognized opcode "+De.toString(16))}}P.length==1?L[1].f=""+P[0]:console.error("WK1 bad formula parse |"+P.join("|")+"|")}function H(b){var L=[{c:0,r:0},{t:"n",v:0},0];return L[0].r=b.read_shift(2),L[3]=b[b.l++],L[0].c=b[b.l++],L}function Y(b,L){var P=H(b);return P[1].t="s",P[1].v=b.read_shift(L-4,"cstr"),P}function I(b,L,P,K){var Z=ge(6+K.length);Z.write_shift(2,b),Z.write_shift(1,P),Z.write_shift(1,L),Z.write_shift(1,39);for(var be=0;be<K.length;++be){var Ce=K.charCodeAt(be);Z.write_shift(1,Ce>=128?95:Ce)}return Z.write_shift(1,0),Z}function G(b,L){var P=H(b);P[1].v=b.read_shift(2);var K=P[1].v>>1;if(P[1].v&1)switch(K&7){case 0:K=(K>>3)*5e3;break;case 1:K=(K>>3)*500;break;case 2:K=(K>>3)/20;break;case 3:K=(K>>3)/200;break;case 4:K=(K>>3)/2e3;break;case 5:K=(K>>3)/2e4;break;case 6:K=(K>>3)/16;break;case 7:K=(K>>3)/64;break}return P[1].v=K,P}function q(b,L){var P=H(b),K=b.read_shift(4),Z=b.read_shift(4),be=b.read_shift(2);if(be==65535)return K===0&&Z===3221225472?(P[1].t="e",P[1].v=15):K===0&&Z===3489660928?(P[1].t="e",P[1].v=42):P[1].v=0,P;var Ce=be&32768;return be=(be&32767)-16446,P[1].v=(1-Ce*2)*(Z*Math.pow(2,be+32)+K*Math.pow(2,be)),P}function ie(b,L,P,K){var Z=ge(14);if(Z.write_shift(2,b),Z.write_shift(1,P),Z.write_shift(1,L),K==0)return Z.write_shift(4,0),Z.write_shift(4,0),Z.write_shift(2,65535),Z;var be=0,Ce=0,Pe=0,De=0;return K<0&&(be=1,K=-K),Ce=Math.log2(K)|0,K/=Math.pow(2,Ce-31),De=K>>>0,(De&2147483648)==0&&(K/=2,++Ce,De=K>>>0),K-=De,De|=2147483648,De>>>=0,K*=Math.pow(2,32),Pe=K>>>0,Z.write_shift(4,Pe),Z.write_shift(4,De),Ce+=16383+(be?32768:0),Z.write_shift(2,Ce),Z}function J(b,L){var P=q(b);return b.l+=L-14,P}function he(b,L){var P=H(b),K=b.read_shift(4);return P[1].v=K>>6,P}function Ae(b,L){var P=H(b),K=b.read_shift(8,"f");return P[1].v=K,P}function je(b,L){var P=Ae(b);return b.l+=L-10,P}function ke(b,L){return b[b.l+L-1]==0?b.read_shift(L,"cstr"):""}function re(b,L){var P=b[b.l++];P>L-1&&(P=L-1);for(var K="";K.length<P;)K+=String.fromCharCode(b[b.l++]);return K}function xe(b,L,P){if(!(!P.qpro||L<21)){var K=b.read_shift(1);b.l+=17,b.l+=1,b.l+=2;var Z=b.read_shift(L-21,"cstr");return[K,Z]}}function fe(b,L){for(var P={},K=b.l+L;b.l<K;){var Z=b.read_shift(2);if(Z==14e3){for(P[Z]=[0,""],P[Z][0]=b.read_shift(2);b[b.l];)P[Z][1]+=String.fromCharCode(b[b.l]),b.l++;b.l++}}return P}function Te(b,L){var P=ge(5+b.length);P.write_shift(2,14e3),P.write_shift(2,L);for(var K=0;K<b.length;++K){var Z=b.charCodeAt(K);P[P.l++]=Z>127?95:Z}return P[P.l++]=0,P}var U={0:{n:"BOF",f:yC},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:h},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:_},14:{n:"NUMBER",f:C},15:{n:"LABEL",f:p},16:{n:"FORMULA",f:A},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:p},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:ke},222:{n:"SHEETNAMELP",f:re},65535:{n:""}},ue={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:Y},23:{n:"NUMBER17",f:q},24:{n:"NUMBER18",f:G},25:{n:"FORMULA19",f:J},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:fe},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:he},38:{n:"??"},39:{n:"NUMBER27",f:Ae},40:{n:"FORMULA28",f:je},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:ke},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:xe},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:a,book_to_wk3:s,to_workbook:e}})(),E3=/^\s|\s$|[\t\n\r]/;function EC(n,e){if(!e.bookSST)return"";var t=[tn];t[t.length]=Ne("sst",null,{xmlns:Eo[0],count:n.Count,uniqueCount:n.Unique});for(var a=0;a!=n.length;++a)if(n[a]!=null){var s=n[a],l="<si>";s.r?l+=s.r:(l+="<t",s.t||(s.t=""),s.t.match(E3)&&(l+=' xml:space="preserve"'),l+=">"+xt(s.t)+"</t>"),l+="</si>",t[t.length]=l}return t.length>2&&(t[t.length]="</sst>",t[1]=t[1].replace("/>",">")),t.join("")}function A3(n){return[n.read_shift(4),n.read_shift(4)]}function w3(n,e){return e||(e=ge(8)),e.write_shift(4,n.Count),e.write_shift(4,n.Unique),e}var b3=vM;function I3(n){var e=ar();Se(e,159,w3(n));for(var t=0;t<n.length;++t)Se(e,19,b3(n[t]));return Se(e,160),e.end()}function R3(n){for(var e=[],t=n.split(""),a=0;a<t.length;++a)e[a]=t[a].charCodeAt(0);return e}function AC(n){var e=0,t,a=R3(n),s=a.length+1,l,c,h,d,g;for(t=ls(s),t[0]=a.length,l=1;l!=s;++l)t[l]=a[l-1];for(l=s-1;l>=0;--l)c=t[l],h=(e&16384)===0?0:1,d=e<<1&32767,g=h|d,e=g^c;return e^52811}var N3=(function(){function n(s,l){switch(l.type){case"base64":return e(ja(s),l);case"binary":return e(s,l);case"buffer":return e(mt&&Buffer.isBuffer(s)?s.toString("binary"):oc(s),l);case"array":return e(ef(s),l)}throw new Error("Unrecognized type "+l.type)}function e(s,l){var c=l||{},h=c.dense?[]:{},d=s.match(/\\trowd.*?\\row\b/g);if(!d.length)throw new Error("RTF missing table");var g={s:{c:0,r:0},e:{c:0,r:d.length-1}};return d.forEach(function(p,v){Array.isArray(h)&&(h[v]=[]);for(var _=/\\\w+\b/g,T=0,C,x=-1;C=_.exec(p);){switch(C[0]){case"\\cell":var A=p.slice(T,_.lastIndex-C[0].length);if(A[0]==" "&&(A=A.slice(1)),++x,A.length){var B={v:A,t:"s"};Array.isArray(h)?h[v][x]=B:h[St({r:v,c:x})]=B}break}T=_.lastIndex}x>g.e.c&&(g.e.c=x)}),h["!ref"]=en(g),h}function t(s,l){return fs(n(s,l),l)}function a(s){for(var l=["{\\rtf1\\ansi"],c=Ut(s["!ref"]),h,d=Array.isArray(s),g=c.s.r;g<=c.e.r;++g){l.push("\\trowd\\trautofit1");for(var p=c.s.c;p<=c.e.c;++p)l.push("\\cellx"+(p+1));for(l.push("\\pard\\intbl"),p=c.s.c;p<=c.e.c;++p){var v=St({r:g,c:p});h=d?(s[g]||[])[p]:s[v],!(!h||h.v==null&&(!h.f||h.F))&&(l.push(" "+(h.w||(za(h),h.w))),l.push("\\cell"))}l.push("\\pard\\intbl\\row")}return l.join("")+"}"}return{to_workbook:t,to_sheet:n,from_sheet:a}})();function qT(n){for(var e=0,t=1;e!=3;++e)t=t*256+(n[e]>255?255:n[e]<0?0:n[e]);return t.toString(16).toUpperCase().slice(1)}var k3=6,Ba=k3;function wh(n){return Math.floor((n+Math.round(128/Ba)/256)*Ba)}function bh(n){return Math.floor((n-5)/Ba*100+.5)/100}function Z0(n){return Math.round((n*Ba+5)/Ba*256)/256}function Am(n){n.width?(n.wpx=wh(n.width),n.wch=bh(n.wpx),n.MDW=Ba):n.wpx?(n.wch=bh(n.wpx),n.width=Z0(n.wch),n.MDW=Ba):typeof n.wch=="number"&&(n.width=Z0(n.wch),n.wpx=wh(n.width),n.MDW=Ba),n.customWidth&&delete n.customWidth}var O3=96,wC=O3;function Ih(n){return n*96/wC}function bC(n){return n*wC/96}function M3(n){var e=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(t){for(var a=t[0];a<=t[1];++a)n[a]!=null&&(e[e.length]=Ne("numFmt",null,{numFmtId:a,formatCode:xt(n[a])}))}),e.length===1?"":(e[e.length]="</numFmts>",e[0]=Ne("numFmts",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function D3(n){var e=[];return e[e.length]=Ne("cellXfs",null),n.forEach(function(t){e[e.length]=Ne("xf",null,t)}),e[e.length]="</cellXfs>",e.length===2?"":(e[0]=Ne("cellXfs",null,{count:e.length-2}).replace("/>",">"),e.join(""))}function IC(n,e){var t=[tn,Ne("styleSheet",null,{xmlns:Eo[0],"xmlns:vt":mn.vt})],a;return n.SSF&&(a=M3(n.SSF))!=null&&(t[t.length]=a),t[t.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',t[t.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',t[t.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',t[t.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(a=D3(e.cellXfs))&&(t[t.length]=a),t[t.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',t[t.length]='<dxfs count="0"/>',t[t.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',t.length>2&&(t[t.length]="</styleSheet>",t[1]=t[1].replace("/>",">")),t.join("")}function P3(n,e){var t=n.read_shift(2),a=Bn(n);return[t,a]}function F3(n,e,t){t||(t=ge(6+4*e.length)),t.write_shift(2,n),vn(e,t);var a=t.length>t.l?t.slice(0,t.l):t;return t.l==null&&(t.l=t.length),a}function L3(n,e,t){var a={};a.sz=n.read_shift(2)/20;var s=EM(n);s.fItalic&&(a.italic=1),s.fCondense&&(a.condense=1),s.fExtend&&(a.extend=1),s.fShadow&&(a.shadow=1),s.fOutline&&(a.outline=1),s.fStrikeout&&(a.strike=1);var l=n.read_shift(2);switch(l===700&&(a.bold=1),n.read_shift(2)){case 1:a.vertAlign="superscript";break;case 2:a.vertAlign="subscript";break}var c=n.read_shift(1);c!=0&&(a.underline=c);var h=n.read_shift(1);h>0&&(a.family=h);var d=n.read_shift(1);switch(d>0&&(a.charset=d),n.l++,a.color=CM(n),n.read_shift(1)){case 1:a.scheme="major";break;case 2:a.scheme="minor";break}return a.name=Bn(n),a}function U3(n,e){e||(e=ge(153)),e.write_shift(2,n.sz*20),AM(n,e),e.write_shift(2,n.bold?700:400);var t=0;n.vertAlign=="superscript"?t=1:n.vertAlign=="subscript"&&(t=2),e.write_shift(2,t),e.write_shift(1,n.underline||0),e.write_shift(1,n.family||0),e.write_shift(1,n.charset||0),e.write_shift(1,0),Eh(n.color,e);var a=0;return a=2,e.write_shift(1,a),vn(n.name,e),e.length>e.l?e.slice(0,e.l):e}var B3=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],I0,H3=ya;function YT(n,e){e||(e=ge(84)),I0||(I0=dm(B3));var t=I0[n.patternType];t==null&&(t=40),e.write_shift(4,t);var a=0;if(t!=40)for(Eh({auto:1},e),Eh({auto:1},e);a<12;++a)e.write_shift(4,0);else{for(;a<4;++a)e.write_shift(4,0);for(;a<12;++a)e.write_shift(4,0)}return e.length>e.l?e.slice(0,e.l):e}function j3(n,e){var t=n.l+e,a=n.read_shift(2),s=n.read_shift(2);return n.l=t,{ixfe:a,numFmtId:s}}function RC(n,e,t){t||(t=ge(16)),t.write_shift(2,e||0),t.write_shift(2,n.numFmtId||0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);var a=0;return t.write_shift(1,a),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(1,0),t}function Rl(n,e){return e||(e=ge(10)),e.write_shift(1,0),e.write_shift(1,0),e.write_shift(4,0),e.write_shift(4,0),e}var z3=ya;function G3(n,e){return e||(e=ge(51)),e.write_shift(1,0),Rl(null,e),Rl(null,e),Rl(null,e),Rl(null,e),Rl(null,e),e.length>e.l?e.slice(0,e.l):e}function $3(n,e){return e||(e=ge(52)),e.write_shift(4,n.xfId),e.write_shift(2,1),e.write_shift(1,0),e.write_shift(1,0),Ch(n.name||"",e),e.length>e.l?e.slice(0,e.l):e}function K3(n,e,t){var a=ge(2052);return a.write_shift(4,n),Ch(e,a),Ch(t,a),a.length>a.l?a.slice(0,a.l):a}function V3(n,e){if(e){var t=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&++t}),t!=0&&(Se(n,615,ea(t)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&Se(n,44,F3(s,e[s]))}),Se(n,616))}}function q3(n){var e=1;Se(n,611,ea(e)),Se(n,43,U3({sz:12,color:{theme:1},name:"Calibri",family:2})),Se(n,612)}function Y3(n){var e=2;Se(n,603,ea(e)),Se(n,45,YT({patternType:"none"})),Se(n,45,YT({patternType:"gray125"})),Se(n,604)}function X3(n){var e=1;Se(n,613,ea(e)),Se(n,46,G3()),Se(n,614)}function W3(n){var e=1;Se(n,626,ea(e)),Se(n,47,RC({numFmtId:0},65535)),Se(n,627)}function Q3(n,e){Se(n,617,ea(e.length)),e.forEach(function(t){Se(n,47,RC(t,0))}),Se(n,618)}function J3(n){var e=1;Se(n,619,ea(e)),Se(n,48,$3({xfId:0,name:"Normal"})),Se(n,620)}function Z3(n){var e=0;Se(n,505,ea(e)),Se(n,506)}function eD(n){var e=0;Se(n,508,K3(e,"TableStyleMedium9","PivotStyleMedium4")),Se(n,509)}function tD(n,e){var t=ar();return Se(t,278),V3(t,n.SSF),q3(t),Y3(t),X3(t),W3(t),Q3(t,e.cellXfs),J3(t),Z3(t),eD(t),Se(t,279),t.end()}function NC(n,e){if(e&&e.themeXLSX)return e.themeXLSX;if(n&&typeof n.raw=="string")return n.raw;var t=[tn];return t[t.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',t[t.length]="<a:themeElements>",t[t.length]='<a:clrScheme name="Office">',t[t.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',t[t.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',t[t.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',t[t.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',t[t.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',t[t.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',t[t.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',t[t.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',t[t.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',t[t.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',t[t.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',t[t.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',t[t.length]="</a:clrScheme>",t[t.length]='<a:fontScheme name="Office">',t[t.length]="<a:majorFont>",t[t.length]='<a:latin typeface="Cambria"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Times New Roman"/>',t[t.length]='<a:font script="Hebr" typeface="Times New Roman"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="MoolBoran"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Times New Roman"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:majorFont>",t[t.length]="<a:minorFont>",t[t.length]='<a:latin typeface="Calibri"/>',t[t.length]='<a:ea typeface=""/>',t[t.length]='<a:cs typeface=""/>',t[t.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',t[t.length]='<a:font script="Hang" typeface="맑은 고딕"/>',t[t.length]='<a:font script="Hans" typeface="宋体"/>',t[t.length]='<a:font script="Hant" typeface="新細明體"/>',t[t.length]='<a:font script="Arab" typeface="Arial"/>',t[t.length]='<a:font script="Hebr" typeface="Arial"/>',t[t.length]='<a:font script="Thai" typeface="Tahoma"/>',t[t.length]='<a:font script="Ethi" typeface="Nyala"/>',t[t.length]='<a:font script="Beng" typeface="Vrinda"/>',t[t.length]='<a:font script="Gujr" typeface="Shruti"/>',t[t.length]='<a:font script="Khmr" typeface="DaunPenh"/>',t[t.length]='<a:font script="Knda" typeface="Tunga"/>',t[t.length]='<a:font script="Guru" typeface="Raavi"/>',t[t.length]='<a:font script="Cans" typeface="Euphemia"/>',t[t.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',t[t.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',t[t.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',t[t.length]='<a:font script="Thaa" typeface="MV Boli"/>',t[t.length]='<a:font script="Deva" typeface="Mangal"/>',t[t.length]='<a:font script="Telu" typeface="Gautami"/>',t[t.length]='<a:font script="Taml" typeface="Latha"/>',t[t.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',t[t.length]='<a:font script="Orya" typeface="Kalinga"/>',t[t.length]='<a:font script="Mlym" typeface="Kartika"/>',t[t.length]='<a:font script="Laoo" typeface="DokChampa"/>',t[t.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',t[t.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',t[t.length]='<a:font script="Viet" typeface="Arial"/>',t[t.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',t[t.length]='<a:font script="Geor" typeface="Sylfaen"/>',t[t.length]="</a:minorFont>",t[t.length]="</a:fontScheme>",t[t.length]='<a:fmtScheme name="Office">',t[t.length]="<a:fillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="1"/>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:lin ang="16200000" scaled="0"/>',t[t.length]="</a:gradFill>",t[t.length]="</a:fillStyleLst>",t[t.length]="<a:lnStyleLst>",t[t.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',t[t.length]="</a:lnStyleLst>",t[t.length]="<a:effectStyleLst>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]="</a:effectStyle>",t[t.length]="<a:effectStyle>",t[t.length]="<a:effectLst>",t[t.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',t[t.length]="</a:effectLst>",t[t.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',t[t.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',t[t.length]="</a:effectStyle>",t[t.length]="</a:effectStyleLst>",t[t.length]="<a:bgFillStyleLst>",t[t.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]='<a:gradFill rotWithShape="1">',t[t.length]="<a:gsLst>",t[t.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',t[t.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',t[t.length]="</a:gsLst>",t[t.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',t[t.length]="</a:gradFill>",t[t.length]="</a:bgFillStyleLst>",t[t.length]="</a:fmtScheme>",t[t.length]="</a:themeElements>",t[t.length]="<a:objectDefaults>",t[t.length]="<a:spDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',t[t.length]="</a:spDef>",t[t.length]="<a:lnDef>",t[t.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',t[t.length]="</a:lnDef>",t[t.length]="</a:objectDefaults>",t[t.length]="<a:extraClrSchemeLst/>",t[t.length]="</a:theme>",t.join("")}function nD(n,e){return{flags:n.read_shift(4),version:n.read_shift(4),name:Bn(n)}}function rD(n){var e=ge(12+2*n.name.length);return e.write_shift(4,n.flags),e.write_shift(4,n.version),vn(n.name,e),e.slice(0,e.l)}function aD(n){for(var e=[],t=n.read_shift(4);t-- >0;)e.push([n.read_shift(4),n.read_shift(4)]);return e}function iD(n){var e=ge(4+8*n.length);e.write_shift(4,n.length);for(var t=0;t<n.length;++t)e.write_shift(4,n[t][0]),e.write_shift(4,n[t][1]);return e}function sD(n,e){var t=ge(8+2*e.length);return t.write_shift(4,n),vn(e,t),t.slice(0,t.l)}function oD(n){return n.l+=4,n.read_shift(4)!=0}function lD(n,e){var t=ge(8);return t.write_shift(4,n),t.write_shift(4,1),t}function cD(){var n=ar();return Se(n,332),Se(n,334,ea(1)),Se(n,335,rD({name:"XLDAPR",version:12e4,flags:3496657072})),Se(n,336),Se(n,339,sD(1,"XLDAPR")),Se(n,52),Se(n,35,ea(514)),Se(n,4096,ea(0)),Se(n,4097,Ur(1)),Se(n,36),Se(n,53),Se(n,340),Se(n,337,lD(1)),Se(n,51,iD([[1,0]])),Se(n,338),Se(n,333),n.end()}function kC(){var n=[tn];return n.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),n.join("")}function uD(n){var e={};e.i=n.read_shift(4);var t={};t.r=n.read_shift(4),t.c=n.read_shift(4),e.r=St(t);var a=n.read_shift(1);return a&2&&(e.l="1"),a&8&&(e.a="1"),e}var so=1024;function OC(n,e){for(var t=[21600,21600],a=["m0,0l0",t[1],t[0],t[1],t[0],"0xe"].join(","),s=[Ne("xml",null,{"xmlns:v":xr.v,"xmlns:o":xr.o,"xmlns:x":xr.x,"xmlns:mv":xr.mv}).replace(/\/>/,">"),Ne("o:shapelayout",Ne("o:idmap",null,{"v:ext":"edit",data:n}),{"v:ext":"edit"}),Ne("v:shapetype",[Ne("v:stroke",null,{joinstyle:"miter"}),Ne("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:t.join(","),path:a})];so<n*1e3;)so+=1e3;return e.forEach(function(l){var c=pn(l[0]),h={color2:"#BEFF82",type:"gradient"};h.type=="gradient"&&(h.angle="-180");var d=h.type=="gradient"?Ne("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,g=Ne("v:fill",d,h),p={on:"t",obscured:"t"};++so,s=s.concat(["<v:shape"+rc({id:"_x0000_s"+so,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(l[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",g,Ne("v:shadow",null,p),Ne("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Rn("x:Anchor",[c.c+1,0,c.r+1,0,c.c+3,20,c.r+5,20].join(",")),Rn("x:AutoFill","False"),Rn("x:Row",String(c.r)),Rn("x:Column",String(c.c)),l[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),s.push("</xml>"),s.join("")}function MC(n){var e=[tn,Ne("comments",null,{xmlns:Eo[0]})],t=[];return e.push("<authors>"),n.forEach(function(a){a[1].forEach(function(s){var l=xt(s.a);t.indexOf(l)==-1&&(t.push(l),e.push("<author>"+l+"</author>")),s.T&&s.ID&&t.indexOf("tc="+s.ID)==-1&&(t.push("tc="+s.ID),e.push("<author>tc="+s.ID+"</author>"))})}),t.length==0&&(t.push("SheetJ5"),e.push("<author>SheetJ5</author>")),e.push("</authors>"),e.push("<commentList>"),n.forEach(function(a){var s=0,l=[];if(a[1][0]&&a[1][0].T&&a[1][0].ID?s=t.indexOf("tc="+a[1][0].ID):a[1].forEach(function(d){d.a&&(s=t.indexOf(xt(d.a))),l.push(d.t||"")}),e.push('<comment ref="'+a[0]+'" authorId="'+s+'"><text>'),l.length<=1)e.push(Rn("t",xt(l[0]||"")));else{for(var c=`Comment:
    `+l[0]+`
`,h=1;h<l.length;++h)c+=`Reply:
    `+l[h]+`
`;e.push(Rn("t",xt(c)))}e.push("</text></comment>")}),e.push("</commentList>"),e.length>2&&(e[e.length]="</comments>",e[1]=e[1].replace("/>",">")),e.join("")}function hD(n,e,t){var a=[tn,Ne("ThreadedComments",null,{xmlns:mn.TCMNT}).replace(/[\/]>/,">")];return n.forEach(function(s){var l="";(s[1]||[]).forEach(function(c,h){if(!c.T){delete c.ID;return}c.a&&e.indexOf(c.a)==-1&&e.push(c.a);var d={ref:s[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+t.tcid++).slice(-12)+"}"};h==0?l=d.id:d.parentId=l,c.ID=d.id,c.a&&(d.personId="{54EE7950-7262-4200-6969-"+("000000000000"+e.indexOf(c.a)).slice(-12)+"}"),a.push(Ne("threadedComment",Rn("text",c.t||""),d))})}),a.push("</ThreadedComments>"),a.join("")}function fD(n){var e=[tn,Ne("personList",null,{xmlns:mn.TCMNT,"xmlns:x":Eo[0]}).replace(/[\/]>/,">")];return n.forEach(function(t,a){e.push(Ne("person",null,{displayName:t,id:"{54EE7950-7262-4200-6969-"+("000000000000"+a).slice(-12)+"}",userId:t,providerId:"None"}))}),e.push("</personList>"),e.join("")}function dD(n){var e={};e.iauthor=n.read_shift(4);var t=ps(n);return e.rfx=t.s,e.ref=St(t.s),n.l+=16,e}function gD(n,e){return e==null&&(e=ge(36)),e.write_shift(4,n[1].iauthor),wo(n[0],e),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e.write_shift(4,0),e}var mD=Bn;function pD(n){return vn(n.slice(0,54))}function vD(n){var e=ar(),t=[];return Se(e,628),Se(e,630),n.forEach(function(a){a[1].forEach(function(s){t.indexOf(s.a)>-1||(t.push(s.a.slice(0,54)),Se(e,632,pD(s.a)))})}),Se(e,631),Se(e,633),n.forEach(function(a){a[1].forEach(function(s){s.iauthor=t.indexOf(s.a);var l={s:pn(a[0]),e:pn(a[0])};Se(e,635,gD([l,s])),s.t&&s.t.length>0&&Se(e,637,TM(s)),Se(e,636),delete s.iauthor})}),Se(e,634),Se(e,629),e.end()}function yD(n,e){e.FullPaths.forEach(function(t,a){if(a!=0){var s=t.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");s.slice(-1)!=="/"&&Rt.utils.cfb_add(n,s,e.FileIndex[a].content)}})}var DC=["xlsb","xlsm","xlam","biff8","xla"],TD=(function(){var n=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,e={r:0,c:0};function t(a,s,l,c){var h=!1,d=!1;l.length==0?d=!0:l.charAt(0)=="["&&(d=!0,l=l.slice(1,-1)),c.length==0?h=!0:c.charAt(0)=="["&&(h=!0,c=c.slice(1,-1));var g=l.length>0?parseInt(l,10)|0:0,p=c.length>0?parseInt(c,10)|0:0;return h?p+=e.c:--p,d?g+=e.r:--g,s+(h?"":"$")+Un(p)+(d?"":"$")+Nn(g)}return function(s,l){return e=l,s.replace(n,t)}})(),wm=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,bm=(function(){return function(e,t){return e.replace(wm,function(a,s,l,c,h,d){var g=_m(c)-(l?0:t.c),p=Tm(d)-(h?0:t.r),v=p==0?"":h?p+1:"["+p+"]",_=g==0?"":l?g+1:"["+g+"]";return s+"R"+v+"C"+_})}})();function _D(n,e){return n.replace(wm,function(t,a,s,l,c,h){return a+(s=="$"?s+l:Un(_m(l)+e.c))+(c=="$"?c+h:Nn(Tm(h)+e.r))})}function xD(n){return n.length!=1}function Jt(n){n.l+=1}function bi(n,e){var t=n.read_shift(2);return[t&16383,t>>14&1,t>>15&1]}function PC(n,e,t){var a=2;if(t){if(t.biff>=2&&t.biff<=5)return FC(n);t.biff==12&&(a=4)}var s=n.read_shift(a),l=n.read_shift(a),c=bi(n),h=bi(n);return{s:{r:s,c:c[0],cRel:c[1],rRel:c[2]},e:{r:l,c:h[0],cRel:h[1],rRel:h[2]}}}function FC(n){var e=bi(n),t=bi(n),a=n.read_shift(1),s=n.read_shift(1);return{s:{r:e[0],c:a,cRel:e[1],rRel:e[2]},e:{r:t[0],c:s,cRel:t[1],rRel:t[2]}}}function SD(n,e,t){if(t.biff<8)return FC(n);var a=n.read_shift(t.biff==12?4:2),s=n.read_shift(t.biff==12?4:2),l=bi(n),c=bi(n);return{s:{r:a,c:l[0],cRel:l[1],rRel:l[2]},e:{r:s,c:c[0],cRel:c[1],rRel:c[2]}}}function LC(n,e,t){if(t&&t.biff>=2&&t.biff<=5)return CD(n);var a=n.read_shift(t&&t.biff==12?4:2),s=bi(n);return{r:a,c:s[0],cRel:s[1],rRel:s[2]}}function CD(n){var e=bi(n),t=n.read_shift(1);return{r:e[0],c:t,cRel:e[1],rRel:e[2]}}function ED(n){var e=n.read_shift(2),t=n.read_shift(2);return{r:e,c:t&255,fQuoted:!!(t&16384),cRel:t>>15,rRel:t>>15}}function AD(n,e,t){var a=t&&t.biff?t.biff:8;if(a>=2&&a<=5)return wD(n);var s=n.read_shift(a>=12?4:2),l=n.read_shift(2),c=(l&16384)>>14,h=(l&32768)>>15;if(l&=16383,h==1)for(;s>524287;)s-=1048576;if(c==1)for(;l>8191;)l=l-16384;return{r:s,c:l,cRel:c,rRel:h}}function wD(n){var e=n.read_shift(2),t=n.read_shift(1),a=(e&32768)>>15,s=(e&16384)>>14;return e&=16383,a==1&&e>=8192&&(e=e-16384),s==1&&t>=128&&(t=t-256),{r:e,c:t,cRel:s,rRel:a}}function bD(n,e,t){var a=(n[n.l++]&96)>>5,s=PC(n,t.biff>=2&&t.biff<=5?6:8,t);return[a,s]}function ID(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2,"i"),l=8;if(t)switch(t.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}var c=PC(n,l,t);return[a,s,c]}function RD(n,e,t){var a=(n[n.l++]&96)>>5;return n.l+=t&&t.biff>8?12:t.biff<8?6:8,[a]}function ND(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2),l=8;if(t)switch(t.biff){case 5:n.l+=12,l=6;break;case 12:l=12;break}return n.l+=l,[a,s]}function kD(n,e,t){var a=(n[n.l++]&96)>>5,s=SD(n,e-1,t);return[a,s]}function OD(n,e,t){var a=(n[n.l++]&96)>>5;return n.l+=t.biff==2?6:t.biff==12?14:7,[a]}function XT(n){var e=n[n.l+1]&1,t=1;return n.l+=4,[e,t]}function MD(n,e,t){n.l+=2;for(var a=n.read_shift(t&&t.biff==2?1:2),s=[],l=0;l<=a;++l)s.push(n.read_shift(t&&t.biff==2?1:2));return s}function DD(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=2,[a,n.read_shift(t&&t.biff==2?1:2)]}function PD(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=2,[a,n.read_shift(t&&t.biff==2?1:2)]}function FD(n){var e=n[n.l+1]&255?1:0;return n.l+=2,[e,n.read_shift(2)]}function LD(n,e,t){var a=n[n.l+1]&255?1:0;return n.l+=t&&t.biff==2?3:4,[a]}function UC(n){var e=n.read_shift(1),t=n.read_shift(1);return[e,t]}function UD(n){return n.read_shift(2),UC(n)}function BD(n){return n.read_shift(2),UC(n)}function HD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=LC(n,0,t);return[a,s]}function jD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=AD(n,0,t);return[a,s]}function zD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(2);t&&t.biff==5&&(n.l+=12);var l=LC(n,0,t);return[a,s,l]}function GD(n,e,t){var a=(n[n.l]&96)>>5;n.l+=1;var s=n.read_shift(t&&t.biff<=3?1:2);return[GP[s],jC[s],a]}function $D(n,e,t){var a=n[n.l++],s=n.read_shift(1),l=t&&t.biff<=3?[a==88?-1:0,n.read_shift(1)]:KD(n);return[s,(l[0]===0?jC:zP)[l[1]]]}function KD(n){return[n[n.l+1]>>7,n.read_shift(2)&32767]}function VD(n,e,t){n.l+=t&&t.biff==2?3:4}function qD(n,e,t){if(n.l++,t&&t.biff==12)return[n.read_shift(4,"i"),0];var a=n.read_shift(2),s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function YD(n){return n.l++,uc[n.read_shift(1)]}function XD(n){return n.l++,n.read_shift(2)}function WD(n){return n.l++,n.read_shift(1)!==0}function QD(n){return n.l++,bo(n)}function JD(n,e,t){return n.l++,_C(n,e-1,t)}function ZD(n,e){var t=[n.read_shift(1)];if(e==12)switch(t[0]){case 2:t[0]=4;break;case 4:t[0]=16;break;case 0:t[0]=1;break;case 1:t[0]=2;break}switch(t[0]){case 4:t[1]=zM(n,1)?"TRUE":"FALSE",e!=12&&(n.l+=7);break;case 37:case 16:t[1]=uc[n[n.l]],n.l+=e==12?4:8;break;case 0:n.l+=8;break;case 1:t[1]=bo(n);break;case 2:t[1]=VM(n,0,{biff:e>0&&e<8?2:e});break;default:throw new Error("Bad SerAr: "+t[0])}return t}function eP(n,e,t){for(var a=n.read_shift(t.biff==12?4:2),s=[],l=0;l!=a;++l)s.push((t.biff==12?ps:XM)(n));return s}function tP(n,e,t){var a=0,s=0;t.biff==12?(a=n.read_shift(4),s=n.read_shift(4)):(s=1+n.read_shift(1),a=1+n.read_shift(2)),t.biff>=2&&t.biff<8&&(--a,--s==0&&(s=256));for(var l=0,c=[];l!=a&&(c[l]=[]);++l)for(var h=0;h!=s;++h)c[l][h]=ZD(n,t.biff);return c}function nP(n,e,t){var a=n.read_shift(1)>>>5&3,s=!t||t.biff>=8?4:2,l=n.read_shift(s);switch(t.biff){case 2:n.l+=5;break;case 3:case 4:n.l+=8;break;case 5:n.l+=12;break}return[a,0,l]}function rP(n,e,t){if(t.biff==5)return aP(n);var a=n.read_shift(1)>>>5&3,s=n.read_shift(2),l=n.read_shift(4);return[a,s,l]}function aP(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2,"i");n.l+=8;var a=n.read_shift(2);return n.l+=12,[e,t,a]}function iP(n,e,t){var a=n.read_shift(1)>>>5&3;n.l+=t&&t.biff==2?3:4;var s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function sP(n,e,t){var a=n.read_shift(1)>>>5&3,s=n.read_shift(t&&t.biff==2?1:2);return[a,s]}function oP(n,e,t){var a=n.read_shift(1)>>>5&3;return n.l+=4,t.biff<8&&n.l--,t.biff==12&&(n.l+=2),[a]}function lP(n,e,t){var a=(n[n.l++]&96)>>5,s=n.read_shift(2),l=4;if(t)switch(t.biff){case 5:l=15;break;case 12:l=6;break}return n.l+=l,[a,s]}var cP=ya,uP=ya,hP=ya;function hc(n,e,t){return n.l+=2,[ED(n)]}function Im(n){return n.l+=6,[]}var fP=hc,dP=Im,gP=Im,mP=hc;function BC(n){return n.l+=2,[yC(n),n.read_shift(2)&1]}var pP=hc,vP=BC,yP=Im,TP=hc,_P=hc,xP=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function SP(n){n.l+=2;var e=n.read_shift(2),t=n.read_shift(2),a=n.read_shift(4),s=n.read_shift(2),l=n.read_shift(2),c=xP[t>>2&31];return{ixti:e,coltype:t&3,rt:c,idx:a,c:s,C:l}}function CP(n){return n.l+=2,[n.read_shift(4)]}function EP(n,e,t){return n.l+=5,n.l+=2,n.l+=t.biff==2?1:4,["PTGSHEET"]}function AP(n,e,t){return n.l+=t.biff==2?4:5,["PTGENDSHEET"]}function wP(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function bP(n){var e=n.read_shift(1)>>>5&3,t=n.read_shift(2);return[e,t]}function IP(n){return n.l+=4,[0,0]}var WT={1:{n:"PtgExp",f:qD},2:{n:"PtgTbl",f:hP},3:{n:"PtgAdd",f:Jt},4:{n:"PtgSub",f:Jt},5:{n:"PtgMul",f:Jt},6:{n:"PtgDiv",f:Jt},7:{n:"PtgPower",f:Jt},8:{n:"PtgConcat",f:Jt},9:{n:"PtgLt",f:Jt},10:{n:"PtgLe",f:Jt},11:{n:"PtgEq",f:Jt},12:{n:"PtgGe",f:Jt},13:{n:"PtgGt",f:Jt},14:{n:"PtgNe",f:Jt},15:{n:"PtgIsect",f:Jt},16:{n:"PtgUnion",f:Jt},17:{n:"PtgRange",f:Jt},18:{n:"PtgUplus",f:Jt},19:{n:"PtgUminus",f:Jt},20:{n:"PtgPercent",f:Jt},21:{n:"PtgParen",f:Jt},22:{n:"PtgMissArg",f:Jt},23:{n:"PtgStr",f:JD},26:{n:"PtgSheet",f:EP},27:{n:"PtgEndSheet",f:AP},28:{n:"PtgErr",f:YD},29:{n:"PtgBool",f:WD},30:{n:"PtgInt",f:XD},31:{n:"PtgNum",f:QD},32:{n:"PtgArray",f:OD},33:{n:"PtgFunc",f:GD},34:{n:"PtgFuncVar",f:$D},35:{n:"PtgName",f:nP},36:{n:"PtgRef",f:HD},37:{n:"PtgArea",f:bD},38:{n:"PtgMemArea",f:iP},39:{n:"PtgMemErr",f:cP},40:{n:"PtgMemNoMem",f:uP},41:{n:"PtgMemFunc",f:sP},42:{n:"PtgRefErr",f:oP},43:{n:"PtgAreaErr",f:RD},44:{n:"PtgRefN",f:jD},45:{n:"PtgAreaN",f:kD},46:{n:"PtgMemAreaN",f:wP},47:{n:"PtgMemNoMemN",f:bP},57:{n:"PtgNameX",f:rP},58:{n:"PtgRef3d",f:zD},59:{n:"PtgArea3d",f:ID},60:{n:"PtgRefErr3d",f:lP},61:{n:"PtgAreaErr3d",f:ND},255:{}},RP={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},NP={1:{n:"PtgElfLel",f:BC},2:{n:"PtgElfRw",f:TP},3:{n:"PtgElfCol",f:fP},6:{n:"PtgElfRwV",f:_P},7:{n:"PtgElfColV",f:mP},10:{n:"PtgElfRadical",f:pP},11:{n:"PtgElfRadicalS",f:yP},13:{n:"PtgElfColS",f:dP},15:{n:"PtgElfColSV",f:gP},16:{n:"PtgElfRadicalLel",f:vP},25:{n:"PtgList",f:SP},29:{n:"PtgSxName",f:CP},255:{}},kP={0:{n:"PtgAttrNoop",f:IP},1:{n:"PtgAttrSemi",f:LD},2:{n:"PtgAttrIf",f:PD},4:{n:"PtgAttrChoose",f:MD},8:{n:"PtgAttrGoto",f:DD},16:{n:"PtgAttrSum",f:VD},32:{n:"PtgAttrBaxcel",f:XT},33:{n:"PtgAttrBaxcel",f:XT},64:{n:"PtgAttrSpace",f:UD},65:{n:"PtgAttrSpaceSemi",f:BD},128:{n:"PtgAttrIfError",f:FD},255:{}};function OP(n,e,t,a){if(a.biff<8)return ya(n,e);for(var s=n.l+e,l=[],c=0;c!==t.length;++c)switch(t[c][0]){case"PtgArray":t[c][1]=tP(n,0,a),l.push(t[c][1]);break;case"PtgMemArea":t[c][2]=eP(n,t[c][1],a),l.push(t[c][2]);break;case"PtgExp":a&&a.biff==12&&(t[c][1][1]=n.read_shift(4),l.push(t[c][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+t[c][0]}return e=s-n.l,e!==0&&l.push(ya(n,e)),l}function MP(n,e,t){for(var a=n.l+e,s,l,c=[];a!=n.l;)e=a-n.l,l=n[n.l],s=WT[l]||WT[RP[l]],(l===24||l===25)&&(s=(l===24?NP:kP)[n[n.l+1]]),!s||!s.f?ya(n,e):c.push([s.n,s.f(n,e,t)]);return c}function DP(n){for(var e=[],t=0;t<n.length;++t){for(var a=n[t],s=[],l=0;l<a.length;++l){var c=a[l];if(c)switch(c[0]){case 2:s.push('"'+c[1].replace(/"/g,'""')+'"');break;default:s.push(c[1])}else s.push("")}e.push(s.join(","))}return e.join(";")}var PP={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function FP(n,e){if(!n&&!(e&&e.biff<=5&&e.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(n)?"'"+n+"'":n}function HC(n,e,t){if(!n)return"SH33TJSERR0";if(t.biff>8&&(!n.XTI||!n.XTI[e]))return n.SheetNames[e];if(!n.XTI)return"SH33TJSERR6";var a=n.XTI[e];if(t.biff<8)return e>1e4&&(e-=65536),e<0&&(e=-e),e==0?"":n.XTI[e-1];if(!a)return"SH33TJSERR1";var s="";if(t.biff>8)switch(n[a[0]][0]){case 357:return s=a[1]==-1?"#REF":n.SheetNames[a[1]],a[1]==a[2]?s:s+":"+n.SheetNames[a[2]];case 358:return t.SID!=null?n.SheetNames[t.SID]:"SH33TJSSAME"+n[a[0]][0];case 355:default:return"SH33TJSSRC"+n[a[0]][0]}switch(n[a[0]][0][0]){case 1025:return s=a[1]==-1?"#REF":n.SheetNames[a[1]]||"SH33TJSERR3",a[1]==a[2]?s:s+":"+n.SheetNames[a[2]];case 14849:return n[a[0]].slice(1).map(function(l){return l.Name}).join(";;");default:return n[a[0]][0][3]?(s=a[1]==-1?"#REF":n[a[0]][0][3][a[1]]||"SH33TJSERR4",a[1]==a[2]?s:s+":"+n[a[0]][0][3][a[2]]):"SH33TJSERR2"}}function QT(n,e,t){var a=HC(n,e,t);return a=="#REF"?a:FP(a,t)}function yo(n,e,t,a,s){var l=s&&s.biff||8,c={s:{c:0,r:0}},h=[],d,g,p,v=0,_=0,T,C="";if(!n[0]||!n[0][0])return"";for(var x=-1,A="",B=0,k=n[0].length;B<k;++B){var O=n[0][B];switch(O[0]){case"PtgUminus":h.push("-"+h.pop());break;case"PtgUplus":h.push("+"+h.pop());break;case"PtgPercent":h.push(h.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(d=h.pop(),g=h.pop(),x>=0){switch(n[0][x][1][0]){case 0:A=Vt(" ",n[0][x][1][1]);break;case 1:A=Vt("\r",n[0][x][1][1]);break;default:if(A="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}g=g+A,x=-1}h.push(g+PP[O[0]]+d);break;case"PtgIsect":d=h.pop(),g=h.pop(),h.push(g+" "+d);break;case"PtgUnion":d=h.pop(),g=h.pop(),h.push(g+","+d);break;case"PtgRange":d=h.pop(),g=h.pop(),h.push(g+":"+d);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":p=$l(O[1][1],c,s),h.push(Kl(p,l));break;case"PtgRefN":p=t?$l(O[1][1],t,s):O[1][1],h.push(Kl(p,l));break;case"PtgRef3d":v=O[1][1],p=$l(O[1][2],c,s),C=QT(a,v,s),h.push(C+"!"+Kl(p,l));break;case"PtgFunc":case"PtgFuncVar":var j=O[1][0],H=O[1][1];j||(j=0),j&=127;var Y=j==0?[]:h.slice(-j);h.length-=j,H==="User"&&(H=Y.shift()),h.push(H+"("+Y.join(",")+")");break;case"PtgBool":h.push(O[1]?"TRUE":"FALSE");break;case"PtgInt":h.push(O[1]);break;case"PtgNum":h.push(String(O[1]));break;case"PtgStr":h.push('"'+O[1].replace(/"/g,'""')+'"');break;case"PtgErr":h.push(O[1]);break;case"PtgAreaN":T=PT(O[1][1],t?{s:t}:c,s),h.push(w0(T,s));break;case"PtgArea":T=PT(O[1][1],c,s),h.push(w0(T,s));break;case"PtgArea3d":v=O[1][1],T=O[1][2],C=QT(a,v,s),h.push(C+"!"+w0(T,s));break;case"PtgAttrSum":h.push("SUM("+h.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":_=O[1][2];var I=(a.names||[])[_-1]||(a[0]||[])[_],G=I?I.Name:"SH33TJSNAME"+String(_);G&&G.slice(0,6)=="_xlfn."&&!s.xlfn&&(G=G.slice(6)),h.push(G);break;case"PtgNameX":var q=O[1][1];_=O[1][2];var ie;if(s.biff<=5)q<0&&(q=-q),a[q]&&(ie=a[q][_]);else{var J="";if(((a[q]||[])[0]||[])[0]==14849||(((a[q]||[])[0]||[])[0]==1025?a[q][_]&&a[q][_].itab>0&&(J=a.SheetNames[a[q][_].itab-1]+"!"):J=a.SheetNames[_-1]+"!"),a[q]&&a[q][_])J+=a[q][_].Name;else if(a[0]&&a[0][_])J+=a[0][_].Name;else{var he=(HC(a,q,s)||"").split(";;");he[_-1]?J=he[_-1]:J+="SH33TJSERRX"}h.push(J);break}ie||(ie={Name:"SH33TJSERRY"}),h.push(ie.Name);break;case"PtgParen":var Ae="(",je=")";if(x>=0){switch(A="",n[0][x][1][0]){case 2:Ae=Vt(" ",n[0][x][1][1])+Ae;break;case 3:Ae=Vt("\r",n[0][x][1][1])+Ae;break;case 4:je=Vt(" ",n[0][x][1][1])+je;break;case 5:je=Vt("\r",n[0][x][1][1])+je;break;default:if(s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+n[0][x][1][0])}x=-1}h.push(Ae+h.pop()+je);break;case"PtgRefErr":h.push("#REF!");break;case"PtgRefErr3d":h.push("#REF!");break;case"PtgExp":p={c:O[1][1],r:O[1][0]};var ke={c:t.c,r:t.r};if(a.sharedf[St(p)]){var re=a.sharedf[St(p)];h.push(yo(re,c,ke,a,s))}else{var xe=!1;for(d=0;d!=a.arrayf.length;++d)if(g=a.arrayf[d],!(p.c<g[0].s.c||p.c>g[0].e.c)&&!(p.r<g[0].s.r||p.r>g[0].e.r)){h.push(yo(g[1],c,ke,a,s)),xe=!0;break}xe||h.push(O[1])}break;case"PtgArray":h.push("{"+DP(O[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":x=B;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":h.push("");break;case"PtgAreaErr":h.push("#REF!");break;case"PtgAreaErr3d":h.push("#REF!");break;case"PtgList":h.push("Table"+O[1].idx+"[#"+O[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(O));default:throw new Error("Unrecognized Formula Token: "+String(O))}var fe=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(s.biff!=3&&x>=0&&fe.indexOf(n[0][B][0])==-1){O=n[0][x];var Te=!0;switch(O[1][0]){case 4:Te=!1;case 0:A=Vt(" ",O[1][1]);break;case 5:Te=!1;case 1:A=Vt("\r",O[1][1]);break;default:if(A="",s.WTF)throw new Error("Unexpected PtgAttrSpaceType "+O[1][0])}h.push((Te?A:"")+h.pop()+(Te?"":A)),x=-1}}if(h.length>1&&s.WTF)throw new Error("bad formula stack");return h[0]}function LP(n){if(n==null){var e=ge(8);return e.write_shift(1,3),e.write_shift(1,0),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,65535),e}else if(typeof n=="number")return cs(n);return cs(0)}function UP(n,e,t,a,s){var l=us(e,t,s),c=LP(n.v),h=ge(6),d=33;h.write_shift(2,d),h.write_shift(4,0);for(var g=ge(n.bf.length),p=0;p<n.bf.length;++p)g[p]=n.bf[p];var v=In([l,c,h,g]);return v}function tf(n,e,t){var a=n.read_shift(4),s=MP(n,a,t),l=n.read_shift(4),c=l>0?OP(n,l,s,t):null;return[s,c]}var BP=tf,nf=tf,HP=tf,jP=tf,zP={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},jC={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},GP={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function $P(n){var e="of:="+n.replace(wm,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return e.replace(/;/g,"|").replace(/,/g,";")}function KP(n){return n.replace(/\./,"!")}var Vl=typeof Map<"u";function Rm(n,e,t){var a=0,s=n.length;if(t){if(Vl?t.has(e):Object.prototype.hasOwnProperty.call(t,e)){for(var l=Vl?t.get(e):t[e];a<l.length;++a)if(n[l[a]].t===e)return n.Count++,l[a]}}else for(;a<s;++a)if(n[a].t===e)return n.Count++,a;return n[s]={t:e},n.Count++,n.Unique++,t&&(Vl?(t.has(e)||t.set(e,[]),t.get(e).push(s)):(Object.prototype.hasOwnProperty.call(t,e)||(t[e]=[]),t[e].push(s))),s}function rf(n,e){var t={min:n+1,max:n+1},a=-1;return e.MDW&&(Ba=e.MDW),e.width!=null?t.customWidth=1:e.wpx!=null?a=bh(e.wpx):e.wch!=null&&(a=e.wch),a>-1?(t.width=Z0(a),t.customWidth=1):e.width!=null&&(t.width=e.width),e.hidden&&(t.hidden=!0),e.level!=null&&(t.outlineLevel=t.level=e.level),t}function zC(n,e){if(n){var t=[.7,.7,.75,.75,.3,.3];n.left==null&&(n.left=t[0]),n.right==null&&(n.right=t[1]),n.top==null&&(n.top=t[2]),n.bottom==null&&(n.bottom=t[3]),n.header==null&&(n.header=t[4]),n.footer==null&&(n.footer=t[5])}}function Ni(n,e,t){var a=t.revssf[e.z!=null?e.z:"General"],s=60,l=n.length;if(a==null&&t.ssf){for(;s<392;++s)if(t.ssf[s]==null){LS(e.z,s),t.ssf[s]=e.z,t.revssf[e.z]=a=s;break}}for(s=0;s!=l;++s)if(n[s].numFmtId===a)return s;return n[l]={numFmtId:a,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},l}function VP(n,e,t){if(n&&n["!ref"]){var a=Ut(n["!ref"]);if(a.e.c<a.s.c||a.e.r<a.s.r)throw new Error("Bad range ("+t+"): "+n["!ref"])}}function qP(n){if(n.length===0)return"";for(var e='<mergeCells count="'+n.length+'">',t=0;t!=n.length;++t)e+='<mergeCell ref="'+en(n[t])+'"/>';return e+"</mergeCells>"}function YP(n,e,t,a,s){var l=!1,c={},h=null;if(a.bookType!=="xlsx"&&e.vbaraw){var d=e.SheetNames[t];try{e.Workbook&&(d=e.Workbook.Sheets[t].CodeName||d)}catch{}l=!0,c.codeName=nc(xt(d))}if(n&&n["!outline"]){var g={summaryBelow:1,summaryRight:1};n["!outline"].above&&(g.summaryBelow=0),n["!outline"].left&&(g.summaryRight=0),h=(h||"")+Ne("outlinePr",null,g)}!l&&!h||(s[s.length]=Ne("sheetPr",h,c))}var XP=["objects","scenarios","selectLockedCells","selectUnlockedCells"],WP=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function QP(n){var e={sheet:1};return XP.forEach(function(t){n[t]!=null&&n[t]&&(e[t]="1")}),WP.forEach(function(t){n[t]!=null&&!n[t]&&(e[t]="0")}),n.password&&(e.password=AC(n.password).toString(16).toUpperCase()),Ne("sheetProtection",null,e)}function JP(n){return zC(n),Ne("pageMargins",null,n)}function ZP(n,e){for(var t=["<cols>"],a,s=0;s!=e.length;++s)(a=e[s])&&(t[t.length]=Ne("col",null,rf(s,a)));return t[t.length]="</cols>",t.join("")}function eF(n,e,t,a){var s=typeof n.ref=="string"?n.ref:en(n.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var l=t.Workbook.Names,c=Ar(s);c.s.r==c.e.r&&(c.e.r=Ar(e["!ref"]).e.r,s=en(c));for(var h=0;h<l.length;++h){var d=l[h];if(d.Name=="_xlnm._FilterDatabase"&&d.Sheet==a){d.Ref="'"+t.SheetNames[a]+"'!"+s;break}}return h==l.length&&l.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+s}),Ne("autoFilter",null,{ref:s})}function tF(n,e,t,a){var s={workbookViewId:"0"};return(((a||{}).Workbook||{}).Views||[])[0]&&(s.rightToLeft=a.Workbook.Views[0].RTL?"1":"0"),Ne("sheetViews",Ne("sheetView",null,s),{})}function nF(n,e,t,a){if(n.c&&t["!comments"].push([e,n.c]),n.v===void 0&&typeof n.f!="string"||n.t==="z"&&!n.f)return"";var s="",l=n.t,c=n.v;if(n.t!=="z")switch(n.t){case"b":s=n.v?"1":"0";break;case"n":s=""+n.v;break;case"e":s=uc[n.v];break;case"d":a&&a.cellDates?s=Qn(n.v,-1).toISOString():(n=or(n),n.t="n",s=""+(n.v=sr(Qn(n.v)))),typeof n.z>"u"&&(n.z=qt[14]);break;default:s=n.v;break}var h=Rn("v",xt(s)),d={r:e},g=Ni(a.cellXfs,n,a);switch(g!==0&&(d.s=g),n.t){case"n":break;case"d":d.t="d";break;case"b":d.t="b";break;case"e":d.t="e";break;case"z":break;default:if(n.v==null){delete n.t;break}if(n.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(a&&a.bookSST){h=Rn("v",""+Rm(a.Strings,n.v,a.revStrings)),d.t="s";break}d.t="str";break}if(n.t!=l&&(n.t=l,n.v=c),typeof n.f=="string"&&n.f){var p=n.F&&n.F.slice(0,e.length)==e?{t:"array",ref:n.F}:null;h=Ne("f",xt(n.f),p)+(n.v!=null?h:"")}return n.l&&t["!links"].push([e,n.l]),n.D&&(d.cm=1),Ne("c",h,d)}function rF(n,e,t,a){var s=[],l=[],c=Ut(n["!ref"]),h="",d,g="",p=[],v=0,_=0,T=n["!rows"],C=Array.isArray(n),x={r:g},A,B=-1;for(_=c.s.c;_<=c.e.c;++_)p[_]=Un(_);for(v=c.s.r;v<=c.e.r;++v){for(l=[],g=Nn(v),_=c.s.c;_<=c.e.c;++_){d=p[_]+g;var k=C?(n[v]||[])[_]:n[d];k!==void 0&&(h=nF(k,d,n,e))!=null&&l.push(h)}(l.length>0||T&&T[v])&&(x={r:g},T&&T[v]&&(A=T[v],A.hidden&&(x.hidden=1),B=-1,A.hpx?B=Ih(A.hpx):A.hpt&&(B=A.hpt),B>-1&&(x.ht=B,x.customHeight=1),A.level&&(x.outlineLevel=A.level)),s[s.length]=Ne("row",l.join(""),x))}if(T)for(;v<T.length;++v)T&&T[v]&&(x={r:v+1},A=T[v],A.hidden&&(x.hidden=1),B=-1,A.hpx?B=Ih(A.hpx):A.hpt&&(B=A.hpt),B>-1&&(x.ht=B,x.customHeight=1),A.level&&(x.outlineLevel=A.level),s[s.length]=Ne("row","",x));return s.join("")}function GC(n,e,t,a){var s=[tn,Ne("worksheet",null,{xmlns:Eo[0],"xmlns:r":mn.r})],l=t.SheetNames[n],c=0,h="",d=t.Sheets[l];d==null&&(d={});var g=d["!ref"]||"A1",p=Ut(g);if(p.e.c>16383||p.e.r>1048575){if(e.WTF)throw new Error("Range "+g+" exceeds format limit A1:XFD1048576");p.e.c=Math.min(p.e.c,16383),p.e.r=Math.min(p.e.c,1048575),g=en(p)}a||(a={}),d["!comments"]=[];var v=[];YP(d,t,n,e,s),s[s.length]=Ne("dimension",null,{ref:g}),s[s.length]=tF(d,e,n,t),e.sheetFormat&&(s[s.length]=Ne("sheetFormatPr",null,{defaultRowHeight:e.sheetFormat.defaultRowHeight||"16",baseColWidth:e.sheetFormat.baseColWidth||"10",outlineLevelRow:e.sheetFormat.outlineLevelRow||"7"})),d["!cols"]!=null&&d["!cols"].length>0&&(s[s.length]=ZP(d,d["!cols"])),s[c=s.length]="<sheetData/>",d["!links"]=[],d["!ref"]!=null&&(h=rF(d,e),h.length>0&&(s[s.length]=h)),s.length>c+1&&(s[s.length]="</sheetData>",s[c]=s[c].replace("/>",">")),d["!protect"]&&(s[s.length]=QP(d["!protect"])),d["!autofilter"]!=null&&(s[s.length]=eF(d["!autofilter"],d,t,n)),d["!merges"]!=null&&d["!merges"].length>0&&(s[s.length]=qP(d["!merges"]));var _=-1,T,C=-1;return d["!links"].length>0&&(s[s.length]="<hyperlinks>",d["!links"].forEach(function(x){x[1].Target&&(T={ref:x[0]},x[1].Target.charAt(0)!="#"&&(C=Tt(a,-1,xt(x[1].Target).replace(/#.*$/,""),ft.HLINK),T["r:id"]="rId"+C),(_=x[1].Target.indexOf("#"))>-1&&(T.location=xt(x[1].Target.slice(_+1))),x[1].Tooltip&&(T.tooltip=xt(x[1].Tooltip)),s[s.length]=Ne("hyperlink",null,T))}),s[s.length]="</hyperlinks>"),delete d["!links"],d["!margins"]!=null&&(s[s.length]=JP(d["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&(s[s.length]=Rn("ignoredErrors",Ne("ignoredError",null,{numberStoredAsText:1,sqref:g}))),v.length>0&&(C=Tt(a,-1,"../drawings/drawing"+(n+1)+".xml",ft.DRAW),s[s.length]=Ne("drawing",null,{"r:id":"rId"+C}),d["!drawing"]=v),d["!comments"].length>0&&(C=Tt(a,-1,"../drawings/vmlDrawing"+(n+1)+".vml",ft.VML),s[s.length]=Ne("legacyDrawing",null,{"r:id":"rId"+C}),d["!legacy"]=C),s.length>1&&(s[s.length]="</worksheet>",s[1]=s[1].replace("/>",">")),s.join("")}function aF(n,e){var t={},a=n.l+e;t.r=n.read_shift(4),n.l+=4;var s=n.read_shift(2);n.l+=1;var l=n.read_shift(1);return n.l=a,l&7&&(t.level=l&7),l&16&&(t.hidden=!0),l&32&&(t.hpt=s/20),t}function iF(n,e,t){var a=ge(145),s=(t["!rows"]||[])[n]||{};a.write_shift(4,n),a.write_shift(4,0);var l=320;s.hpx?l=Ih(s.hpx)*20:s.hpt&&(l=s.hpt*20),a.write_shift(2,l),a.write_shift(1,0);var c=0;s.level&&(c|=s.level),s.hidden&&(c|=16),(s.hpx||s.hpt)&&(c|=32),a.write_shift(1,c),a.write_shift(1,0);var h=0,d=a.l;a.l+=4;for(var g={r:n,c:0},p=0;p<16;++p)if(!(e.s.c>p+1<<10||e.e.c<p<<10)){for(var v=-1,_=-1,T=p<<10;T<p+1<<10;++T){g.c=T;var C=Array.isArray(t)?(t[g.r]||[])[g.c]:t[St(g)];C&&(v<0&&(v=T),_=T)}v<0||(++h,a.write_shift(4,v),a.write_shift(4,_))}var x=a.l;return a.l=d,a.write_shift(4,h),a.l=x,a.length>a.l?a.slice(0,a.l):a}function sF(n,e,t,a){var s=iF(a,t,e);(s.length>17||(e["!rows"]||[])[a])&&Se(n,0,s)}var oF=ps,lF=wo;function cF(){}function uF(n,e){var t={},a=n[n.l];return++n.l,t.above=!(a&64),t.left=!(a&128),n.l+=18,t.name=_M(n),t}function hF(n,e,t){t==null&&(t=ge(84+4*n.length));var a=192;e&&(e.above&&(a&=-65),e.left&&(a&=-129)),t.write_shift(1,a);for(var s=1;s<3;++s)t.write_shift(1,0);return Eh({auto:1},t),t.write_shift(-4,-1),t.write_shift(-4,-1),aC(n,t),t.slice(0,t.l)}function fF(n){var e=jr(n);return[e]}function dF(n,e,t){return t==null&&(t=ge(8)),ds(e,t)}function gF(n){var e=gs(n);return[e]}function mF(n,e,t){return t==null&&(t=ge(4)),ms(e,t)}function pF(n){var e=jr(n),t=n.read_shift(1);return[e,t,"b"]}function vF(n,e,t){return t==null&&(t=ge(9)),ds(e,t),t.write_shift(1,n.v?1:0),t}function yF(n){var e=gs(n),t=n.read_shift(1);return[e,t,"b"]}function TF(n,e,t){return t==null&&(t=ge(5)),ms(e,t),t.write_shift(1,n.v?1:0),t}function _F(n){var e=jr(n),t=n.read_shift(1);return[e,t,"e"]}function xF(n,e,t){return t==null&&(t=ge(9)),ds(e,t),t.write_shift(1,n.v),t}function SF(n){var e=gs(n),t=n.read_shift(1);return[e,t,"e"]}function CF(n,e,t){return t==null&&(t=ge(8)),ms(e,t),t.write_shift(1,n.v),t.write_shift(2,0),t.write_shift(1,0),t}function EF(n){var e=jr(n),t=n.read_shift(4);return[e,t,"s"]}function AF(n,e,t){return t==null&&(t=ge(12)),ds(e,t),t.write_shift(4,e.v),t}function wF(n){var e=gs(n),t=n.read_shift(4);return[e,t,"s"]}function bF(n,e,t){return t==null&&(t=ge(8)),ms(e,t),t.write_shift(4,e.v),t}function IF(n){var e=jr(n),t=bo(n);return[e,t,"n"]}function RF(n,e,t){return t==null&&(t=ge(16)),ds(e,t),cs(n.v,t),t}function NF(n){var e=gs(n),t=bo(n);return[e,t,"n"]}function kF(n,e,t){return t==null&&(t=ge(12)),ms(e,t),cs(n.v,t),t}function OF(n){var e=jr(n),t=iC(n);return[e,t,"n"]}function MF(n,e,t){return t==null&&(t=ge(12)),ds(e,t),sC(n.v,t),t}function DF(n){var e=gs(n),t=iC(n);return[e,t,"n"]}function PF(n,e,t){return t==null&&(t=ge(8)),ms(e,t),sC(n.v,t),t}function FF(n){var e=jr(n),t=xm(n);return[e,t,"is"]}function LF(n){var e=jr(n),t=Bn(n);return[e,t,"str"]}function UF(n,e,t){return t==null&&(t=ge(12+4*n.v.length)),ds(e,t),vn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function BF(n){var e=gs(n),t=Bn(n);return[e,t,"str"]}function HF(n,e,t){return t==null&&(t=ge(8+4*n.v.length)),ms(e,t),vn(n.v,t),t.length>t.l?t.slice(0,t.l):t}function jF(n,e,t){var a=n.l+e,s=jr(n);s.r=t["!row"];var l=n.read_shift(1),c=[s,l,"b"];if(t.cellFormula){n.l+=2;var h=nf(n,a-n.l,t);c[3]=yo(h,null,s,t.supbooks,t)}else n.l=a;return c}function zF(n,e,t){var a=n.l+e,s=jr(n);s.r=t["!row"];var l=n.read_shift(1),c=[s,l,"e"];if(t.cellFormula){n.l+=2;var h=nf(n,a-n.l,t);c[3]=yo(h,null,s,t.supbooks,t)}else n.l=a;return c}function GF(n,e,t){var a=n.l+e,s=jr(n);s.r=t["!row"];var l=bo(n),c=[s,l,"n"];if(t.cellFormula){n.l+=2;var h=nf(n,a-n.l,t);c[3]=yo(h,null,s,t.supbooks,t)}else n.l=a;return c}function $F(n,e,t){var a=n.l+e,s=jr(n);s.r=t["!row"];var l=Bn(n),c=[s,l,"str"];if(t.cellFormula){n.l+=2;var h=nf(n,a-n.l,t);c[3]=yo(h,null,s,t.supbooks,t)}else n.l=a;return c}var KF=ps,VF=wo;function qF(n,e){return e==null&&(e=ge(4)),e.write_shift(4,n),e}function YF(n,e){var t=n.l+e,a=ps(n),s=Sm(n),l=Bn(n),c=Bn(n),h=Bn(n);n.l=t;var d={rfx:a,relId:s,loc:l,display:h};return c&&(d.Tooltip=c),d}function XF(n,e){var t=ge(50+4*(n[1].Target.length+(n[1].Tooltip||"").length));wo({s:pn(n[0]),e:pn(n[0])},t),Cm("rId"+e,t);var a=n[1].Target.indexOf("#"),s=a==-1?"":n[1].Target.slice(a+1);return vn(s||"",t),vn(n[1].Tooltip||"",t),vn("",t),t.slice(0,t.l)}function WF(){}function QF(n,e,t){var a=n.l+e,s=oC(n),l=n.read_shift(1),c=[s];if(c[2]=l,t.cellFormula){var h=BP(n,a-n.l,t);c[1]=h}else n.l=a;return c}function JF(n,e,t){var a=n.l+e,s=ps(n),l=[s];if(t.cellFormula){var c=jP(n,a-n.l,t);l[1]=c,n.l=a}else n.l=a;return l}function ZF(n,e,t){t==null&&(t=ge(18));var a=rf(n,e);t.write_shift(-4,n),t.write_shift(-4,n),t.write_shift(4,(a.width||10)*256),t.write_shift(4,0);var s=0;return e.hidden&&(s|=1),typeof a.width=="number"&&(s|=2),e.level&&(s|=e.level<<8),t.write_shift(2,s),t}var $C=["left","right","top","bottom","header","footer"];function e6(n){var e={};return $C.forEach(function(t){e[t]=bo(n)}),e}function t6(n,e){return e==null&&(e=ge(48)),zC(n),$C.forEach(function(t){cs(n[t],e)}),e}function n6(n){var e=n.read_shift(2);return n.l+=28,{RTL:e&32}}function r6(n,e,t){t==null&&(t=ge(30));var a=924;return(((e||{}).Views||[])[0]||{}).RTL&&(a|=32),t.write_shift(2,a),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,100),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(4,0),t}function a6(n){var e=ge(24);return e.write_shift(4,4),e.write_shift(4,1),wo(n,e),e}function i6(n,e){return e==null&&(e=ge(66)),e.write_shift(2,n.password?AC(n.password):0),e.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(t){t[1]?e.write_shift(4,n[t[0]]!=null&&!n[t[0]]?1:0):e.write_shift(4,n[t[0]]!=null&&n[t[0]]?0:1)}),e}function s6(){}function o6(){}function l6(n,e,t,a,s,l,c){if(e.v===void 0)return!1;var h="";switch(e.t){case"b":h=e.v?"1":"0";break;case"d":e=or(e),e.z=e.z||qt[14],e.v=sr(Qn(e.v)),e.t="n";break;case"n":case"e":h=""+e.v;break;default:h=e.v;break}var d={r:t,c:a};switch(d.s=Ni(s.cellXfs,e,s),e.l&&l["!links"].push([St(d),e.l]),e.c&&l["!comments"].push([St(d),e.c]),e.t){case"s":case"str":return s.bookSST?(h=Rm(s.Strings,e.v,s.revStrings),d.t="s",d.v=h,c?Se(n,18,bF(e,d)):Se(n,7,AF(e,d))):(d.t="str",c?Se(n,17,HF(e,d)):Se(n,6,UF(e,d))),!0;case"n":return e.v==(e.v|0)&&e.v>-1e3&&e.v<1e3?c?Se(n,13,PF(e,d)):Se(n,2,MF(e,d)):c?Se(n,16,kF(e,d)):Se(n,5,RF(e,d)),!0;case"b":return d.t="b",c?Se(n,15,TF(e,d)):Se(n,4,vF(e,d)),!0;case"e":return d.t="e",c?Se(n,14,CF(e,d)):Se(n,3,xF(e,d)),!0}return c?Se(n,12,mF(e,d)):Se(n,1,dF(e,d)),!0}function c6(n,e,t,a){var s=Ut(e["!ref"]||"A1"),l,c="",h=[];Se(n,145);var d=Array.isArray(e),g=s.e.r;e["!rows"]&&(g=Math.max(s.e.r,e["!rows"].length-1));for(var p=s.s.r;p<=g;++p){c=Nn(p),sF(n,e,s,p);var v=!1;if(p<=s.e.r)for(var _=s.s.c;_<=s.e.c;++_){p===s.s.r&&(h[_]=Un(_)),l=h[_]+c;var T=d?(e[p]||[])[_]:e[l];if(!T){v=!1;continue}v=l6(n,T,p,_,a,e,v)}}Se(n,146)}function u6(n,e){!e||!e["!merges"]||(Se(n,177,qF(e["!merges"].length)),e["!merges"].forEach(function(t){Se(n,176,VF(t))}),Se(n,178))}function h6(n,e){!e||!e["!cols"]||(Se(n,390),e["!cols"].forEach(function(t,a){t&&Se(n,60,ZF(a,t))}),Se(n,391))}function f6(n,e){!e||!e["!ref"]||(Se(n,648),Se(n,649,a6(Ut(e["!ref"]))),Se(n,650))}function d6(n,e,t){e["!links"].forEach(function(a){if(a[1].Target){var s=Tt(t,-1,a[1].Target.replace(/#.*$/,""),ft.HLINK);Se(n,494,XF(a,s))}}),delete e["!links"]}function g6(n,e,t,a){if(e["!comments"].length>0){var s=Tt(a,-1,"../drawings/vmlDrawing"+(t+1)+".vml",ft.VML);Se(n,551,Cm("rId"+s)),e["!legacy"]=s}}function m6(n,e,t,a){if(e["!autofilter"]){var s=e["!autofilter"],l=typeof s.ref=="string"?s.ref:en(s.ref);t.Workbook||(t.Workbook={Sheets:[]}),t.Workbook.Names||(t.Workbook.Names=[]);var c=t.Workbook.Names,h=Ar(l);h.s.r==h.e.r&&(h.e.r=Ar(e["!ref"]).e.r,l=en(h));for(var d=0;d<c.length;++d){var g=c[d];if(g.Name=="_xlnm._FilterDatabase"&&g.Sheet==a){g.Ref="'"+t.SheetNames[a]+"'!"+l;break}}d==c.length&&c.push({Name:"_xlnm._FilterDatabase",Sheet:a,Ref:"'"+t.SheetNames[a]+"'!"+l}),Se(n,161,wo(Ut(l))),Se(n,162)}}function p6(n,e,t){Se(n,133),Se(n,137,r6(e,t)),Se(n,138),Se(n,134)}function v6(n,e){e["!protect"]&&Se(n,535,i6(e["!protect"]))}function y6(n,e,t,a){var s=ar(),l=t.SheetNames[n],c=t.Sheets[l]||{},h=l;try{t&&t.Workbook&&(h=t.Workbook.Sheets[n].CodeName||h)}catch{}var d=Ut(c["!ref"]||"A1");if(d.e.c>16383||d.e.r>1048575){if(e.WTF)throw new Error("Range "+(c["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");d.e.c=Math.min(d.e.c,16383),d.e.r=Math.min(d.e.c,1048575)}return c["!links"]=[],c["!comments"]=[],Se(s,129),(t.vbaraw||c["!outline"])&&Se(s,147,hF(h,c["!outline"])),Se(s,148,lF(d)),p6(s,c,t.Workbook),h6(s,c),c6(s,c,n,e),v6(s,c),m6(s,c,t,n),u6(s,c),d6(s,c,a),c["!margins"]&&Se(s,476,t6(c["!margins"])),(!e||e.ignoreEC||e.ignoreEC==null)&&f6(s,c),g6(s,c,n,a),Se(s,130),s.end()}function T6(n,e){n.l+=10;var t=Bn(n);return{name:t}}var _6=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]];function x6(n){return!n.Workbook||!n.Workbook.WBProps?"false":J4(n.Workbook.WBProps.date1904)?"true":"false"}var S6="][*?/\\".split("");function KC(n,e){if(n.length>31)throw new Error("Sheet names cannot exceed 31 chars");var t=!0;return S6.forEach(function(a){if(n.indexOf(a)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),t}function C6(n,e,t){n.forEach(function(a,s){KC(a);for(var l=0;l<s;++l)if(a==n[l])throw new Error("Duplicate Sheet Name: "+a);if(t){var c=e&&e[s]&&e[s].CodeName||a;if(c.charCodeAt(0)==95&&c.length>22)throw new Error("Bad Code Name: Worksheet"+c)}})}function E6(n){if(!n||!n.SheetNames||!n.Sheets)throw new Error("Invalid Workbook");if(!n.SheetNames.length)throw new Error("Workbook is empty");var e=n.Workbook&&n.Workbook.Sheets||[];C6(n.SheetNames,e,!!n.vbaraw);for(var t=0;t<n.SheetNames.length;++t)VP(n.Sheets[n.SheetNames[t]],n.SheetNames[t],t)}function VC(n){var e=[tn];e[e.length]=Ne("workbook",null,{xmlns:Eo[0],"xmlns:r":mn.r});var t=n.Workbook&&(n.Workbook.Names||[]).length>0,a={codeName:"ThisWorkbook"};n.Workbook&&n.Workbook.WBProps&&(_6.forEach(function(h){n.Workbook.WBProps[h[0]]!=null&&n.Workbook.WBProps[h[0]]!=h[1]&&(a[h[0]]=n.Workbook.WBProps[h[0]])}),n.Workbook.WBProps.CodeName&&(a.codeName=n.Workbook.WBProps.CodeName,delete a.CodeName)),e[e.length]=Ne("workbookPr",null,a);var s=n.Workbook&&n.Workbook.Sheets||[],l=0;if(s&&s[0]&&s[0].Hidden){for(e[e.length]="<bookViews>",l=0;l!=n.SheetNames.length&&!(!s[l]||!s[l].Hidden);++l);l==n.SheetNames.length&&(l=0),e[e.length]='<workbookView firstSheet="'+l+'" activeTab="'+l+'"/>',e[e.length]="</bookViews>"}for(e[e.length]="<sheets>",l=0;l!=n.SheetNames.length;++l){var c={name:xt(n.SheetNames[l].slice(0,31))};if(c.sheetId=""+(l+1),c["r:id"]="rId"+(l+1),s[l])switch(s[l].Hidden){case 1:c.state="hidden";break;case 2:c.state="veryHidden";break}e[e.length]=Ne("sheet",null,c)}return e[e.length]="</sheets>",t&&(e[e.length]="<definedNames>",n.Workbook&&n.Workbook.Names&&n.Workbook.Names.forEach(function(h){var d={name:h.Name};h.Comment&&(d.comment=h.Comment),h.Sheet!=null&&(d.localSheetId=""+h.Sheet),h.Hidden&&(d.hidden="1"),h.Ref&&(e[e.length]=Ne("definedName",xt(h.Ref),d))}),e[e.length]="</definedNames>"),e.length>2&&(e[e.length]="</workbook>",e[1]=e[1].replace("/>",">")),e.join("")}function A6(n,e){var t={};return t.Hidden=n.read_shift(4),t.iTabID=n.read_shift(4),t.strRelID=J0(n),t.name=Bn(n),t}function w6(n,e){return e||(e=ge(127)),e.write_shift(4,n.Hidden),e.write_shift(4,n.iTabID),Cm(n.strRelID,e),vn(n.name.slice(0,31),e),e.length>e.l?e.slice(0,e.l):e}function b6(n,e){var t={},a=n.read_shift(4);t.defaultThemeVersion=n.read_shift(4);var s=e>8?Bn(n):"";return s.length>0&&(t.CodeName=s),t.autoCompressPictures=!!(a&65536),t.backupFile=!!(a&64),t.checkCompatibility=!!(a&4096),t.date1904=!!(a&1),t.filterPrivacy=!!(a&8),t.hidePivotFieldList=!!(a&1024),t.promptedSolutions=!!(a&16),t.publishItems=!!(a&2048),t.refreshAllConnections=!!(a&262144),t.saveExternalLinkValues=!!(a&128),t.showBorderUnselectedTables=!!(a&4),t.showInkAnnotation=!!(a&32),t.showObjects=["all","placeholders","none"][a>>13&3],t.showPivotChartFilter=!!(a&32768),t.updateLinks=["userSet","never","always"][a>>8&3],t}function I6(n,e){e||(e=ge(72));var t=0;return n&&n.filterPrivacy&&(t|=8),e.write_shift(4,t),e.write_shift(4,0),aC(n&&n.CodeName||"ThisWorkbook",e),e.slice(0,e.l)}function R6(n,e,t){var a=n.l+e;n.l+=4,n.l+=1;var s=n.read_shift(4),l=xM(n),c=HP(n,0,t),h=Sm(n);n.l=a;var d={Name:l,Ptg:c};return s<268435455&&(d.Sheet=s),h&&(d.Comment=h),d}function N6(n,e){Se(n,143);for(var t=0;t!=e.SheetNames.length;++t){var a=e.Workbook&&e.Workbook.Sheets&&e.Workbook.Sheets[t]&&e.Workbook.Sheets[t].Hidden||0,s={Hidden:a,iTabID:t+1,strRelID:"rId"+(t+1),name:e.SheetNames[t]};Se(n,156,w6(s))}Se(n,144)}function k6(n,e){e||(e=ge(127));for(var t=0;t!=4;++t)e.write_shift(4,0);return vn("SheetJS",e),vn(ph.version,e),vn(ph.version,e),vn("7262",e),e.length>e.l?e.slice(0,e.l):e}function O6(n,e){e||(e=ge(29)),e.write_shift(-4,0),e.write_shift(-4,460),e.write_shift(4,28800),e.write_shift(4,17600),e.write_shift(4,500),e.write_shift(4,n),e.write_shift(4,n);var t=120;return e.write_shift(1,t),e.length>e.l?e.slice(0,e.l):e}function M6(n,e){if(!(!e.Workbook||!e.Workbook.Sheets)){for(var t=e.Workbook.Sheets,a=0,s=-1,l=-1;a<t.length;++a)!t[a]||!t[a].Hidden&&s==-1?s=a:t[a].Hidden==1&&l==-1&&(l=a);l>s||(Se(n,135),Se(n,158,O6(s)),Se(n,136))}}function D6(n,e){var t=ar();return Se(t,131),Se(t,128,k6()),Se(t,153,I6(n.Workbook&&n.Workbook.WBProps||null)),M6(t,n),N6(t,n),Se(t,132),t.end()}function P6(n,e,t){return(e.slice(-4)===".bin"?D6:VC)(n)}function F6(n,e,t,a,s){return(e.slice(-4)===".bin"?y6:GC)(n,t,a,s)}function L6(n,e,t){return(e.slice(-4)===".bin"?tD:IC)(n,t)}function U6(n,e,t){return(e.slice(-4)===".bin"?I3:EC)(n,t)}function B6(n,e,t){return(e.slice(-4)===".bin"?vD:MC)(n)}function H6(n){return(n.slice(-4)===".bin"?cD:kC)()}function j6(n,e){var t=[];return n.Props&&t.push(LM(n.Props,e)),n.Custprops&&t.push(UM(n.Props,n.Custprops)),t.join("")}function z6(){return""}function G6(n,e){var t=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return e.cellXfs.forEach(function(a,s){var l=[];l.push(Ne("NumberFormat",null,{"ss:Format":xt(qt[a.numFmtId])}));var c={"ss:ID":"s"+(21+s)};t.push(Ne("Style",l.join(""),c))}),Ne("Styles",t.join(""))}function qC(n){return Ne("NamedRange",null,{"ss:Name":n.Name,"ss:RefersTo":"="+bm(n.Ref,{r:0,c:0})})}function $6(n){if(!((n||{}).Workbook||{}).Names)return"";for(var e=n.Workbook.Names,t=[],a=0;a<e.length;++a){var s=e[a];s.Sheet==null&&(s.Name.match(/^_xlfn\./)||t.push(qC(s)))}return Ne("Names",t.join(""))}function K6(n,e,t,a){if(!n||!((a||{}).Workbook||{}).Names)return"";for(var s=a.Workbook.Names,l=[],c=0;c<s.length;++c){var h=s[c];h.Sheet==t&&(h.Name.match(/^_xlfn\./)||l.push(qC(h)))}return l.join("")}function V6(n,e,t,a){if(!n)return"";var s=[];if(n["!margins"]&&(s.push("<PageSetup>"),n["!margins"].header&&s.push(Ne("Header",null,{"x:Margin":n["!margins"].header})),n["!margins"].footer&&s.push(Ne("Footer",null,{"x:Margin":n["!margins"].footer})),s.push(Ne("PageMargins",null,{"x:Bottom":n["!margins"].bottom||"0.75","x:Left":n["!margins"].left||"0.7","x:Right":n["!margins"].right||"0.7","x:Top":n["!margins"].top||"0.75"})),s.push("</PageSetup>")),a&&a.Workbook&&a.Workbook.Sheets&&a.Workbook.Sheets[t])if(a.Workbook.Sheets[t].Hidden)s.push(Ne("Visible",a.Workbook.Sheets[t].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var l=0;l<t&&!(a.Workbook.Sheets[l]&&!a.Workbook.Sheets[l].Hidden);++l);l==t&&s.push("<Selected/>")}return((((a||{}).Workbook||{}).Views||[])[0]||{}).RTL&&s.push("<DisplayRightToLeft/>"),n["!protect"]&&(s.push(Rn("ProtectContents","True")),n["!protect"].objects&&s.push(Rn("ProtectObjects","True")),n["!protect"].scenarios&&s.push(Rn("ProtectScenarios","True")),n["!protect"].selectLockedCells!=null&&!n["!protect"].selectLockedCells?s.push(Rn("EnableSelection","NoSelection")):n["!protect"].selectUnlockedCells!=null&&!n["!protect"].selectUnlockedCells&&s.push(Rn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(c){n["!protect"][c[0]]&&s.push("<"+c[1]+"/>")})),s.length==0?"":Ne("WorksheetOptions",s.join(""),{xmlns:xr.x})}function q6(n){return n.map(function(e){var t=Q4(e.t||""),a=Ne("ss:Data",t,{xmlns:"http://www.w3.org/TR/REC-html40"});return Ne("Comment",a,{"ss:Author":e.a})}).join("")}function Y6(n,e,t,a,s,l,c){if(!n||n.v==null&&n.f==null)return"";var h={};if(n.f&&(h["ss:Formula"]="="+xt(bm(n.f,c))),n.F&&n.F.slice(0,e.length)==e){var d=pn(n.F.slice(e.length+1));h["ss:ArrayRange"]="RC:R"+(d.r==c.r?"":"["+(d.r-c.r)+"]")+"C"+(d.c==c.c?"":"["+(d.c-c.c)+"]")}if(n.l&&n.l.Target&&(h["ss:HRef"]=xt(n.l.Target),n.l.Tooltip&&(h["x:HRefScreenTip"]=xt(n.l.Tooltip))),t["!merges"])for(var g=t["!merges"],p=0;p!=g.length;++p)g[p].s.c!=c.c||g[p].s.r!=c.r||(g[p].e.c>g[p].s.c&&(h["ss:MergeAcross"]=g[p].e.c-g[p].s.c),g[p].e.r>g[p].s.r&&(h["ss:MergeDown"]=g[p].e.r-g[p].s.r));var v="",_="";switch(n.t){case"z":if(!a.sheetStubs)return"";break;case"n":v="Number",_=String(n.v);break;case"b":v="Boolean",_=n.v?"1":"0";break;case"e":v="Error",_=uc[n.v];break;case"d":v="DateTime",_=new Date(n.v).toISOString(),n.z==null&&(n.z=n.z||qt[14]);break;case"s":v="String",_=W4(n.v||"");break}var T=Ni(a.cellXfs,n,a);h["ss:StyleID"]="s"+(21+T),h["ss:Index"]=c.c+1;var C=n.v!=null?_:"",x=n.t=="z"?"":'<Data ss:Type="'+v+'">'+C+"</Data>";return(n.c||[]).length>0&&(x+=q6(n.c)),Ne("Cell",x,h)}function X6(n,e){var t='<Row ss:Index="'+(n+1)+'"';return e&&(e.hpt&&!e.hpx&&(e.hpx=bC(e.hpt)),e.hpx&&(t+=' ss:AutoFitHeight="0" ss:Height="'+e.hpx+'"'),e.hidden&&(t+=' ss:Hidden="1"')),t+">"}function W6(n,e,t,a){if(!n["!ref"])return"";var s=Ut(n["!ref"]),l=n["!merges"]||[],c=0,h=[];n["!cols"]&&n["!cols"].forEach(function(A,B){Am(A);var k=!!A.width,O=rf(B,A),j={"ss:Index":B+1};k&&(j["ss:Width"]=wh(O.width)),A.hidden&&(j["ss:Hidden"]="1"),h.push(Ne("Column",null,j))});for(var d=Array.isArray(n),g=s.s.r;g<=s.e.r;++g){for(var p=[X6(g,(n["!rows"]||[])[g])],v=s.s.c;v<=s.e.c;++v){var _=!1;for(c=0;c!=l.length;++c)if(!(l[c].s.c>v)&&!(l[c].s.r>g)&&!(l[c].e.c<v)&&!(l[c].e.r<g)){(l[c].s.c!=v||l[c].s.r!=g)&&(_=!0);break}if(!_){var T={r:g,c:v},C=St(T),x=d?(n[g]||[])[v]:n[C];p.push(Y6(x,C,n,e,t,a,T))}}p.push("</Row>"),p.length>2&&h.push(p.join(""))}return h.join("")}function Q6(n,e,t){var a=[],s=t.SheetNames[n],l=t.Sheets[s],c=l?K6(l,e,n,t):"";return c.length>0&&a.push("<Names>"+c+"</Names>"),c=l?W6(l,e,n,t):"",c.length>0&&a.push("<Table>"+c+"</Table>"),a.push(V6(l,e,n,t)),a.join("")}function J6(n,e){e||(e={}),n.SSF||(n.SSF=or(qt)),n.SSF&&(Jh(),Qh(n.SSF),e.revssf=Zh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF,e.cellXfs=[],Ni(e.cellXfs,{},{revssf:{General:0}}));var t=[];t.push(j6(n,e)),t.push(z6()),t.push(""),t.push("");for(var a=0;a<n.SheetNames.length;++a)t.push(Ne("Worksheet",Q6(a,e,n),{"ss:Name":xt(n.SheetNames[a])}));return t[2]=G6(n,e),t[3]=$6(n),tn+Ne("Workbook",t.join(""),{xmlns:xr.ss,"xmlns:o":xr.o,"xmlns:x":xr.x,"xmlns:ss":xr.ss,"xmlns:dt":xr.dt,"xmlns:html":xr.html})}var R0={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function Z6(n,e){var t=[],a=[],s=[],l=0,c,h=ET(LT,"n"),d=ET(UT,"n");if(n.Props)for(c=kn(n.Props),l=0;l<c.length;++l)(Object.prototype.hasOwnProperty.call(h,c[l])?t:Object.prototype.hasOwnProperty.call(d,c[l])?a:s).push([c[l],n.Props[c[l]]]);if(n.Custprops)for(c=kn(n.Custprops),l=0;l<c.length;++l)Object.prototype.hasOwnProperty.call(n.Props||{},c[l])||(Object.prototype.hasOwnProperty.call(h,c[l])?t:Object.prototype.hasOwnProperty.call(d,c[l])?a:s).push([c[l],n.Custprops[c[l]]]);var g=[];for(l=0;l<s.length;++l)vC.indexOf(s[l][0])>-1||gC.indexOf(s[l][0])>-1||s[l][1]!=null&&g.push(s[l]);a.length&&Rt.utils.cfb_add(e,"/SummaryInformation",GT(a,R0.SI,d,UT)),(t.length||g.length)&&Rt.utils.cfb_add(e,"/DocumentSummaryInformation",GT(t,R0.DSI,h,LT,g.length?g:null,R0.UDI))}function eL(n,e){var t=e||{},a=Rt.utils.cfb_new({root:"R"}),s="/Workbook";switch(t.bookType||"xls"){case"xls":t.bookType="biff8";case"xla":t.bookType||(t.bookType="xla");case"biff8":s="/Workbook",t.biff=8;break;case"biff5":s="/Book",t.biff=5;break;default:throw new Error("invalid type "+t.bookType+" for XLS CFB")}return Rt.utils.cfb_add(a,s,YC(n,t)),t.biff==8&&(n.Props||n.Custprops)&&Z6(n,a),t.biff==8&&n.vbaraw&&yD(a,Rt.read(n.vbaraw,{type:typeof n.vbaraw=="string"?"binary":"buffer"})),a}var tL={0:{f:aF},1:{f:fF},2:{f:OF},3:{f:_F},4:{f:pF},5:{f:IF},6:{f:LF},7:{f:EF},8:{f:$F},9:{f:GF},10:{f:jF},11:{f:zF},12:{f:gF},13:{f:DF},14:{f:SF},15:{f:yF},16:{f:NF},17:{f:BF},18:{f:wF},19:{f:xm},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:R6},40:{},42:{},43:{f:L3},44:{f:P3},45:{f:H3},46:{f:z3},47:{f:j3},48:{},49:{f:gM},50:{},51:{f:aD},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:m3},62:{f:FF},63:{f:uD},64:{f:s6},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:ya,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:n6},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:uF},148:{f:oF,p:16},151:{f:WF},152:{},153:{f:b6},154:{},155:{},156:{f:A6},157:{},158:{},159:{T:1,f:A3},160:{T:-1},161:{T:1,f:ps},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:KF},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:nD},336:{T:-1},337:{f:oD,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:J0},357:{},358:{},359:{},360:{T:1},361:{},362:{f:c3},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:QF},427:{f:JF},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:e6},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:cF},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:YF},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:J0},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:mD},633:{T:1},634:{T:-1},635:{T:1,f:dD},636:{T:-1},637:{f:yM},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:T6},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:o6},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}};function Oe(n,e,t,a){var s=e;if(!isNaN(s)){var l=a||(t||[]).length||0,c=n.next(4);c.write_shift(2,s),c.write_shift(2,l),l>0&&ym(t)&&n.push(t)}}function nL(n,e,t,a){var s=(t||[]).length||0;if(s<=8224)return Oe(n,e,t,s);var l=e;if(!isNaN(l)){for(var c=t.parts||[],h=0,d=0,g=0;g+(c[h]||8224)<=8224;)g+=c[h]||8224,h++;var p=n.next(4);for(p.write_shift(2,l),p.write_shift(2,g),n.push(t.slice(d,d+g)),d+=g;d<s;){for(p=n.next(4),p.write_shift(2,60),g=0;g+(c[h]||8224)<=8224;)g+=c[h]||8224,h++;p.write_shift(2,g),n.push(t.slice(d,d+g)),d+=g}}}function fc(n,e,t){return n||(n=ge(7)),n.write_shift(2,e),n.write_shift(2,t),n.write_shift(2,0),n.write_shift(1,0),n}function rL(n,e,t,a){var s=ge(9);return fc(s,n,e),TC(t,a||"b",s),s}function aL(n,e,t){var a=ge(8+2*t.length);return fc(a,n,e),a.write_shift(1,t.length),a.write_shift(t.length,t,"sbcs"),a.l<a.length?a.slice(0,a.l):a}function iL(n,e,t,a){if(e.v!=null)switch(e.t){case"d":case"n":var s=e.t=="d"?sr(Qn(e.v)):e.v;s==(s|0)&&s>=0&&s<65536?Oe(n,2,T3(t,a,s)):Oe(n,3,y3(t,a,s));return;case"b":case"e":Oe(n,5,rL(t,a,e.v,e.t));return;case"s":case"str":Oe(n,4,aL(t,a,(e.v||"").slice(0,255)));return}Oe(n,1,fc(null,t,a))}function sL(n,e,t,a){var s=Array.isArray(e),l=Ut(e["!ref"]||"A1"),c,h="",d=[];if(l.e.c>255||l.e.r>16383){if(a.WTF)throw new Error("Range "+(e["!ref"]||"A1")+" exceeds format limit A1:IV16384");l.e.c=Math.min(l.e.c,255),l.e.r=Math.min(l.e.c,16383),c=en(l)}for(var g=l.s.r;g<=l.e.r;++g){h=Nn(g);for(var p=l.s.c;p<=l.e.c;++p){g===l.s.r&&(d[p]=Un(p)),c=d[p]+h;var v=s?(e[g]||[])[p]:e[c];v&&iL(n,v,g,p)}}}function oL(n,e){for(var t=e||{},a=ar(),s=0,l=0;l<n.SheetNames.length;++l)n.SheetNames[l]==t.sheet&&(s=l);if(s==0&&t.sheet&&n.SheetNames[0]!=t.sheet)throw new Error("Sheet not found: "+t.sheet);return Oe(a,t.biff==4?1033:t.biff==3?521:9,Em(n,16,t)),sL(a,n.Sheets[n.SheetNames[s]],s,t),Oe(a,10),a.end()}function lL(n,e,t){Oe(n,49,t3({sz:12,name:"Arial"},t))}function cL(n,e,t){e&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(a){for(var s=a[0];s<=a[1];++s)e[s]!=null&&Oe(n,1054,a3(s,e[s],t))})}function uL(n,e){var t=ge(19);t.write_shift(4,2151),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,1),t.write_shift(4,0),Oe(n,2151,t),t=ge(39),t.write_shift(4,2152),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(2,3),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(2,1),t.write_shift(4,4),t.write_shift(2,0),SC(Ut(e["!ref"]||"A1"),t),t.write_shift(4,4),Oe(n,2152,t)}function hL(n,e){for(var t=0;t<16;++t)Oe(n,224,KT({numFmtId:0,style:!0},0,e));e.cellXfs.forEach(function(a){Oe(n,224,KT(a,0,e))})}function fL(n,e){for(var t=0;t<e["!links"].length;++t){var a=e["!links"][t];Oe(n,440,f3(a)),a[1].Tooltip&&Oe(n,2048,d3(a))}delete e["!links"]}function dL(n,e){if(e){var t=0;e.forEach(function(a,s){++t<=256&&a&&Oe(n,125,p3(rf(s,a),s))})}}function gL(n,e,t,a,s){var l=16+Ni(s.cellXfs,e,s);if(e.v==null&&!e.bf){Oe(n,513,us(t,a,l));return}if(e.bf)Oe(n,6,UP(e,t,a,s,l));else switch(e.t){case"d":case"n":var c=e.t=="d"?sr(Qn(e.v)):e.v;Oe(n,515,l3(t,a,c,l));break;case"b":case"e":Oe(n,517,o3(t,a,e.v,l,s,e.t));break;case"s":case"str":if(s.bookSST){var h=Rm(s.Strings,e.v,s.revStrings);Oe(n,253,n3(t,a,h,l))}else Oe(n,516,r3(t,a,(e.v||"").slice(0,255),l,s));break;default:Oe(n,513,us(t,a,l))}}function mL(n,e,t){var a=ar(),s=t.SheetNames[n],l=t.Sheets[s]||{},c=(t||{}).Workbook||{},h=(c.Sheets||[])[n]||{},d=Array.isArray(l),g=e.biff==8,p,v="",_=[],T=Ut(l["!ref"]||"A1"),C=g?65536:16384;if(T.e.c>255||T.e.r>=C){if(e.WTF)throw new Error("Range "+(l["!ref"]||"A1")+" exceeds format limit A1:IV16384");T.e.c=Math.min(T.e.c,255),T.e.r=Math.min(T.e.c,C-1)}Oe(a,2057,Em(t,16,e)),Oe(a,13,Ur(1)),Oe(a,12,Ur(100)),Oe(a,15,Xn(!0)),Oe(a,17,Xn(!1)),Oe(a,16,cs(.001)),Oe(a,95,Xn(!0)),Oe(a,42,Xn(!1)),Oe(a,43,Xn(!1)),Oe(a,130,Ur(1)),Oe(a,128,s3()),Oe(a,131,Xn(!1)),Oe(a,132,Xn(!1)),g&&dL(a,l["!cols"]),Oe(a,512,i3(T,e)),g&&(l["!links"]=[]);for(var x=T.s.r;x<=T.e.r;++x){v=Nn(x);for(var A=T.s.c;A<=T.e.c;++A){x===T.s.r&&(_[A]=Un(A)),p=_[A]+v;var B=d?(l[x]||[])[A]:l[p];B&&(gL(a,B,x,A,e),g&&B.l&&l["!links"].push([p,B.l]))}}var k=h.CodeName||h.name||s;return g&&Oe(a,574,e3((c.Views||[])[0])),g&&(l["!merges"]||[]).length&&Oe(a,229,h3(l["!merges"])),g&&fL(a,l),Oe(a,442,xC(k)),g&&uL(a,l),Oe(a,10),a.end()}function pL(n,e,t){var a=ar(),s=(n||{}).Workbook||{},l=s.Sheets||[],c=s.WBProps||{},h=t.biff==8,d=t.biff==5;if(Oe(a,2057,Em(n,5,t)),t.bookType=="xla"&&Oe(a,135),Oe(a,225,h?Ur(1200):null),Oe(a,193,jM(2)),d&&Oe(a,191),d&&Oe(a,192),Oe(a,226),Oe(a,92,WM("SheetJS",t)),Oe(a,66,Ur(h?1200:1252)),h&&Oe(a,353,Ur(0)),h&&Oe(a,448),Oe(a,317,v3(n.SheetNames.length)),h&&n.vbaraw&&Oe(a,211),h&&n.vbaraw){var g=c.CodeName||"ThisWorkbook";Oe(a,442,xC(g))}Oe(a,156,Ur(17)),Oe(a,25,Xn(!1)),Oe(a,18,Xn(!1)),Oe(a,19,Ur(0)),h&&Oe(a,431,Xn(!1)),h&&Oe(a,444,Ur(0)),Oe(a,61,ZM()),Oe(a,64,Xn(!1)),Oe(a,141,Ur(0)),Oe(a,34,Xn(x6(n)=="true")),Oe(a,14,Xn(!0)),h&&Oe(a,439,Xn(!1)),Oe(a,218,Ur(0)),lL(a,n,t),cL(a,n.SSF,t),hL(a,t),h&&Oe(a,352,Xn(!1));var p=a.end(),v=ar();h&&Oe(v,140,g3()),h&&t.Strings&&nL(v,252,JM(t.Strings)),Oe(v,10);var _=v.end(),T=ar(),C=0,x=0;for(x=0;x<n.SheetNames.length;++x)C+=(h?12:11)+(h?2:1)*n.SheetNames[x].length;var A=p.length+C+_.length;for(x=0;x<n.SheetNames.length;++x){var B=l[x]||{};Oe(T,133,QM({pos:A,hs:B.Hidden||0,dt:0,name:n.SheetNames[x]},t)),A+=e[x].length}var k=T.end();if(C!=k.length)throw new Error("BS8 "+C+" != "+k.length);var O=[];return p.length&&O.push(p),k.length&&O.push(k),_.length&&O.push(_),In(O)}function vL(n,e){var t=e||{},a=[];n&&!n.SSF&&(n.SSF=or(qt)),n&&n.SSF&&(Jh(),Qh(n.SSF),t.revssf=Zh(n.SSF),t.revssf[n.SSF[65535]]=0,t.ssf=n.SSF),t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Nm(t),t.cellXfs=[],Ni(t.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={});for(var s=0;s<n.SheetNames.length;++s)a[a.length]=mL(s,t,n);return a.unshift(pL(n,a,t)),In(a)}function YC(n,e){for(var t=0;t<=n.SheetNames.length;++t){var a=n.Sheets[n.SheetNames[t]];if(!(!a||!a["!ref"])){var s=Ar(a["!ref"]);s.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+n.SheetNames[t]+"' extends beyond column IV (255).  Data may be lost.")}}var l=e||{};switch(l.biff||2){case 8:case 5:return vL(n,e);case 4:case 3:case 2:return oL(n,e)}throw new Error("invalid type "+l.bookType+" for BIFF")}function yL(n,e,t,a){for(var s=n["!merges"]||[],l=[],c=e.s.c;c<=e.e.c;++c){for(var h=0,d=0,g=0;g<s.length;++g)if(!(s[g].s.r>t||s[g].s.c>c)&&!(s[g].e.r<t||s[g].e.c<c)){if(s[g].s.r<t||s[g].s.c<c){h=-1;break}h=s[g].e.r-s[g].s.r+1,d=s[g].e.c-s[g].s.c+1;break}if(!(h<0)){var p=St({r:t,c}),v=a.dense?(n[t]||[])[c]:n[p],_=v&&v.v!=null&&(v.h||X4(v.w||(za(v),v.w)||""))||"",T={};h>1&&(T.rowspan=h),d>1&&(T.colspan=d),a.editable?_='<span contenteditable="true">'+_+"</span>":v&&(T["data-t"]=v&&v.t||"z",v.v!=null&&(T["data-v"]=v.v),v.z!=null&&(T["data-z"]=v.z),v.l&&(v.l.Target||"#").charAt(0)!="#"&&(_='<a href="'+v.l.Target+'">'+_+"</a>")),T.id=(a.id||"sjs")+"-"+p,l.push(Ne("td",_,T))}}var C="<tr>";return C+l.join("")+"</tr>"}var TL='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_L="</body></html>";function xL(n,e,t){var a=[];return a.join("")+"<table"+(t&&t.id?' id="'+t.id+'"':"")+">"}function XC(n,e){var t=e||{},a=t.header!=null?t.header:TL,s=t.footer!=null?t.footer:_L,l=[a],c=Ar(n["!ref"]);t.dense=Array.isArray(n),l.push(xL(n,c,t));for(var h=c.s.r;h<=c.e.r;++h)l.push(yL(n,c,h,t));return l.push("</table>"+s),l.join("")}function WC(n,e,t){var a=t||{},s=0,l=0;if(a.origin!=null)if(typeof a.origin=="number")s=a.origin;else{var c=typeof a.origin=="string"?pn(a.origin):a.origin;s=c.r,l=c.c}var h=e.getElementsByTagName("tr"),d=Math.min(a.sheetRows||1e7,h.length),g={s:{r:0,c:0},e:{r:s,c:l}};if(n["!ref"]){var p=Ar(n["!ref"]);g.s.r=Math.min(g.s.r,p.s.r),g.s.c=Math.min(g.s.c,p.s.c),g.e.r=Math.max(g.e.r,p.e.r),g.e.c=Math.max(g.e.c,p.e.c),s==-1&&(g.e.r=s=p.e.r+1)}var v=[],_=0,T=n["!rows"]||(n["!rows"]=[]),C=0,x=0,A=0,B=0,k=0,O=0;for(n["!cols"]||(n["!cols"]=[]);C<h.length&&x<d;++C){var j=h[C];if(JT(j)){if(a.display)continue;T[x]={hidden:!0}}var H=j.children;for(A=B=0;A<H.length;++A){var Y=H[A];if(!(a.display&&JT(Y))){var I=Y.hasAttribute("data-v")?Y.getAttribute("data-v"):Y.hasAttribute("v")?Y.getAttribute("v"):Z4(Y.innerHTML),G=Y.getAttribute("data-z")||Y.getAttribute("z");for(_=0;_<v.length;++_){var q=v[_];q.s.c==B+l&&q.s.r<x+s&&x+s<=q.e.r&&(B=q.e.c+1-l,_=-1)}O=+Y.getAttribute("colspan")||1,((k=+Y.getAttribute("rowspan")||1)>1||O>1)&&v.push({s:{r:x+s,c:B+l},e:{r:x+s+(k||1)-1,c:B+l+(O||1)-1}});var ie={t:"s",v:I},J=Y.getAttribute("data-t")||Y.getAttribute("t")||"";I!=null&&(I.length==0?ie.t=J||"z":a.raw||I.trim().length==0||J=="s"||(I==="TRUE"?ie={t:"b",v:!0}:I==="FALSE"?ie={t:"b",v:!1}:isNaN(Ua(I))?isNaN(tc(I).getDate())||(ie={t:"d",v:Qn(I)},a.cellDates||(ie={t:"n",v:sr(ie.v)}),ie.z=a.dateNF||qt[14]):ie={t:"n",v:Ua(I)})),ie.z===void 0&&G!=null&&(ie.z=G);var he="",Ae=Y.getElementsByTagName("A");if(Ae&&Ae.length)for(var je=0;je<Ae.length&&!(Ae[je].hasAttribute("href")&&(he=Ae[je].getAttribute("href"),he.charAt(0)!="#"));++je);he&&he.charAt(0)!="#"&&(ie.l={Target:he}),a.dense?(n[x+s]||(n[x+s]=[]),n[x+s][B+l]=ie):n[St({c:B+l,r:x+s})]=ie,g.e.c<B+l&&(g.e.c=B+l),B+=O}}++x}return v.length&&(n["!merges"]=(n["!merges"]||[]).concat(v)),g.e.r=Math.max(g.e.r,x-1+s),n["!ref"]=en(g),x>=d&&(n["!fullref"]=en((g.e.r=h.length-C+x-1+s,g))),n}function QC(n,e){var t=e||{},a=t.dense?[]:{};return WC(a,n,e)}function SL(n,e){return fs(QC(n,e),e)}function JT(n){var e="",t=CL(n);return t&&(e=t(n).getPropertyValue("display")),e||(e=n.style&&n.style.display),e==="none"}function CL(n){return n.ownerDocument.defaultView&&typeof n.ownerDocument.defaultView.getComputedStyle=="function"?n.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}var EL=(function(){var n=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),e="<office:document-styles "+rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+n+"</office:document-styles>";return function(){return tn+e}})(),ZT=(function(){var n=function(l){return xt(l).replace(/  +/g,function(c){return'<text:s text:c="'+c.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},e=`          <table:table-cell />
`,t=`          <table:covered-table-cell/>
`,a=function(l,c,h){var d=[];d.push('      <table:table table:name="'+xt(c.SheetNames[h])+`" table:style-name="ta1">
`);var g=0,p=0,v=Ar(l["!ref"]||"A1"),_=l["!merges"]||[],T=0,C=Array.isArray(l);if(l["!cols"])for(p=0;p<=v.e.c;++p)d.push("        <table:table-column"+(l["!cols"][p]?' table:style-name="co'+l["!cols"][p].ods+'"':"")+`></table:table-column>
`);var x="",A=l["!rows"]||[];for(g=0;g<v.s.r;++g)x=A[g]?' table:style-name="ro'+A[g].ods+'"':"",d.push("        <table:table-row"+x+`></table:table-row>
`);for(;g<=v.e.r;++g){for(x=A[g]?' table:style-name="ro'+A[g].ods+'"':"",d.push("        <table:table-row"+x+`>
`),p=0;p<v.s.c;++p)d.push(e);for(;p<=v.e.c;++p){var B=!1,k={},O="";for(T=0;T!=_.length;++T)if(!(_[T].s.c>p)&&!(_[T].s.r>g)&&!(_[T].e.c<p)&&!(_[T].e.r<g)){(_[T].s.c!=p||_[T].s.r!=g)&&(B=!0),k["table:number-columns-spanned"]=_[T].e.c-_[T].s.c+1,k["table:number-rows-spanned"]=_[T].e.r-_[T].s.r+1;break}if(B){d.push(t);continue}var j=St({r:g,c:p}),H=C?(l[g]||[])[p]:l[j];if(H&&H.f&&(k["table:formula"]=xt($P(H.f)),H.F&&H.F.slice(0,j.length)==j)){var Y=Ar(H.F);k["table:number-matrix-columns-spanned"]=Y.e.c-Y.s.c+1,k["table:number-matrix-rows-spanned"]=Y.e.r-Y.s.r+1}if(!H){d.push(e);continue}switch(H.t){case"b":O=H.v?"TRUE":"FALSE",k["office:value-type"]="boolean",k["office:boolean-value"]=H.v?"true":"false";break;case"n":O=H.w||String(H.v||0),k["office:value-type"]="float",k["office:value"]=H.v||0;break;case"s":case"str":O=H.v==null?"":H.v,k["office:value-type"]="string";break;case"d":O=H.w||Qn(H.v).toISOString(),k["office:value-type"]="date",k["office:date-value"]=Qn(H.v).toISOString(),k["table:style-name"]="ce1";break;default:d.push(e);continue}var I=n(O);if(H.l&&H.l.Target){var G=H.l.Target;G=G.charAt(0)=="#"?"#"+KP(G.slice(1)):G,G.charAt(0)!="#"&&!G.match(/^\w+:/)&&(G="../"+G),I=Ne("text:a",I,{"xlink:href":G.replace(/&/g,"&amp;")})}d.push("          "+Ne("table:table-cell",Ne("text:p",I,{}),k)+`
`)}d.push(`        </table:table-row>
`)}return d.push(`      </table:table>
`),d.join("")},s=function(l,c){l.push(` <office:automatic-styles>
`),l.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),l.push(`   <number:month number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:day number:style="long"/>
`),l.push(`   <number:text>/</number:text>
`),l.push(`   <number:year/>
`),l.push(`  </number:date-style>
`);var h=0;c.SheetNames.map(function(g){return c.Sheets[g]}).forEach(function(g){if(g&&g["!cols"]){for(var p=0;p<g["!cols"].length;++p)if(g["!cols"][p]){var v=g["!cols"][p];if(v.width==null&&v.wpx==null&&v.wch==null)continue;Am(v),v.ods=h;var _=g["!cols"][p].wpx+"px";l.push('  <style:style style:name="co'+h+`" style:family="table-column">
`),l.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+_+`"/>
`),l.push(`  </style:style>
`),++h}}});var d=0;c.SheetNames.map(function(g){return c.Sheets[g]}).forEach(function(g){if(g&&g["!rows"]){for(var p=0;p<g["!rows"].length;++p)if(g["!rows"][p]){g["!rows"][p].ods=d;var v=g["!rows"][p].hpx+"px";l.push('  <style:style style:name="ro'+d+`" style:family="table-row">
`),l.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+v+`"/>
`),l.push(`  </style:style>
`),++d}}}),l.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),l.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),l.push(`  </style:style>
`),l.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),l.push(` </office:automatic-styles>
`)};return function(c,h){var d=[tn],g=rc({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),p=rc({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});h.bookType=="fods"?(d.push("<office:document"+g+p+`>
`),d.push(fC().replace(/office:document-meta/g,"office:meta"))):d.push("<office:document-content"+g+`>
`),s(d,c),d.push(`  <office:body>
`),d.push(`    <office:spreadsheet>
`);for(var v=0;v!=c.SheetNames.length;++v)d.push(a(c.Sheets[c.SheetNames[v]],c,v));return d.push(`    </office:spreadsheet>
`),d.push(`  </office:body>
`),h.bookType=="fods"?d.push("</office:document>"):d.push("</office:document-content>"),d.join("")}})();function JC(n,e){if(e.bookType=="fods")return ZT(n,e);var t=gm(),a="",s=[],l=[];return a="mimetype",nt(t,a,"application/vnd.oasis.opendocument.spreadsheet"),a="content.xml",nt(t,a,ZT(n,e)),s.push([a,"text/xml"]),l.push([a,"ContentFile"]),a="styles.xml",nt(t,a,EL(n,e)),s.push([a,"text/xml"]),l.push([a,"StylesFile"]),a="meta.xml",nt(t,a,tn+fC()),s.push([a,"text/xml"]),l.push([a,"MetadataFile"]),a="manifest.rdf",nt(t,a,FM(l)),s.push([a,"application/rdf+xml"]),a="META-INF/manifest.xml",nt(t,a,DM(s)),t}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Rh(n){return new DataView(n.buffer,n.byteOffset,n.byteLength)}function AL(n){return typeof TextEncoder<"u"?new TextEncoder().encode(n):Wr(nc(n))}function wL(n,e){e:for(var t=0;t<=n.length-e.length;++t){for(var a=0;a<e.length;++a)if(n[t+a]!=e[a])continue e;return!0}return!1}function Ii(n){var e=n.reduce(function(s,l){return s+l.length},0),t=new Uint8Array(e),a=0;return n.forEach(function(s){t.set(s,a),a+=s.length}),t}function bL(n,e,t){var a=Math.floor(t==0?0:Math.LOG10E*Math.log(Math.abs(t)))+6176-20,s=t/Math.pow(10,a-6176);n[e+15]|=a>>7,n[e+14]|=(a&127)<<1;for(var l=0;s>=1;++l,s/=256)n[e+l]=s&255;n[e+15]|=t>=0?0:128}function ac(n,e){var t=e?e[0]:0,a=n[t]&127;e:if(n[t++]>=128&&(a|=(n[t]&127)<<7,n[t++]<128||(a|=(n[t]&127)<<14,n[t++]<128)||(a|=(n[t]&127)<<21,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,28),++t,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,35),++t,n[t++]<128)||(a+=(n[t]&127)*Math.pow(2,42),++t,n[t++]<128)))break e;return e&&(e[0]=t),a}function yt(n){var e=new Uint8Array(7);e[0]=n&127;var t=1;e:if(n>127){if(e[t-1]|=128,e[t]=n>>7&127,++t,n<=16383||(e[t-1]|=128,e[t]=n>>14&127,++t,n<=2097151)||(e[t-1]|=128,e[t]=n>>21&127,++t,n<=268435455)||(e[t-1]|=128,e[t]=n/256>>>21&127,++t,n<=34359738367)||(e[t-1]|=128,e[t]=n/65536>>>21&127,++t,n<=4398046511103))break e;e[t-1]|=128,e[t]=n/16777216>>>21&127,++t}return e.slice(0,t)}function go(n){var e=0,t=n[e]&127;e:if(n[e++]>=128){if(t|=(n[e]&127)<<7,n[e++]<128||(t|=(n[e]&127)<<14,n[e++]<128)||(t|=(n[e]&127)<<21,n[e++]<128))break e;t|=(n[e]&127)<<28}return t}function an(n){for(var e=[],t=[0];t[0]<n.length;){var a=t[0],s=ac(n,t),l=s&7;s=Math.floor(s/8);var c=0,h;if(s==0)break;switch(l){case 0:{for(var d=t[0];n[t[0]++]>=128;);h=n.slice(d,t[0])}break;case 5:c=4,h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 1:c=8,h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 2:c=ac(n,t),h=n.slice(t[0],t[0]+c),t[0]+=c;break;case 3:case 4:default:throw new Error("PB Type ".concat(l," for Field ").concat(s," at offset ").concat(a))}var g={data:h,type:l};e[s]==null?e[s]=[g]:e[s].push(g)}return e}function An(n){var e=[];return n.forEach(function(t,a){t.forEach(function(s){s.data&&(e.push(yt(a*8+s.type)),s.type==2&&e.push(yt(s.data.length)),e.push(s.data))})}),Ii(e)}function qr(n){for(var e,t=[],a=[0];a[0]<n.length;){var s=ac(n,a),l=an(n.slice(a[0],a[0]+s));a[0]+=s;var c={id:go(l[1][0].data),messages:[]};l[2].forEach(function(h){var d=an(h.data),g=go(d[3][0].data);c.messages.push({meta:d,data:n.slice(a[0],a[0]+g)}),a[0]+=g}),(e=l[3])!=null&&e[0]&&(c.merge=go(l[3][0].data)>>>0>0),t.push(c)}return t}function eo(n){var e=[];return n.forEach(function(t){var a=[];a[1]=[{data:yt(t.id),type:0}],a[2]=[],t.merge!=null&&(a[3]=[{data:yt(+!!t.merge),type:0}]);var s=[];t.messages.forEach(function(c){s.push(c.data),c.meta[3]=[{type:0,data:yt(c.data.length)}],a[2].push({data:An(c.meta),type:2})});var l=An(a);e.push(yt(l.length)),e.push(l),s.forEach(function(c){return e.push(c)})}),Ii(e)}function IL(n,e){if(n!=0)throw new Error("Unexpected Snappy chunk type ".concat(n));for(var t=[0],a=ac(e,t),s=[];t[0]<e.length;){var l=e[t[0]]&3;if(l==0){var c=e[t[0]++]>>2;if(c<60)++c;else{var h=c-59;c=e[t[0]],h>1&&(c|=e[t[0]+1]<<8),h>2&&(c|=e[t[0]+2]<<16),h>3&&(c|=e[t[0]+3]<<24),c>>>=0,c++,t[0]+=h}s.push(e.slice(t[0],t[0]+c)),t[0]+=c;continue}else{var d=0,g=0;if(l==1?(g=(e[t[0]]>>2&7)+4,d=(e[t[0]++]&224)<<3,d|=e[t[0]++]):(g=(e[t[0]++]>>2)+1,l==2?(d=e[t[0]]|e[t[0]+1]<<8,t[0]+=2):(d=(e[t[0]]|e[t[0]+1]<<8|e[t[0]+2]<<16|e[t[0]+3]<<24)>>>0,t[0]+=4)),s=[Ii(s)],d==0)throw new Error("Invalid offset 0");if(d>s[0].length)throw new Error("Invalid offset beyond length");if(g>=d)for(s.push(s[0].slice(-d)),g-=d;g>=s[s.length-1].length;)s.push(s[s.length-1]),g-=s[s.length-1].length;s.push(s[0].slice(-d,-d+g))}}var p=Ii(s);if(p.length!=a)throw new Error("Unexpected length: ".concat(p.length," != ").concat(a));return p}function Yr(n){for(var e=[],t=0;t<n.length;){var a=n[t++],s=n[t]|n[t+1]<<8|n[t+2]<<16;t+=3,e.push(IL(a,n.slice(t,t+s))),t+=s}if(t!==n.length)throw new Error("data is not a valid framed stream!");return Ii(e)}function to(n){for(var e=[],t=0;t<n.length;){var a=Math.min(n.length-t,268435455),s=new Uint8Array(4);e.push(s);var l=yt(a),c=l.length;e.push(l),a<=60?(c++,e.push(new Uint8Array([a-1<<2]))):a<=256?(c+=2,e.push(new Uint8Array([240,a-1&255]))):a<=65536?(c+=3,e.push(new Uint8Array([244,a-1&255,a-1>>8&255]))):a<=16777216?(c+=4,e.push(new Uint8Array([248,a-1&255,a-1>>8&255,a-1>>16&255]))):a<=4294967296&&(c+=5,e.push(new Uint8Array([252,a-1&255,a-1>>8&255,a-1>>16&255,a-1>>>24&255]))),e.push(n.slice(t,t+a)),c+=a,s[0]=0,s[1]=c&255,s[2]=c>>8&255,s[3]=c>>16&255,t+=a}return Ii(e)}function N0(n,e){var t=new Uint8Array(32),a=Rh(t),s=12,l=0;switch(t[0]=5,n.t){case"n":t[1]=2,bL(t,s,n.v),l|=1,s+=16;break;case"b":t[1]=6,a.setFloat64(s,n.v?1:0,!0),l|=2,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[1]=3,a.setUint32(s,e.indexOf(n.v),!0),l|=8,s+=4;break;default:throw"unsupported cell type "+n.t}return a.setUint32(8,l,!0),t.slice(0,s)}function k0(n,e){var t=new Uint8Array(32),a=Rh(t),s=12,l=0;switch(t[0]=3,n.t){case"n":t[2]=2,a.setFloat64(s,n.v,!0),l|=32,s+=8;break;case"b":t[2]=6,a.setFloat64(s,n.v?1:0,!0),l|=32,s+=8;break;case"s":if(e.indexOf(n.v)==-1)throw new Error("Value ".concat(n.v," missing from SST!"));t[2]=3,a.setUint32(s,e.indexOf(n.v),!0),l|=16,s+=4;break;default:throw"unsupported cell type "+n.t}return a.setUint32(4,l,!0),t.slice(0,s)}function gi(n){var e=an(n);return ac(e[1][0].data)}function RL(n,e,t){var a,s,l,c;if(!((a=n[6])!=null&&a[0])||!((s=n[7])!=null&&s[0]))throw"Mutation only works on post-BNC storages!";var h=((c=(l=n[8])==null?void 0:l[0])==null?void 0:c.data)&&go(n[8][0].data)>0||!1;if(h)throw"Math only works with normal offsets";for(var d=0,g=Rh(n[7][0].data),p=0,v=[],_=Rh(n[4][0].data),T=0,C=[],x=0;x<e.length;++x){if(e[x]==null){g.setUint16(x*2,65535,!0),_.setUint16(x*2,65535);continue}g.setUint16(x*2,p,!0),_.setUint16(x*2,T,!0);var A,B;switch(typeof e[x]){case"string":A=N0({t:"s",v:e[x]},t),B=k0({t:"s",v:e[x]},t);break;case"number":A=N0({t:"n",v:e[x]},t),B=k0({t:"n",v:e[x]},t);break;case"boolean":A=N0({t:"b",v:e[x]},t),B=k0({t:"b",v:e[x]},t);break;default:throw new Error("Unsupported value "+e[x])}v.push(A),p+=A.length,C.push(B),T+=B.length,++d}for(n[2][0].data=yt(d);x<n[7][0].data.length/2;++x)g.setUint16(x*2,65535,!0),_.setUint16(x*2,65535,!0);return n[6][0].data=Ii(v),n[3][0].data=Ii(C),d}function NL(n,e){if(!e||!e.numbers)throw new Error("Must pass a `numbers` option -- check the README");var t=n.Sheets[n.SheetNames[0]];n.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var a=Ar(t["!ref"]);a.s.r=a.s.c=0;var s=!1;a.e.c>9&&(s=!0,a.e.c=9),a.e.r>49&&(s=!0,a.e.r=49),s&&console.error("The Numbers writer is currently limited to ".concat(en(a)));var l=Nh(t,{range:a,header:1}),c=["~Sh33tJ5~"];l.forEach(function(L){return L.forEach(function(P){typeof P=="string"&&c.push(P)})});var h={},d=[],g=Rt.read(e.numbers,{type:"base64"});g.FileIndex.map(function(L,P){return[L,g.FullPaths[P]]}).forEach(function(L){var P=L[0],K=L[1];if(P.type==2&&P.name.match(/\.iwa/)){var Z=P.content,be=Yr(Z),Ce=qr(be);Ce.forEach(function(Pe){d.push(Pe.id),h[Pe.id]={deps:[],location:K,type:go(Pe.messages[0].meta[1][0].data)}})}}),d.sort(function(L,P){return L-P});var p=d.filter(function(L){return L>1}).map(function(L){return[L,yt(L)]});g.FileIndex.map(function(L,P){return[L,g.FullPaths[P]]}).forEach(function(L){var P=L[0];if(L[1],!!P.name.match(/\.iwa/)){var K=qr(Yr(P.content));K.forEach(function(Z){Z.messages.forEach(function(be){p.forEach(function(Ce){Z.messages.some(function(Pe){return go(Pe.meta[1][0].data)!=11006&&wL(Pe.data,Ce[1])})&&h[Ce[0]].deps.push(Z.id)})})})}});for(var v=Rt.find(g,h[1].location),_=qr(Yr(v.content)),T,C=0;C<_.length;++C){var x=_[C];x.id==1&&(T=x)}var A=gi(an(T.messages[0].data)[1][0].data);for(v=Rt.find(g,h[A].location),_=qr(Yr(v.content)),C=0;C<_.length;++C)x=_[C],x.id==A&&(T=x);for(A=gi(an(T.messages[0].data)[2][0].data),v=Rt.find(g,h[A].location),_=qr(Yr(v.content)),C=0;C<_.length;++C)x=_[C],x.id==A&&(T=x);for(A=gi(an(T.messages[0].data)[2][0].data),v=Rt.find(g,h[A].location),_=qr(Yr(v.content)),C=0;C<_.length;++C)x=_[C],x.id==A&&(T=x);var B=an(T.messages[0].data);{B[6][0].data=yt(a.e.r+1),B[7][0].data=yt(a.e.c+1);var k=gi(B[46][0].data),O=Rt.find(g,h[k].location),j=qr(Yr(O.content));{for(var H=0;H<j.length&&j[H].id!=k;++H);if(j[H].id!=k)throw"Bad ColumnRowUIDMapArchive";var Y=an(j[H].messages[0].data);Y[1]=[],Y[2]=[],Y[3]=[];for(var I=0;I<=a.e.c;++I){var G=[];G[1]=G[2]=[{type:0,data:yt(I+420690)}],Y[1].push({type:2,data:An(G)}),Y[2].push({type:0,data:yt(I)}),Y[3].push({type:0,data:yt(I)})}Y[4]=[],Y[5]=[],Y[6]=[];for(var q=0;q<=a.e.r;++q)G=[],G[1]=G[2]=[{type:0,data:yt(q+726270)}],Y[4].push({type:2,data:An(G)}),Y[5].push({type:0,data:yt(q)}),Y[6].push({type:0,data:yt(q)});j[H].messages[0].data=An(Y)}O.content=to(eo(j)),O.size=O.content.length,delete B[46];var ie=an(B[4][0].data);{ie[7][0].data=yt(a.e.r+1);var J=an(ie[1][0].data),he=gi(J[2][0].data);O=Rt.find(g,h[he].location),j=qr(Yr(O.content));{if(j[0].id!=he)throw"Bad HeaderStorageBucket";var Ae=an(j[0].messages[0].data);for(q=0;q<l.length;++q){var je=an(Ae[2][0].data);je[1][0].data=yt(q),je[4][0].data=yt(l[q].length),Ae[2][q]={type:Ae[2][0].type,data:An(je)}}j[0].messages[0].data=An(Ae)}O.content=to(eo(j)),O.size=O.content.length;var ke=gi(ie[2][0].data);O=Rt.find(g,h[ke].location),j=qr(Yr(O.content));{if(j[0].id!=ke)throw"Bad HeaderStorageBucket";for(Ae=an(j[0].messages[0].data),I=0;I<=a.e.c;++I)je=an(Ae[2][0].data),je[1][0].data=yt(I),je[4][0].data=yt(a.e.r+1),Ae[2][I]={type:Ae[2][0].type,data:An(je)};j[0].messages[0].data=An(Ae)}O.content=to(eo(j)),O.size=O.content.length;var re=gi(ie[4][0].data);(function(){for(var L=Rt.find(g,h[re].location),P=qr(Yr(L.content)),K,Z=0;Z<P.length;++Z){var be=P[Z];be.id==re&&(K=be)}var Ce=an(K.messages[0].data);{Ce[3]=[];var Pe=[];c.forEach(function(et,zt){Pe[1]=[{type:0,data:yt(zt)}],Pe[2]=[{type:0,data:yt(1)}],Pe[3]=[{type:2,data:AL(et)}],Ce[3].push({type:2,data:An(Pe)})})}K.messages[0].data=An(Ce);var De=eo(P),lt=to(De);L.content=lt,L.size=L.content.length})();var xe=an(ie[3][0].data);{var fe=xe[1][0];delete xe[2];var Te=an(fe.data);{var U=gi(Te[2][0].data);(function(){for(var L=Rt.find(g,h[U].location),P=qr(Yr(L.content)),K,Z=0;Z<P.length;++Z){var be=P[Z];be.id==U&&(K=be)}var Ce=an(K.messages[0].data);{delete Ce[6],delete xe[7];var Pe=new Uint8Array(Ce[5][0].data);Ce[5]=[];for(var De=0,lt=0;lt<=a.e.r;++lt){var et=an(Pe);De+=RL(et,l[lt],c),et[1][0].data=yt(lt),Ce[5].push({data:An(et),type:2})}Ce[1]=[{type:0,data:yt(a.e.c+1)}],Ce[2]=[{type:0,data:yt(a.e.r+1)}],Ce[3]=[{type:0,data:yt(De)}],Ce[4]=[{type:0,data:yt(a.e.r+1)}]}K.messages[0].data=An(Ce);var zt=eo(P),ct=to(zt);L.content=ct,L.size=L.content.length})()}fe.data=An(Te)}ie[3][0].data=An(xe)}B[4][0].data=An(ie)}T.messages[0].data=An(B);var ue=eo(_),b=to(ue);return v.content=b,v.size=v.content.length,g}function kL(n){return function(t){for(var a=0;a!=n.length;++a){var s=n[a];t[s[0]]===void 0&&(t[s[0]]=s[1]),s[2]==="n"&&(t[s[0]]=Number(t[s[0]]))}}}function Nm(n){kL([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(n)}function OL(n,e){return e.bookType=="ods"?JC(n,e):e.bookType=="numbers"?NL(n,e):e.bookType=="xlsb"?ML(n,e):DL(n,e)}function ML(n,e){so=1024,n&&!n.SSF&&(n.SSF=or(qt)),n&&n.SSF&&(Jh(),Qh(n.SSF),e.revssf=Zh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t=e.bookType=="xlsb"?"bin":"xml",a=DC.indexOf(e.bookType)>-1,s=cC();Nm(e=e||{});var l=gm(),c="",h=0;if(e.cellXfs=[],Ni(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),c="docProps/core.xml",nt(l,c,dC(n.Props,e)),s.coreprops.push(c),Tt(e.rels,2,c,ft.CORE_PROPS),c="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var d=[],g=0;g<n.SheetNames.length;++g)(n.Workbook.Sheets[g]||{}).Hidden!=2&&d.push(n.SheetNames[g]);n.Props.SheetNames=d}for(n.Props.Worksheets=n.Props.SheetNames.length,nt(l,c,mC(n.Props)),s.extprops.push(c),Tt(e.rels,3,c,ft.EXT_PROPS),n.Custprops!==n.Props&&kn(n.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,pC(n.Custprops)),s.custprops.push(c),Tt(e.rels,4,c,ft.CUST_PROPS)),h=1;h<=n.SheetNames.length;++h){var p={"!id":{}},v=n.Sheets[n.SheetNames[h-1]],_=(v||{})["!type"]||"sheet";switch(_){case"chart":default:c="xl/worksheets/sheet"+h+"."+t,nt(l,c,F6(h-1,c,e,n,p)),s.sheets.push(c),Tt(e.wbrels,-1,"worksheets/sheet"+h+"."+t,ft.WS[0])}if(v){var T=v["!comments"],C=!1,x="";T&&T.length>0&&(x="xl/comments"+h+"."+t,nt(l,x,B6(T,x)),s.comments.push(x),Tt(p,-1,"../comments"+h+"."+t,ft.CMNT),C=!0),v["!legacy"]&&C&&nt(l,"xl/drawings/vmlDrawing"+h+".vml",OC(h,v["!comments"])),delete v["!comments"],delete v["!legacy"]}p["!id"].rId1&&nt(l,hC(c),ho(p))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,nt(l,c,U6(e.Strings,c,e)),s.strs.push(c),Tt(e.wbrels,-1,"sharedStrings."+t,ft.SST)),c="xl/workbook."+t,nt(l,c,P6(n,c)),s.workbooks.push(c),Tt(e.rels,1,c,ft.WB),c="xl/theme/theme1.xml",nt(l,c,NC(n.Themes,e)),s.themes.push(c),Tt(e.wbrels,-1,"theme/theme1.xml",ft.THEME),c="xl/styles."+t,nt(l,c,L6(n,c,e)),s.styles.push(c),Tt(e.wbrels,-1,"styles."+t,ft.STY),n.vbaraw&&a&&(c="xl/vbaProject.bin",nt(l,c,n.vbaraw),s.vba.push(c),Tt(e.wbrels,-1,"vbaProject.bin",ft.VBA)),c="xl/metadata."+t,nt(l,c,H6(c)),s.metadata.push(c),Tt(e.wbrels,-1,"metadata."+t,ft.XLMETA),nt(l,"[Content_Types].xml",uC(s,e)),nt(l,"_rels/.rels",ho(e.rels)),nt(l,"xl/_rels/workbook."+t+".rels",ho(e.wbrels)),delete e.revssf,delete e.ssf,l}function DL(n,e){so=1024,n&&!n.SSF&&(n.SSF=or(qt)),n&&n.SSF&&(Jh(),Qh(n.SSF),e.revssf=Zh(n.SSF),e.revssf[n.SSF[65535]]=0,e.ssf=n.SSF),e.rels={},e.wbrels={},e.Strings=[],e.Strings.Count=0,e.Strings.Unique=0,Vl?e.revStrings=new Map:(e.revStrings={},e.revStrings.foo=[],delete e.revStrings.foo);var t="xml",a=DC.indexOf(e.bookType)>-1,s=cC();Nm(e=e||{});var l=gm(),c="",h=0;if(e.cellXfs=[],Ni(e.cellXfs,{},{revssf:{General:0}}),n.Props||(n.Props={}),c="docProps/core.xml",nt(l,c,dC(n.Props,e)),s.coreprops.push(c),Tt(e.rels,2,c,ft.CORE_PROPS),c="docProps/app.xml",!(n.Props&&n.Props.SheetNames))if(!n.Workbook||!n.Workbook.Sheets)n.Props.SheetNames=n.SheetNames;else{for(var d=[],g=0;g<n.SheetNames.length;++g)(n.Workbook.Sheets[g]||{}).Hidden!=2&&d.push(n.SheetNames[g]);n.Props.SheetNames=d}n.Props.Worksheets=n.Props.SheetNames.length,nt(l,c,mC(n.Props)),s.extprops.push(c),Tt(e.rels,3,c,ft.EXT_PROPS),n.Custprops!==n.Props&&kn(n.Custprops||{}).length>0&&(c="docProps/custom.xml",nt(l,c,pC(n.Custprops)),s.custprops.push(c),Tt(e.rels,4,c,ft.CUST_PROPS));var p=["SheetJ5"];for(e.tcid=0,h=1;h<=n.SheetNames.length;++h){var v={"!id":{}},_=n.Sheets[n.SheetNames[h-1]],T=(_||{})["!type"]||"sheet";switch(T){case"chart":default:c="xl/worksheets/sheet"+h+"."+t,nt(l,c,GC(h-1,e,n,v)),s.sheets.push(c),Tt(e.wbrels,-1,"worksheets/sheet"+h+"."+t,ft.WS[0])}if(_){var C=_["!comments"],x=!1,A="";if(C&&C.length>0){var B=!1;C.forEach(function(k){k[1].forEach(function(O){O.T==!0&&(B=!0)})}),B&&(A="xl/threadedComments/threadedComment"+h+"."+t,nt(l,A,hD(C,p,e)),s.threadedcomments.push(A),Tt(v,-1,"../threadedComments/threadedComment"+h+"."+t,ft.TCMNT)),A="xl/comments"+h+"."+t,nt(l,A,MC(C)),s.comments.push(A),Tt(v,-1,"../comments"+h+"."+t,ft.CMNT),x=!0}_["!legacy"]&&x&&nt(l,"xl/drawings/vmlDrawing"+h+".vml",OC(h,_["!comments"])),delete _["!comments"],delete _["!legacy"]}v["!id"].rId1&&nt(l,hC(c),ho(v))}return e.Strings!=null&&e.Strings.length>0&&(c="xl/sharedStrings."+t,nt(l,c,EC(e.Strings,e)),s.strs.push(c),Tt(e.wbrels,-1,"sharedStrings."+t,ft.SST)),c="xl/workbook."+t,nt(l,c,VC(n)),s.workbooks.push(c),Tt(e.rels,1,c,ft.WB),c="xl/theme/theme1.xml",nt(l,c,NC(n.Themes,e)),s.themes.push(c),Tt(e.wbrels,-1,"theme/theme1.xml",ft.THEME),c="xl/styles."+t,nt(l,c,IC(n,e)),s.styles.push(c),Tt(e.wbrels,-1,"styles."+t,ft.STY),n.vbaraw&&a&&(c="xl/vbaProject.bin",nt(l,c,n.vbaraw),s.vba.push(c),Tt(e.wbrels,-1,"vbaProject.bin",ft.VBA)),c="xl/metadata."+t,nt(l,c,kC()),s.metadata.push(c),Tt(e.wbrels,-1,"metadata."+t,ft.XLMETA),p.length>1&&(c="xl/persons/person.xml",nt(l,c,fD(p)),s.people.push(c),Tt(e.wbrels,-1,"persons/person.xml",ft.PEOPLE)),nt(l,"[Content_Types].xml",uC(s,e)),nt(l,"_rels/.rels",ho(e.rels)),nt(l,"xl/_rels/workbook."+t+".rels",ho(e.wbrels)),delete e.revssf,delete e.ssf,l}function PL(n,e){var t="";switch((e||{}).type||"base64"){case"buffer":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];case"base64":t=ja(n.slice(0,12));break;case"binary":t=n;break;case"array":return[n[0],n[1],n[2],n[3],n[4],n[5],n[6],n[7]];default:throw new Error("Unrecognized type "+(e&&e.type||"undefined"))}return[t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2),t.charCodeAt(3),t.charCodeAt(4),t.charCodeAt(5),t.charCodeAt(6),t.charCodeAt(7)]}function ZC(n,e){switch(e.type){case"base64":case"binary":break;case"buffer":case"array":e.type="";break;case"file":return lc(e.file,Rt.write(n,{type:mt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");default:throw new Error("Unrecognized type "+e.type)}return Rt.write(n,e)}function FL(n,e){var t=or(e||{}),a=OL(n,t);return LL(a,t)}function LL(n,e){var t={},a=mt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(e.compression&&(t.compression="DEFLATE"),e.password)t.type=a;else switch(e.type){case"base64":t.type="base64";break;case"binary":t.type="string";break;case"string":throw new Error("'string' output type invalid for '"+e.bookType+"' files");case"buffer":case"file":t.type=a;break;default:throw new Error("Unrecognized type "+e.type)}var s=n.FullPaths?Rt.write(n,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[t.type]||t.type,compression:!!e.compression}):n.generate(t);if(typeof Deno<"u"&&typeof s=="string"){if(e.type=="binary"||e.type=="base64")return s;s=new Uint8Array(Wh(s))}return e.password&&typeof encrypt_agile<"u"?ZC(encrypt_agile(s,e.password),e):e.type==="file"?lc(e.file,s):e.type=="string"?zl(s):s}function UL(n,e){var t=e||{},a=eL(n,t);return ZC(a,t)}function ga(n,e,t){t||(t="");var a=t+n;switch(e.type){case"base64":return ec(nc(a));case"binary":return nc(a);case"string":return n;case"file":return lc(e.file,a,"utf8");case"buffer":return mt?Ga(a,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(a):ga(a,{type:"binary"}).split("").map(function(s){return s.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function BL(n,e){switch(e.type){case"base64":return ec(n);case"binary":return n;case"string":return n;case"file":return lc(e.file,n,"binary");case"buffer":return mt?Ga(n,"binary"):n.split("").map(function(t){return t.charCodeAt(0)})}throw new Error("Unrecognized type "+e.type)}function Ku(n,e){switch(e.type){case"string":case"base64":case"binary":for(var t="",a=0;a<n.length;++a)t+=String.fromCharCode(n[a]);return e.type=="base64"?ec(t):e.type=="string"?zl(t):t;case"file":return lc(e.file,n);case"buffer":return n;default:throw new Error("Unrecognized type "+e.type)}}function eE(n,e){d4(),E6(n);var t=or(e||{});if(t.cellStyles&&(t.cellNF=!0,t.sheetStubs=!0),t.type=="array"){t.type="binary";var a=eE(n,t);return t.type="array",Wh(a)}var s=0;if(t.sheet&&(typeof t.sheet=="number"?s=t.sheet:s=n.SheetNames.indexOf(t.sheet),!n.SheetNames[s]))throw new Error("Sheet not found: "+t.sheet+" : "+typeof t.sheet);switch(t.bookType||"xlsb"){case"xml":case"xlml":return ga(J6(n,t),t);case"slk":case"sylk":return ga(x3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"htm":case"html":return ga(XC(n.Sheets[n.SheetNames[s]],t),t);case"txt":return BL(tE(n.Sheets[n.SheetNames[s]],t),t);case"csv":return ga(km(n.Sheets[n.SheetNames[s]],t),t,"\uFEFF");case"dif":return ga(S3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"dbf":return Ku(_3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"prn":return ga(C3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"rtf":return ga(N3.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"eth":return ga(CC.from_sheet(n.Sheets[n.SheetNames[s]],t),t);case"fods":return ga(JC(n,t),t);case"wk1":return Ku(VT.sheet_to_wk1(n.Sheets[n.SheetNames[s]],t),t);case"wk3":return Ku(VT.book_to_wk3(n,t),t);case"biff2":t.biff||(t.biff=2);case"biff3":t.biff||(t.biff=3);case"biff4":return t.biff||(t.biff=4),Ku(YC(n,t),t);case"biff5":t.biff||(t.biff=5);case"biff8":case"xla":case"xls":return t.biff||(t.biff=8),UL(n,t);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return FL(n,t);default:throw new Error("Unrecognized bookType |"+t.bookType+"|")}}function HL(n){if(!n.bookType){var e={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},t=n.file.slice(n.file.lastIndexOf(".")).toLowerCase();t.match(/^\.[a-z]+$/)&&(n.bookType=t.slice(1)),n.bookType=e[n.bookType]||n.bookType}}function jL(n,e,t){var a={};return a.type="file",a.file=e,HL(a),eE(n,a)}function zL(n,e,t,a,s,l,c,h){var d=Nn(t),g=h.defval,p=h.raw||!Object.prototype.hasOwnProperty.call(h,"raw"),v=!0,_=s===1?[]:{};if(s!==1)if(Object.defineProperty)try{Object.defineProperty(_,"__rowNum__",{value:t,enumerable:!1})}catch{_.__rowNum__=t}else _.__rowNum__=t;if(!c||n[t])for(var T=e.s.c;T<=e.e.c;++T){var C=c?n[t][T]:n[a[T]+d];if(C===void 0||C.t===void 0){if(g===void 0)continue;l[T]!=null&&(_[l[T]]=g);continue}var x=C.v;switch(C.t){case"z":if(x==null)break;continue;case"e":x=x==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+C.t)}if(l[T]!=null){if(x==null)if(C.t=="e"&&x===null)_[l[T]]=null;else if(g!==void 0)_[l[T]]=g;else if(p&&x===null)_[l[T]]=null;else continue;else _[l[T]]=p&&(C.t!=="n"||C.t==="n"&&h.rawNumbers!==!1)?x:za(C,x,h);x!=null&&(v=!1)}}return{row:_,isempty:v}}function Nh(n,e){if(n==null||n["!ref"]==null)return[];var t={t:"n",v:0},a=0,s=1,l=[],c=0,h="",d={s:{r:0,c:0},e:{r:0,c:0}},g=e||{},p=g.range!=null?g.range:n["!ref"];switch(g.header===1?a=1:g.header==="A"?a=2:Array.isArray(g.header)?a=3:g.header==null&&(a=0),typeof p){case"string":d=Ut(p);break;case"number":d=Ut(n["!ref"]),d.s.r=p;break;default:d=p}a>0&&(s=0);var v=Nn(d.s.r),_=[],T=[],C=0,x=0,A=Array.isArray(n),B=d.s.r,k=0,O={};A&&!n[B]&&(n[B]=[]);var j=g.skipHidden&&n["!cols"]||[],H=g.skipHidden&&n["!rows"]||[];for(k=d.s.c;k<=d.e.c;++k)if(!(j[k]||{}).hidden)switch(_[k]=Un(k),t=A?n[B][k]:n[_[k]+v],a){case 1:l[k]=k-d.s.c;break;case 2:l[k]=_[k];break;case 3:l[k]=g.header[k-d.s.c];break;default:if(t==null&&(t={w:"__EMPTY",t:"s"}),h=c=za(t,null,g),x=O[c]||0,!x)O[c]=1;else{do h=c+"_"+x++;while(O[h]);O[c]=x,O[h]=1}l[k]=h}for(B=d.s.r+s;B<=d.e.r;++B)if(!(H[B]||{}).hidden){var Y=zL(n,d,B,_,a,l,A,g);(Y.isempty===!1||(a===1?g.blankrows!==!1:g.blankrows))&&(T[C++]=Y.row)}return T.length=C,T}var e_=/"/g;function GL(n,e,t,a,s,l,c,h){for(var d=!0,g=[],p="",v=Nn(t),_=e.s.c;_<=e.e.c;++_)if(a[_]){var T=h.dense?(n[t]||[])[_]:n[a[_]+v];if(T==null)p="";else if(T.v!=null){d=!1,p=""+(h.rawNumbers&&T.t=="n"?T.v:za(T,null,h));for(var C=0,x=0;C!==p.length;++C)if((x=p.charCodeAt(C))===s||x===l||x===34||h.forceQuotes){p='"'+p.replace(e_,'""')+'"';break}p=="ID"&&(p='"ID"')}else T.f!=null&&!T.F?(d=!1,p="="+T.f,p.indexOf(",")>=0&&(p='"'+p.replace(e_,'""')+'"')):p="";g.push(p)}return h.blankrows===!1&&d?null:g.join(c)}function km(n,e){var t=[],a=e??{};if(n==null||n["!ref"]==null)return"";var s=Ut(n["!ref"]),l=a.FS!==void 0?a.FS:",",c=l.charCodeAt(0),h=a.RS!==void 0?a.RS:`
`,d=h.charCodeAt(0),g=new RegExp((l=="|"?"\\|":l)+"+$"),p="",v=[];a.dense=Array.isArray(n);for(var _=a.skipHidden&&n["!cols"]||[],T=a.skipHidden&&n["!rows"]||[],C=s.s.c;C<=s.e.c;++C)(_[C]||{}).hidden||(v[C]=Un(C));for(var x=0,A=s.s.r;A<=s.e.r;++A)(T[A]||{}).hidden||(p=GL(n,s,A,v,c,d,l,a),p!=null&&(a.strip&&(p=p.replace(g,"")),(p||a.blankrows!==!1)&&t.push((x++?h:"")+p)));return delete a.dense,t.join("")}function tE(n,e){e||(e={}),e.FS="	",e.RS=`
`;var t=km(n,e);return t}function $L(n){var e="",t,a="";if(n==null||n["!ref"]==null)return[];var s=Ut(n["!ref"]),l="",c=[],h,d=[],g=Array.isArray(n);for(h=s.s.c;h<=s.e.c;++h)c[h]=Un(h);for(var p=s.s.r;p<=s.e.r;++p)for(l=Nn(p),h=s.s.c;h<=s.e.c;++h)if(e=c[h]+l,t=g?(n[p]||[])[h]:n[e],a="",t!==void 0){if(t.F!=null){if(e=t.F,!t.f)continue;a=t.f,e.indexOf(":")==-1&&(e=e+":"+e)}if(t.f!=null)a=t.f;else{if(t.t=="z")continue;if(t.t=="n"&&t.v!=null)a=""+t.v;else if(t.t=="b")a=t.v?"TRUE":"FALSE";else if(t.w!==void 0)a="'"+t.w;else{if(t.v===void 0)continue;t.t=="s"?a="'"+t.v:a=""+t.v}}d[d.length]=e+"="+a}return d}function nE(n,e,t){var a=t||{},s=+!a.skipHeader,l=n||{},c=0,h=0;if(l&&a.origin!=null)if(typeof a.origin=="number")c=a.origin;else{var d=typeof a.origin=="string"?pn(a.origin):a.origin;c=d.r,h=d.c}var g,p={s:{c:0,r:0},e:{c:h,r:c+e.length-1+s}};if(l["!ref"]){var v=Ut(l["!ref"]);p.e.c=Math.max(p.e.c,v.e.c),p.e.r=Math.max(p.e.r,v.e.r),c==-1&&(c=v.e.r+1,p.e.r=c+e.length-1+s)}else c==-1&&(c=0,p.e.r=e.length-1+s);var _=a.header||[],T=0;e.forEach(function(x,A){kn(x).forEach(function(B){(T=_.indexOf(B))==-1&&(_[T=_.length]=B);var k=x[B],O="z",j="",H=St({c:h+T,r:c+A+s});g=ic(l,H),k&&typeof k=="object"&&!(k instanceof Date)?l[H]=k:(typeof k=="number"?O="n":typeof k=="boolean"?O="b":typeof k=="string"?O="s":k instanceof Date?(O="d",a.cellDates||(O="n",k=sr(k)),j=a.dateNF||qt[14]):k===null&&a.nullError&&(O="e",k=0),g?(g.t=O,g.v=k,delete g.w,delete g.R,j&&(g.z=j)):l[H]=g={t:O,v:k},j&&(g.z=j))})}),p.e.c=Math.max(p.e.c,h+_.length-1);var C=Nn(c);if(s)for(T=0;T<_.length;++T)l[Un(T+h)+C]={t:"s",v:_[T]};return l["!ref"]=en(p),l}function KL(n,e){return nE(null,n,e)}function ic(n,e,t){if(typeof e=="string"){if(Array.isArray(n)){var a=pn(e);return n[a.r]||(n[a.r]=[]),n[a.r][a.c]||(n[a.r][a.c]={t:"z"})}return n[e]||(n[e]={t:"z"})}return typeof e!="number"?ic(n,St(e)):ic(n,St({r:e,c:t||0}))}function VL(n,e){if(typeof e=="number"){if(e>=0&&n.SheetNames.length>e)return e;throw new Error("Cannot find sheet # "+e)}else if(typeof e=="string"){var t=n.SheetNames.indexOf(e);if(t>-1)return t;throw new Error("Cannot find sheet name |"+e+"|")}else throw new Error("Cannot find sheet |"+e+"|")}function qL(){return{SheetNames:[],Sheets:{}}}function YL(n,e,t,a){var s=1;if(!t)for(;s<=65535&&n.SheetNames.indexOf(t="Sheet"+s)!=-1;++s,t=void 0);if(!t||n.SheetNames.length>=65535)throw new Error("Too many worksheets");if(a&&n.SheetNames.indexOf(t)>=0){var l=t.match(/(^.*?)(\d+)$/);s=l&&+l[2]||0;var c=l&&l[1]||t;for(++s;s<=65535&&n.SheetNames.indexOf(t=c+s)!=-1;++s);}if(KC(t),n.SheetNames.indexOf(t)>=0)throw new Error("Worksheet with name |"+t+"| already exists!");return n.SheetNames.push(t),n.Sheets[t]=e,t}function XL(n,e,t){n.Workbook||(n.Workbook={}),n.Workbook.Sheets||(n.Workbook.Sheets=[]);var a=VL(n,e);switch(n.Workbook.Sheets[a]||(n.Workbook.Sheets[a]={}),t){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+t)}n.Workbook.Sheets[a].Hidden=t}function WL(n,e){return n.z=e,n}function rE(n,e,t){return e?(n.l={Target:e},t&&(n.l.Tooltip=t)):delete n.l,n}function QL(n,e,t){return rE(n,"#"+e,t)}function JL(n,e,t){n.c||(n.c=[]),n.c.push({t:e,a:t||"SheetJS"})}function ZL(n,e,t,a){for(var s=typeof e!="string"?e:Ut(e),l=typeof e=="string"?e:en(e),c=s.s.r;c<=s.e.r;++c)for(var h=s.s.c;h<=s.e.c;++h){var d=ic(n,c,h);d.t="n",d.F=l,delete d.v,c==s.s.r&&h==s.s.c&&(d.f=t,a&&(d.D=!0))}return n}var O0={encode_col:Un,encode_row:Nn,encode_cell:St,encode_range:en,decode_col:_m,decode_row:Tm,split_cell:dM,decode_cell:pn,decode_range:Ar,format_cell:za,sheet_add_aoa:rC,sheet_add_json:nE,sheet_add_dom:WC,aoa_to_sheet:Ao,json_to_sheet:KL,table_to_sheet:QC,table_to_book:SL,sheet_to_csv:km,sheet_to_txt:tE,sheet_to_json:Nh,sheet_to_html:XC,sheet_to_formulae:$L,sheet_to_row_object_array:Nh,sheet_get_cell:ic,book_new:qL,book_append_sheet:YL,book_set_sheet_visibility:XL,cell_set_number_format:WL,cell_set_hyperlink:rE,cell_set_internal_link:QL,cell_add_comment:JL,sheet_set_array_formula:ZL,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function e8(n,e="reporte.xlsx"){const t=n.map(c=>({...c})),a=O0.json_to_sheet(t),s=Object.keys(t[0]??{}).map(c=>{const h=t.reduce((d,g)=>{const p=g?.[c],v=p==null?0:String(p).length;return Math.max(d,v,c.length)},10);return{wch:Math.min(Math.max(h+2,10),60)}});a["!cols"]=s;const l=O0.book_new();O0.book_append_sheet(l,a,"Reporte"),jL(l,e)}const t8=1;function n8(n,e){const[t,a]=V.useState(!1),[s,l]=V.useState(null),[c,h]=V.useState([]),[d,g]=V.useState(0),[p,v]=V.useState(0),[_,T]=V.useState({desde:Cy(),hasta:Cy(),persona:"",tipoVehiculo:""}),C=B=>T(k=>({...k,...B})),x=V.useCallback(async()=>{const B=await e.getAll({filter:"fields/Activa eq 'Activa'",top:2e3,orderby:"fields/Title asc"});let k=0,O=0;for(const H of B){const Y=String(H.TipoCelda??"").toLowerCase();Y==="carro"?k+=1:Y==="moto"&&(O+=1)}const j=k*1+O*t8;g(j)},[e]),A=V.useCallback(async()=>{const{desde:B,hasta:k,persona:O,tipoVehiculo:j}=_,H=["(fields/Status ne 'Cancelada')",`fields/Date ge '${B}'`,`fields/Date le '${k}'`];if(j&&H.push(`fields/VehicleType eq '${String(j).replace(/'/g,"''")}'`),O?.trim()){const G=O.trim().toLowerCase().replace(/'/g,"''");H.push(`(contains(tolower(fields/Title),'${G}') or contains(tolower(fields/NombreUsuario),'${G}'))`)}const I=(await n.getAll({filter:H.join(" and "),orderby:"fields/Date asc,fields/Turn asc",top:2e3})).map(G=>({Id:Number(G.ID??G.Id??0),Fecha:String(G.Date??"").slice(0,10),Turno:String(G.Turn??""),Celda:G.SpotId??String(G.SpotIdLookupId??G.SpotId??""),SpotId:Number(G.SpotIdLookupId??G.SpotId??0),TipoVehiculo:G.VehicleType??G.VehivleType??"",Usuario:String(G.NombreUsuario??G.Title??""),Estado:String(G.Status??"")}));h(I)},[_,n]);return V.useEffect(()=>{if(!d||d<=0){v(0);return}let B=0;for(const O of c){const j=String(O.TipoVehiculo).toLowerCase();B+=1}const k=Math.min(100,Math.round(B/d*100));v(Number.isFinite(k)?k:0)},[c,d]),V.useEffect(()=>{let B=!1;return(async()=>{try{a(!0),l(null),await x(),await A()}catch(k){B||l(k?.message??"Error cargando reportería")}finally{B||a(!1)}})(),()=>{B=!0}},[x,A]),V.useEffect(()=>{let B=!1;return(async()=>{try{a(!0),l(null),await A()}catch(k){B||l(k?.message??"Error cargando reservas")}finally{B||a(!1)}})(),()=>{B=!0}},[A]),{loading:t,error:s,rows:c,aforoPct:p,capacidadTotal:d,filters:_,setFilters:T,onChange:C,loadReservas:A,loadCapacidad:x}}function r8(){const{reservations:n,parkingSlots:e}=Ri(),{loading:t,error:a,rows:s,aforoPct:l,capacidadTotal:c,filters:h,onChange:d,loadReservas:g}=n8(n,e);return y.jsxs("section",{className:dn.wrapper,children:[y.jsxs("header",{className:dn.header,children:[y.jsx("h2",{className:dn.title,children:"Reportería de Parqueadero"}),y.jsxs("div",{className:dn.aforo,children:["Aforo (periodo filtrado): ",y.jsxs("strong",{children:[l,"%"]}),!!c&&y.jsxs("span",{className:dn.aforoCap,children:["(Capacidad total: ",c," vehiculos)"]})]})]}),y.jsxs("div",{className:dn.filters,children:[y.jsxs("div",{className:dn.field,children:[y.jsx("label",{children:"Desde"}),y.jsx("input",{type:"date",value:h.desde,onChange:p=>d({desde:p.target.value})})]}),y.jsxs("div",{className:dn.field,children:[y.jsx("label",{children:"Hasta"}),y.jsx("input",{type:"date",value:h.hasta,onChange:p=>d({hasta:p.target.value})})]}),y.jsxs("div",{className:dn.field,children:[y.jsx("label",{children:"Persona (correo o nombre)"}),y.jsx("input",{type:"text",placeholder:"ej: juan@empresa.com",value:h.persona,onChange:p=>d({persona:p.target.value})})]}),y.jsxs("div",{className:dn.field,children:[y.jsx("label",{children:"Tipo de vehículo"}),y.jsxs("select",{value:h.tipoVehiculo,onChange:p=>d({tipoVehiculo:p.target.value}),children:[y.jsx("option",{value:"",children:"Todos"}),y.jsx("option",{value:"Carro",children:"Carro"}),y.jsx("option",{value:"Moto",children:"Moto"})]})]}),y.jsxs("div",{className:dn.actions,children:[y.jsx("button",{className:dn.btn,onClick:()=>g(),disabled:t,children:"Aplicar filtros"}),y.jsx("button",{className:dn.btnPrimary,onClick:()=>e8(s,"reporte-parqueadero.xlsx"),disabled:t||s.length===0,children:"Exportar a Excel"})]})]}),t&&y.jsx("div",{className:dn.info,children:"Cargando…"}),a&&y.jsx("div",{className:dn.error,children:a}),!t&&!a&&y.jsx("div",{className:dn.tableWrap,children:y.jsxs("table",{className:dn.table,children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"Fecha"}),y.jsx("th",{children:"Turno"}),y.jsx("th",{children:"Celda"}),y.jsx("th",{children:"Vehículo"}),y.jsx("th",{children:"Usuario"}),y.jsx("th",{children:"Estado"})]})}),y.jsx("tbody",{children:s.length===0?y.jsx("tr",{children:y.jsx("td",{colSpan:6,className:dn.empty,children:"Sin resultados"})}):s.map(p=>y.jsxs("tr",{children:[y.jsx("td",{children:p.Fecha}),y.jsx("td",{children:p.Turno}),y.jsx("td",{children:p.Celda}),y.jsx("td",{children:p.TipoVehiculo}),y.jsx("td",{children:p.Usuario}),y.jsx("td",{children:p.Estado})]},p.Id))})]})})]})}const a8="_section_xchyt_1",i8="_card_xchyt_3",s8="_title_xchyt_21",o8="_error_xchyt_31",l8="_ok_xchyt_33",c8="_tableWrap_xchyt_37",u8="_table_xchyt_37",h8="_day_xchyt_43",f8="_input_xchyt_47",d8="_bad_xchyt_63",g8="_button_xchyt_67",m8="_hint_xchyt_77",Cn={section:a8,card:i8,title:s8,error:o8,ok:l8,tableWrap:c8,table:u8,day:h8,input:f8,bad:d8,button:g8,hint:m8},p8="_disabled_w0jvz_71",v8="_trackText_w0jvz_83",y8="_thumb_w0jvz_101",T8="_on_w0jvz_127",Nl={switch:"_switch_w0jvz_31",disabled:p8,trackText:v8,thumb:y8,on:T8},_8=({checked:n,onChange:e,disabled:t,id:a,onLabel:s,offLabel:l})=>{const c=()=>!t&&e(!n);return y.jsxs("button",{id:a,type:"button",role:"switch","aria-checked":n,"aria-label":n?s:l,disabled:t,className:`${Nl.switch} ${n?Nl.on:""} ${t?Nl.disabled:""}`,onClick:c,onKeyDown:h=>{(h.key===" "||h.key==="Enter")&&(h.preventDefault(),c())},children:[y.jsx("span",{className:Nl.trackText,children:n?s:l}),y.jsx("span",{className:Nl.thumb})]})},t_={1:"Lunes",2:"Martes",3:"Miércoles",4:"Jueves",5:"Viernes",6:"Sábado",7:"Domingo"},x8=/^(\s*[0-9]\s*(,\s*[0-9]\s*)*)?$/;function S8(n){const e=Number(n);return Number.isFinite(e)&&t_[e]?t_[e]:`Día ${n}`}function Vu(n){return x8.test(n)}const Ji={VisibleDays:7,TyC:"",InicioManana:"07:00",FinalManana:"12:00",InicioTarde:"12:00",FinalTarde:"18:00",PicoPlaca:!1},C8=()=>{const{picoYPlaca:n,settings:e}=Ri(),[t,a]=V.useState([]),[s,l]=V.useState(!0),[c,h]=V.useState(null),[d,g]=V.useState(null),[p,v]=V.useState(null),[_,T]=V.useState(null),[C,x]=V.useState(!1);V.useEffect(()=>{let j=!1;return(async()=>{try{l(!0),g(null);const H=await n.getAll();j||a(H.map(G=>({ID:String(G.ID),Title:String(G.Title??""),Moto:String(G.Moto??""),Carro:String(G.Carro??"")})).sort((G,q)=>Number(G.Title)-Number(q.Title)));const Y=await e.getAll({top:1});let I;Y.length?I=Y[0]:I=await e.create({VisibleDays:Ji.VisibleDays,TerminosyCondiciones:Ji.TyC,InicioManana:Ji.InicioManana,FinalManana:Ji.FinalManana,InicioTarde:Ji.InicioTarde,FinalTarde:Ji.FinalTarde,PicoPlaca:Ji.PicoPlaca}),j||(T(I),x(!!I.PicoPlaca))}catch(H){j||g(H?.message??"No se pudieron cargar los datos.")}finally{j||l(!1)}})(),()=>{j=!0}},[n,e]);const A=V.useMemo(()=>{let j;return H=>{x(H),v(null),g(null),_&&(clearTimeout(j),j=setTimeout(async()=>{try{const Y=await e.update(_.ID,{PicoPlaca:H});T(Y),v(`Pico y Placa ${H?"activado":"desactivado"}.`)}catch(Y){g(Y?.message??"No se pudo guardar el ajuste Pico y Placa.")}},400))}},[_,e]),B=(j,H,Y)=>{C&&(a(I=>I.map(G=>G.ID===j?{...G,[H]:Y}:G)),v(null),g(null))},k=async j=>{if(!C)return;const{Moto:H,Carro:Y}=j;if(!Vu(H)||!Vu(Y)){g('Formato inválido. Usa dígitos separados por comas. Ej: "6,9" o "0,2,4,6,8".');return}h(j.ID),v(null),g(null);try{await n.update(j.ID,{Moto:H,Carro:Y}),a(I=>I.map(G=>G.ID===j.ID?{...G,Moto:H,Carro:Y}:G)),v(`Fila ${j.Title} guardada.`)}catch(I){g(I?.message??"No se pudo guardar la fila.")}finally{h(null)}};if(s)return y.jsx("div",{children:"Cargando Pico y Placa…"});const O=!C;return y.jsx("section",{className:Cn.section,children:y.jsxs("div",{className:Cn.card,children:[y.jsx("h2",{className:Cn.title,children:"Pico y Placa Medellín"}),y.jsx("div",{className:Cn.switchRow,children:y.jsx(_8,{checked:C,onChange:A})}),d&&y.jsx("div",{className:Cn.error,children:d}),p&&y.jsx("div",{className:Cn.ok,children:p}),y.jsxs("div",{className:`${Cn.tableWrap} ${O?Cn.isDisabled:""}`,"aria-disabled":O,children:[y.jsxs("table",{className:Cn.table,children:[y.jsx("thead",{children:y.jsxs("tr",{children:[y.jsx("th",{children:"Día"}),y.jsx("th",{children:"Moto"}),y.jsx("th",{children:"Carro"}),y.jsx("th",{children:"Acción"})]})}),y.jsx("tbody",{children:t.map(j=>{const H=!Vu(j.Moto),Y=!Vu(j.Carro);return y.jsxs("tr",{children:[y.jsx("td",{className:Cn.day,children:S8(j.Title)}),y.jsx("td",{children:y.jsx("input",{className:`${Cn.input} ${H?Cn.bad:""}`,value:j.Moto,onChange:I=>B(j.ID,"Moto",I.target.value),placeholder:"ej: 6,9",disabled:O,readOnly:O,tabIndex:O?-1:0})}),y.jsx("td",{children:y.jsx("input",{className:`${Cn.input} ${Y?Cn.bad:""}`,value:j.Carro,onChange:I=>B(j.ID,"Carro",I.target.value),placeholder:"ej: 6,9",disabled:O,readOnly:O,tabIndex:O?-1:0})}),y.jsx("td",{children:y.jsx("button",{className:Cn.button,onClick:()=>k(j),disabled:O||c===j.ID||H||Y,title:O?"Pico y Placa está deshabilitado":"Guardar cambios de esta fila",children:c===j.ID?"Guardando…":"Guardar"})})]},j.ID)})})]}),O&&y.jsx("div",{className:Cn.overlayMsg,children:"Pico y Placa está deshabilitado"})]}),y.jsxs("p",{className:Cn.hint,children:["Formato: dígitos 0–9 separados por comas. Ejemplos: ",y.jsx("code",{children:"6,9"}),", ",y.jsx("code",{children:"0,2,4,6,8"}),"."]})]})})};class E8{graph;constructor(e){this.graph=e}async getMeBasic(){const e=["id","displayName","givenName","surname","mail","userPrincipalName","jobTitle","department","officeLocation","businessPhones","mobilePhone"].join(","),t=await this.graph.get(`/me?$select=${encodeURIComponent(e)}`);return{id:String(t?.id??""),displayName:t?.displayName,givenName:t?.givenName,surname:t?.surname,mail:t?.mail??null,userPrincipalName:t?.userPrincipalName,jobTitle:t?.jobTitle??null,department:t?.department??null,officeLocation:t?.officeLocation??null,businessPhones:Array.isArray(t?.businessPhones)?t.businessPhones:[],mobilePhone:t?.mobilePhone??null}}async getMyPhotoDataUrl(){try{const e=await this.graph.getToken(),t=await fetch("https://graph.microsoft.com/v1.0/me/photo/$value",{headers:{Authorization:`Bearer ${e}`}});if(!t.ok)return null;const s=await(await t.blob()).arrayBuffer();return`data:image/jpeg;base64,${this.arrayBufferToBase64(s)}`}catch{return null}}arrayBufferToBase64(e){let t="";const a=new Uint8Array(e),s=a.byteLength;for(let l=0;l<s;l++)t+=String.fromCharCode(a[l]);return btoa(t)}}const A8=[{key:"misreservas",label:"Reservas"},{key:"celdas",label:"Celdas"},{key:"admin",label:"Administración"},{key:"pyp",label:"Pico y placa"},{key:"colaboradores",label:"Colaboradores"},{key:"reportes",label:"Reportes"}];function w8(){const{usuariosParking:n}=Ri();return{changeUser:async a=>{const s=(a??"").trim();if(!s)throw new Error("userEmail requerido");const c={filter:`Title eq '${s.replace(/'/g,"''")}'`,top:1},h=await n.getAll(c),g=(Array.isArray(h)?h:[])[0];if(!g)throw new Error(`Usuario no encontrado: ${s}`);const p=g.ID??g.Id??g.id;if(p==null)throw new Error("El usuario no tiene ID");const v=String(g.Rol??g.rol??"").toLowerCase(),_=v==="admin"?"Usuario":"admin";return await n.update(String(p),{Rol:_}),{ok:!0,id:p,email:s,before:v,after:_}},isUserPermitted:async a=>{const s=(a??"").trim();if(!s)return!1;const c={filter:`Title eq '${s.replace(/'/g,"''")}'`,top:1},h=await n.getAll(c),g=(Array.isArray(h)?h:[])[0];if(!g)return!1;const p=g.Permitidos??g.permitidos??g.Permitido;return p===!0||p===1||String(p).toLowerCase()==="true"}}}function b8(){const[n,e]=V.useState("misreservas"),[t,a]=V.useState(null),[s,l]=V.useState(!0),[c,h]=V.useState(null),[d,g]=V.useState(!1),[p,v]=V.useState(!1),{graph:_,shared:T}=Ri(),C=V.useMemo(()=>new E8(_),[_]),{changeUser:x,isUserPermitted:A}=w8(),B=async()=>{if(!(!t?.mail||d))try{g(!0);const{after:j}=await x(t.mail);h(j.toLowerCase())}catch(j){console.error(j)}finally{g(!1)}};V.useEffect(()=>{let j=!1;return l(!0),(async()=>{try{const H=await C.getMeBasic();if(j)return;a({displayName:H.displayName??void 0,mail:H.mail??H.userPrincipalName??void 0,jobTitle:H.jobTitle??void 0})}catch(H){j||a(null),console.error(H)}finally{j||l(!1)}})(),()=>{j=!0}},[C]),V.useEffect(()=>{h(null)},[t?.mail]),V.useEffect(()=>{const j=t?.mail;if(!j)return;let H=!1;return(async()=>{try{const Y=await T.getRole(j);H||(h(Y),Y==="admin"&&e(I=>I??"misreservas"))}catch(Y){console.error(Y),H||h("usuario")}})(),()=>{H=!0}},[t?.mail,T]),V.useEffect(()=>{let j=!1;return(async()=>{if(!t?.mail){v(!1);return}try{const H=await A(t.mail);j||v(H)}catch{j||v(!1)}})(),()=>{j=!0}},[t?.mail,A]);const k=c==="admin",O=j=>e(j);return s||c===null?y.jsx("div",{className:"center muted",style:{padding:24},children:"Cargando permisos…"}):y.jsx(KR,{children:y.jsxs("div",{className:"page",children:[y.jsx("div",{className:"section userCard",children:y.jsxs("div",{className:"userRow",children:[y.jsx("div",{className:"brand",children:y.jsx("h1",{children:"PARKING EDM"})}),y.jsxs("div",{className:"userCluster",children:[y.jsx("div",{className:"avatar",children:t?.displayName?t.displayName[0]:y.jsx("span",{children:"?"})}),y.jsx("div",{className:"userInfo",children:t?y.jsxs(y.Fragment,{children:[y.jsx("div",{className:"userName",children:t.displayName}),y.jsx("div",{className:"userMail",children:t.mail}),y.jsx("div",{className:"userMail",children:k?"admin":"usuario"}),t.jobTitle&&y.jsx("div",{className:"userTitle",children:t.jobTitle})]}):y.jsx("div",{className:"errorText",children:"No se pudo cargar el usuario"})})]})]})}),k&&y.jsx("nav",{className:"nav",children:A8.map(j=>y.jsx("button",{onClick:()=>O(j.key),className:"navBtn",style:{background:n===j.key?"#38bdf8":"#fff",color:n===j.key?"#fff":"#2563eb",boxShadow:n===j.key?"0 2px 8px #38bdf855":"none"},children:j.label},j.key))}),y.jsxs("main",{className:"main",children:[!k&&t?.mail&&y.jsxs(y.Fragment,{children:[y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Reservar Parqueadero"}),y.jsx(YR,{userEmail:t.mail,userName:t.displayName})]}),y.jsx(cT,{userMail:t.mail,isAdmin:!1})]}),k&&n==="misreservas"&&t?.mail&&y.jsx(cT,{userMail:t.mail,isAdmin:!0}),k&&n==="celdas"&&y.jsx(Ek,{}),k&&n==="admin"&&y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Administración"}),y.jsx(jk,{port:r_()})]}),k&&n==="colaboradores"&&y.jsxs("div",{className:"center",children:[y.jsx("h2",{children:"Colaboradores"}),y.jsx(XO,{})]}),k&&n==="reportes"&&y.jsx(r8,{}),k&&n==="pyp"&&y.jsx("div",{className:"center",children:y.jsx(C8,{})}),y.jsx("br",{}),p&&y.jsx("button",{onClick:B,disabled:!t?.mail||d,className:"btn-change-role","aria-busy":d||void 0,children:d?"Actualizando…":"Cambiar rol"})]})]})})}function I8(){return y.jsx(PR,{children:y.jsx(b8,{})})}vw.createRoot(document.getElementById("root")).render(y.jsx(NR,{children:y.jsx(V.StrictMode,{children:y.jsx(I8,{})})}));
